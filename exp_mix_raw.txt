Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=10, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=10, root_path='data/EcmP_stock_L_2016_24_mix_F_dva', scale=0.1, sequence_length=10, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.5696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7785281 KL Loss: 7.1133957 DSM Loss: 11.6830120 Overall Loss:20.5749359
Validation loss decreased (inf --> 4.772365).  Saving model ...
Updating learning rate to 0.0005
tensor(20.7759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8271325 KL Loss: 7.0892573 DSM Loss: 10.3447829 Overall Loss:19.2611727
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(17.0541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7122096 KL Loss: 6.9489346 DSM Loss: 9.7996525 Overall Loss:18.4607968
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.37239933013916


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.6062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8886691 KL Loss: 7.1981007 DSM Loss: 11.9560616 Overall Loss:21.0428313
Validation loss decreased (inf --> 10.465238).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7933793 KL Loss: 7.1181040 DSM Loss: 9.8087387 Overall Loss:18.7202219
Validation loss decreased (10.465238 --> 10.263268).  Saving model ...
Updating learning rate to 0.00025
tensor(18.0130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7983400 KL Loss: 7.2120167 DSM Loss: 9.5473789 Overall Loss:18.5577356
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(19.1628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1343, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7721237 KL Loss: 7.1350866 DSM Loss: 9.3758123 Overall Loss:18.2830226
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:17.81383514404297


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.6109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8373273 KL Loss: 7.1977099 DSM Loss: 11.8023434 Overall Loss:20.8373806
Validation loss decreased (inf --> 2.931340).  Saving model ...
Updating learning rate to 0.0005
tensor(15.0390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7890382 KL Loss: 7.1728518 DSM Loss: 9.8657562 Overall Loss:18.8276463
Validation loss decreased (2.931340 --> 2.488419).  Saving model ...
Updating learning rate to 0.00025
tensor(18.6403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7727787 KL Loss: 7.0642287 DSM Loss: 9.7433889 Overall Loss:18.5803963
Validation loss decreased (2.488419 --> 2.232724).  Saving model ...
Updating learning rate to 0.000125
tensor(16.4893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9509, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7168996 KL Loss: 7.0934390 DSM Loss: 9.4388283 Overall Loss:18.2491669
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(18.4941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7186143 KL Loss: 6.9942908 DSM Loss: 9.4557664 Overall Loss:18.1686715
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.89107346534729


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.4076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8039001 KL Loss: 7.2040351 DSM Loss: 13.5409893 Overall Loss:22.5489243
Validation loss decreased (inf --> 1.793520).  Saving model ...
Updating learning rate to 0.0005
tensor(16.1454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7202, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7968678 KL Loss: 7.0827040 DSM Loss: 10.0216651 Overall Loss:18.9012368
Validation loss decreased (1.793520 --> 1.505133).  Saving model ...
Updating learning rate to 0.00025
tensor(17.9880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7234197 KL Loss: 7.0020936 DSM Loss: 9.7415677 Overall Loss:18.4670810
Validation loss decreased (1.505133 --> 1.385219).  Saving model ...
Updating learning rate to 0.000125
tensor(17.1025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7584412 KL Loss: 7.0627479 DSM Loss: 9.4829556 Overall Loss:18.3041446
Validation loss decreased (1.385219 --> 1.326603).  Saving model ...
Updating learning rate to 6.25e-05
tensor(14.8679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8680, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7338158 KL Loss: 6.9455804 DSM Loss: 9.3210747 Overall Loss:18.0004710
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(22.0077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7021686 KL Loss: 6.9061587 DSM Loss: 9.3811991 Overall Loss:17.9895263
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.36751651763916


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.5039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8026465 KL Loss: 7.1641658 DSM Loss: 13.0504238 Overall Loss:22.0172361
Validation loss decreased (inf --> 1.845820).  Saving model ...
Updating learning rate to 0.0005
tensor(25.6985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7730840 KL Loss: 7.0552894 DSM Loss: 10.4243331 Overall Loss:19.2527066
Validation loss decreased (1.845820 --> 1.781363).  Saving model ...
Updating learning rate to 0.00025
tensor(16.1860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7356264 KL Loss: 6.9326324 DSM Loss: 9.6401852 Overall Loss:18.3084441
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(18.1833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7224998 KL Loss: 6.9313982 DSM Loss: 9.4298278 Overall Loss:18.0837259
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.3293236494064331


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.6709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2233, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8613656 KL Loss: 7.2253017 DSM Loss: 11.1648923 Overall Loss:20.2515597
Validation loss decreased (inf --> 7.284152).  Saving model ...
Updating learning rate to 0.0005
tensor(21.4141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2454, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8115973 KL Loss: 7.1105084 DSM Loss: 10.1434631 Overall Loss:19.0655688
Validation loss decreased (7.284152 --> 6.520741).  Saving model ...
Updating learning rate to 0.00025
tensor(17.1592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7721049 KL Loss: 7.0316816 DSM Loss: 9.4467193 Overall Loss:18.2505058
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(23.5713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6903573 KL Loss: 6.9183949 DSM Loss: 9.5772330 Overall Loss:18.1859850
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0157514810562134


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.1365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8585685 KL Loss: 7.1713861 DSM Loss: 12.1301956 Overall Loss:21.1601502
Validation loss decreased (inf --> 0.070703).  Saving model ...
Updating learning rate to 0.0005
tensor(20.8279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8118694 KL Loss: 7.0755627 DSM Loss: 10.2556605 Overall Loss:19.1430924
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(20.5921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7733867 KL Loss: 7.1175356 DSM Loss: 9.9224357 Overall Loss:18.8133581
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.16705475747585297


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.8878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6822, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8808975 KL Loss: 7.1642705 DSM Loss: 12.6196039 Overall Loss:21.6647718
Validation loss decreased (inf --> 0.530631).  Saving model ...
Updating learning rate to 0.0005
tensor(17.3437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8269285 KL Loss: 7.1502507 DSM Loss: 9.9330105 Overall Loss:18.9101895
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(23.8075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8031300 KL Loss: 7.1638021 DSM Loss: 9.7958360 Overall Loss:18.7627681
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.2224477380514145


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.7652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7922794 KL Loss: 7.1059409 DSM Loss: 11.6146287 Overall Loss:20.5128490
Validation loss decreased (inf --> 2.143588).  Saving model ...
Updating learning rate to 0.0005
tensor(14.5922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1320, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7611047 KL Loss: 7.0429610 DSM Loss: 9.9260867 Overall Loss:18.7301524
Validation loss decreased (2.143588 --> 1.884019).  Saving model ...
Updating learning rate to 0.00025
tensor(15.7145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2384, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7765186 KL Loss: 7.0745491 DSM Loss: 9.6040896 Overall Loss:18.4551573
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(21.9558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7004207 KL Loss: 6.9726547 DSM Loss: 9.2642501 Overall Loss:17.9373255
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.031747579574585


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.8718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5051, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8363848 KL Loss: 7.1800167 DSM Loss: 12.7354661 Overall Loss:21.7518677
Validation loss decreased (inf --> 0.245936).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.6985889 KL Loss: 6.9137153 DSM Loss: 10.1262096 Overall Loss:18.7385138
Validation loss decreased (0.245936 --> 0.091313).  Saving model ...
Updating learning rate to 0.00025
tensor(18.5072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7783798 KL Loss: 6.9934279 DSM Loss: 9.6983496 Overall Loss:18.4701571
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(19.1612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7098667 KL Loss: 6.9726586 DSM Loss: 9.5884329 Overall Loss:18.2709581
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7904974222183228


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.2570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8632443 KL Loss: 7.2249705 DSM Loss: 10.9840202 Overall Loss:20.0722351
Validation loss decreased (inf --> 9.980126).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9052, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7993813 KL Loss: 7.1798435 DSM Loss: 9.8012235 Overall Loss:18.7804482
Validation loss decreased (9.980126 --> 8.969098).  Saving model ...
Updating learning rate to 0.00025
tensor(19.2049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7548577 KL Loss: 7.1117137 DSM Loss: 9.5954796 Overall Loss:18.4620508
Validation loss decreased (8.969098 --> 8.654144).  Saving model ...
Updating learning rate to 0.000125
tensor(18.3428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7805606 KL Loss: 7.1117815 DSM Loss: 9.1279257 Overall Loss:18.0202677
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(22.3530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7415470 KL Loss: 7.0437451 DSM Loss: 9.3609546 Overall Loss:18.1462466
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:11.345685005187988


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.5153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2182, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8090735 KL Loss: 7.1119748 DSM Loss: 12.2675841 Overall Loss:21.1886323
Validation loss decreased (inf --> 0.262288).  Saving model ...
Updating learning rate to 0.0005
tensor(17.3632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7058, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7547492 KL Loss: 7.0260546 DSM Loss: 9.9718500 Overall Loss:18.7526537
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(21.0966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5179, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.6999756 KL Loss: 7.0017425 DSM Loss: 9.7408309 Overall Loss:18.4425490
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5088292360305786


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(30.8193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4375, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8905317 KL Loss: 7.2023291 DSM Loss: 12.3653638 Overall Loss:21.4582245
Validation loss decreased (inf --> 1.861114).  Saving model ...
Updating learning rate to 0.0005
tensor(18.3694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7341331 KL Loss: 7.0062594 DSM Loss: 10.1733441 Overall Loss:18.9137367
Validation loss decreased (1.861114 --> 0.957078).  Saving model ...
Updating learning rate to 0.00025
tensor(16.3296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7446445 KL Loss: 6.9485018 DSM Loss: 9.8947934 Overall Loss:18.5879397
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.3617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7059348 KL Loss: 6.8885870 DSM Loss: 9.5379100 Overall Loss:18.1324317
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1833819150924683


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.2327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8514, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8122279 KL Loss: 7.2101343 DSM Loss: 13.2318229 Overall Loss:22.2541852
Validation loss decreased (inf --> 5.302963).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7942052 KL Loss: 7.0414972 DSM Loss: 9.9791646 Overall Loss:18.8148670
Validation loss decreased (5.302963 --> 4.881438).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7067771 KL Loss: 6.9067234 DSM Loss: 9.5370632 Overall Loss:18.1505637
Validation loss decreased (4.881438 --> 4.545724).  Saving model ...
Updating learning rate to 0.000125
tensor(19.6302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7212340 KL Loss: 6.9078348 DSM Loss: 9.4374854 Overall Loss:18.0665541
Validation loss decreased (4.545724 --> 3.732111).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.6451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.3068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7032741 KL Loss: 6.8852314 DSM Loss: 9.4075366 Overall Loss:17.9960421
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(21.2430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1621, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.6909543 KL Loss: 6.9243519 DSM Loss: 9.2514214 Overall Loss:17.8667275
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.317070484161377


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.6905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8094624 KL Loss: 7.1317787 DSM Loss: 11.5892889 Overall Loss:20.5305301
Validation loss decreased (inf --> 3.091226).  Saving model ...
Updating learning rate to 0.0005
tensor(14.1743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7526075 KL Loss: 7.0659470 DSM Loss: 10.3467783 Overall Loss:19.1653327
Validation loss decreased (3.091226 --> 2.407903).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7240424 KL Loss: 6.8909154 DSM Loss: 9.6447109 Overall Loss:18.2596686
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(16.8691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0486, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6802951 KL Loss: 6.9038535 DSM Loss: 9.5009578 Overall Loss:18.0851064
Validation loss decreased (2.407903 --> 2.404257).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.3544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7358215 KL Loss: 7.0016465 DSM Loss: 9.3340521 Overall Loss:18.0715201
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(17.7013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.6790980 KL Loss: 6.8758570 DSM Loss: 9.1358933 Overall Loss:17.6908481
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.06829013675451279


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.1743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8204803 KL Loss: 7.1976253 DSM Loss: 11.1017056 Overall Loss:20.1198111
Validation loss decreased (inf --> 2.712432).  Saving model ...
Updating learning rate to 0.0005
tensor(11.2992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7502965 KL Loss: 7.0546157 DSM Loss: 9.7965664 Overall Loss:18.6014786
Validation loss decreased (2.712432 --> 2.553440).  Saving model ...
Updating learning rate to 0.00025
tensor(16.4067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7702355 KL Loss: 7.0294153 DSM Loss: 9.2652280 Overall Loss:18.0648787
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(25.0852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7686345 KL Loss: 7.0820543 DSM Loss: 9.2697425 Overall Loss:18.1204312
Validation loss decreased (2.553440 --> 2.376789).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.5085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7009038 KL Loss: 6.9808714 DSM Loss: 9.0789359 Overall Loss:17.7607111
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(15.9289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7391829 KL Loss: 6.9521673 DSM Loss: 9.2433220 Overall Loss:17.9346721
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.3415362536907196


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.7124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8005, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7622014 KL Loss: 7.1094732 DSM Loss: 12.1156327 Overall Loss:20.9873073
Validation loss decreased (inf --> 11.466640).  Saving model ...
Updating learning rate to 0.0005
tensor(12.5293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8077215 KL Loss: 7.0041763 DSM Loss: 10.2673985 Overall Loss:19.0792962
Validation loss decreased (11.466640 --> 10.687175).  Saving model ...
Updating learning rate to 0.00025
tensor(12.9674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.6363246 KL Loss: 6.9262660 DSM Loss: 9.7686260 Overall Loss:18.3312166
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.1209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6567827 KL Loss: 6.8606983 DSM Loss: 9.4753100 Overall Loss:17.9927909
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.2460434436798096


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.4856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4642, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8688424 KL Loss: 7.1771676 DSM Loss: 12.9142148 Overall Loss:21.9602248
Validation loss decreased (inf --> 3.743500).  Saving model ...
Updating learning rate to 0.0005
tensor(16.0098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7985247 KL Loss: 7.0728812 DSM Loss: 10.0149747 Overall Loss:18.8863806
Validation loss decreased (3.743500 --> 3.409029).  Saving model ...
Updating learning rate to 0.00025
tensor(22.4836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7774378 KL Loss: 7.0437212 DSM Loss: 9.5780031 Overall Loss:18.3991622
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(14.5630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7518602 KL Loss: 7.0212293 DSM Loss: 9.3097526 Overall Loss:18.0828421
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7366214990615845


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.2265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8060136 KL Loss: 7.0934517 DSM Loss: 10.9801347 Overall Loss:19.8796000
Validation loss decreased (inf --> 12.321787).  Saving model ...
Updating learning rate to 0.0005
tensor(18.1333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8347484 KL Loss: 7.1277146 DSM Loss: 9.5977400 Overall Loss:18.5602030
Validation loss decreased (12.321787 --> 12.260692).  Saving model ...
Updating learning rate to 0.00025
tensor(23.6287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8103667 KL Loss: 7.1094384 DSM Loss: 9.4775897 Overall Loss:18.3973949
Validation loss decreased (12.260692 --> 11.659005).  Saving model ...
Updating learning rate to 0.000125
tensor(15.3847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7805605 KL Loss: 7.0353170 DSM Loss: 9.4356909 Overall Loss:18.2515684
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(20.7570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7020412 KL Loss: 6.9744355 DSM Loss: 9.0248268 Overall Loss:17.7013035
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:35.92361831665039


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.9278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7641320 KL Loss: 7.0969787 DSM Loss: 12.6684316 Overall Loss:21.5295423
Validation loss decreased (inf --> 0.981127).  Saving model ...
Updating learning rate to 0.0005
tensor(14.5945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7980663 KL Loss: 7.1092572 DSM Loss: 10.0464150 Overall Loss:18.9537385
Validation loss decreased (0.981127 --> 0.697309).  Saving model ...
Updating learning rate to 0.00025
tensor(17.3928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7620314 KL Loss: 7.0756684 DSM Loss: 9.5690352 Overall Loss:18.4067350
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(17.5569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7487075 KL Loss: 7.0579232 DSM Loss: 9.4546018 Overall Loss:18.2612324
Validation loss decreased (0.697309 --> 0.560968).  Saving model ...
Updating learning rate to 6.25e-05
tensor(15.2362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7630384 KL Loss: 7.0534823 DSM Loss: 9.5339043 Overall Loss:18.3504249
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(14.5160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7389147 KL Loss: 7.0683795 DSM Loss: 9.2425010 Overall Loss:18.0497952
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7357819676399231


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(31.4828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8679018 KL Loss: 7.2052007 DSM Loss: 11.8350460 Overall Loss:20.9081484
Validation loss decreased (inf --> 8.270481).  Saving model ...
Updating learning rate to 0.0005
tensor(13.4066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8067148 KL Loss: 7.0413527 DSM Loss: 10.0443070 Overall Loss:18.8923744
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(17.3708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7225603 KL Loss: 7.0021525 DSM Loss: 9.5718980 Overall Loss:18.2966107
Validation loss decreased (8.270481 --> 8.102587).  Saving model ...
Updating learning rate to 0.000125
tensor(21.2819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2094, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7337618 KL Loss: 6.9610025 DSM Loss: 9.3530169 Overall Loss:18.0477813
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(16.1983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.5323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7429137 KL Loss: 6.9298466 DSM Loss: 9.4062054 Overall Loss:18.0789657
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.533068656921387


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.3316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7550677 KL Loss: 7.0469026 DSM Loss: 11.7569478 Overall Loss:20.5589182
Validation loss decreased (inf --> 2.315289).  Saving model ...
Updating learning rate to 0.0005
tensor(24.9244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7890127 KL Loss: 7.0665159 DSM Loss: 10.2131915 Overall Loss:19.0687200
Validation loss decreased (2.315289 --> 1.905786).  Saving model ...
Updating learning rate to 0.00025
tensor(20.3559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7939513 KL Loss: 7.0804477 DSM Loss: 9.7162906 Overall Loss:18.5906896
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(19.8763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7299854 KL Loss: 7.0261894 DSM Loss: 9.7169520 Overall Loss:18.4731268
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9346522092819214


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(20.9549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7834126 KL Loss: 7.1299825 DSM Loss: 11.7179591 Overall Loss:20.6313542
Validation loss decreased (inf --> 7.487351).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7464247 KL Loss: 7.0545265 DSM Loss: 10.2535492 Overall Loss:19.0545004
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(18.8862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7180381 KL Loss: 6.9333955 DSM Loss: 9.4682812 Overall Loss:18.1197149
Validation loss decreased (7.487351 --> 6.721828).  Saving model ...
Updating learning rate to 0.000125
tensor(21.4797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6605860 KL Loss: 6.8090252 DSM Loss: 9.2657683 Overall Loss:17.7353795
Validation loss decreased (6.721828 --> 5.659081).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.4146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7490, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.6857452 KL Loss: 6.9353002 DSM Loss: 9.1842076 Overall Loss:17.8052530
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(15.0806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7046108 KL Loss: 6.9442727 DSM Loss: 9.2024894 Overall Loss:17.8513729
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.6741557121276855


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.1724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8513643 KL Loss: 7.2014286 DSM Loss: 11.8876306 Overall Loss:20.9404235
Validation loss decreased (inf --> 2.799656).  Saving model ...
Updating learning rate to 0.0005
tensor(24.2163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8464630 KL Loss: 7.1428045 DSM Loss: 10.0109874 Overall Loss:19.0002549
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(22.7732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7003196 KL Loss: 7.0069198 DSM Loss: 9.5646264 Overall Loss:18.2718658
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.7662196159362793


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.6203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8839476 KL Loss: 7.2012285 DSM Loss: 12.5637294 Overall Loss:21.6489054
Validation loss decreased (inf --> 13.004637).  Saving model ...
Updating learning rate to 0.0005
tensor(20.2974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8710, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8250854 KL Loss: 7.1463104 DSM Loss: 9.6499773 Overall Loss:18.6213731
Validation loss decreased (13.004637 --> 11.854641).  Saving model ...
Updating learning rate to 0.00025
tensor(19.1351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7798989 KL Loss: 7.1158425 DSM Loss: 9.2599241 Overall Loss:18.1556654
Validation loss decreased (11.854641 --> 11.380381).  Saving model ...
Updating learning rate to 0.000125
tensor(17.1358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7213405 KL Loss: 7.0789293 DSM Loss: 9.1364170 Overall Loss:17.9366868
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(15.5030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7046829 KL Loss: 6.9724004 DSM Loss: 9.0618784 Overall Loss:17.7389617
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:14.669159889221191


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(30.9735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8021959 KL Loss: 7.1667181 DSM Loss: 11.2117418 Overall Loss:20.1806555
Validation loss decreased (inf --> 5.065337).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9355, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8246560 KL Loss: 7.1745128 DSM Loss: 9.8023222 Overall Loss:18.8014911
Validation loss decreased (5.065337 --> 4.546812).  Saving model ...
Updating learning rate to 0.00025
tensor(18.4137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7415979 KL Loss: 7.0994363 DSM Loss: 9.4392281 Overall Loss:18.2802624
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(23.8224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7670339 KL Loss: 7.1671970 DSM Loss: 9.1315649 Overall Loss:18.0657958
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.794808387756348


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.7532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3014, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8277858 KL Loss: 7.1402579 DSM Loss: 11.7395855 Overall Loss:20.7076293
Validation loss decreased (inf --> 0.491885).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7942631 KL Loss: 6.9951285 DSM Loss: 10.2863587 Overall Loss:19.0757502
Validation loss decreased (0.491885 --> 0.083975).  Saving model ...
Updating learning rate to 0.00025
tensor(20.0248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7944358 KL Loss: 7.0267440 DSM Loss: 9.8961557 Overall Loss:18.7173355
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(17.8465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7445474 KL Loss: 6.9376900 DSM Loss: 9.6035147 Overall Loss:18.2857520
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.19967712461948395


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.4583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8555829 KL Loss: 7.1071001 DSM Loss: 11.3041689 Overall Loss:20.2668518
Validation loss decreased (inf --> 13.374542).  Saving model ...
Updating learning rate to 0.0005
tensor(20.0481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.3588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7608213 KL Loss: 6.9356149 DSM Loss: 9.6818238 Overall Loss:18.3782600
Validation loss decreased (13.374542 --> 11.036871).  Saving model ...
Updating learning rate to 0.00025
tensor(17.5258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7687464 KL Loss: 6.9979517 DSM Loss: 9.2745189 Overall Loss:18.0412170
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.4321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.5730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7948547 KL Loss: 6.9497152 DSM Loss: 9.3658356 Overall Loss:18.1104055
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.3107099533081055


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.3779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9237899 KL Loss: 7.2852639 DSM Loss: 13.1089503 Overall Loss:22.3180040
Validation loss decreased (inf --> 9.749642).  Saving model ...
Updating learning rate to 0.0005
tensor(23.2112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8294963 KL Loss: 7.1812693 DSM Loss: 9.6974458 Overall Loss:18.7082114
Validation loss decreased (9.749642 --> 7.407913).  Saving model ...
Updating learning rate to 0.00025
tensor(13.6279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7876105 KL Loss: 7.0745394 DSM Loss: 9.5776989 Overall Loss:18.4398487
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(16.6855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7777991 KL Loss: 7.0947328 DSM Loss: 9.4084681 Overall Loss:18.2810002
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.307169437408447


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.6664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0580, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8720475 KL Loss: 7.1665260 DSM Loss: 11.7816142 Overall Loss:20.8201878
Validation loss decreased (inf --> 3.540201).  Saving model ...
Updating learning rate to 0.0005
tensor(17.1719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7530752 KL Loss: 7.0766637 DSM Loss: 9.6643041 Overall Loss:18.4940429
Validation loss decreased (3.540201 --> 2.923822).  Saving model ...
Updating learning rate to 0.00025
tensor(12.8017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7207682 KL Loss: 6.9578489 DSM Loss: 9.5514300 Overall Loss:18.2300471
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.9816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.5386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6936075 KL Loss: 6.8844334 DSM Loss: 9.3270943 Overall Loss:17.9051352
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.189223527908325


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.5280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8039728 KL Loss: 7.1388801 DSM Loss: 12.5815815 Overall Loss:21.5244345
Validation loss decreased (inf --> 0.261247).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7603583 KL Loss: 7.0565185 DSM Loss: 10.0706215 Overall Loss:18.8874982
Validation loss decreased (0.261247 --> 0.193471).  Saving model ...
Updating learning rate to 0.00025
tensor(19.0396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7316512 KL Loss: 7.0679079 DSM Loss: 9.7153107 Overall Loss:18.5148698
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(21.3713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7242, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7173597 KL Loss: 6.9869523 DSM Loss: 9.7120463 Overall Loss:18.4163583
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6322392225265503


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.0601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8403536 KL Loss: 7.1810142 DSM Loss: 11.5983850 Overall Loss:20.6197528
Validation loss decreased (inf --> 2.365528).  Saving model ...
Updating learning rate to 0.0005
tensor(13.7125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8482849 KL Loss: 7.2200860 DSM Loss: 10.0636704 Overall Loss:19.1320413
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(19.5269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7540719 KL Loss: 7.0900901 DSM Loss: 9.9196702 Overall Loss:18.7638321
Validation loss decreased (2.365528 --> 1.826719).  Saving model ...
Updating learning rate to 0.000125
tensor(19.8578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7399691 KL Loss: 7.0387733 DSM Loss: 9.5443220 Overall Loss:18.3230644
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(19.4101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7246259 KL Loss: 7.0047980 DSM Loss: 9.5093187 Overall Loss:18.2387426
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.080333948135376


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.2669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0958, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8509559 KL Loss: 7.2185639 DSM Loss: 11.3157201 Overall Loss:20.3852399
Validation loss decreased (inf --> 0.980232).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7855577 KL Loss: 7.1048020 DSM Loss: 9.7721214 Overall Loss:18.6624811
Validation loss decreased (0.980232 --> 0.420142).  Saving model ...
Updating learning rate to 0.00025
tensor(19.8763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7890271 KL Loss: 7.1260906 DSM Loss: 9.6306240 Overall Loss:18.5457416
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.2813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7254328 KL Loss: 7.0709749 DSM Loss: 9.4183210 Overall Loss:18.2147288
Validation loss decreased (0.420142 --> 0.320598).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.2423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7255091 KL Loss: 6.9538607 DSM Loss: 9.2970371 Overall Loss:17.9764069
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(19.4480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7199170 KL Loss: 7.0427578 DSM Loss: 9.2252538 Overall Loss:17.9879287
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8815508484840393


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.1972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7961001 KL Loss: 7.1374041 DSM Loss: 11.2742581 Overall Loss:20.2077623
Validation loss decreased (inf --> 5.592465).  Saving model ...
Updating learning rate to 0.0005
tensor(19.6205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.4403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8504032 KL Loss: 7.2097912 DSM Loss: 9.6516182 Overall Loss:18.7118126
Validation loss decreased (5.592465 --> 5.520573).  Saving model ...
Updating learning rate to 0.00025
tensor(17.0329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7612674 KL Loss: 7.1529326 DSM Loss: 9.3723110 Overall Loss:18.2865110
Validation loss decreased (5.520573 --> 5.436495).  Saving model ...
Updating learning rate to 0.000125
tensor(24.5743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9388, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7482954 KL Loss: 7.0701759 DSM Loss: 9.2072544 Overall Loss:18.0257257
Validation loss decreased (5.436495 --> 4.975271).  Saving model ...
Updating learning rate to 6.25e-05
tensor(15.3038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7594210 KL Loss: 7.0907544 DSM Loss: 9.1236521 Overall Loss:17.9738275
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(11.7565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7677277 KL Loss: 7.0506124 DSM Loss: 8.9095002 Overall Loss:17.7278403
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.111303806304932


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(37.0978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8798531 KL Loss: 7.2084561 DSM Loss: 11.2503562 Overall Loss:20.3386654
Validation loss decreased (inf --> 4.841216).  Saving model ...
Updating learning rate to 0.0005
tensor(15.9259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8586541 KL Loss: 7.2057462 DSM Loss: 9.7578009 Overall Loss:18.8222011
Validation loss decreased (4.841216 --> 4.283914).  Saving model ...
Updating learning rate to 0.00025
tensor(23.8003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7800721 KL Loss: 7.1026019 DSM Loss: 9.5636721 Overall Loss:18.4463462
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(14.1117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0205, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7235728 KL Loss: 7.0400474 DSM Loss: 9.4111532 Overall Loss:18.1747735
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.7042367458343506


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(31.8248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1384, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8742192 KL Loss: 7.2103349 DSM Loss: 14.7556630 Overall Loss:23.8402173
Validation loss decreased (inf --> 5.812680).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7787620 KL Loss: 7.0330665 DSM Loss: 10.0271270 Overall Loss:18.8389556
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(19.0001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7415364 KL Loss: 7.0413993 DSM Loss: 9.4034417 Overall Loss:18.1863775
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.02718734741211


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(31.0724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8228935 KL Loss: 7.1921224 DSM Loss: 12.0058255 Overall Loss:21.0208414
Validation loss decreased (inf --> 2.867302).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8246485 KL Loss: 7.1351343 DSM Loss: 9.9577857 Overall Loss:18.9175684
Validation loss decreased (2.867302 --> 2.492663).  Saving model ...
Updating learning rate to 0.00025
tensor(16.8808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0534, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7681154 KL Loss: 7.0446805 DSM Loss: 9.6598538 Overall Loss:18.4726497
Validation loss decreased (2.492663 --> 2.255073).  Saving model ...
Updating learning rate to 0.000125
tensor(16.3474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4098, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6948887 KL Loss: 6.9815935 DSM Loss: 9.4232080 Overall Loss:18.0996901
Validation loss decreased (2.255073 --> 2.234871).  Saving model ...
Updating learning rate to 6.25e-05
tensor(19.0660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7015592 KL Loss: 6.9473840 DSM Loss: 9.2932202 Overall Loss:17.9421634
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(16.6401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7283361 KL Loss: 6.9611413 DSM Loss: 9.3979015 Overall Loss:18.0873789
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.912374496459961


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.7228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8222716 KL Loss: 7.2325586 DSM Loss: 12.4281906 Overall Loss:21.4830208
Validation loss decreased (inf --> 1.737829).  Saving model ...
Updating learning rate to 0.0005
tensor(18.7778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4056, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8193263 KL Loss: 7.1357359 DSM Loss: 10.3249304 Overall Loss:19.2799927
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(20.9836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7752345 KL Loss: 7.0148507 DSM Loss: 9.7244389 Overall Loss:18.5145241
Validation loss decreased (1.737829 --> 1.677263).  Saving model ...
Updating learning rate to 0.000125
tensor(16.0366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7421727 KL Loss: 7.0171948 DSM Loss: 9.4527966 Overall Loss:18.2121642
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(16.7635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.6789033 KL Loss: 6.9701244 DSM Loss: 9.3389238 Overall Loss:17.9879516
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.098851442337036


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(39.8721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7331, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8806380 KL Loss: 7.2285235 DSM Loss: 11.3182965 Overall Loss:20.4274579
Validation loss decreased (inf --> 4.406787).  Saving model ...
Updating learning rate to 0.0005
tensor(22.8981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8188208 KL Loss: 7.1872756 DSM Loss: 9.9808170 Overall Loss:18.9869133
Validation loss decreased (4.406787 --> 4.003934).  Saving model ...
Updating learning rate to 0.00025
tensor(16.3174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3236, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7736350 KL Loss: 7.1012829 DSM Loss: 9.6267423 Overall Loss:18.5016601
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(18.6164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7516272 KL Loss: 7.0683278 DSM Loss: 9.5336471 Overall Loss:18.3536022
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.5200042724609375


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.8294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8270568 KL Loss: 7.1400659 DSM Loss: 10.8618280 Overall Loss:19.8289506
Validation loss decreased (inf --> 2.956464).  Saving model ...
Updating learning rate to 0.0005
tensor(19.6411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7518711 KL Loss: 6.9921269 DSM Loss: 9.9971708 Overall Loss:18.7411688
Validation loss decreased (2.956464 --> 2.596485).  Saving model ...
Updating learning rate to 0.00025
tensor(18.0885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8134498 KL Loss: 7.0662428 DSM Loss: 9.5426128 Overall Loss:18.4223054
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(18.7349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6877859 KL Loss: 6.9579378 DSM Loss: 9.4396835 Overall Loss:18.0854072
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1077481135725975


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.6922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8518734 KL Loss: 7.2133157 DSM Loss: 11.0330287 Overall Loss:20.0982178
Validation loss decreased (inf --> 0.587238).  Saving model ...
Updating learning rate to 0.0005
tensor(15.9431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7562376 KL Loss: 7.0719380 DSM Loss: 9.7937347 Overall Loss:18.6219102
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(22.7412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7586748 KL Loss: 7.0362115 DSM Loss: 9.2563528 Overall Loss:18.0512391
Validation loss decreased (0.587238 --> 0.392470).  Saving model ...
Updating learning rate to 0.000125
tensor(18.0688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7638693 KL Loss: 7.0469470 DSM Loss: 9.2329713 Overall Loss:18.0437874
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(17.9549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7210321 KL Loss: 7.0280319 DSM Loss: 9.0975103 Overall Loss:17.8465743
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.509426593780518


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.5595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8174819 KL Loss: 7.2084566 DSM Loss: 11.4386453 Overall Loss:20.4645837
Validation loss decreased (inf --> 3.010025).  Saving model ...
Updating learning rate to 0.0005
tensor(26.7796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7910851 KL Loss: 7.1088825 DSM Loss: 10.1872817 Overall Loss:19.0872493
Validation loss decreased (3.010025 --> 1.355010).  Saving model ...
Updating learning rate to 0.00025
tensor(11.4731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6447, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7296149 KL Loss: 6.9963849 DSM Loss: 9.9767382 Overall Loss:18.7027380
Validation loss decreased (1.355010 --> 1.086248).  Saving model ...
Updating learning rate to 0.000125
tensor(15.9590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7835455 KL Loss: 7.0858696 DSM Loss: 9.7884359 Overall Loss:18.6578511
Validation loss decreased (1.086248 --> 1.036383).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.6348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7421282 KL Loss: 6.9835086 DSM Loss: 9.6062133 Overall Loss:18.3318503
Validation loss decreased (1.036383 --> 1.023288).  Saving model ...
Updating learning rate to 3.125e-05
tensor(12.4500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8607, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.6983469 KL Loss: 6.9833918 DSM Loss: 9.7275391 Overall Loss:18.4092776
Validation loss decreased (1.023288 --> 1.001126).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(18.2219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7240674 KL Loss: 7.0293808 DSM Loss: 9.5919760 Overall Loss:18.3454243
Validation loss decreased (1.001126 --> 0.975719).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(16.5429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9863, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.6855872 KL Loss: 6.9365700 DSM Loss: 9.3749040 Overall Loss:17.9970610
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(15.8651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3368, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.6970267 KL Loss: 6.9635216 DSM Loss: 9.5422232 Overall Loss:18.2027714
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.582906186580658


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.1100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8473057 KL Loss: 7.2334336 DSM Loss: 11.8844258 Overall Loss:20.9651652
Validation loss decreased (inf --> 3.106392).  Saving model ...
Updating learning rate to 0.0005
tensor(21.2021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8103252 KL Loss: 7.0828083 DSM Loss: 10.0546380 Overall Loss:18.9477716
Validation loss decreased (3.106392 --> 2.631785).  Saving model ...
Updating learning rate to 0.00025
tensor(19.5256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7670922 KL Loss: 7.0879571 DSM Loss: 9.5880953 Overall Loss:18.4431445
Validation loss decreased (2.631785 --> 2.098909).  Saving model ...
Updating learning rate to 0.000125
tensor(18.0095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8646, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6988025 KL Loss: 6.9485505 DSM Loss: 9.3715208 Overall Loss:18.0188738
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(18.5245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7280768 KL Loss: 6.9378302 DSM Loss: 9.3947526 Overall Loss:18.0606596
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:14.130239486694336


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.1956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0515, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8080079 KL Loss: 7.1452873 DSM Loss: 11.5756354 Overall Loss:20.5289307
Validation loss decreased (inf --> 7.172646).  Saving model ...
Updating learning rate to 0.0005
tensor(21.6721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7474, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7395659 KL Loss: 7.0490043 DSM Loss: 9.8569245 Overall Loss:18.6454947
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(15.9417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7164713 KL Loss: 6.9306449 DSM Loss: 9.8035163 Overall Loss:18.4506325
Validation loss decreased (7.172646 --> 6.100723).  Saving model ...
Updating learning rate to 0.000125
tensor(16.7213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7302810 KL Loss: 7.0085472 DSM Loss: 9.5111425 Overall Loss:18.2499706
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(17.9442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.6949068 KL Loss: 6.8810014 DSM Loss: 9.2157720 Overall Loss:17.7916803
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.526640892028809


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.7817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7350, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7980898 KL Loss: 7.1414079 DSM Loss: 12.2188763 Overall Loss:21.1583739
Validation loss decreased (inf --> 4.471297).  Saving model ...
Updating learning rate to 0.0005
tensor(14.4653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7827463 KL Loss: 7.0623069 DSM Loss: 9.8492471 Overall Loss:18.6943003
Validation loss decreased (4.471297 --> 4.321938).  Saving model ...
Updating learning rate to 0.00025
tensor(14.7371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7790501 KL Loss: 7.1157537 DSM Loss: 9.6694183 Overall Loss:18.5642221
Validation loss decreased (4.321938 --> 3.270454).  Saving model ...
Updating learning rate to 0.000125
tensor(17.2613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7021948 KL Loss: 6.9526369 DSM Loss: 9.5038642 Overall Loss:18.1586957
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(15.4885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9738, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7520206 KL Loss: 6.9764660 DSM Loss: 9.4433627 Overall Loss:18.1718493
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.438323497772217


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.5068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8240711 KL Loss: 7.2029935 DSM Loss: 11.5435893 Overall Loss:20.5706538
Validation loss decreased (inf --> 11.144632).  Saving model ...
Updating learning rate to 0.0005
tensor(23.4158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7957675 KL Loss: 7.0965536 DSM Loss: 10.0410931 Overall Loss:18.9334140
Validation loss decreased (11.144632 --> 11.141720).  Saving model ...
Updating learning rate to 0.00025
tensor(14.7758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8086077 KL Loss: 7.1510644 DSM Loss: 9.8660508 Overall Loss:18.8257230
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.9194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8372487 KL Loss: 7.1641889 DSM Loss: 9.4599848 Overall Loss:18.4614225
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.875764846801758


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.7173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8425946 KL Loss: 7.1980656 DSM Loss: 13.0090574 Overall Loss:22.0497176
Validation loss decreased (inf --> 1.048116).  Saving model ...
Updating learning rate to 0.0005
tensor(18.0945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.6864935 KL Loss: 6.8906432 DSM Loss: 10.0110066 Overall Loss:18.5881432
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(21.0826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7054701 KL Loss: 6.9008930 DSM Loss: 9.6264096 Overall Loss:18.2327728
Validation loss decreased (1.048116 --> 0.959044).  Saving model ...
Updating learning rate to 0.000125
tensor(17.6370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6901218 KL Loss: 6.8930058 DSM Loss: 9.5651418 Overall Loss:18.1482695
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(22.9214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.6821057 KL Loss: 6.8809333 DSM Loss: 9.5208858 Overall Loss:18.0839248
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.818943738937378


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.8999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5514, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8102452 KL Loss: 7.1725246 DSM Loss: 10.7876627 Overall Loss:19.7704323
Validation loss decreased (inf --> 11.626724).  Saving model ...
Updating learning rate to 0.0005
tensor(25.1025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9582, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7974059 KL Loss: 7.1018678 DSM Loss: 9.6668148 Overall Loss:18.5660884
Validation loss decreased (11.626724 --> 10.512295).  Saving model ...
Updating learning rate to 0.00025
tensor(28.6043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8063621 KL Loss: 7.0688278 DSM Loss: 9.4176716 Overall Loss:18.2928614
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(17.7040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.8359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7816458 KL Loss: 7.0455231 DSM Loss: 9.2002806 Overall Loss:18.0274496
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:17.96766471862793


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.1646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8039945 KL Loss: 7.1832331 DSM Loss: 11.6972774 Overall Loss:20.6845049
Validation loss decreased (inf --> 0.346531).  Saving model ...
Updating learning rate to 0.0005
tensor(20.9689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8112671 KL Loss: 7.1251072 DSM Loss: 10.4249989 Overall Loss:19.3613731
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(19.3754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9188, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7926894 KL Loss: 7.0872345 DSM Loss: 9.8995374 Overall Loss:18.7794614
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.18848057091236115


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.1065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8848429 KL Loss: 7.2706613 DSM Loss: 13.6902507 Overall Loss:22.8457548
Validation loss decreased (inf --> 6.322665).  Saving model ...
Updating learning rate to 0.0005
tensor(21.3633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7693271 KL Loss: 7.0955516 DSM Loss: 9.9016472 Overall Loss:18.7665258
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(17.2801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7166833 KL Loss: 7.0204405 DSM Loss: 9.4446216 Overall Loss:18.1817453
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:11.854105949401855


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.8775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4559, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7684043 KL Loss: 7.1340903 DSM Loss: 11.0081356 Overall Loss:19.9106303
Validation loss decreased (inf --> 15.516070).  Saving model ...
Updating learning rate to 0.0005
tensor(16.5390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7982347 KL Loss: 7.0668690 DSM Loss: 9.8938741 Overall Loss:18.7589777
Validation loss decreased (15.516070 --> 14.452123).  Saving model ...
Updating learning rate to 0.00025
tensor(19.0322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7159702 KL Loss: 6.9839557 DSM Loss: 9.5219699 Overall Loss:18.2218957
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(21.8289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6949622 KL Loss: 6.9550004 DSM Loss: 9.2353261 Overall Loss:17.8852886
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.132898330688477


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.7577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7939541 KL Loss: 7.1718620 DSM Loss: 12.0159777 Overall Loss:20.9817938
Validation loss decreased (inf --> 5.294995).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7793916 KL Loss: 7.0167008 DSM Loss: 10.0724009 Overall Loss:18.8684931
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(16.9304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7586694 KL Loss: 6.9637700 DSM Loss: 9.6106267 Overall Loss:18.3330661
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.050405025482178


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.4962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7185776 KL Loss: 7.0732361 DSM Loss: 11.2634303 Overall Loss:20.0552440
Validation loss decreased (inf --> 4.532505).  Saving model ...
Updating learning rate to 0.0005
tensor(15.3037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7670347 KL Loss: 7.0768113 DSM Loss: 9.9083470 Overall Loss:18.7521930
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(17.0368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9642, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7364975 KL Loss: 7.0729914 DSM Loss: 9.4685494 Overall Loss:18.2780382
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.314063549041748


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.7906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8027880 KL Loss: 7.2015132 DSM Loss: 12.8612874 Overall Loss:21.8655886
Validation loss decreased (inf --> 0.606484).  Saving model ...
Updating learning rate to 0.0005
tensor(21.8801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8488687 KL Loss: 7.1704723 DSM Loss: 10.3119634 Overall Loss:19.3313045
Validation loss decreased (0.606484 --> 0.344817).  Saving model ...
Updating learning rate to 0.00025
tensor(15.4895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7742346 KL Loss: 7.0481364 DSM Loss: 9.9098063 Overall Loss:18.7321771
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(18.5491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8205737 KL Loss: 7.1366558 DSM Loss: 9.7415290 Overall Loss:18.6987584
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.577218770980835


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.0763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8460013 KL Loss: 7.2321495 DSM Loss: 11.7676827 Overall Loss:20.8458335
Validation loss decreased (inf --> 1.409806).  Saving model ...
Updating learning rate to 0.0005
tensor(16.2097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8294986 KL Loss: 7.1708696 DSM Loss: 9.6653692 Overall Loss:18.6657373
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(14.4021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7786850 KL Loss: 7.1126328 DSM Loss: 9.3841813 Overall Loss:18.2754991
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.29746150970459


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.6412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8627999 KL Loss: 7.1810761 DSM Loss: 11.4086348 Overall Loss:20.4525108
Validation loss decreased (inf --> 0.232177).  Saving model ...
Updating learning rate to 0.0005
tensor(21.5932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8704, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7996668 KL Loss: 7.1295084 DSM Loss: 10.0364335 Overall Loss:18.9656087
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(17.6910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7424007 KL Loss: 7.0709106 DSM Loss: 9.8093499 Overall Loss:18.6226612
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.3804762661457062


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.1332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8429540 KL Loss: 7.2329866 DSM Loss: 11.0977880 Overall Loss:20.1737286
Validation loss decreased (inf --> 3.490441).  Saving model ...
Updating learning rate to 0.0005
tensor(21.9029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8423231 KL Loss: 7.1561761 DSM Loss: 10.0535029 Overall Loss:19.0520021
Validation loss decreased (3.490441 --> 2.831567).  Saving model ...
Updating learning rate to 0.00025
tensor(20.6929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7639392 KL Loss: 7.0346123 DSM Loss: 9.7992103 Overall Loss:18.5977619
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(25.4820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7363248 KL Loss: 7.0169071 DSM Loss: 9.4952160 Overall Loss:18.2484480
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.8364527225494385


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.2365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0846, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8193853 KL Loss: 7.1547744 DSM Loss: 12.4576144 Overall Loss:21.4317741
Validation loss decreased (inf --> 7.157521).  Saving model ...
Updating learning rate to 0.0005
tensor(23.0809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7535380 KL Loss: 7.1162907 DSM Loss: 10.0623502 Overall Loss:18.9321790
Validation loss decreased (7.157521 --> 5.536370).  Saving model ...
Updating learning rate to 0.00025
tensor(19.2827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7751810 KL Loss: 7.0955866 DSM Loss: 9.8532225 Overall Loss:18.7239900
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(19.2549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7405697 KL Loss: 7.0504424 DSM Loss: 9.5477055 Overall Loss:18.3387175
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.312939643859863


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.5337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7571, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7519785 KL Loss: 7.1567106 DSM Loss: 10.9779342 Overall Loss:19.8866232
Validation loss decreased (inf --> 20.079837).  Saving model ...
Updating learning rate to 0.0005
tensor(17.5951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7825291 KL Loss: 7.1824938 DSM Loss: 10.0148447 Overall Loss:18.9798675
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(21.0843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7757131 KL Loss: 7.1110585 DSM Loss: 9.5000835 Overall Loss:18.3868550
Validation loss decreased (20.079837 --> 19.513700).  Saving model ...
Updating learning rate to 0.000125
tensor(19.8572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7509830 KL Loss: 6.9754259 DSM Loss: 9.2534308 Overall Loss:17.9798397
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(12.6192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7291063 KL Loss: 6.9471870 DSM Loss: 9.1981304 Overall Loss:17.8744236
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:32.16582107543945


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(35.0080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8137461 KL Loss: 7.2490840 DSM Loss: 11.6262941 Overall Loss:20.6891241
Validation loss decreased (inf --> 4.023800).  Saving model ...
Updating learning rate to 0.0005
tensor(19.3323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7873959 KL Loss: 7.1220689 DSM Loss: 9.7053949 Overall Loss:18.6148597
Validation loss decreased (4.023800 --> 3.748562).  Saving model ...
Updating learning rate to 0.00025
tensor(17.1237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7836493 KL Loss: 7.0588159 DSM Loss: 9.4535391 Overall Loss:18.2960044
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(16.4348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7432574 KL Loss: 6.9713040 DSM Loss: 9.2907374 Overall Loss:18.0052988
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.581038475036621


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.9896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8183709 KL Loss: 7.2509535 DSM Loss: 11.3370581 Overall Loss:20.4063825
Validation loss decreased (inf --> 10.091809).  Saving model ...
Updating learning rate to 0.0005
tensor(24.2069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8187776 KL Loss: 7.2037718 DSM Loss: 9.7891439 Overall Loss:18.8116933
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(16.5929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7320, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7985167 KL Loss: 7.0911805 DSM Loss: 9.4166924 Overall Loss:18.3063896
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.356950044631958


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.2295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8607284 KL Loss: 7.1545081 DSM Loss: 12.3696424 Overall Loss:21.3848790
Validation loss decreased (inf --> 4.723413).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.2796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7791751 KL Loss: 7.0463742 DSM Loss: 10.1300863 Overall Loss:18.9556354
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(11.2555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7857262 KL Loss: 6.9826005 DSM Loss: 9.7407012 Overall Loss:18.5090278
Validation loss decreased (4.723413 --> 4.527082).  Saving model ...
Updating learning rate to 0.000125
tensor(19.4843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1094, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7439472 KL Loss: 6.8615967 DSM Loss: 9.6117194 Overall Loss:18.2172634
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(23.8615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7325464 KL Loss: 6.8249893 DSM Loss: 9.3574388 Overall Loss:17.9149746
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.78976309299469


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.4699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8114202 KL Loss: 7.1337551 DSM Loss: 11.9703787 Overall Loss:20.9155540
Validation loss decreased (inf --> 0.523649).  Saving model ...
Updating learning rate to 0.0005
tensor(17.5760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8720922 KL Loss: 7.1496910 DSM Loss: 9.9002497 Overall Loss:18.9220328
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(16.9847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7648995 KL Loss: 7.0624948 DSM Loss: 9.6024900 Overall Loss:18.4298844
Validation loss decreased (0.523649 --> 0.486934).  Saving model ...
Updating learning rate to 0.000125
tensor(17.9570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7924261 KL Loss: 7.1004987 DSM Loss: 9.2305411 Overall Loss:18.1234659
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(15.4949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2735, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7725718 KL Loss: 7.1516558 DSM Loss: 9.2097300 Overall Loss:18.1339576
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.4952484369277954


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.0063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6863, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8335812 KL Loss: 7.1608821 DSM Loss: 11.9092474 Overall Loss:20.9037108
Validation loss decreased (inf --> 0.426607).  Saving model ...
Updating learning rate to 0.0005
tensor(15.9443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.0421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7340450 KL Loss: 6.9792689 DSM Loss: 9.9673123 Overall Loss:18.6806264
Validation loss decreased (0.426607 --> 0.180041).  Saving model ...
Updating learning rate to 0.00025
tensor(16.0371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7398, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7397461 KL Loss: 7.0260629 DSM Loss: 9.4647693 Overall Loss:18.2305783
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.0320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7706793 KL Loss: 7.0182125 DSM Loss: 9.4091541 Overall Loss:18.1980459
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.19861119985580444


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.0046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9538, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8557974 KL Loss: 7.2281084 DSM Loss: 12.8714857 Overall Loss:21.9553916
Validation loss decreased (inf --> 12.563255).  Saving model ...
Updating learning rate to 0.0005
tensor(15.4810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8239, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8164618 KL Loss: 7.0858685 DSM Loss: 9.9937858 Overall Loss:18.8961161
Validation loss decreased (12.563255 --> 8.965670).  Saving model ...
Updating learning rate to 0.00025
tensor(12.8774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7811527 KL Loss: 7.0439969 DSM Loss: 9.7867518 Overall Loss:18.6119014
Validation loss decreased (8.965670 --> 8.820842).  Saving model ...
Updating learning rate to 0.000125
tensor(15.3093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.9014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7570718 KL Loss: 7.0774102 DSM Loss: 9.1869114 Overall Loss:18.0213936
Validation loss decreased (8.820842 --> 8.650511).  Saving model ...
Updating learning rate to 6.25e-05
tensor(14.7772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6054, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7315795 KL Loss: 7.0331066 DSM Loss: 9.2469757 Overall Loss:18.0116619
Validation loss decreased (8.650511 --> 8.473437).  Saving model ...
Updating learning rate to 3.125e-05
tensor(18.0197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.6642439 KL Loss: 6.8820096 DSM Loss: 9.1684175 Overall Loss:17.7146710
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(13.8471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7213479 KL Loss: 7.0119266 DSM Loss: 9.1371868 Overall Loss:17.8704614
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.419881820678711


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.2787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8252565 KL Loss: 7.0300825 DSM Loss: 12.7491235 Overall Loss:21.6044624
Validation loss decreased (inf --> 7.163009).  Saving model ...
Updating learning rate to 0.0005
tensor(20.6312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.9209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8194531 KL Loss: 7.0519915 DSM Loss: 9.9654511 Overall Loss:18.8368957
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(13.2793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4581, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8141103 KL Loss: 7.0541359 DSM Loss: 9.7706300 Overall Loss:18.6388762
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.3049445152282715


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.4602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9049566 KL Loss: 7.2450104 DSM Loss: 11.7069872 Overall Loss:20.8569540
Validation loss decreased (inf --> 0.590016).  Saving model ...
Updating learning rate to 0.0005
tensor(18.5481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7520820 KL Loss: 7.0560588 DSM Loss: 10.0798820 Overall Loss:18.8880227
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(21.4088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7385562 KL Loss: 6.9534893 DSM Loss: 9.7684043 Overall Loss:18.4604498
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.254271388053894


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.4188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8208007 KL Loss: 7.1593789 DSM Loss: 11.4078164 Overall Loss:20.3879960
Validation loss decreased (inf --> 1.864273).  Saving model ...
Updating learning rate to 0.0005
tensor(17.5983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7986262 KL Loss: 7.0538174 DSM Loss: 9.9599959 Overall Loss:18.8124395
Validation loss decreased (1.864273 --> 1.691927).  Saving model ...
Updating learning rate to 0.00025
tensor(14.3637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8429135 KL Loss: 7.0464963 DSM Loss: 9.7976648 Overall Loss:18.6870745
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(19.5623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8059209 KL Loss: 7.1683206 DSM Loss: 9.5959265 Overall Loss:18.5701682
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.0943996906280518


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.3507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6642, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8061890 KL Loss: 7.1231008 DSM Loss: 12.0460808 Overall Loss:20.9753706
Validation loss decreased (inf --> 0.759979).  Saving model ...
Updating learning rate to 0.0005
tensor(21.1045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7511188 KL Loss: 7.0161116 DSM Loss: 10.4151109 Overall Loss:19.1823413
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(22.0386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7208247 KL Loss: 7.0766594 DSM Loss: 10.1239693 Overall Loss:18.9214534
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.11578358709812164


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.8094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7940373 KL Loss: 7.1898935 DSM Loss: 12.3381228 Overall Loss:21.3220535
Validation loss decreased (inf --> 2.833647).  Saving model ...
Updating learning rate to 0.0005
tensor(19.2983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2310, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7371343 KL Loss: 7.0156134 DSM Loss: 10.0591185 Overall Loss:18.8118661
Validation loss decreased (2.833647 --> 2.788670).  Saving model ...
Updating learning rate to 0.00025
tensor(23.6507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7100891 KL Loss: 6.9166354 DSM Loss: 9.7357025 Overall Loss:18.3624270
Validation loss decreased (2.788670 --> 2.609715).  Saving model ...
Updating learning rate to 0.000125
tensor(22.8380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6736255 KL Loss: 6.8970198 DSM Loss: 9.4845981 Overall Loss:18.0552434
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(23.1504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.6915157 KL Loss: 6.8948222 DSM Loss: 9.4251652 Overall Loss:18.0115032
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.3071000576019287


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.2937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8299834 KL Loss: 7.1419442 DSM Loss: 11.7097561 Overall Loss:20.6816836
Validation loss decreased (inf --> 2.214053).  Saving model ...
Updating learning rate to 0.0005
tensor(25.5623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7305281 KL Loss: 6.9698331 DSM Loss: 10.0618517 Overall Loss:18.7622129
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(25.9991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7831228 KL Loss: 6.9695849 DSM Loss: 10.3149967 Overall Loss:19.0677044
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:23.287187576293945
      Ticker        MSE StdDev
0   AAPL_pct   5.372399    0.0
1   ABBV_pct  17.813835    0.0
2    AEP_pct   2.891073    0.0
3   AMGN_pct   4.367517    0.0
4   AMZN_pct   0.329324    0.0
..       ...        ...    ...
66    VZ_pct   1.254271    0.0
67     V_pct     2.0944    0.0
68   WFC_pct   0.115784    0.0
69   WMT_pct     3.3071    0.0
70   XOM_pct  23.287188    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=10, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=20, root_path='data/EcmP_stock_L_2016_24_mix_F_dva', scale=0.1, sequence_length=20, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(41.8803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9137051 KL Loss: 14.2866118 DSM Loss: 23.3140101 Overall Loss:39.5143268
Validation loss decreased (inf --> 7.776208).  Saving model ...
Updating learning rate to 0.0005
tensor(35.2212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7332, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8986956 KL Loss: 14.0874508 DSM Loss: 19.0463936 Overall Loss:35.0325399
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(29.7683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8361067 KL Loss: 13.8765936 DSM Loss: 18.7720041 Overall Loss:34.4847045
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.222461700439453


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(51.9387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9062346 KL Loss: 14.2203314 DSM Loss: 21.2417223 Overall Loss:37.3682882
Validation loss decreased (inf --> 10.704514).  Saving model ...
Updating learning rate to 0.0005
tensor(41.8806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8937003 KL Loss: 14.1891405 DSM Loss: 19.0300169 Overall Loss:35.1128575
Validation loss decreased (10.704514 --> 10.657047).  Saving model ...
Updating learning rate to 0.00025
tensor(29.6299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9498565 KL Loss: 14.2539478 DSM Loss: 18.1183996 Overall Loss:34.3222040
Validation loss decreased (10.657047 --> 10.473631).  Saving model ...
Updating learning rate to 0.000125
tensor(35.0685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5216, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8734790 KL Loss: 14.2716796 DSM Loss: 18.0990802 Overall Loss:34.2442386
Validation loss decreased (10.473631 --> 10.196763).  Saving model ...
Updating learning rate to 6.25e-05
tensor(36.7687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8424901 KL Loss: 14.0602369 DSM Loss: 17.8219500 Overall Loss:33.7246770
Validation loss decreased (10.196763 --> 9.872435).  Saving model ...
Updating learning rate to 3.125e-05
tensor(32.2305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8441699 KL Loss: 14.0666088 DSM Loss: 17.8890163 Overall Loss:33.7997950
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(43.6491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8308159 KL Loss: 14.0176531 DSM Loss: 17.4393646 Overall Loss:33.2878337
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:17.763883590698242


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.6323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8831902 KL Loss: 14.1684962 DSM Loss: 21.8242925 Overall Loss:37.8759788
Validation loss decreased (inf --> 2.622024).  Saving model ...
Updating learning rate to 0.0005
tensor(30.6004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9264915 KL Loss: 14.1357132 DSM Loss: 19.2798331 Overall Loss:35.3420377
Validation loss decreased (2.622024 --> 2.187138).  Saving model ...
Updating learning rate to 0.00025
tensor(34.6171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9041878 KL Loss: 14.1343240 DSM Loss: 18.8404150 Overall Loss:34.8789268
Validation loss decreased (2.187138 --> 2.112812).  Saving model ...
Updating learning rate to 0.000125
tensor(35.2108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8889890 KL Loss: 14.1140987 DSM Loss: 18.4295425 Overall Loss:34.4326301
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(36.5562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8618166 KL Loss: 14.0653894 DSM Loss: 18.1858395 Overall Loss:34.1130454
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.8912408351898193


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(42.9228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9245196 KL Loss: 14.2203193 DSM Loss: 23.4340926 Overall Loss:39.5789317
Validation loss decreased (inf --> 1.168365).  Saving model ...
Updating learning rate to 0.0005
tensor(47.5880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.1006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8570480 KL Loss: 14.0546223 DSM Loss: 20.4830580 Overall Loss:36.3947281
Validation loss decreased (1.168365 --> 1.015215).  Saving model ...
Updating learning rate to 0.00025
tensor(37.9599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8797776 KL Loss: 14.1396039 DSM Loss: 19.2924657 Overall Loss:35.3118473
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(28.1420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8052139 KL Loss: 13.9453132 DSM Loss: 18.4494549 Overall Loss:34.1999819
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.4021754264831543


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.3716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8750787 KL Loss: 14.2400604 DSM Loss: 23.4380252 Overall Loss:39.5531641
Validation loss decreased (inf --> 2.579338).  Saving model ...
Updating learning rate to 0.0005
tensor(28.5923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.3371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9071445 KL Loss: 14.1756022 DSM Loss: 20.1505842 Overall Loss:36.2333309
Validation loss decreased (2.579338 --> 2.383751).  Saving model ...
Updating learning rate to 0.00025
tensor(37.7205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8961186 KL Loss: 14.0625568 DSM Loss: 18.7173173 Overall Loss:34.6759926
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(44.1605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8367482 KL Loss: 13.8897645 DSM Loss: 18.4401932 Overall Loss:34.1667058
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.3563273251056671


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.9103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9418140 KL Loss: 14.3273529 DSM Loss: 21.4925891 Overall Loss:37.7617559
Validation loss decreased (inf --> 7.516890).  Saving model ...
Updating learning rate to 0.0005
tensor(31.6229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.8967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1374, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8882102 KL Loss: 14.1007840 DSM Loss: 18.5384647 Overall Loss:34.5274589
Validation loss decreased (7.516890 --> 6.762967).  Saving model ...
Updating learning rate to 0.00025
tensor(44.6010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2573, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8398174 KL Loss: 14.0298075 DSM Loss: 18.4925523 Overall Loss:34.3621771
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(38.3279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8830560 KL Loss: 14.0654480 DSM Loss: 17.9551353 Overall Loss:33.9036393
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.0205167531967163


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.7063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9165169 KL Loss: 14.1076906 DSM Loss: 23.7854141 Overall Loss:39.8096213
Validation loss decreased (inf --> 0.107770).  Saving model ...
Updating learning rate to 0.0005
tensor(36.9808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9790672 KL Loss: 14.2230402 DSM Loss: 20.1712289 Overall Loss:36.3733363
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(32.8857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9402903 KL Loss: 14.1759743 DSM Loss: 19.2927592 Overall Loss:35.4090238
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.31020405888557434


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.0809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8714544 KL Loss: 14.1621704 DSM Loss: 22.2226868 Overall Loss:38.2563116
Validation loss decreased (inf --> 0.651705).  Saving model ...
Updating learning rate to 0.0005
tensor(26.3822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9996, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8387782 KL Loss: 13.9135985 DSM Loss: 19.4617494 Overall Loss:35.2141260
Validation loss decreased (0.651705 --> 0.536502).  Saving model ...
Updating learning rate to 0.00025
tensor(36.3785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8473789 KL Loss: 13.9745776 DSM Loss: 18.9218509 Overall Loss:34.7438072
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(32.1632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3378, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7964608 KL Loss: 13.8937913 DSM Loss: 18.5838939 Overall Loss:34.2741460
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.20241913199424744


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.0492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8894866 KL Loss: 14.2712692 DSM Loss: 21.9724954 Overall Loss:38.1332512
Validation loss decreased (inf --> 2.417356).  Saving model ...
Updating learning rate to 0.0005
tensor(29.2506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9015478 KL Loss: 14.1622355 DSM Loss: 18.3850213 Overall Loss:34.4488047
Validation loss decreased (2.417356 --> 1.806587).  Saving model ...
Updating learning rate to 0.00025
tensor(34.8273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8681029 KL Loss: 13.9310190 DSM Loss: 17.8637418 Overall Loss:33.6628637
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(37.6777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8376789 KL Loss: 13.8566975 DSM Loss: 17.5411366 Overall Loss:33.2355131
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.946582078933716


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(59.6885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6996, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9363483 KL Loss: 14.2415768 DSM Loss: 23.2270969 Overall Loss:39.4050220
Validation loss decreased (inf --> 0.166975).  Saving model ...
Updating learning rate to 0.0005
tensor(31.1692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8871327 KL Loss: 14.2129896 DSM Loss: 19.9656585 Overall Loss:36.0657806
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(33.6797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8771657 KL Loss: 14.0867806 DSM Loss: 19.2751973 Overall Loss:35.2391436
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.1380717754364014


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.5467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9455963 KL Loss: 14.2486203 DSM Loss: 22.9822697 Overall Loss:39.1764864
Validation loss decreased (inf --> 8.400584).  Saving model ...
Updating learning rate to 0.0005
tensor(35.2717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9253256 KL Loss: 14.0129562 DSM Loss: 19.0944531 Overall Loss:35.0327349
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(41.5953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9055751 KL Loss: 14.0720309 DSM Loss: 17.7932693 Overall Loss:33.7708750
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:11.037721633911133


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.1525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2080, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9234416 KL Loss: 14.1795713 DSM Loss: 28.9460800 Overall Loss:45.0490928
Validation loss decreased (inf --> 0.335637).  Saving model ...
Updating learning rate to 0.0005
tensor(36.5307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8800546 KL Loss: 14.1453082 DSM Loss: 19.6480143 Overall Loss:35.6733772
Validation loss decreased (0.335637 --> 0.148234).  Saving model ...
Updating learning rate to 0.00025
tensor(37.2756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8270173 KL Loss: 14.0131260 DSM Loss: 19.1875936 Overall Loss:35.0277370
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(32.6940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7853366 KL Loss: 13.7573597 DSM Loss: 18.7801188 Overall Loss:34.3228152
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.3343883752822876


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.0606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9064693 KL Loss: 14.1329549 DSM Loss: 22.9853646 Overall Loss:39.0247887
Validation loss decreased (inf --> 2.745880).  Saving model ...
Updating learning rate to 0.0005
tensor(32.5994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9280795 KL Loss: 14.2143518 DSM Loss: 20.6665121 Overall Loss:36.8089433
Validation loss decreased (2.745880 --> 1.823250).  Saving model ...
Updating learning rate to 0.00025
tensor(35.5724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9140456 KL Loss: 14.1128512 DSM Loss: 19.6580242 Overall Loss:35.6849208
Validation loss decreased (1.823250 --> 1.516041).  Saving model ...
Updating learning rate to 0.000125
tensor(35.5509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8139736 KL Loss: 13.8668348 DSM Loss: 19.1069617 Overall Loss:34.7877699
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(40.8928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8117029 KL Loss: 13.9369667 DSM Loss: 19.2314156 Overall Loss:34.9800853
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.8804610967636108


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.4383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9158737 KL Loss: 14.1639667 DSM Loss: 24.3425408 Overall Loss:40.4223812
Validation loss decreased (inf --> 4.108885).  Saving model ...
Updating learning rate to 0.0005
tensor(30.4183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8951421 KL Loss: 13.9752065 DSM Loss: 18.7060222 Overall Loss:34.5763708
Validation loss decreased (4.108885 --> 3.781079).  Saving model ...
Updating learning rate to 0.00025
tensor(38.1093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8350113 KL Loss: 13.7931425 DSM Loss: 18.6762080 Overall Loss:34.3043621
Validation loss decreased (3.781079 --> 3.643802).  Saving model ...
Updating learning rate to 0.000125
tensor(23.5037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.1511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7909543 KL Loss: 13.6399954 DSM Loss: 17.9838129 Overall Loss:33.4147625
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(44.2964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8479801 KL Loss: 13.7762583 DSM Loss: 18.0269537 Overall Loss:33.6511920
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.186834335327148


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(51.8359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8378038 KL Loss: 14.1185473 DSM Loss: 23.7522971 Overall Loss:39.7086481
Validation loss decreased (inf --> 4.153818).  Saving model ...
Updating learning rate to 0.0005
tensor(34.3308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8437099 KL Loss: 14.0233971 DSM Loss: 18.9454832 Overall Loss:34.8125900
Validation loss decreased (4.153818 --> 2.738780).  Saving model ...
Updating learning rate to 0.00025
tensor(29.9537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8379139 KL Loss: 13.9705622 DSM Loss: 18.3127848 Overall Loss:34.1212609
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(32.3322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7849688 KL Loss: 13.7239409 DSM Loss: 17.8363131 Overall Loss:33.3452228
Validation loss decreased (2.738780 --> 2.643166).  Saving model ...
Updating learning rate to 6.25e-05
tensor(33.1277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6047, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8283406 KL Loss: 13.8404239 DSM Loss: 17.4440992 Overall Loss:33.1128639
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(31.2008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6704, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7916066 KL Loss: 13.8575899 DSM Loss: 18.1303434 Overall Loss:33.7795399
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.1188182681798935


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(57.2877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8891542 KL Loss: 14.1824675 DSM Loss: 21.3408214 Overall Loss:37.4124432
Validation loss decreased (inf --> 2.985493).  Saving model ...
Updating learning rate to 0.0005
tensor(44.0980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8355356 KL Loss: 13.9679473 DSM Loss: 18.4113668 Overall Loss:34.2148496
Validation loss decreased (2.985493 --> 2.883830).  Saving model ...
Updating learning rate to 0.00025
tensor(36.1954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6368, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8339513 KL Loss: 13.9573618 DSM Loss: 17.8825937 Overall Loss:33.6739068
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(25.2529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4805, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8792531 KL Loss: 14.0677179 DSM Loss: 17.6840388 Overall Loss:33.6310097
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4668431878089905


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(61.4557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9611381 KL Loss: 14.2810898 DSM Loss: 21.9545354 Overall Loss:38.1967634
Validation loss decreased (inf --> 11.518947).  Saving model ...
Updating learning rate to 0.0005
tensor(22.5167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9609, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9031925 KL Loss: 14.1102971 DSM Loss: 19.2775253 Overall Loss:35.2910146
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(24.7470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.3186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.2510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8311728 KL Loss: 13.9363322 DSM Loss: 18.5275888 Overall Loss:34.2950937
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.4302406311035156


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(55.8887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8903724 KL Loss: 14.1229886 DSM Loss: 20.7730077 Overall Loss:36.7863689
Validation loss decreased (inf --> 4.216878).  Saving model ...
Updating learning rate to 0.0005
tensor(35.1382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9067898 KL Loss: 14.2725146 DSM Loss: 18.4791815 Overall Loss:34.6584860
Validation loss decreased (4.216878 --> 4.055398).  Saving model ...
Updating learning rate to 0.00025
tensor(26.4255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8828767 KL Loss: 14.0681804 DSM Loss: 17.9745167 Overall Loss:33.9255735
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(35.5292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8190376 KL Loss: 14.0561887 DSM Loss: 18.0157869 Overall Loss:33.8910131
Validation loss decreased (4.055398 --> 3.892820).  Saving model ...
Updating learning rate to 6.25e-05
tensor(22.9753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8154484 KL Loss: 13.9751972 DSM Loss: 17.5720548 Overall Loss:33.3627006
Validation loss decreased (3.892820 --> 3.802240).  Saving model ...
Updating learning rate to 3.125e-05
tensor(32.9563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4071, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7964199 KL Loss: 13.9989397 DSM Loss: 17.7891146 Overall Loss:33.5844741
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(23.8265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7964247 KL Loss: 13.9010968 DSM Loss: 17.5330934 Overall Loss:33.2306149
Validation loss decreased (3.802240 --> 3.726866).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(29.0741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7840848 KL Loss: 13.9667467 DSM Loss: 17.3789337 Overall Loss:33.1297651
Validation loss decreased (3.726866 --> 3.686512).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(35.7721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7864091 KL Loss: 13.9824085 DSM Loss: 17.3051169 Overall Loss:33.0739346
Validation loss decreased (3.686512 --> 3.663948).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(37.6586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8101147 KL Loss: 13.9685053 DSM Loss: 17.5043053 Overall Loss:33.2829252
EarlyStopping counter: 1 out of 2
Updating learning rate to 9.765625e-07
tensor(34.6896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9417, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8036543 KL Loss: 14.0278851 DSM Loss: 17.1786642 Overall Loss:33.0102037
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.8410166501998901


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.4695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8149132 KL Loss: 14.0489723 DSM Loss: 23.0887933 Overall Loss:38.9526786
Validation loss decreased (inf --> 9.861948).  Saving model ...
Updating learning rate to 0.0005
tensor(33.1157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8866402 KL Loss: 14.2079673 DSM Loss: 18.4595751 Overall Loss:34.5541824
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(28.1034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3579, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8786209 KL Loss: 14.0941432 DSM Loss: 17.6588689 Overall Loss:33.6316331
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:34.404788970947266


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(51.0968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8910142 KL Loss: 14.1741752 DSM Loss: 21.7750632 Overall Loss:37.8402527
Validation loss decreased (inf --> 0.701352).  Saving model ...
Updating learning rate to 0.0005
tensor(32.9754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8839770 KL Loss: 14.2102038 DSM Loss: 18.9381181 Overall Loss:35.0322988
Validation loss decreased (0.701352 --> 0.681225).  Saving model ...
Updating learning rate to 0.00025
tensor(39.3725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1203, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8730348 KL Loss: 14.1746773 DSM Loss: 19.0590062 Overall Loss:35.1067184
Validation loss decreased (0.681225 --> 0.666256).  Saving model ...
Updating learning rate to 0.000125
tensor(35.0436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8449268 KL Loss: 14.1018586 DSM Loss: 18.2796826 Overall Loss:34.2264680
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(34.9954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8638632 KL Loss: 14.1518398 DSM Loss: 18.0574536 Overall Loss:34.0731568
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.665522038936615


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.4750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8634135 KL Loss: 14.1646504 DSM Loss: 29.7306463 Overall Loss:45.7587099
Validation loss decreased (inf --> 8.197387).  Saving model ...
Updating learning rate to 0.0005
tensor(40.9936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9124845 KL Loss: 14.1381617 DSM Loss: 19.9004538 Overall Loss:35.9511000
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(27.6716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8937742 KL Loss: 13.9758602 DSM Loss: 19.0274635 Overall Loss:34.8970978
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.4723100662231445


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(45.4792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9493712 KL Loss: 14.4519705 DSM Loss: 21.4572026 Overall Loss:37.8585440
Validation loss decreased (inf --> 2.373395).  Saving model ...
Updating learning rate to 0.0005
tensor(30.0115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9452988 KL Loss: 14.3661707 DSM Loss: 19.1593582 Overall Loss:35.4708276
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(46.3987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9495256 KL Loss: 14.2845100 DSM Loss: 19.3280717 Overall Loss:35.5621071
Validation loss decreased (2.373395 --> 2.106393).  Saving model ...
Updating learning rate to 0.000125
tensor(38.3098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9265642 KL Loss: 14.2256412 DSM Loss: 18.8749912 Overall Loss:35.0271964
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(34.1955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9253526 KL Loss: 14.1371378 DSM Loss: 18.7311456 Overall Loss:34.7936361
Validation loss decreased (2.106393 --> 2.011257).  Saving model ...
Updating learning rate to 3.125e-05
tensor(31.1378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9068401 KL Loss: 14.2335219 DSM Loss: 18.6658014 Overall Loss:34.8061633
Validation loss decreased (2.011257 --> 1.913869).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(29.7619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 2.0029575 KL Loss: 14.3593235 DSM Loss: 18.4270059 Overall Loss:34.7892869
Validation loss decreased (1.913869 --> 1.878477).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(46.4129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 2.0538094 KL Loss: 14.3635980 DSM Loss: 18.0283788 Overall Loss:34.4457862
Validation loss decreased (1.878477 --> 1.772667).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(31.0273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.9075620 KL Loss: 14.2029420 DSM Loss: 18.5708807 Overall Loss:34.6813846
Validation loss decreased (1.772667 --> 1.678016).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(36.4988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 2.0146023 KL Loss: 14.3405276 DSM Loss: 18.3674920 Overall Loss:34.7226221
EarlyStopping counter: 1 out of 2
Updating learning rate to 9.765625e-07
tensor(34.7353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 2.0887165 KL Loss: 14.3588618 DSM Loss: 18.0708189 Overall Loss:34.5183969
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7500913739204407


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(61.1181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8771513 KL Loss: 14.1236814 DSM Loss: 21.4735940 Overall Loss:37.4744268
Validation loss decreased (inf --> 6.712255).  Saving model ...
Updating learning rate to 0.0005
tensor(40.7436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8954544 KL Loss: 14.1135646 DSM Loss: 18.6206820 Overall Loss:34.6297010
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(27.7061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8685305 KL Loss: 14.0020876 DSM Loss: 17.7825159 Overall Loss:33.6531339
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.809781074523926


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(60.0460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8771687 KL Loss: 14.2029321 DSM Loss: 22.2536960 Overall Loss:38.3337968
Validation loss decreased (inf --> 2.379543).  Saving model ...
Updating learning rate to 0.0005
tensor(29.0168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9171428 KL Loss: 14.1411826 DSM Loss: 19.4067020 Overall Loss:35.4650274
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(33.4585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8803828 KL Loss: 14.0854279 DSM Loss: 18.7892653 Overall Loss:34.7550759
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.041897773742676


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(44.2148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8457074 KL Loss: 14.1426825 DSM Loss: 21.1236888 Overall Loss:37.1120785
Validation loss decreased (inf --> 11.898890).  Saving model ...
Updating learning rate to 0.0005
tensor(32.7660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1843, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8743486 KL Loss: 14.0796351 DSM Loss: 18.5196110 Overall Loss:34.4735945
Validation loss decreased (11.898890 --> 11.829369).  Saving model ...
Updating learning rate to 0.00025
tensor(33.4234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8114581 KL Loss: 13.9593206 DSM Loss: 17.7930700 Overall Loss:33.5638489
Validation loss decreased (11.829369 --> 11.320102).  Saving model ...
Updating learning rate to 0.000125
tensor(30.3276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7631194 KL Loss: 13.7838062 DSM Loss: 17.4713969 Overall Loss:33.0183226
Validation loss decreased (11.320102 --> 11.167577).  Saving model ...
Updating learning rate to 6.25e-05
tensor(37.9351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7641326 KL Loss: 13.7361892 DSM Loss: 17.0980009 Overall Loss:32.5983226
Validation loss decreased (11.167577 --> 10.862183).  Saving model ...
Updating learning rate to 3.125e-05
tensor(28.2610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7746341 KL Loss: 13.8234426 DSM Loss: 17.3502579 Overall Loss:32.9483347
Validation loss decreased (10.862183 --> 10.658916).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(26.8727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7651194 KL Loss: 13.7643376 DSM Loss: 17.3297962 Overall Loss:32.8592532
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(36.8504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9845, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8074086 KL Loss: 13.8001764 DSM Loss: 17.4731552 Overall Loss:33.0807402
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:14.367850303649902


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.8347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9036246 KL Loss: 14.2095353 DSM Loss: 23.2827406 Overall Loss:39.3959002
Validation loss decreased (inf --> 6.315267).  Saving model ...
Updating learning rate to 0.0005
tensor(37.9536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9293456 KL Loss: 14.1785820 DSM Loss: 19.6001881 Overall Loss:35.7081156
Validation loss decreased (6.315267 --> 5.101989).  Saving model ...
Updating learning rate to 0.00025
tensor(37.5257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8935404 KL Loss: 14.0805116 DSM Loss: 18.4628098 Overall Loss:34.4368616
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(38.3062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8130431 KL Loss: 13.9867966 DSM Loss: 17.9122055 Overall Loss:33.7120452
Validation loss decreased (5.101989 --> 4.852345).  Saving model ...
Updating learning rate to 6.25e-05
tensor(35.6323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3080, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8279873 KL Loss: 13.9715537 DSM Loss: 17.8702525 Overall Loss:33.6697936
Validation loss decreased (4.852345 --> 4.735435).  Saving model ...
Updating learning rate to 3.125e-05
tensor(48.4605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7547808 KL Loss: 13.8661247 DSM Loss: 17.1693344 Overall Loss:32.7902395
Validation loss decreased (4.735435 --> 4.488116).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(31.9852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7532924 KL Loss: 13.8472935 DSM Loss: 17.2558348 Overall Loss:32.8564207
Validation loss decreased (4.488116 --> 4.483902).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(39.6807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7727872 KL Loss: 13.8860485 DSM Loss: 17.5188762 Overall Loss:33.1777120
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(35.5606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2188, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7893760 KL Loss: 14.0446838 DSM Loss: 17.4497569 Overall Loss:33.2838167
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.532323837280273


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(51.6124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9108497 KL Loss: 14.2041311 DSM Loss: 23.4772734 Overall Loss:39.5922541
Validation loss decreased (inf --> 0.141991).  Saving model ...
Updating learning rate to 0.0005
tensor(35.8861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8678082 KL Loss: 14.0070911 DSM Loss: 20.1504710 Overall Loss:36.0253705
Validation loss decreased (0.141991 --> 0.138459).  Saving model ...
Updating learning rate to 0.00025
tensor(32.1566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9380072 KL Loss: 14.2590261 DSM Loss: 19.2495669 Overall Loss:35.4466003
Validation loss decreased (0.138459 --> 0.115894).  Saving model ...
Updating learning rate to 0.000125
tensor(31.8532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8559757 KL Loss: 14.0133707 DSM Loss: 19.2782081 Overall Loss:35.1475545
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(29.1117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8828063 KL Loss: 13.9801356 DSM Loss: 19.0318477 Overall Loss:34.8947893
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.29553067684173584


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.1871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9194995 KL Loss: 14.0678646 DSM Loss: 22.7412964 Overall Loss:38.7286604
Validation loss decreased (inf --> 11.031155).  Saving model ...
Updating learning rate to 0.0005
tensor(33.4560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6793, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8308456 KL Loss: 13.9849271 DSM Loss: 18.8874864 Overall Loss:34.7032591
Validation loss decreased (11.031155 --> 11.004386).  Saving model ...
Updating learning rate to 0.00025
tensor(38.1925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8297363 KL Loss: 13.9791691 DSM Loss: 18.0541642 Overall Loss:33.8630695
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(47.1879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8319687 KL Loss: 13.8713783 DSM Loss: 17.8713370 Overall Loss:33.5746842
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.893290042877197


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.8164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8749672 KL Loss: 14.2439166 DSM Loss: 23.4090346 Overall Loss:39.5279185
Validation loss decreased (inf --> 7.783070).  Saving model ...
Updating learning rate to 0.0005
tensor(33.7769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8967078 KL Loss: 14.1796943 DSM Loss: 18.9852370 Overall Loss:35.0616388
Validation loss decreased (7.783070 --> 6.531898).  Saving model ...
Updating learning rate to 0.00025
tensor(24.6849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4254, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8914856 KL Loss: 14.1378886 DSM Loss: 18.8219892 Overall Loss:34.8513633
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(34.2952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8973726 KL Loss: 14.1120268 DSM Loss: 17.8130443 Overall Loss:33.8224435
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.3903043270111084


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(65.8880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9144764 KL Loss: 14.1638362 DSM Loss: 21.7133855 Overall Loss:37.7916978
Validation loss decreased (inf --> 3.468863).  Saving model ...
Updating learning rate to 0.0005
tensor(32.1932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6926, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8508517 KL Loss: 13.9812021 DSM Loss: 18.5909590 Overall Loss:34.4230128
Validation loss decreased (3.468863 --> 3.357672).  Saving model ...
Updating learning rate to 0.00025
tensor(49.7055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8345904 KL Loss: 13.9297941 DSM Loss: 18.0236449 Overall Loss:33.7880295
Validation loss decreased (3.357672 --> 3.069048).  Saving model ...
Updating learning rate to 0.000125
tensor(40.8163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7885779 KL Loss: 13.8500852 DSM Loss: 18.0723024 Overall Loss:33.7109655
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(31.4428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4693, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7955252 KL Loss: 13.6102066 DSM Loss: 17.6312689 Overall Loss:33.0370004
Validation loss decreased (3.069048 --> 3.059053).  Saving model ...
Updating learning rate to 3.125e-05
tensor(32.4227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3898, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8082737 KL Loss: 13.7594134 DSM Loss: 18.0901285 Overall Loss:33.6578156
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(29.0745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7799856 KL Loss: 13.7833031 DSM Loss: 17.2785849 Overall Loss:32.8418736
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.3153738975524902


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.0110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8498593 KL Loss: 14.0263897 DSM Loss: 24.2270667 Overall Loss:40.1033157
Validation loss decreased (inf --> 0.354730).  Saving model ...
Updating learning rate to 0.0005
tensor(36.3352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8608289 KL Loss: 14.1677899 DSM Loss: 19.8578840 Overall Loss:35.8865028
Validation loss decreased (0.354730 --> 0.332167).  Saving model ...
Updating learning rate to 0.00025
tensor(30.6724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8844546 KL Loss: 14.1669050 DSM Loss: 19.3923279 Overall Loss:35.4436876
Validation loss decreased (0.332167 --> 0.323350).  Saving model ...
Updating learning rate to 0.000125
tensor(30.8800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8192895 KL Loss: 14.0863521 DSM Loss: 19.0537179 Overall Loss:34.9593597
Validation loss decreased (0.323350 --> 0.318420).  Saving model ...
Updating learning rate to 6.25e-05
tensor(35.0181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0922, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8162127 KL Loss: 14.0543473 DSM Loss: 18.7749967 Overall Loss:34.6455566
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(42.0686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8470430 KL Loss: 14.1053099 DSM Loss: 18.7792480 Overall Loss:34.7316009
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.153800129890442


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.3273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8772933 KL Loss: 14.1058254 DSM Loss: 24.2382972 Overall Loss:40.2214158
Validation loss decreased (inf --> 2.245969).  Saving model ...
Updating learning rate to 0.0005
tensor(32.4516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8882825 KL Loss: 13.9979500 DSM Loss: 19.1948408 Overall Loss:35.0810734
Validation loss decreased (2.245969 --> 1.512522).  Saving model ...
Updating learning rate to 0.00025
tensor(36.2817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8382148 KL Loss: 13.9148478 DSM Loss: 18.6948869 Overall Loss:34.4479494
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(39.5419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8123540 KL Loss: 13.8805761 DSM Loss: 18.5246490 Overall Loss:34.2175788
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.5967493057250977


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(57.0066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9579191 KL Loss: 14.3494357 DSM Loss: 21.9327636 Overall Loss:38.2401183
Validation loss decreased (inf --> 0.374015).  Saving model ...
Updating learning rate to 0.0005
tensor(30.7551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.4640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9482137 KL Loss: 14.2437363 DSM Loss: 20.0658716 Overall Loss:36.2578216
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(31.3311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4732, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9076040 KL Loss: 14.2389373 DSM Loss: 18.8186766 Overall Loss:34.9652180
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.351982831954956


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.1299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9373129 KL Loss: 14.3190258 DSM Loss: 21.4746132 Overall Loss:37.7309518
Validation loss decreased (inf --> 5.623330).  Saving model ...
Updating learning rate to 0.0005
tensor(25.9538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6418, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9061951 KL Loss: 14.0961853 DSM Loss: 18.3275483 Overall Loss:34.3299289
Validation loss decreased (5.623330 --> 4.082620).  Saving model ...
Updating learning rate to 0.00025
tensor(28.6167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9158000 KL Loss: 14.2182721 DSM Loss: 17.5681407 Overall Loss:33.7022129
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(33.5589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8415473 KL Loss: 13.9870805 DSM Loss: 17.3692496 Overall Loss:33.1978773
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.397604942321777


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.2469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8947251 KL Loss: 14.3006698 DSM Loss: 22.1319660 Overall Loss:38.3273611
Validation loss decreased (inf --> 4.514269).  Saving model ...
Updating learning rate to 0.0005
tensor(27.2455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8977059 KL Loss: 14.3161960 DSM Loss: 19.0787931 Overall Loss:35.2926949
Validation loss decreased (4.514269 --> 4.229538).  Saving model ...
Updating learning rate to 0.00025
tensor(25.3988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8538480 KL Loss: 14.1036542 DSM Loss: 18.1873952 Overall Loss:34.1448977
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(43.8407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3123, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8867022 KL Loss: 14.1117090 DSM Loss: 17.7638722 Overall Loss:33.7622834
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.423027992248535


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.2816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8914741 KL Loss: 14.2558353 DSM Loss: 24.2966496 Overall Loss:40.4439590
Validation loss decreased (inf --> 7.243235).  Saving model ...
Updating learning rate to 0.0005
tensor(32.7394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8809982 KL Loss: 14.0471816 DSM Loss: 19.5312448 Overall Loss:35.4594247
Validation loss decreased (7.243235 --> 7.200942).  Saving model ...
Updating learning rate to 0.00025
tensor(35.8894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7953, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8890466 KL Loss: 14.1481647 DSM Loss: 18.6262068 Overall Loss:34.6634178
Validation loss decreased (7.200942 --> 7.171439).  Saving model ...
Updating learning rate to 0.000125
tensor(33.3799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8332846 KL Loss: 13.8403861 DSM Loss: 18.2439359 Overall Loss:33.9176066
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(36.5897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7989971 KL Loss: 13.8153701 DSM Loss: 18.3725748 Overall Loss:33.9869423
Validation loss decreased (7.171439 --> 6.712488).  Saving model ...
Updating learning rate to 3.125e-05
tensor(33.3994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8087256 KL Loss: 13.8179505 DSM Loss: 18.1480801 Overall Loss:33.7747563
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(30.4072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8392717 KL Loss: 13.9636032 DSM Loss: 17.8791532 Overall Loss:33.6820281
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:10.549688339233398


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(57.9316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0135, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9318708 KL Loss: 14.2531018 DSM Loss: 22.0410850 Overall Loss:38.2260574
Validation loss decreased (inf --> 2.011247).  Saving model ...
Updating learning rate to 0.0005
tensor(36.1867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8457075 KL Loss: 14.0434306 DSM Loss: 19.0945203 Overall Loss:34.9836585
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(29.9434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8473461 KL Loss: 13.9758332 DSM Loss: 18.2316421 Overall Loss:34.0548213
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:6.8478827476501465


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(51.5490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8968200 KL Loss: 14.2536229 DSM Loss: 23.3085979 Overall Loss:39.4590407
Validation loss decreased (inf --> 1.554118).  Saving model ...
Updating learning rate to 0.0005
tensor(31.3113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8048245 KL Loss: 13.8193920 DSM Loss: 20.2542407 Overall Loss:35.8784572
Validation loss decreased (1.554118 --> 1.367558).  Saving model ...
Updating learning rate to 0.00025
tensor(35.1506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8368218 KL Loss: 13.9918965 DSM Loss: 19.9291398 Overall Loss:35.7578581
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(30.3667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3639, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8060903 KL Loss: 13.7027085 DSM Loss: 18.7710490 Overall Loss:34.2798478
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.7671246528625488


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(63.8268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9160865 KL Loss: 14.2373777 DSM Loss: 21.9138090 Overall Loss:38.0672736
Validation loss decreased (inf --> 4.164488).  Saving model ...
Updating learning rate to 0.0005
tensor(33.8601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9305544 KL Loss: 14.2807698 DSM Loss: 19.1746503 Overall Loss:35.3859744
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(32.0640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8794735 KL Loss: 14.0456104 DSM Loss: 19.0431069 Overall Loss:34.9681909
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.65776252746582


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.5569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5533, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9364265 KL Loss: 14.2742881 DSM Loss: 22.5839918 Overall Loss:38.7947065
Validation loss decreased (inf --> 3.537445).  Saving model ...
Updating learning rate to 0.0005
tensor(30.6036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9116611 KL Loss: 14.0833113 DSM Loss: 19.2534065 Overall Loss:35.2483788
Validation loss decreased (3.537445 --> 3.246039).  Saving model ...
Updating learning rate to 0.00025
tensor(36.6766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8956753 KL Loss: 14.1572195 DSM Loss: 18.8896737 Overall Loss:34.9425684
Validation loss decreased (3.246039 --> 2.285330).  Saving model ...
Updating learning rate to 0.000125
tensor(30.6321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8848074 KL Loss: 14.1242171 DSM Loss: 18.3321380 Overall Loss:34.3411627
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(31.4431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8538513 KL Loss: 14.1003337 DSM Loss: 18.1159574 Overall Loss:34.0701423
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.17069655656814575


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.0414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9558191 KL Loss: 14.2913320 DSM Loss: 21.2993901 Overall Loss:37.5465413
Validation loss decreased (inf --> 0.458828).  Saving model ...
Updating learning rate to 0.0005
tensor(32.1150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8849600 KL Loss: 14.1119447 DSM Loss: 18.9198553 Overall Loss:34.9167600
Validation loss decreased (0.458828 --> 0.333220).  Saving model ...
Updating learning rate to 0.00025
tensor(40.2680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8552657 KL Loss: 14.1087857 DSM Loss: 18.0647739 Overall Loss:34.0288254
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(34.3124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8652187 KL Loss: 14.1189705 DSM Loss: 17.6407380 Overall Loss:33.6249272
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.9909753799438477


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(69.3066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9657195 KL Loss: 14.2991815 DSM Loss: 24.8521405 Overall Loss:41.1170416
Validation loss decreased (inf --> 1.048266).  Saving model ...
Updating learning rate to 0.0005
tensor(35.8522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8752274 KL Loss: 14.1054755 DSM Loss: 20.6806156 Overall Loss:36.6613183
Validation loss decreased (1.048266 --> 0.918100).  Saving model ...
Updating learning rate to 0.00025
tensor(38.6872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8296787 KL Loss: 14.0246732 DSM Loss: 20.0365957 Overall Loss:35.8909475
Validation loss decreased (0.918100 --> 0.879881).  Saving model ...
Updating learning rate to 0.000125
tensor(37.6180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6987, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8288212 KL Loss: 13.9993783 DSM Loss: 19.9176789 Overall Loss:35.7458784
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(38.5019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8213890 KL Loss: 13.9443351 DSM Loss: 19.3975519 Overall Loss:35.1632757
Validation loss decreased (0.879881 --> 0.878172).  Saving model ...
Updating learning rate to 3.125e-05
tensor(42.6808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8200226 KL Loss: 13.9041091 DSM Loss: 19.1516457 Overall Loss:34.8757773
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(44.1865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5898, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8108436 KL Loss: 13.9485639 DSM Loss: 19.3960747 Overall Loss:35.1554823
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5751519203186035


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.7919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9259119 KL Loss: 14.2704010 DSM Loss: 23.5633431 Overall Loss:39.7596562
Validation loss decreased (inf --> 1.875453).  Saving model ...
Updating learning rate to 0.0005
tensor(36.3981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9423068 KL Loss: 14.2644149 DSM Loss: 19.3032126 Overall Loss:35.5099344
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(43.0123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8727567 KL Loss: 14.0789937 DSM Loss: 18.9147409 Overall Loss:34.8664913
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:14.116286277770996


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.3536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8990423 KL Loss: 14.1826328 DSM Loss: 24.2591012 Overall Loss:40.3407762
Validation loss decreased (inf --> 8.081171).  Saving model ...
Updating learning rate to 0.0005
tensor(35.4155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5525, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8463958 KL Loss: 13.9162774 DSM Loss: 18.8514434 Overall Loss:34.6141166
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(33.7691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8065021 KL Loss: 13.9429878 DSM Loss: 18.9671686 Overall Loss:34.7166589
Validation loss decreased (8.081171 --> 7.488624).  Saving model ...
Updating learning rate to 0.000125
tensor(36.2176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1535, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8354106 KL Loss: 13.8348348 DSM Loss: 18.5212856 Overall Loss:34.1915309
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(32.3581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8053560 KL Loss: 13.7864324 DSM Loss: 17.9412066 Overall Loss:33.5329951
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:6.364119052886963


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(59.3946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8914143 KL Loss: 14.2227193 DSM Loss: 23.4191034 Overall Loss:39.5332369
Validation loss decreased (inf --> 4.618935).  Saving model ...
Updating learning rate to 0.0005
tensor(37.2043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9249832 KL Loss: 14.1826571 DSM Loss: 19.5235393 Overall Loss:35.6311796
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(36.5353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8952, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8462740 KL Loss: 14.0482966 DSM Loss: 18.9078095 Overall Loss:34.8023802
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.450068712234497


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(43.9497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0216, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9043351 KL Loss: 14.3217553 DSM Loss: 23.8089722 Overall Loss:40.0350626
Validation loss decreased (inf --> 9.999082).  Saving model ...
Updating learning rate to 0.0005
tensor(41.3437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.8676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8742091 KL Loss: 14.1751820 DSM Loss: 19.9328450 Overall Loss:35.9822363
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(29.3535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8354081 KL Loss: 13.9810294 DSM Loss: 19.1199148 Overall Loss:34.9363525
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.862694263458252


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(43.5217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9178925 KL Loss: 14.2998946 DSM Loss: 23.0382730 Overall Loss:39.2560601
Validation loss decreased (inf --> 1.859111).  Saving model ...
Updating learning rate to 0.0005
tensor(38.7485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8866427 KL Loss: 14.2590030 DSM Loss: 19.3645274 Overall Loss:35.5101734
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(35.3804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8823775 KL Loss: 14.1280604 DSM Loss: 19.1328650 Overall Loss:35.1433031
Validation loss decreased (1.859111 --> 1.395275).  Saving model ...
Updating learning rate to 0.000125
tensor(38.7541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8356512 KL Loss: 14.0790996 DSM Loss: 19.0275031 Overall Loss:34.9422538
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(33.1908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8779396 KL Loss: 14.2656029 DSM Loss: 18.4033201 Overall Loss:34.5468625
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.87145471572876


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(42.2628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0762, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9115179 KL Loss: 14.1491598 DSM Loss: 21.3573377 Overall Loss:37.4180155
Validation loss decreased (inf --> 11.670792).  Saving model ...
Updating learning rate to 0.0005
tensor(28.7336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8287679 KL Loss: 13.9626138 DSM Loss: 18.8161969 Overall Loss:34.6075786
Validation loss decreased (11.670792 --> 10.892278).  Saving model ...
Updating learning rate to 0.00025
tensor(26.1533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.7982048 KL Loss: 13.8134787 DSM Loss: 17.4292429 Overall Loss:33.0409264
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(30.5401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7781431 KL Loss: 13.6652148 DSM Loss: 17.3961859 Overall Loss:32.8395440
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:17.79236602783203


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.5920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9000648 KL Loss: 14.2531752 DSM Loss: 23.3491061 Overall Loss:39.5023460
Validation loss decreased (inf --> 1.238273).  Saving model ...
Updating learning rate to 0.0005
tensor(38.3817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9151117 KL Loss: 14.2578736 DSM Loss: 20.0934367 Overall Loss:36.2664221
Validation loss decreased (1.238273 --> 0.966024).  Saving model ...
Updating learning rate to 0.00025
tensor(37.1549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4571, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9131573 KL Loss: 14.2102815 DSM Loss: 19.7696902 Overall Loss:35.8931287
Validation loss decreased (0.966024 --> 0.924613).  Saving model ...
Updating learning rate to 0.000125
tensor(36.5276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8862231 KL Loss: 14.2004308 DSM Loss: 19.5419920 Overall Loss:35.6286458
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(34.5906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8695843 KL Loss: 14.1781012 DSM Loss: 19.1035481 Overall Loss:35.1512337
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6352402567863464


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(59.4810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9040748 KL Loss: 14.1523369 DSM Loss: 24.1125605 Overall Loss:40.1689722
Validation loss decreased (inf --> 7.272559).  Saving model ...
Updating learning rate to 0.0005
tensor(46.4718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8974, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8799281 KL Loss: 13.9907588 DSM Loss: 19.7854218 Overall Loss:35.6561086
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(38.6917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8591156 KL Loss: 13.9576439 DSM Loss: 19.1511995 Overall Loss:34.9679587
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:13.233394622802734


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.7278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8455865 KL Loss: 14.1591600 DSM Loss: 23.8349745 Overall Loss:39.8397209
Validation loss decreased (inf --> 19.011048).  Saving model ...
Updating learning rate to 0.0005
tensor(26.0863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8854159 KL Loss: 14.1113006 DSM Loss: 18.8239953 Overall Loss:34.8207119
Validation loss decreased (19.011048 --> 18.152791).  Saving model ...
Updating learning rate to 0.00025
tensor(28.3195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8694424 KL Loss: 14.1376230 DSM Loss: 18.1050856 Overall Loss:34.1121509
Validation loss decreased (18.152791 --> 16.519427).  Saving model ...
Updating learning rate to 0.000125
tensor(28.6412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8515511 KL Loss: 13.9848518 DSM Loss: 17.5650747 Overall Loss:33.4014776
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(31.2826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8261225 KL Loss: 13.9608699 DSM Loss: 17.6790175 Overall Loss:33.4660099
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.366569519042969


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.2713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8106543 KL Loss: 14.0495234 DSM Loss: 22.4530124 Overall Loss:38.3131902
Validation loss decreased (inf --> 5.290575).  Saving model ...
Updating learning rate to 0.0005
tensor(36.3441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8896670 KL Loss: 14.0598384 DSM Loss: 19.6269174 Overall Loss:35.5764229
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(32.1397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8259874 KL Loss: 13.9825394 DSM Loss: 19.0857022 Overall Loss:34.8942293
Validation loss decreased (5.290575 --> 5.244498).  Saving model ...
Updating learning rate to 0.000125
tensor(40.0920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8424443 KL Loss: 13.9492878 DSM Loss: 18.6801027 Overall Loss:34.4718347
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(33.2929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8140781 KL Loss: 13.8539713 DSM Loss: 18.2909020 Overall Loss:33.9589516
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.993862628936768


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.5092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8932415 KL Loss: 14.2214765 DSM Loss: 25.7285360 Overall Loss:41.8432541
Validation loss decreased (inf --> 6.478747).  Saving model ...
Updating learning rate to 0.0005
tensor(43.4412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8812993 KL Loss: 14.0993849 DSM Loss: 20.0140309 Overall Loss:35.9947151
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(27.7735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9191194 KL Loss: 14.2356977 DSM Loss: 18.8743539 Overall Loss:35.0291708
Validation loss decreased (6.478747 --> 5.824994).  Saving model ...
Updating learning rate to 0.000125
tensor(29.8914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8525758 KL Loss: 14.0978170 DSM Loss: 18.2418822 Overall Loss:34.1922753
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(30.8683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8721441 KL Loss: 14.0852371 DSM Loss: 18.5221369 Overall Loss:34.4795182
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.043388366699219


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.7025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9197648 KL Loss: 14.2981835 DSM Loss: 27.0272581 Overall Loss:43.2452066
Validation loss decreased (inf --> 1.094135).  Saving model ...
Updating learning rate to 0.0005
tensor(34.8084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8398473 KL Loss: 14.1290272 DSM Loss: 21.5120884 Overall Loss:37.4809630
Validation loss decreased (1.094135 --> 0.708962).  Saving model ...
Updating learning rate to 0.00025
tensor(40.7207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8933945 KL Loss: 14.2258651 DSM Loss: 20.7058465 Overall Loss:36.8251062
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(43.4986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8848477 KL Loss: 14.2019531 DSM Loss: 20.2962343 Overall Loss:36.3830351
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.823474109172821


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.8879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9125360 KL Loss: 14.3710416 DSM Loss: 27.0311480 Overall Loss:43.3147256
Validation loss decreased (inf --> 1.299024).  Saving model ...
Updating learning rate to 0.0005
tensor(28.5087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9267527 KL Loss: 14.2775537 DSM Loss: 19.0169547 Overall Loss:35.2212608
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(23.2949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8564229 KL Loss: 14.1869471 DSM Loss: 18.1682834 Overall Loss:34.2116535
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.7696805000305176


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.6213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8354684 KL Loss: 14.1715304 DSM Loss: 27.5335089 Overall Loss:43.5405077
Validation loss decreased (inf --> 0.407374).  Saving model ...
Updating learning rate to 0.0005
tensor(38.4367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8490660 KL Loss: 14.1133724 DSM Loss: 20.4925395 Overall Loss:36.4549778
Validation loss decreased (0.407374 --> 0.376178).  Saving model ...
Updating learning rate to 0.00025
tensor(32.7832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8700696 KL Loss: 14.1841174 DSM Loss: 19.7255448 Overall Loss:35.7797320
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(38.9559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8828393 KL Loss: 14.2200456 DSM Loss: 19.3223098 Overall Loss:35.4251947
Validation loss decreased (0.376178 --> 0.335870).  Saving model ...
Updating learning rate to 6.25e-05
tensor(35.0131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8454624 KL Loss: 14.0059112 DSM Loss: 19.4881889 Overall Loss:35.3395627
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(37.1433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8577964 KL Loss: 14.1027864 DSM Loss: 19.0790810 Overall Loss:35.0396636
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4097485840320587


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.0180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8469944 KL Loss: 14.1351961 DSM Loss: 24.0387302 Overall Loss:40.0209207
Validation loss decreased (inf --> 2.974370).  Saving model ...
Updating learning rate to 0.0005
tensor(34.2095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8282322 KL Loss: 13.9846736 DSM Loss: 19.8765288 Overall Loss:35.6894344
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(31.4129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.8655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8853774 KL Loss: 14.1598042 DSM Loss: 18.7777302 Overall Loss:34.8229117
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.228109359741211


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.9289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9525686 KL Loss: 14.2527805 DSM Loss: 22.3874508 Overall Loss:38.5927998
Validation loss decreased (inf --> 6.892585).  Saving model ...
Updating learning rate to 0.0005
tensor(35.7544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4867, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9233692 KL Loss: 14.0530841 DSM Loss: 19.5582617 Overall Loss:35.5347151
Validation loss decreased (6.892585 --> 5.848160).  Saving model ...
Updating learning rate to 0.00025
tensor(27.2898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8897060 KL Loss: 14.1789399 DSM Loss: 18.9406879 Overall Loss:35.0093337
Validation loss decreased (5.848160 --> 5.528703).  Saving model ...
Updating learning rate to 0.000125
tensor(39.3408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8643839 KL Loss: 13.9844984 DSM Loss: 18.8674216 Overall Loss:34.7163035
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(37.9645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8727838 KL Loss: 14.0011996 DSM Loss: 18.7362018 Overall Loss:34.6101854
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:9.536500930786133


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(60.5579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9260575 KL Loss: 14.1921735 DSM Loss: 27.2238076 Overall Loss:43.3420388
Validation loss decreased (inf --> 19.487820).  Saving model ...
Updating learning rate to 0.0005
tensor(26.7823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9259555 KL Loss: 14.1887583 DSM Loss: 19.6533674 Overall Loss:35.7680811
Validation loss decreased (19.487820 --> 19.354901).  Saving model ...
Updating learning rate to 0.00025
tensor(22.1849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.1609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8118452 KL Loss: 13.9118440 DSM Loss: 18.3164741 Overall Loss:34.0401633
Validation loss decreased (19.354901 --> 19.088509).  Saving model ...
Updating learning rate to 0.000125
tensor(25.7365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2860, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8223950 KL Loss: 13.9774706 DSM Loss: 18.2524224 Overall Loss:34.0522880
Validation loss decreased (19.088509 --> 18.748263).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.9408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8637082 KL Loss: 14.0259733 DSM Loss: 18.3413007 Overall Loss:34.2309823
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(43.4611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2982, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8380409 KL Loss: 14.0334239 DSM Loss: 18.0598278 Overall Loss:33.9312929
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:31.966962814331055


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.4703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8798728 KL Loss: 14.2281688 DSM Loss: 25.7724577 Overall Loss:41.8804992
Validation loss decreased (inf --> 4.755053).  Saving model ...
Updating learning rate to 0.0005
tensor(36.9557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9017177 KL Loss: 14.2087426 DSM Loss: 18.8640773 Overall Loss:34.9745376
Validation loss decreased (4.755053 --> 3.431410).  Saving model ...
Updating learning rate to 0.00025
tensor(38.1163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6227, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9038315 KL Loss: 14.2611280 DSM Loss: 18.5828144 Overall Loss:34.7477738
Validation loss decreased (3.431410 --> 3.233755).  Saving model ...
Updating learning rate to 0.000125
tensor(30.4610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8651317 KL Loss: 14.1562261 DSM Loss: 18.4644877 Overall Loss:34.4858454
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(37.1135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8680783 KL Loss: 14.1291342 DSM Loss: 17.9820281 Overall Loss:33.9792406
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.236225128173828


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.6577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9180758 KL Loss: 14.2938327 DSM Loss: 21.1929896 Overall Loss:37.4048980
Validation loss decreased (inf --> 10.466442).  Saving model ...
Updating learning rate to 0.0005
tensor(38.2145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2961, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9006124 KL Loss: 14.1124660 DSM Loss: 18.8660921 Overall Loss:34.8791706
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(46.4727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2563, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8800285 KL Loss: 14.0431680 DSM Loss: 18.4651802 Overall Loss:34.3883765
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.0722718238830566


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.1764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0334, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8954209 KL Loss: 14.0852664 DSM Loss: 24.3953914 Overall Loss:40.3760786
Validation loss decreased (inf --> 4.818607).  Saving model ...
Updating learning rate to 0.0005
tensor(52.3355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8501009 KL Loss: 13.9135990 DSM Loss: 19.3952872 Overall Loss:35.1589870
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(34.9391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8322793 KL Loss: 13.6583448 DSM Loss: 18.7458783 Overall Loss:34.2365023
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.8236157894134521


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.5345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0088, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9556949 KL Loss: 14.3553183 DSM Loss: 26.3827145 Overall Loss:42.6937277
Validation loss decreased (inf --> 0.671412).  Saving model ...
Updating learning rate to 0.0005
tensor(24.7075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9011013 KL Loss: 14.1013570 DSM Loss: 18.9847554 Overall Loss:34.9872137
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(40.9734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8955305 KL Loss: 14.1781980 DSM Loss: 18.4063344 Overall Loss:34.4800629
Validation loss decreased (0.671412 --> 0.634346).  Saving model ...
Updating learning rate to 0.000125
tensor(24.5511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8074036 KL Loss: 13.8908567 DSM Loss: 18.6347962 Overall Loss:34.3330564
Validation loss decreased (0.634346 --> 0.577050).  Saving model ...
Updating learning rate to 6.25e-05
tensor(29.9417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8812883 KL Loss: 14.1390106 DSM Loss: 18.2656502 Overall Loss:34.2859491
Validation loss decreased (0.577050 --> 0.573923).  Saving model ...
Updating learning rate to 3.125e-05
tensor(30.4663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8571854 KL Loss: 14.1315222 DSM Loss: 18.1601038 Overall Loss:34.1488117
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(38.1154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5088, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8521894 KL Loss: 14.1259662 DSM Loss: 18.4402823 Overall Loss:34.4184378
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.5700057744979858


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.1628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8959014 KL Loss: 14.2680270 DSM Loss: 23.0036033 Overall Loss:39.1675315
Validation loss decreased (inf --> 0.232558).  Saving model ...
Updating learning rate to 0.0005
tensor(38.6913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8281432 KL Loss: 13.9720934 DSM Loss: 19.4756959 Overall Loss:35.2759325
Validation loss decreased (0.232558 --> 0.145774).  Saving model ...
Updating learning rate to 0.00025
tensor(44.2857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9182, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.7724514 KL Loss: 13.8155635 DSM Loss: 18.6476398 Overall Loss:34.2356548
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(42.8459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8233118 KL Loss: 13.9087140 DSM Loss: 18.3494066 Overall Loss:34.0814324
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.1532464623451233


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(41.6967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9173, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9039115 KL Loss: 14.2809206 DSM Loss: 25.9807291 Overall Loss:42.1655611
Validation loss decreased (inf --> 8.248305).  Saving model ...
Updating learning rate to 0.0005
tensor(46.5499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8689243 KL Loss: 14.0094322 DSM Loss: 19.2608850 Overall Loss:35.1392416
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(37.7208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.7958453 KL Loss: 13.8391144 DSM Loss: 18.1675976 Overall Loss:33.8025574
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:12.10114860534668


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(59.4447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9333360 KL Loss: 14.1996546 DSM Loss: 20.9177433 Overall Loss:37.0507339
Validation loss decreased (inf --> 9.125103).  Saving model ...
Updating learning rate to 0.0005
tensor(35.1454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8449824 KL Loss: 13.7494506 DSM Loss: 19.3557918 Overall Loss:34.9502248
Validation loss decreased (9.125103 --> 8.386103).  Saving model ...
Updating learning rate to 0.00025
tensor(31.6817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8517155 KL Loss: 13.9449709 DSM Loss: 18.6842418 Overall Loss:34.4809280
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(50.5296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8884991 KL Loss: 13.8951957 DSM Loss: 18.2636202 Overall Loss:34.0473150
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.13680362701416


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.7005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9310415 KL Loss: 14.3286242 DSM Loss: 23.1578300 Overall Loss:39.4174957
Validation loss decreased (inf --> 1.025163).  Saving model ...
Updating learning rate to 0.0005
tensor(35.9250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9009598 KL Loss: 14.1638276 DSM Loss: 19.7100666 Overall Loss:35.7748537
Validation loss decreased (1.025163 --> 0.761641).  Saving model ...
Updating learning rate to 0.00025
tensor(34.6354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8746259 KL Loss: 14.1665826 DSM Loss: 18.7937607 Overall Loss:34.8349692
Validation loss decreased (0.761641 --> 0.695485).  Saving model ...
Updating learning rate to 0.000125
tensor(34.6428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8712267 KL Loss: 14.2157069 DSM Loss: 18.4966715 Overall Loss:34.5836052
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(25.7579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2359, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8095019 KL Loss: 14.0988567 DSM Loss: 18.4252606 Overall Loss:34.3336190
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.212963342666626


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.4418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8689438 KL Loss: 14.1360919 DSM Loss: 21.3258606 Overall Loss:37.3308962
Validation loss decreased (inf --> 1.836631).  Saving model ...
Updating learning rate to 0.0005
tensor(32.3040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8858888 KL Loss: 14.1067803 DSM Loss: 19.6822550 Overall Loss:35.6749240
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(37.9407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8518656 KL Loss: 13.8322686 DSM Loss: 18.4764614 Overall Loss:34.1605952
Validation loss decreased (1.836631 --> 1.628315).  Saving model ...
Updating learning rate to 0.000125
tensor(32.4628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2254, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8086450 KL Loss: 13.6739448 DSM Loss: 18.2756201 Overall Loss:33.7582097
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(28.2721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4004, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8262260 KL Loss: 13.7180574 DSM Loss: 18.2716541 Overall Loss:33.8159375
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.952972173690796


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.1897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8997591 KL Loss: 14.2459979 DSM Loss: 26.1938308 Overall Loss:42.3395879
Validation loss decreased (inf --> 0.934507).  Saving model ...
Updating learning rate to 0.0005
tensor(47.6355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3832, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9148514 KL Loss: 14.0785972 DSM Loss: 20.8865481 Overall Loss:36.8799967
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(27.7110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8838974 KL Loss: 13.9927818 DSM Loss: 19.8379433 Overall Loss:35.7146222
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.1296294629573822


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.9361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8258515 KL Loss: 14.2137756 DSM Loss: 32.0492393 Overall Loss:48.0888663
Validation loss decreased (inf --> 2.253283).  Saving model ...
Updating learning rate to 0.0005
tensor(36.4701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8610152 KL Loss: 13.9124771 DSM Loss: 19.7373964 Overall Loss:35.5108885
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(37.5170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.7873206 KL Loss: 13.8155761 DSM Loss: 18.5567820 Overall Loss:34.1596787
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.9713876247406006


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.0876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9336180 KL Loss: 14.2010070 DSM Loss: 25.1747054 Overall Loss:41.3093304
Validation loss decreased (inf --> 2.691753).  Saving model ...
Updating learning rate to 0.0005
tensor(38.8162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8892097 KL Loss: 13.9294819 DSM Loss: 20.4964753 Overall Loss:36.3151669
Validation loss decreased (2.691753 --> 1.689152).  Saving model ...
Updating learning rate to 0.00025
tensor(34.9668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8758904 KL Loss: 13.9416791 DSM Loss: 19.8718740 Overall Loss:35.6894435
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(46.3453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9347, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8833119 KL Loss: 13.9474658 DSM Loss: 19.8166638 Overall Loss:35.6474412
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:22.042306900024414
      Ticker        MSE StdDev
0   AAPL_pct   8.222462    0.0
1   ABBV_pct  17.763884    0.0
2    AEP_pct   2.891241    0.0
3   AMGN_pct   3.402175    0.0
4   AMZN_pct   0.356327    0.0
..       ...        ...    ...
66    VZ_pct   1.212963    0.0
67     V_pct   1.952972    0.0
68   WFC_pct   0.129629    0.0
69   WMT_pct   2.971388    0.0
70   XOM_pct  22.042307    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=10, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=40, root_path='data/EcmP_stock_L_2016_24_mix_F_dva', scale=0.1, sequence_length=40, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(111.6627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0003811 KL Loss: 28.1526539 DSM Loss: 43.2860148 Overall Loss:73.4390498
Validation loss decreased (inf --> 8.986006).  Saving model ...
Updating learning rate to 0.0005
tensor(67.9882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.4299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.2484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0063825 KL Loss: 27.9185606 DSM Loss: 36.8445303 Overall Loss:66.7694735
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(70.8549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9693954 KL Loss: 27.6657071 DSM Loss: 36.2557324 Overall Loss:65.8908347
Validation loss decreased (8.986006 --> 7.859544).  Saving model ...
Updating learning rate to 0.000125
tensor(76.2373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9219734 KL Loss: 27.5897453 DSM Loss: 35.6883581 Overall Loss:65.2000768
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(72.7274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9281363 KL Loss: 27.6882033 DSM Loss: 35.3858740 Overall Loss:65.0022134
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.30777359008789


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(111.3891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9868164 KL Loss: 28.3831147 DSM Loss: 40.4696737 Overall Loss:70.8396047
Validation loss decreased (inf --> 9.769507).  Saving model ...
Updating learning rate to 0.0005
tensor(75.0143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.0180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9720992 KL Loss: 28.4070373 DSM Loss: 34.7558032 Overall Loss:65.1349395
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(59.7696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9260440 KL Loss: 28.1625622 DSM Loss: 34.7974372 Overall Loss:64.8860429
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:17.816524505615234


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(115.4880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9462504 KL Loss: 28.3862677 DSM Loss: 41.7583464 Overall Loss:72.0908645
Validation loss decreased (inf --> 2.151769).  Saving model ...
Updating learning rate to 0.0005
tensor(62.7490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9595564 KL Loss: 28.3131442 DSM Loss: 36.5326767 Overall Loss:66.8053769
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(68.7905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.9526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9768612 KL Loss: 28.3502555 DSM Loss: 35.9370507 Overall Loss:66.2641671
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.165571689605713


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(93.2667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9473220 KL Loss: 28.4120271 DSM Loss: 42.6637488 Overall Loss:73.0230974
Validation loss decreased (inf --> 1.513500).  Saving model ...
Updating learning rate to 0.0005
tensor(59.4243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.9637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9283102 KL Loss: 28.2721205 DSM Loss: 37.1615623 Overall Loss:67.3619934
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(61.0217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9199397 KL Loss: 28.3131718 DSM Loss: 35.7895240 Overall Loss:66.0226357
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.9330735206604


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.6290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.8958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8756286 KL Loss: 28.3188825 DSM Loss: 48.2821589 Overall Loss:78.4766702
Validation loss decreased (inf --> 3.562784).  Saving model ...
Updating learning rate to 0.0005
tensor(45.7682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.9741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8720051 KL Loss: 27.6171537 DSM Loss: 36.9459956 Overall Loss:66.4351547
Validation loss decreased (3.562784 --> 2.255688).  Saving model ...
Updating learning rate to 0.00025
tensor(63.0868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8225415 KL Loss: 27.3691213 DSM Loss: 35.6591533 Overall Loss:64.8508158
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(61.0882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8369455 KL Loss: 27.3348696 DSM Loss: 34.5212188 Overall Loss:63.6930338
Validation loss decreased (2.255688 --> 1.581537).  Saving model ...
Updating learning rate to 6.25e-05
tensor(48.0997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8722115 KL Loss: 27.2980808 DSM Loss: 35.2133494 Overall Loss:64.3836415
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(75.0370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8474119 KL Loss: 27.2196934 DSM Loss: 34.4180217 Overall Loss:63.4851269
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.2559525668621063


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(85.1192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5828, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0033159 KL Loss: 28.3672653 DSM Loss: 38.7631323 Overall Loss:69.1337134
Validation loss decreased (inf --> 7.556813).  Saving model ...
Updating learning rate to 0.0005
tensor(39.9970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9471617 KL Loss: 28.2079209 DSM Loss: 33.5919670 Overall Loss:63.7470494
Validation loss decreased (7.556813 --> 6.887138).  Saving model ...
Updating learning rate to 0.00025
tensor(48.7598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8853045 KL Loss: 28.0814420 DSM Loss: 32.9372542 Overall Loss:62.9040006
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(49.6550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8968841 KL Loss: 28.0548263 DSM Loss: 32.0888876 Overall Loss:62.0405978
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.997465193271637


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(104.1786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0133226 KL Loss: 28.5923274 DSM Loss: 43.7342534 Overall Loss:74.3399039
Validation loss decreased (inf --> 0.285455).  Saving model ...
Updating learning rate to 0.0005
tensor(75.7928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9934930 KL Loss: 28.2992717 DSM Loss: 38.6626641 Overall Loss:68.9554289
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(56.9822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9197977 KL Loss: 28.1599976 DSM Loss: 37.5760479 Overall Loss:67.6558433
Validation loss decreased (0.285455 --> 0.268273).  Saving model ...
Updating learning rate to 0.000125
tensor(55.3527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.9123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2406, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9019977 KL Loss: 27.9523773 DSM Loss: 36.4823465 Overall Loss:66.3367212
Validation loss decreased (0.268273 --> 0.264464).  Saving model ...
Updating learning rate to 6.25e-05
tensor(68.4093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8900256 KL Loss: 27.9529447 DSM Loss: 36.8248082 Overall Loss:66.6677785
Validation loss decreased (0.264464 --> 0.235211).  Saving model ...
Updating learning rate to 3.125e-05
tensor(71.4292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8697854 KL Loss: 27.9011861 DSM Loss: 36.5374784 Overall Loss:66.3084498
Validation loss decreased (0.235211 --> 0.229565).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(73.3738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8921466 KL Loss: 27.9945890 DSM Loss: 36.4078906 Overall Loss:66.2946266
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(67.4832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8895945 KL Loss: 27.9239584 DSM Loss: 36.4220558 Overall Loss:66.2356086
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.4490744173526764


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(112.0523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0111, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0082397 KL Loss: 28.5156557 DSM Loss: 44.7258465 Overall Loss:75.2497420
Validation loss decreased (inf --> 1.155580).  Saving model ...
Updating learning rate to 0.0005
tensor(65.0688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9901376 KL Loss: 28.3148222 DSM Loss: 39.2110398 Overall Loss:69.5159996
Validation loss decreased (1.155580 --> 0.712603).  Saving model ...
Updating learning rate to 0.00025
tensor(69.1682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.6893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 2.0145249 KL Loss: 28.4442920 DSM Loss: 37.0605617 Overall Loss:67.5193784
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(61.1535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9251224 KL Loss: 28.1655946 DSM Loss: 36.9649308 Overall Loss:67.0556477
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.2558385729789734


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(114.3222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9720758 KL Loss: 28.2472850 DSM Loss: 41.9770726 Overall Loss:72.1964337
Validation loss decreased (inf --> 2.322953).  Saving model ...
Updating learning rate to 0.0005
tensor(48.7407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9945690 KL Loss: 28.4158551 DSM Loss: 34.4787912 Overall Loss:64.8892153
Validation loss decreased (2.322953 --> 1.957306).  Saving model ...
Updating learning rate to 0.00025
tensor(54.0592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9406301 KL Loss: 28.0012416 DSM Loss: 33.2869966 Overall Loss:63.2288683
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(77.0836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9203493 KL Loss: 27.9839563 DSM Loss: 32.9940179 Overall Loss:62.8983232
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.2935118675231934


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(121.4654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9332, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9034941 KL Loss: 28.3252801 DSM Loss: 48.6245848 Overall Loss:78.8533591
Validation loss decreased (inf --> 0.166638).  Saving model ...
Updating learning rate to 0.0005
tensor(70.6315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.4963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9188625 KL Loss: 28.2528456 DSM Loss: 39.3902548 Overall Loss:69.5619627
Validation loss decreased (0.166638 --> 0.157184).  Saving model ...
Updating learning rate to 0.00025
tensor(83.3431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8979985 KL Loss: 28.3087086 DSM Loss: 37.6883750 Overall Loss:67.8950822
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(64.9233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9075080 KL Loss: 28.3906212 DSM Loss: 37.5315051 Overall Loss:67.8296341
Validation loss decreased (0.157184 --> 0.154955).  Saving model ...
Updating learning rate to 6.25e-05
tensor(72.1984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9092039 KL Loss: 28.2842625 DSM Loss: 37.4899685 Overall Loss:67.6834346
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(70.6119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9155083 KL Loss: 28.3144815 DSM Loss: 37.2169714 Overall Loss:67.4469612
Validation loss decreased (0.154955 --> 0.153918).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(66.1328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9303673 KL Loss: 28.3472868 DSM Loss: 36.8447831 Overall Loss:67.1224370
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(69.7469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3367, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9220883 KL Loss: 28.4378439 DSM Loss: 36.7392737 Overall Loss:67.0992058
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.426935911178589


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(81.1427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9886243 KL Loss: 28.3314794 DSM Loss: 43.2540064 Overall Loss:73.5741100
Validation loss decreased (inf --> 10.478874).  Saving model ...
Updating learning rate to 0.0005
tensor(50.1760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.7309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9869396 KL Loss: 28.3087419 DSM Loss: 33.3070161 Overall Loss:63.6026979
Validation loss decreased (10.478874 --> 9.483374).  Saving model ...
Updating learning rate to 0.00025
tensor(71.3883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8642, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9353744 KL Loss: 28.1771420 DSM Loss: 32.3670814 Overall Loss:62.4795978
Validation loss decreased (9.483374 --> 9.239460).  Saving model ...
Updating learning rate to 0.000125
tensor(66.8833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9382769 KL Loss: 28.0640659 DSM Loss: 32.0958941 Overall Loss:62.0982371
Validation loss decreased (9.239460 --> 8.996073).  Saving model ...
Updating learning rate to 6.25e-05
tensor(58.4840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8619375 KL Loss: 27.5104659 DSM Loss: 32.1525882 Overall Loss:61.5249916
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(59.1779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8876897 KL Loss: 27.9879263 DSM Loss: 32.1563394 Overall Loss:62.0319550
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:11.685829162597656


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(103.6998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.3047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0119525 KL Loss: 28.4729693 DSM Loss: 44.8197191 Overall Loss:75.3046412
Validation loss decreased (inf --> 0.215852).  Saving model ...
Updating learning rate to 0.0005
tensor(75.6271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9533384 KL Loss: 28.3686671 DSM Loss: 37.6219959 Overall Loss:67.9440013
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(63.9376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9091554 KL Loss: 28.0568338 DSM Loss: 36.1349011 Overall Loss:66.1008902
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.451278418302536


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(130.2256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.6558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0235981 KL Loss: 28.5491041 DSM Loss: 50.0394045 Overall Loss:80.6121064
Validation loss decreased (inf --> 1.803084).  Saving model ...
Updating learning rate to 0.0005
tensor(80.1086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9757983 KL Loss: 28.4164438 DSM Loss: 40.5103162 Overall Loss:70.9025582
Validation loss decreased (1.803084 --> 1.389533).  Saving model ...
Updating learning rate to 0.00025
tensor(62.4147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5370, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9506386 KL Loss: 28.3140693 DSM Loss: 39.4388595 Overall Loss:69.7035675
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(59.6849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7447, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9165237 KL Loss: 28.2980177 DSM Loss: 39.6162998 Overall Loss:69.8308411
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.7159720659255981


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.5993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9635556 KL Loss: 28.6906824 DSM Loss: 43.0005678 Overall Loss:73.6548058
Validation loss decreased (inf --> 4.172591).  Saving model ...
Updating learning rate to 0.0005
tensor(67.9027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.1794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.8514, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9634495 KL Loss: 28.3636937 DSM Loss: 35.4165084 Overall Loss:65.7436514
Validation loss decreased (4.172591 --> 4.155820).  Saving model ...
Updating learning rate to 0.00025
tensor(46.9278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9261425 KL Loss: 28.0815340 DSM Loss: 34.1525581 Overall Loss:64.1602348
Validation loss decreased (4.155820 --> 3.697915).  Saving model ...
Updating learning rate to 0.000125
tensor(76.3911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7846, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8949121 KL Loss: 27.9686972 DSM Loss: 34.1250887 Overall Loss:63.9886982
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(41.8432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.4197, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9406737 KL Loss: 27.9088174 DSM Loss: 33.6606850 Overall Loss:63.5101766
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.412241458892822


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(98.5370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9138250 KL Loss: 28.1615360 DSM Loss: 41.2958311 Overall Loss:71.3711920
Validation loss decreased (inf --> 3.506550).  Saving model ...
Updating learning rate to 0.0005
tensor(67.4414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9974733 KL Loss: 28.3150214 DSM Loss: 34.4891332 Overall Loss:64.8016278
Validation loss decreased (3.506550 --> 3.458146).  Saving model ...
Updating learning rate to 0.00025
tensor(83.9773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2738, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9927331 KL Loss: 28.5643348 DSM Loss: 34.1520358 Overall Loss:64.7091037
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(53.6306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.1068054 KL Loss: 28.6160977 DSM Loss: 33.0235631 Overall Loss:63.7464661
Validation loss decreased (3.458146 --> 3.075685).  Saving model ...
Updating learning rate to 6.25e-05
tensor(55.9673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.1546992 KL Loss: 28.6004535 DSM Loss: 33.0780221 Overall Loss:63.8331744
Validation loss decreased (3.075685 --> 2.395782).  Saving model ...
Updating learning rate to 3.125e-05
tensor(83.8283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.2097574 KL Loss: 29.1015042 DSM Loss: 32.4222498 Overall Loss:63.7335113
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(63.2791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.1309007 KL Loss: 28.8564474 DSM Loss: 33.0668318 Overall Loss:64.0541802
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.12270300835371017


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(90.1739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7014, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9446302 KL Loss: 28.3515429 DSM Loss: 41.1837879 Overall Loss:71.4799608
Validation loss decreased (inf --> 2.638347).  Saving model ...
Updating learning rate to 0.0005
tensor(75.5600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9096318 KL Loss: 27.9963162 DSM Loss: 34.2549555 Overall Loss:64.1609036
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(48.8059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9347949 KL Loss: 27.9314314 DSM Loss: 32.9670624 Overall Loss:62.8332886
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.4373082220554352


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(106.8706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9158466 KL Loss: 27.9564703 DSM Loss: 43.7103352 Overall Loss:73.5826521
Validation loss decreased (inf --> 11.247862).  Saving model ...
Updating learning rate to 0.0005
tensor(64.7261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.9558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9362132 KL Loss: 27.9621830 DSM Loss: 35.5149101 Overall Loss:65.4133066
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(79.8242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9268263 KL Loss: 27.7168392 DSM Loss: 34.8775102 Overall Loss:64.5211753
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.179847002029419


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(114.6190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0314601 KL Loss: 28.4811321 DSM Loss: 43.4646731 Overall Loss:73.9772649
Validation loss decreased (inf --> 3.532788).  Saving model ...
Updating learning rate to 0.0005
tensor(53.4619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9380621 KL Loss: 28.2150576 DSM Loss: 34.6807692 Overall Loss:64.8338891
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(74.4559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9055046 KL Loss: 28.1104285 DSM Loss: 33.8460162 Overall Loss:63.8619492
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.7535078525543213


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(96.9955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8471, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9423653 KL Loss: 28.3550973 DSM Loss: 39.9702705 Overall Loss:70.2677331
Validation loss decreased (inf --> 11.145669).  Saving model ...
Updating learning rate to 0.0005
tensor(61.7138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9260617 KL Loss: 28.2341385 DSM Loss: 34.1704796 Overall Loss:64.3306795
Validation loss decreased (11.145669 --> 9.991346).  Saving model ...
Updating learning rate to 0.00025
tensor(79.0709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9430691 KL Loss: 28.5134158 DSM Loss: 33.5388893 Overall Loss:63.9953743
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(64.4082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9083587 KL Loss: 28.1678266 DSM Loss: 33.1912029 Overall Loss:63.2673878
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:35.24793243408203


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(109.8146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9541204 KL Loss: 28.2864013 DSM Loss: 44.8849993 Overall Loss:75.1255212
Validation loss decreased (inf --> 0.800231).  Saving model ...
Updating learning rate to 0.0005
tensor(65.4567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9435892 KL Loss: 28.3204846 DSM Loss: 35.0720119 Overall Loss:65.3360858
Validation loss decreased (0.800231 --> 0.749149).  Saving model ...
Updating learning rate to 0.00025
tensor(47.7159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9326776 KL Loss: 28.2485756 DSM Loss: 34.5930827 Overall Loss:64.7743361
Validation loss decreased (0.749149 --> 0.596481).  Saving model ...
Updating learning rate to 0.000125
tensor(66.9303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9030900 KL Loss: 28.1229675 DSM Loss: 33.9091706 Overall Loss:63.9352282
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(76.2651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.3721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9020081 KL Loss: 28.1826009 DSM Loss: 34.1222020 Overall Loss:64.2068110
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.794036865234375


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(106.0690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.5373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9190768 KL Loss: 28.1914108 DSM Loss: 48.2995631 Overall Loss:78.4100505
Validation loss decreased (inf --> 9.236477).  Saving model ...
Updating learning rate to 0.0005
tensor(73.6986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9021409 KL Loss: 27.8530635 DSM Loss: 36.6029489 Overall Loss:66.3581533
Validation loss decreased (9.236477 --> 8.267387).  Saving model ...
Updating learning rate to 0.00025
tensor(69.2325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.0252, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8938148 KL Loss: 27.5157565 DSM Loss: 35.6535769 Overall Loss:65.0631481
Validation loss decreased (8.267387 --> 8.133316).  Saving model ...
Updating learning rate to 0.000125
tensor(79.5167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8668, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8710322 KL Loss: 27.3948849 DSM Loss: 35.1116877 Overall Loss:64.3776048
Validation loss decreased (8.133316 --> 8.131878).  Saving model ...
Updating learning rate to 6.25e-05
tensor(86.2106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8548395 KL Loss: 27.4594322 DSM Loss: 34.7377352 Overall Loss:64.0520065
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(49.1552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8228, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9171148 KL Loss: 27.5498658 DSM Loss: 33.6458361 Overall Loss:63.1128169
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.547122001647949


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(128.5170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1354, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9160806 KL Loss: 28.2817204 DSM Loss: 45.7097327 Overall Loss:75.9075334
Validation loss decreased (inf --> 1.544458).  Saving model ...
Updating learning rate to 0.0005
tensor(75.5491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9888517 KL Loss: 28.2046992 DSM Loss: 37.4054147 Overall Loss:67.5989653
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(59.1242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(125.4033, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9472493 KL Loss: 28.1048191 DSM Loss: 36.7660029 Overall Loss:66.8180715
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.0657230615615845


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(99.8759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.1548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9136975 KL Loss: 28.3823776 DSM Loss: 42.4692389 Overall Loss:72.7653143
Validation loss decreased (inf --> 6.937905).  Saving model ...
Updating learning rate to 0.0005
tensor(61.1466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9135628 KL Loss: 28.3582386 DSM Loss: 34.7739027 Overall Loss:65.0457040
Validation loss decreased (6.937905 --> 6.270631).  Saving model ...
Updating learning rate to 0.00025
tensor(57.5375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9166525 KL Loss: 28.1565258 DSM Loss: 33.9505146 Overall Loss:64.0236928
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(58.6221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9073661 KL Loss: 28.1252136 DSM Loss: 33.6544442 Overall Loss:63.6870237
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.563542366027832


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(112.5192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.5785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9206077 KL Loss: 28.2299285 DSM Loss: 53.7559663 Overall Loss:83.9065021
Validation loss decreased (inf --> 2.196515).  Saving model ...
Updating learning rate to 0.0005
tensor(75.3097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9161019 KL Loss: 28.2517014 DSM Loss: 37.0758038 Overall Loss:67.2436071
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(66.5400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.0087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9267730 KL Loss: 28.1963527 DSM Loss: 35.8713472 Overall Loss:65.9944728
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.305185317993164


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(85.6619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9390526 KL Loss: 28.2663730 DSM Loss: 47.3462538 Overall Loss:77.5516795
Validation loss decreased (inf --> 11.861647).  Saving model ...
Updating learning rate to 0.0005
tensor(67.7548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3244, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9365807 KL Loss: 28.1695912 DSM Loss: 35.1519576 Overall Loss:65.2581290
Validation loss decreased (11.861647 --> 11.347275).  Saving model ...
Updating learning rate to 0.00025
tensor(74.4020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9362308 KL Loss: 28.2998911 DSM Loss: 33.9760275 Overall Loss:64.2121491
Validation loss decreased (11.347275 --> 11.095093).  Saving model ...
Updating learning rate to 0.000125
tensor(72.5950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9176612 KL Loss: 28.2309357 DSM Loss: 33.8428774 Overall Loss:63.9914743
Validation loss decreased (11.095093 --> 11.078527).  Saving model ...
Updating learning rate to 6.25e-05
tensor(60.1184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9603076 KL Loss: 28.5131722 DSM Loss: 33.3801271 Overall Loss:63.8536069
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(68.3447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9133083 KL Loss: 28.1102064 DSM Loss: 33.0080719 Overall Loss:63.0315866
Validation loss decreased (11.078527 --> 10.886698).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(61.3632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9059450 KL Loss: 28.2717600 DSM Loss: 33.5454281 Overall Loss:63.7231328
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(69.6516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9276353 KL Loss: 28.3302135 DSM Loss: 33.0202488 Overall Loss:63.2780973
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:14.728564262390137


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(113.2078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.6917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8473506 KL Loss: 28.1567340 DSM Loss: 44.1212248 Overall Loss:74.1253098
Validation loss decreased (inf --> 5.033948).  Saving model ...
Updating learning rate to 0.0005
tensor(59.1228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9084487 KL Loss: 28.3491598 DSM Loss: 34.3287710 Overall Loss:64.5863796
Validation loss decreased (5.033948 --> 4.387226).  Saving model ...
Updating learning rate to 0.00025
tensor(44.4505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8867359 KL Loss: 28.2955735 DSM Loss: 33.5002929 Overall Loss:63.6826021
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(49.5832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9036773 KL Loss: 28.2978113 DSM Loss: 32.8762219 Overall Loss:63.0777108
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.766057014465332


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(105.8423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8317659 KL Loss: 27.8832946 DSM Loss: 54.0516950 Overall Loss:83.7667555
Validation loss decreased (inf --> 0.100465).  Saving model ...
Updating learning rate to 0.0005
tensor(68.4336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9651909 KL Loss: 28.1366240 DSM Loss: 39.5732981 Overall Loss:69.6751129
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(64.4979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0098, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9219212 KL Loss: 27.7947741 DSM Loss: 39.0944471 Overall Loss:68.8111426
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.27069756388664246


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(72.4882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9396885 KL Loss: 28.1571056 DSM Loss: 39.9768182 Overall Loss:70.0736122
Validation loss decreased (inf --> 11.965152).  Saving model ...
Updating learning rate to 0.0005
tensor(100.8628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9533371 KL Loss: 28.1987546 DSM Loss: 33.6022325 Overall Loss:63.7543248
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(78.4139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9304941 KL Loss: 27.8216072 DSM Loss: 32.6866234 Overall Loss:62.4387246
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.478923797607422


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(112.5428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8972434 KL Loss: 28.5029991 DSM Loss: 41.1013897 Overall Loss:71.5016320
Validation loss decreased (inf --> 8.870672).  Saving model ...
Updating learning rate to 0.0005
tensor(77.1175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9379338 KL Loss: 28.7205292 DSM Loss: 35.7949110 Overall Loss:66.4533739
Validation loss decreased (8.870672 --> 7.950258).  Saving model ...
Updating learning rate to 0.00025
tensor(73.7049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.3092, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9416945 KL Loss: 28.3293084 DSM Loss: 35.3815927 Overall Loss:65.6525957
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(57.9938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.0163223 KL Loss: 28.4412559 DSM Loss: 34.7961265 Overall Loss:65.2537049
Validation loss decreased (7.950258 --> 7.770694).  Saving model ...
Updating learning rate to 6.25e-05
tensor(74.5096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.4885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0576803 KL Loss: 28.5884759 DSM Loss: 34.5743747 Overall Loss:65.2205305
Validation loss decreased (7.770694 --> 6.428028).  Saving model ...
Updating learning rate to 3.125e-05
tensor(64.5257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.0404174 KL Loss: 28.5500422 DSM Loss: 34.6645341 Overall Loss:65.2549938
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(59.2970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.0854397 KL Loss: 28.4940126 DSM Loss: 34.8349606 Overall Loss:65.4144130
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.053037166595459


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(109.0388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9251649 KL Loss: 28.2147681 DSM Loss: 41.8722631 Overall Loss:72.0121961
Validation loss decreased (inf --> 2.338829).  Saving model ...
Updating learning rate to 0.0005
tensor(76.9445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9160387 KL Loss: 27.9792130 DSM Loss: 35.5574362 Overall Loss:65.4526878
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(60.2960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5176, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8999456 KL Loss: 27.8225366 DSM Loss: 33.7265976 Overall Loss:63.4490796
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.7855799198150635


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(110.7729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.8968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8944741 KL Loss: 28.3605404 DSM Loss: 44.7643539 Overall Loss:75.0193684
Validation loss decreased (inf --> 0.377574).  Saving model ...
Updating learning rate to 0.0005
tensor(78.8595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.4373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9048931 KL Loss: 28.4107614 DSM Loss: 39.2344530 Overall Loss:69.5501079
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(74.9592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9206499 KL Loss: 28.3295218 DSM Loss: 37.8212600 Overall Loss:68.0714319
Validation loss decreased (0.377574 --> 0.364160).  Saving model ...
Updating learning rate to 0.000125
tensor(61.6394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9201009 KL Loss: 28.3511654 DSM Loss: 37.9369364 Overall Loss:68.2082025
Validation loss decreased (0.364160 --> 0.341225).  Saving model ...
Updating learning rate to 6.25e-05
tensor(66.0136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8639, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8957486 KL Loss: 28.3044483 DSM Loss: 37.1712740 Overall Loss:67.3714708
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(54.4481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8953907 KL Loss: 28.2885845 DSM Loss: 37.0049571 Overall Loss:67.1889324
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9898210167884827


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(80.0963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8990221 KL Loss: 28.2024878 DSM Loss: 45.0750858 Overall Loss:75.1765956
Validation loss decreased (inf --> 2.723507).  Saving model ...
Updating learning rate to 0.0005
tensor(83.8224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3646, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9571929 KL Loss: 28.5666916 DSM Loss: 37.4371842 Overall Loss:67.9610684
Validation loss decreased (2.723507 --> 2.230995).  Saving model ...
Updating learning rate to 0.00025
tensor(70.6827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9376128 KL Loss: 28.2717764 DSM Loss: 36.3243983 Overall Loss:66.5337877
Validation loss decreased (2.230995 --> 2.148870).  Saving model ...
Updating learning rate to 0.000125
tensor(45.9667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4117, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8895019 KL Loss: 28.0140058 DSM Loss: 36.3111821 Overall Loss:66.2146897
Validation loss decreased (2.148870 --> 1.843413).  Saving model ...
Updating learning rate to 6.25e-05
tensor(68.8726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9331043 KL Loss: 28.2298548 DSM Loss: 36.0880813 Overall Loss:66.2510401
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(59.1516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8941350 KL Loss: 28.0162355 DSM Loss: 35.9350041 Overall Loss:65.8453746
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.1953628063201904


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(106.5760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9638169 KL Loss: 28.3739311 DSM Loss: 41.9489129 Overall Loss:72.2866606
Validation loss decreased (inf --> 0.483766).  Saving model ...
Updating learning rate to 0.0005
tensor(72.8892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4271, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9357404 KL Loss: 28.0716847 DSM Loss: 36.5633714 Overall Loss:66.5707966
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(74.8981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7919, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9169879 KL Loss: 28.0605492 DSM Loss: 35.9859002 Overall Loss:65.9634370
Validation loss decreased (0.483766 --> 0.413638).  Saving model ...
Updating learning rate to 0.000125
tensor(65.0817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8952699 KL Loss: 27.9910778 DSM Loss: 35.5286155 Overall Loss:65.4149636
Validation loss decreased (0.413638 --> 0.355583).  Saving model ...
Updating learning rate to 6.25e-05
tensor(67.9487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8904477 KL Loss: 27.9816221 DSM Loss: 35.1606331 Overall Loss:65.0327024
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(72.6977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3708, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8899316 KL Loss: 27.9714806 DSM Loss: 34.8887851 Overall Loss:64.7501976
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.1572860479354858


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(97.3870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9190744 KL Loss: 28.2607695 DSM Loss: 46.9255358 Overall Loss:77.1053796
Validation loss decreased (inf --> 5.671906).  Saving model ...
Updating learning rate to 0.0005
tensor(53.7810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8666435 KL Loss: 27.9337530 DSM Loss: 33.0458458 Overall Loss:62.8462423
Validation loss decreased (5.671906 --> 4.537655).  Saving model ...
Updating learning rate to 0.00025
tensor(51.2425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5848, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9224887 KL Loss: 28.0787220 DSM Loss: 32.0230555 Overall Loss:62.0242663
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(77.6364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.0412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8659831 KL Loss: 27.7415273 DSM Loss: 31.7708826 Overall Loss:61.3783932
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.01429557800293


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(108.9699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9426761 KL Loss: 28.4910528 DSM Loss: 39.3365771 Overall Loss:69.7703063
Validation loss decreased (inf --> 4.774038).  Saving model ...
Updating learning rate to 0.0005
tensor(61.4594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9095773 KL Loss: 28.2120297 DSM Loss: 34.3914227 Overall Loss:64.5130299
Validation loss decreased (4.774038 --> 4.195557).  Saving model ...
Updating learning rate to 0.00025
tensor(62.8694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5054, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8871978 KL Loss: 28.0026174 DSM Loss: 33.7808496 Overall Loss:63.6706648
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(51.3287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8959426 KL Loss: 28.1520369 DSM Loss: 32.8534902 Overall Loss:62.9014697
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.461585521697998


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(107.0540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9490940 KL Loss: 28.2230955 DSM Loss: 41.6548611 Overall Loss:71.8270509
Validation loss decreased (inf --> 6.217698).  Saving model ...
Updating learning rate to 0.0005
tensor(71.2748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9616959 KL Loss: 28.4408781 DSM Loss: 37.2680805 Overall Loss:67.6706547
Validation loss decreased (6.217698 --> 6.154474).  Saving model ...
Updating learning rate to 0.00025
tensor(64.8917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9321577 KL Loss: 28.1088698 DSM Loss: 36.2494992 Overall Loss:66.2905267
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(58.1125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8915124 KL Loss: 27.7277345 DSM Loss: 35.4744371 Overall Loss:65.0936841
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:9.857490539550781


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(96.9824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.0080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9419659 KL Loss: 28.3248745 DSM Loss: 40.2467447 Overall Loss:70.5135848
Validation loss decreased (inf --> 2.032934).  Saving model ...
Updating learning rate to 0.0005
tensor(63.0149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.9348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9347362 KL Loss: 28.2247187 DSM Loss: 34.8628167 Overall Loss:65.0222718
Validation loss decreased (2.032934 --> 1.853931).  Saving model ...
Updating learning rate to 0.00025
tensor(64.8008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9436193 KL Loss: 27.8768791 DSM Loss: 34.7231567 Overall Loss:64.5436553
Validation loss decreased (1.853931 --> 1.805683).  Saving model ...
Updating learning rate to 0.000125
tensor(73.5879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8999634 KL Loss: 28.0188096 DSM Loss: 33.7077280 Overall Loss:63.6265010
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(52.7411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9099971 KL Loss: 27.9148986 DSM Loss: 34.0269932 Overall Loss:63.8518893
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:6.617278575897217


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.9866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0346644 KL Loss: 28.4950539 DSM Loss: 42.0983355 Overall Loss:72.6280539
Validation loss decreased (inf --> 1.669772).  Saving model ...
Updating learning rate to 0.0005
tensor(57.4319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9943580 KL Loss: 28.3149194 DSM Loss: 37.1093734 Overall Loss:67.4186508
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(63.3765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9050507 KL Loss: 27.9584522 DSM Loss: 36.0724392 Overall Loss:65.9359425
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.1102755069732666


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(108.7344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.6100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9647917 KL Loss: 28.4911648 DSM Loss: 43.6008450 Overall Loss:74.0568016
Validation loss decreased (inf --> 4.177109).  Saving model ...
Updating learning rate to 0.0005
tensor(63.3230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9558630 KL Loss: 28.3130543 DSM Loss: 36.4732227 Overall Loss:66.7421403
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(60.1861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9390504 KL Loss: 28.3624559 DSM Loss: 35.2478367 Overall Loss:65.5493430
Validation loss decreased (4.177109 --> 4.091299).  Saving model ...
Updating learning rate to 0.000125
tensor(82.0886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7777, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9416973 KL Loss: 28.3170436 DSM Loss: 35.3619820 Overall Loss:65.6207229
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(59.7269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8831444 KL Loss: 28.1296059 DSM Loss: 34.7728370 Overall Loss:64.7855873
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.573675155639648


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(130.1300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9957535 KL Loss: 28.2787966 DSM Loss: 42.2577748 Overall Loss:72.5323255
Validation loss decreased (inf --> 2.698142).  Saving model ...
Updating learning rate to 0.0005
tensor(60.6687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9448522 KL Loss: 28.1529683 DSM Loss: 35.4635485 Overall Loss:65.5613691
Validation loss decreased (2.698142 --> 2.099804).  Saving model ...
Updating learning rate to 0.00025
tensor(57.6338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9240613 KL Loss: 27.9299182 DSM Loss: 34.8453017 Overall Loss:64.6992812
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(82.6297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.1929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5121, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9450882 KL Loss: 28.1167576 DSM Loss: 34.5065789 Overall Loss:64.5684247
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.10989513248205185


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(107.2713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8828, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9695246 KL Loss: 28.1400573 DSM Loss: 46.1342482 Overall Loss:76.2438298
Validation loss decreased (inf --> 0.437073).  Saving model ...
Updating learning rate to 0.0005
tensor(74.8585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9595963 KL Loss: 28.1816725 DSM Loss: 35.4798779 Overall Loss:65.6211467
Validation loss decreased (0.437073 --> 0.431896).  Saving model ...
Updating learning rate to 0.00025
tensor(52.1999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.4475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1279, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9175430 KL Loss: 28.0236965 DSM Loss: 33.5699363 Overall Loss:63.5111758
Validation loss decreased (0.431896 --> 0.401562).  Saving model ...
Updating learning rate to 0.000125
tensor(65.2655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9131075 KL Loss: 28.0576689 DSM Loss: 33.7247285 Overall Loss:63.6955053
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(51.2650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9039994 KL Loss: 28.2122357 DSM Loss: 32.9976947 Overall Loss:63.1139295
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.261953353881836


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.8765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.9128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9366623 KL Loss: 28.5836618 DSM Loss: 50.2375080 Overall Loss:80.7578322
Validation loss decreased (inf --> 1.098821).  Saving model ...
Updating learning rate to 0.0005
tensor(88.1483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9535078 KL Loss: 28.6209444 DSM Loss: 42.0249733 Overall Loss:72.5994256
Validation loss decreased (1.098821 --> 0.926639).  Saving model ...
Updating learning rate to 0.00025
tensor(67.4634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.9404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9492258 KL Loss: 28.6229833 DSM Loss: 40.1029317 Overall Loss:70.6751409
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(61.4236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9076861 KL Loss: 28.3239605 DSM Loss: 41.0029428 Overall Loss:71.2345891
Validation loss decreased (0.926639 --> 0.882813).  Saving model ...
Updating learning rate to 6.25e-05
tensor(71.9783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9121948 KL Loss: 28.3471497 DSM Loss: 39.9714475 Overall Loss:70.2307925
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(77.6236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.8446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9385781 KL Loss: 28.3721480 DSM Loss: 39.9302966 Overall Loss:70.2410225
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6421334147453308


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(99.0296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.6949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9003780 KL Loss: 28.1122241 DSM Loss: 61.4509509 Overall Loss:91.4635532
Validation loss decreased (inf --> 2.324961).  Saving model ...
Updating learning rate to 0.0005
tensor(63.5237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8914958 KL Loss: 27.8846916 DSM Loss: 37.9852885 Overall Loss:67.7614759
Validation loss decreased (2.324961 --> 1.981015).  Saving model ...
Updating learning rate to 0.00025
tensor(55.3688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.1264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8875804 KL Loss: 27.8257994 DSM Loss: 35.0920931 Overall Loss:64.8054726
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(63.2197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3111, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8700964 KL Loss: 27.7497282 DSM Loss: 35.0138396 Overall Loss:64.6336643
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:14.576125144958496


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(104.4667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9215764 KL Loss: 28.2528128 DSM Loss: 41.1085451 Overall Loss:71.2829344
Validation loss decreased (inf --> 8.257893).  Saving model ...
Updating learning rate to 0.0005
tensor(52.7686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9336868 KL Loss: 28.3114589 DSM Loss: 36.6283077 Overall Loss:66.8734533
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(65.8758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.6123, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9925944 KL Loss: 28.2467472 DSM Loss: 35.2990069 Overall Loss:65.5383484
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:6.918844223022461


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(96.3371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9660395 KL Loss: 28.0853946 DSM Loss: 41.0558810 Overall Loss:71.1073154
Validation loss decreased (inf --> 5.053451).  Saving model ...
Updating learning rate to 0.0005
tensor(62.8888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9190972 KL Loss: 28.0840355 DSM Loss: 37.0305625 Overall Loss:67.0336953
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(78.8784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9279954 KL Loss: 27.9837558 DSM Loss: 36.3941649 Overall Loss:66.3059162
Validation loss decreased (5.053451 --> 4.902658).  Saving model ...
Updating learning rate to 0.000125
tensor(75.6476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1115, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9484434 KL Loss: 27.9516090 DSM Loss: 35.7931721 Overall Loss:65.6932243
Validation loss decreased (4.902658 --> 4.753876).  Saving model ...
Updating learning rate to 6.25e-05
tensor(73.4990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.1448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9161283 KL Loss: 27.7823030 DSM Loss: 36.4004446 Overall Loss:66.0988759
Validation loss decreased (4.753876 --> 4.619590).  Saving model ...
Updating learning rate to 3.125e-05
tensor(60.0122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9309130 KL Loss: 27.8945766 DSM Loss: 35.8849576 Overall Loss:65.7104470
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(55.7665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9722649 KL Loss: 27.8019502 DSM Loss: 35.3422324 Overall Loss:65.1164474
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.5012412071228027


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.6594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3646, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9179451 KL Loss: 28.3393520 DSM Loss: 45.1540219 Overall Loss:75.4113190
Validation loss decreased (inf --> 9.441744).  Saving model ...
Updating learning rate to 0.0005
tensor(89.1040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.9165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9165564 KL Loss: 28.1998221 DSM Loss: 38.3056380 Overall Loss:68.4220167
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(66.1808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9856, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9246288 KL Loss: 28.3305367 DSM Loss: 38.0912237 Overall Loss:68.3463891
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.417473793029785


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(91.3055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0274074 KL Loss: 28.4905711 DSM Loss: 43.7373545 Overall Loss:74.2553328
Validation loss decreased (inf --> 1.120058).  Saving model ...
Updating learning rate to 0.0005
tensor(68.1853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9501056 KL Loss: 28.3224601 DSM Loss: 37.2155566 Overall Loss:67.4881224
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(86.2977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9322738 KL Loss: 28.3200882 DSM Loss: 36.3768189 Overall Loss:66.6291810
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.6371588706970215


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(103.4368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.8370, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9855351 KL Loss: 28.1180087 DSM Loss: 38.5460297 Overall Loss:68.6495738
Validation loss decreased (inf --> 12.870197).  Saving model ...
Updating learning rate to 0.0005
tensor(83.4229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1224, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9024055 KL Loss: 27.8123424 DSM Loss: 32.7411906 Overall Loss:62.4559389
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(73.1981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7453, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9137561 KL Loss: 27.9293714 DSM Loss: 31.5717935 Overall Loss:61.4149212
Validation loss decreased (12.870197 --> 12.154481).  Saving model ...
Updating learning rate to 0.000125
tensor(40.1794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8858079 KL Loss: 27.6784921 DSM Loss: 31.6774671 Overall Loss:61.2417672
Validation loss decreased (12.154481 --> 11.920196).  Saving model ...
Updating learning rate to 6.25e-05
tensor(54.5556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8867488 KL Loss: 27.7003237 DSM Loss: 31.0009366 Overall Loss:60.5880088
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(68.1398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8767250 KL Loss: 27.6757387 DSM Loss: 30.5959707 Overall Loss:60.1484347
Validation loss decreased (11.920196 --> 11.846530).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(39.7418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8705855 KL Loss: 27.5349407 DSM Loss: 30.7487070 Overall Loss:60.1542329
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(46.2139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(130.9961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9321667 KL Loss: 27.7697657 DSM Loss: 30.6061638 Overall Loss:60.3080958
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:18.946231842041016


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(106.7376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9357595 KL Loss: 28.3834963 DSM Loss: 46.6837530 Overall Loss:77.0030095
Validation loss decreased (inf --> 1.366479).  Saving model ...
Updating learning rate to 0.0005
tensor(75.6962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.6898, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9542991 KL Loss: 28.3460463 DSM Loss: 40.3285029 Overall Loss:70.6288482
Validation loss decreased (1.366479 --> 0.819877).  Saving model ...
Updating learning rate to 0.00025
tensor(66.1376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9293494 KL Loss: 28.1777204 DSM Loss: 39.7150252 Overall Loss:69.8220949
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(61.8196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9401419 KL Loss: 28.3980967 DSM Loss: 38.6038962 Overall Loss:68.9421352
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5518057942390442


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(122.8913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9056311 KL Loss: 28.4364927 DSM Loss: 40.8711744 Overall Loss:71.2132981
Validation loss decreased (inf --> 7.260206).  Saving model ...
Updating learning rate to 0.0005
tensor(72.2723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.7277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8980166 KL Loss: 28.1224882 DSM Loss: 35.2128448 Overall Loss:65.2333493
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(65.6038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8728819 KL Loss: 27.8756554 DSM Loss: 34.8128025 Overall Loss:64.5613401
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:13.325188636779785


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(106.8878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9085479 KL Loss: 28.0983065 DSM Loss: 38.2813020 Overall Loss:68.2881562
Validation loss decreased (inf --> 18.863899).  Saving model ...
Updating learning rate to 0.0005
tensor(57.0186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9544095 KL Loss: 28.2264846 DSM Loss: 33.2977659 Overall Loss:63.4786601
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(58.5400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9316573 KL Loss: 28.2139660 DSM Loss: 32.2860246 Overall Loss:62.4316474
Validation loss decreased (18.863899 --> 17.907338).  Saving model ...
Updating learning rate to 0.000125
tensor(66.6941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9271836 KL Loss: 28.1226441 DSM Loss: 32.1428932 Overall Loss:62.1927208
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(62.8104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8985583 KL Loss: 28.0453857 DSM Loss: 31.9761128 Overall Loss:61.9200568
Validation loss decreased (17.907338 --> 17.573223).  Saving model ...
Updating learning rate to 3.125e-05
tensor(59.5617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8769333 KL Loss: 27.8710429 DSM Loss: 31.9234923 Overall Loss:61.6714688
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(65.7980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8836681 KL Loss: 27.9484652 DSM Loss: 31.8614708 Overall Loss:61.6936039
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.681710243225098


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(107.2475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9292161 KL Loss: 28.2041503 DSM Loss: 45.4641674 Overall Loss:75.5975335
Validation loss decreased (inf --> 6.071309).  Saving model ...
Updating learning rate to 0.0005
tensor(62.1062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9539428 KL Loss: 28.4346781 DSM Loss: 38.1744230 Overall Loss:68.5630438
Validation loss decreased (6.071309 --> 5.947773).  Saving model ...
Updating learning rate to 0.00025
tensor(60.7767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8992641 KL Loss: 28.1600393 DSM Loss: 36.4879139 Overall Loss:66.5472173
Validation loss decreased (5.947773 --> 5.645755).  Saving model ...
Updating learning rate to 0.000125
tensor(77.0193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9036726 KL Loss: 27.9259578 DSM Loss: 36.5096945 Overall Loss:66.3393248
Validation loss decreased (5.645755 --> 5.281822).  Saving model ...
Updating learning rate to 6.25e-05
tensor(69.3909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8862388 KL Loss: 27.6123670 DSM Loss: 36.3544986 Overall Loss:65.8531044
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(71.6883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8817743 KL Loss: 27.8724021 DSM Loss: 36.7007950 Overall Loss:66.4549714
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.007734298706055


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(99.7452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9768523 KL Loss: 28.4812752 DSM Loss: 43.7410402 Overall Loss:74.1991677
Validation loss decreased (inf --> 5.469114).  Saving model ...
Updating learning rate to 0.0005
tensor(78.3735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.9002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0005722 KL Loss: 28.4718047 DSM Loss: 37.5896916 Overall Loss:68.0620688
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(68.1772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9509869 KL Loss: 28.2071288 DSM Loss: 37.3322975 Overall Loss:67.4904131
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.793081283569336


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(103.7118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.7148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9598643 KL Loss: 28.5792434 DSM Loss: 51.1064779 Overall Loss:81.6455856
Validation loss decreased (inf --> 0.707385).  Saving model ...
Updating learning rate to 0.0005
tensor(56.7112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9453044 KL Loss: 28.3694513 DSM Loss: 42.0714997 Overall Loss:72.3862551
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(80.8253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.8187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9660613 KL Loss: 28.3844693 DSM Loss: 40.3158300 Overall Loss:70.6663606
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8691231608390808


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(100.7037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8900316 KL Loss: 28.3593165 DSM Loss: 42.1039514 Overall Loss:72.3532997
Validation loss decreased (inf --> 1.738979).  Saving model ...
Updating learning rate to 0.0005
tensor(75.7088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9433213 KL Loss: 28.4074714 DSM Loss: 34.7094659 Overall Loss:65.0602583
Validation loss decreased (1.738979 --> 1.501684).  Saving model ...
Updating learning rate to 0.00025
tensor(56.9200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8947044 KL Loss: 28.1248947 DSM Loss: 33.8604226 Overall Loss:63.8800216
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(53.7114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9077695 KL Loss: 28.2448981 DSM Loss: 33.0373714 Overall Loss:63.1900384
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.9396817684173584


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(109.2198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9762541 KL Loss: 28.4880135 DSM Loss: 48.7386029 Overall Loss:79.2028696
Validation loss decreased (inf --> 0.441742).  Saving model ...
Updating learning rate to 0.0005
tensor(71.9624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9657714 KL Loss: 28.4243733 DSM Loss: 41.3390032 Overall Loss:71.7291478
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(76.4454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9628630 KL Loss: 28.3642105 DSM Loss: 39.5103769 Overall Loss:69.8374501
Validation loss decreased (0.441742 --> 0.356847).  Saving model ...
Updating learning rate to 0.000125
tensor(74.3549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9491372 KL Loss: 28.2568444 DSM Loss: 38.6793672 Overall Loss:68.8853487
Validation loss decreased (0.356847 --> 0.338249).  Saving model ...
Updating learning rate to 6.25e-05
tensor(55.9245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9314280 KL Loss: 28.2642002 DSM Loss: 38.9813538 Overall Loss:69.1769818
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(75.5746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9404625 KL Loss: 28.3150775 DSM Loss: 39.1472614 Overall Loss:69.4028009
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.27956733107566833


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(115.8131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3415, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9955388 KL Loss: 28.2938893 DSM Loss: 47.7846704 Overall Loss:78.0740984
Validation loss decreased (inf --> 3.395713).  Saving model ...
Updating learning rate to 0.0005
tensor(51.5121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.9826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9558455 KL Loss: 28.1580384 DSM Loss: 36.9799309 Overall Loss:67.0938147
Validation loss decreased (3.395713 --> 3.282316).  Saving model ...
Updating learning rate to 0.00025
tensor(74.4390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9544935 KL Loss: 28.1558830 DSM Loss: 36.2403502 Overall Loss:66.3507265
Validation loss decreased (3.282316 --> 3.103539).  Saving model ...
Updating learning rate to 0.000125
tensor(44.8804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9061463 KL Loss: 27.9820413 DSM Loss: 35.3472850 Overall Loss:65.2354723
Validation loss decreased (3.103539 --> 3.015857).  Saving model ...
Updating learning rate to 6.25e-05
tensor(68.0690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1720, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9180614 KL Loss: 28.1160480 DSM Loss: 34.8261573 Overall Loss:64.8602663
Validation loss decreased (3.015857 --> 2.906144).  Saving model ...
Updating learning rate to 3.125e-05
tensor(72.7954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9145583 KL Loss: 28.1485481 DSM Loss: 34.5913197 Overall Loss:64.6544258
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(51.2623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9293897 KL Loss: 28.2702527 DSM Loss: 34.8561327 Overall Loss:65.0557753
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.158467769622803


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(104.0829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1288, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9210241 KL Loss: 28.2523114 DSM Loss: 43.8832254 Overall Loss:74.0565610
Validation loss decreased (inf --> 6.526996).  Saving model ...
Updating learning rate to 0.0005
tensor(72.1193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9194924 KL Loss: 28.3721984 DSM Loss: 38.0529246 Overall Loss:68.3446155
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(51.0410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 2.0379300 KL Loss: 28.7735231 DSM Loss: 37.2136201 Overall Loss:68.0250729
Validation loss decreased (6.526996 --> 5.982877).  Saving model ...
Updating learning rate to 0.000125
tensor(71.0383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.1233308 KL Loss: 28.9023025 DSM Loss: 36.4495524 Overall Loss:67.4751855
Validation loss decreased (5.982877 --> 4.537385).  Saving model ...
Updating learning rate to 6.25e-05
tensor(63.1792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.1906967 KL Loss: 29.2495179 DSM Loss: 36.3213145 Overall Loss:67.7615290
Validation loss decreased (4.537385 --> 4.232277).  Saving model ...
Updating learning rate to 3.125e-05
tensor(74.8145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1082, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.1721887 KL Loss: 29.1429734 DSM Loss: 35.9238965 Overall Loss:67.2390584
Validation loss decreased (4.232277 --> 4.230449).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(58.3827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.0289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.2815090 KL Loss: 29.4819386 DSM Loss: 35.7316477 Overall Loss:67.4950950
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(53.4059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5435, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.1893980 KL Loss: 29.2003425 DSM Loss: 35.8198485 Overall Loss:67.2095888
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.32149887084961


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(104.4176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0190442 KL Loss: 28.5205038 DSM Loss: 41.7524780 Overall Loss:72.2920258
Validation loss decreased (inf --> 19.669274).  Saving model ...
Updating learning rate to 0.0005
tensor(83.2989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.5991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9876832 KL Loss: 28.2102396 DSM Loss: 36.5835211 Overall Loss:66.7814440
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(60.3567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.8408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6486, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8905841 KL Loss: 28.1997887 DSM Loss: 35.9867896 Overall Loss:66.0771626
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:33.0333366394043


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(97.6346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9547943 KL Loss: 28.3396520 DSM Loss: 47.2797969 Overall Loss:77.5742429
Validation loss decreased (inf --> 3.452771).  Saving model ...
Updating learning rate to 0.0005
tensor(65.8940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9712621 KL Loss: 28.2469092 DSM Loss: 36.3293954 Overall Loss:66.5475669
Validation loss decreased (3.452771 --> 3.131020).  Saving model ...
Updating learning rate to 0.00025
tensor(68.6988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9199846 KL Loss: 28.0922225 DSM Loss: 34.9742766 Overall Loss:64.9864838
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(60.9896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9132040 KL Loss: 27.9727029 DSM Loss: 34.9856317 Overall Loss:64.8715388
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.48314094543457


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.5856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9931118 KL Loss: 28.3722421 DSM Loss: 41.8472378 Overall Loss:72.2125917
Validation loss decreased (inf --> 11.261453).  Saving model ...
Updating learning rate to 0.0005
tensor(47.2343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9634114 KL Loss: 28.0725328 DSM Loss: 34.1484107 Overall Loss:64.1843549
Validation loss decreased (11.261453 --> 10.666642).  Saving model ...
Updating learning rate to 0.00025
tensor(70.1650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0229, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9584027 KL Loss: 28.2495075 DSM Loss: 32.5901237 Overall Loss:62.7980338
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(48.2184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9099921 KL Loss: 28.1209750 DSM Loss: 32.6130220 Overall Loss:62.6439889
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.9639999866485596


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(110.6243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9187980 KL Loss: 28.1023032 DSM Loss: 42.9787073 Overall Loss:72.9998081
Validation loss decreased (inf --> 4.942757).  Saving model ...
Updating learning rate to 0.0005
tensor(61.1685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7486, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8865471 KL Loss: 27.4578241 DSM Loss: 36.9727386 Overall Loss:66.3171095
Validation loss decreased (4.942757 --> 4.882315).  Saving model ...
Updating learning rate to 0.00025
tensor(55.9865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8557686 KL Loss: 27.2378320 DSM Loss: 35.7513089 Overall Loss:64.8449091
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(55.5828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9387501 KL Loss: 27.6580349 DSM Loss: 35.8230350 Overall Loss:65.4198201
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.8412413597106934


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(105.9128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.1995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9347517 KL Loss: 28.5577616 DSM Loss: 44.6523475 Overall Loss:75.1448612
Validation loss decreased (inf --> 0.749507).  Saving model ...
Updating learning rate to 0.0005
tensor(60.7863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.3558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7426, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9280142 KL Loss: 28.4007106 DSM Loss: 37.8066938 Overall Loss:68.1354185
Validation loss decreased (0.749507 --> 0.681359).  Saving model ...
Updating learning rate to 0.00025
tensor(54.3242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9291418 KL Loss: 28.2069193 DSM Loss: 37.1318459 Overall Loss:67.2679070
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(45.4408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9229411 KL Loss: 28.2290410 DSM Loss: 36.8577670 Overall Loss:67.0097490
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.711076021194458


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(94.5721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9438842 KL Loss: 28.5153102 DSM Loss: 42.9891907 Overall Loss:73.4483849
Validation loss decreased (inf --> 0.210996).  Saving model ...
Updating learning rate to 0.0005
tensor(79.7610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8345087 KL Loss: 27.9166077 DSM Loss: 35.9898417 Overall Loss:65.7409582
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(65.8314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.8170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0327, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8928725 KL Loss: 28.1048290 DSM Loss: 34.8117757 Overall Loss:64.8094771
Validation loss decreased (0.210996 --> 0.205755).  Saving model ...
Updating learning rate to 0.000125
tensor(69.2726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8993176 KL Loss: 27.9655653 DSM Loss: 34.4111067 Overall Loss:64.2759897
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(69.0177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9047769 KL Loss: 28.1412424 DSM Loss: 34.2065887 Overall Loss:64.2526078
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.2768442630767822


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(93.1049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8750286 KL Loss: 28.2342710 DSM Loss: 41.2737700 Overall Loss:71.3830698
Validation loss decreased (inf --> 9.185730).  Saving model ...
Updating learning rate to 0.0005
tensor(59.5863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8986384 KL Loss: 28.1656621 DSM Loss: 34.3700845 Overall Loss:64.4343851
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(58.3693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2252, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8628972 KL Loss: 27.9387862 DSM Loss: 33.7365959 Overall Loss:63.5382788
Validation loss decreased (9.185730 --> 9.095493).  Saving model ...
Updating learning rate to 0.000125
tensor(49.1443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8553141 KL Loss: 27.4964335 DSM Loss: 33.2221411 Overall Loss:62.5738886
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(57.2895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8347964 KL Loss: 27.5531467 DSM Loss: 33.4643146 Overall Loss:62.8522575
Validation loss decreased (9.095493 --> 9.008416).  Saving model ...
Updating learning rate to 3.125e-05
tensor(69.8110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8437239 KL Loss: 27.5155405 DSM Loss: 33.4859500 Overall Loss:62.8452143
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(49.5936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.2930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8723271 KL Loss: 27.7149661 DSM Loss: 32.9085353 Overall Loss:62.4958281
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:12.983121871948242


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(118.5038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.7317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2882, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9092945 KL Loss: 28.0279605 DSM Loss: 40.3628420 Overall Loss:70.3000970
Validation loss decreased (inf --> 9.167141).  Saving model ...
Updating learning rate to 0.0005
tensor(73.2872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7736, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9173719 KL Loss: 27.6453037 DSM Loss: 35.8412077 Overall Loss:65.4038835
Validation loss decreased (9.167141 --> 7.819763).  Saving model ...
Updating learning rate to 0.00025
tensor(53.4070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.1422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.7340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9269946 KL Loss: 27.6201854 DSM Loss: 35.0938443 Overall Loss:64.6410243
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(74.6728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9978344 KL Loss: 27.8435533 DSM Loss: 34.2521117 Overall Loss:64.0934994
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.643392562866211


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.5236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8893637 KL Loss: 28.2013546 DSM Loss: 48.2190655 Overall Loss:78.3097834
Validation loss decreased (inf --> 0.604338).  Saving model ...
Updating learning rate to 0.0005
tensor(68.8482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8857767 KL Loss: 27.9917711 DSM Loss: 37.6157976 Overall Loss:67.4933451
Validation loss decreased (0.604338 --> 0.479672).  Saving model ...
Updating learning rate to 0.00025
tensor(63.0444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8474812 KL Loss: 27.6363310 DSM Loss: 36.6934023 Overall Loss:66.1772142
Validation loss decreased (0.479672 --> 0.323551).  Saving model ...
Updating learning rate to 0.000125
tensor(56.8114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8500263 KL Loss: 27.6311134 DSM Loss: 36.8108718 Overall Loss:66.2920118
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(71.6266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8206803 KL Loss: 27.4151626 DSM Loss: 36.3667308 Overall Loss:65.6025736
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.077875018119812


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(128.5815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9281930 KL Loss: 28.0832417 DSM Loss: 46.9843884 Overall Loss:76.9958235
Validation loss decreased (inf --> 0.711031).  Saving model ...
Updating learning rate to 0.0005
tensor(77.6385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9498078 KL Loss: 28.0916468 DSM Loss: 36.3080792 Overall Loss:66.3495336
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(63.0177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8854323 KL Loss: 27.8097209 DSM Loss: 35.3909860 Overall Loss:65.0861391
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9921132326126099


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(112.6641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.3076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9371876 KL Loss: 28.4810766 DSM Loss: 49.4655833 Overall Loss:79.8838476
Validation loss decreased (inf --> 1.356965).  Saving model ...
Updating learning rate to 0.0005
tensor(78.6159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.9914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8912980 KL Loss: 28.3192279 DSM Loss: 42.8205125 Overall Loss:73.0310381
Validation loss decreased (1.356965 --> 1.135690).  Saving model ...
Updating learning rate to 0.00025
tensor(79.8412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.3831, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8993850 KL Loss: 28.1365037 DSM Loss: 40.6342712 Overall Loss:70.6701594
Validation loss decreased (1.135690 --> 0.907405).  Saving model ...
Updating learning rate to 0.000125
tensor(64.0632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.6820, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8799463 KL Loss: 28.1542158 DSM Loss: 40.9709644 Overall Loss:71.0051261
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(52.0495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2725, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9022797 KL Loss: 28.1880944 DSM Loss: 40.6020768 Overall Loss:70.6924509
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.12955760955810547


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(110.1388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.9539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9243772 KL Loss: 28.1655400 DSM Loss: 45.1748237 Overall Loss:75.2647410
Validation loss decreased (inf --> 1.622075).  Saving model ...
Updating learning rate to 0.0005
tensor(62.7083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1680, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9137450 KL Loss: 27.8316147 DSM Loss: 37.2420671 Overall Loss:66.9874262
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(81.0726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9030893 KL Loss: 27.6638683 DSM Loss: 36.3810213 Overall Loss:65.9479794
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.349337577819824


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(107.2983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8823656 KL Loss: 28.4934514 DSM Loss: 51.8643015 Overall Loss:82.2401185
Validation loss decreased (inf --> 2.349956).  Saving model ...
Updating learning rate to 0.0005
tensor(73.9005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.3332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8981433 KL Loss: 28.3861975 DSM Loss: 42.8990621 Overall Loss:73.1834030
Validation loss decreased (2.349956 --> 2.237496).  Saving model ...
Updating learning rate to 0.00025
tensor(72.3621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.7386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.2922, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8933396 KL Loss: 28.0461542 DSM Loss: 40.2357430 Overall Loss:70.1752369
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(71.4182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9375480 KL Loss: 28.2260583 DSM Loss: 40.2245824 Overall Loss:70.3881887
Validation loss decreased (2.237496 --> 1.952472).  Saving model ...
Updating learning rate to 6.25e-05
tensor(82.8635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6052, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9431319 KL Loss: 28.2258775 DSM Loss: 39.8264059 Overall Loss:69.9954149
Validation loss decreased (1.952472 --> 1.866916).  Saving model ...
Updating learning rate to 3.125e-05
tensor(58.0370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.8107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9460991 KL Loss: 28.2164135 DSM Loss: 39.9940859 Overall Loss:70.1565983
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(51.1134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9523371 KL Loss: 28.1214020 DSM Loss: 39.5338208 Overall Loss:69.6075600
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:23.84869956970215
      Ticker        MSE StdDev
0   AAPL_pct   8.307774    0.0
1   ABBV_pct  17.816525    0.0
2    AEP_pct   3.165572    0.0
3   AMGN_pct   4.933074    0.0
4   AMZN_pct   0.255953    0.0
..       ...        ...    ...
66    VZ_pct   1.077875    0.0
67     V_pct   0.992113    0.0
68   WFC_pct   0.129558    0.0
69   WMT_pct   2.349338    0.0
70   XOM_pct    23.8487    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=10, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=60, root_path='data/EcmP_stock_L_2016_24_mix_F_dva', scale=0.1, sequence_length=60, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(162.2856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.2995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0252025 KL Loss: 42.5143818 DSM Loss: 61.8420819 Overall Loss:106.3816662
Validation loss decreased (inf --> 9.082875).  Saving model ...
Updating learning rate to 0.0005
tensor(125.5844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(130.4728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0270043 KL Loss: 42.0566867 DSM Loss: 54.2964609 Overall Loss:98.3801524
Validation loss decreased (9.082875 --> 8.818171).  Saving model ...
Updating learning rate to 0.00025
tensor(78.7943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.6457, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.2931580 KL Loss: 43.1576966 DSM Loss: 51.1965986 Overall Loss:96.6474534
Validation loss decreased (8.818171 --> 5.195148).  Saving model ...
Updating learning rate to 0.000125
tensor(88.4368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(121.3996, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 2.3574751 KL Loss: 43.3989879 DSM Loss: 51.0362472 Overall Loss:96.7927099
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(95.0203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.4444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 2.3302920 KL Loss: 43.1621232 DSM Loss: 50.1980553 Overall Loss:95.6904705
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:5.679227352142334


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(158.4426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(121.6326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0006472 KL Loss: 42.4997248 DSM Loss: 59.5287258 Overall Loss:104.0290979
Validation loss decreased (inf --> 8.892089).  Saving model ...
Updating learning rate to 0.0005
tensor(91.1277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.1979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9851019 KL Loss: 42.6100391 DSM Loss: 49.2810836 Overall Loss:93.8762248
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(98.7538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.6761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9550850 KL Loss: 42.3301721 DSM Loss: 47.7525447 Overall Loss:92.0378021
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:18.34621238708496


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(140.2576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9613199 KL Loss: 42.8583739 DSM Loss: 65.9043383 Overall Loss:110.7240319
Validation loss decreased (inf --> 2.184978).  Saving model ...
Updating learning rate to 0.0005
tensor(91.9122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9455226 KL Loss: 42.5572459 DSM Loss: 56.3064212 Overall Loss:100.8091896
Validation loss decreased (2.184978 --> 2.104334).  Saving model ...
Updating learning rate to 0.00025
tensor(97.1195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.4270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9291788 KL Loss: 42.4872400 DSM Loss: 54.1310509 Overall Loss:98.5474692
Validation loss decreased (2.104334 --> 1.898750).  Saving model ...
Updating learning rate to 0.000125
tensor(99.9703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.4256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9376336 KL Loss: 42.4210402 DSM Loss: 53.5560246 Overall Loss:97.9146982
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(106.2876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.0250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9103642 KL Loss: 42.1480192 DSM Loss: 52.8201718 Overall Loss:96.8785551
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:3.3339684009552


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(167.6845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.1080, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9788632 KL Loss: 42.2738668 DSM Loss: 69.3516213 Overall Loss:113.6043520
Validation loss decreased (inf --> 1.151964).  Saving model ...
Updating learning rate to 0.0005
tensor(84.9949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.1303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9565318 KL Loss: 42.0632874 DSM Loss: 54.0366468 Overall Loss:98.0564662
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(110.8099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9790662 KL Loss: 42.3670921 DSM Loss: 52.3377518 Overall Loss:96.6839100
Validation loss decreased (1.151964 --> 1.011996).  Saving model ...
Updating learning rate to 0.000125
tensor(92.5912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.6511, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9700560 KL Loss: 42.1396387 DSM Loss: 52.0299910 Overall Loss:96.1396855
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(77.2502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9377944 KL Loss: 42.1919335 DSM Loss: 51.4564303 Overall Loss:95.5861576
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:4.21305513381958


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(165.3134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.4911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9621581 KL Loss: 42.2288856 DSM Loss: 62.9383173 Overall Loss:107.1293612
Validation loss decreased (inf --> 3.431653).  Saving model ...
Updating learning rate to 0.0005
tensor(101.2017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.2399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9620743 KL Loss: 42.2119230 DSM Loss: 52.4262907 Overall Loss:96.6002884
Validation loss decreased (3.431653 --> 2.859669).  Saving model ...
Updating learning rate to 0.00025
tensor(77.0946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9365000 KL Loss: 42.1162482 DSM Loss: 51.5301364 Overall Loss:95.5828837
Validation loss decreased (2.859669 --> 2.832170).  Saving model ...
Updating learning rate to 0.000125
tensor(69.6858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.3892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9126701 KL Loss: 41.5582232 DSM Loss: 50.5259356 Overall Loss:93.9968290
Validation loss decreased (2.832170 --> 2.652008).  Saving model ...
Updating learning rate to 6.25e-05
tensor(122.1159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9333635 KL Loss: 41.9194789 DSM Loss: 49.5599081 Overall Loss:93.4127504
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(99.6813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.9435, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9301764 KL Loss: 41.4981698 DSM Loss: 50.2312802 Overall Loss:93.6596269
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.41617169976234436


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(148.6299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.2679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0742238 KL Loss: 42.7729934 DSM Loss: 59.3447852 Overall Loss:104.1920025
Validation loss decreased (inf --> 7.829198).  Saving model ...
Updating learning rate to 0.0005
tensor(98.6417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0188901 KL Loss: 42.6271099 DSM Loss: 45.3753508 Overall Loss:90.0213511
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(95.8802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9767512 KL Loss: 42.5162228 DSM Loss: 42.5607611 Overall Loss:87.0537352
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.168581485748291


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(162.8112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.7533, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9630137 KL Loss: 42.5075115 DSM Loss: 71.0112616 Overall Loss:115.4817868
Validation loss decreased (inf --> 0.229229).  Saving model ...
Updating learning rate to 0.0005
tensor(106.7253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.2579, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9415954 KL Loss: 42.5410692 DSM Loss: 55.2619059 Overall Loss:99.7445707
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(100.7181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.8291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9433520 KL Loss: 42.4952139 DSM Loss: 55.1640280 Overall Loss:99.6025937
Validation loss decreased (0.229229 --> 0.168966).  Saving model ...
Updating learning rate to 0.000125
tensor(110.4591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.3031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9269337 KL Loss: 42.3384385 DSM Loss: 53.7978344 Overall Loss:98.0632066
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(101.5392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.3102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9290148 KL Loss: 42.2748685 DSM Loss: 53.8941026 Overall Loss:98.0979863
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.42460158467292786


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(151.0531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.8109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9204618 KL Loss: 42.3569708 DSM Loss: 73.6591747 Overall Loss:117.9366073
Validation loss decreased (inf --> 1.427628).  Saving model ...
Updating learning rate to 0.0005
tensor(113.1157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.6695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9854453 KL Loss: 42.5204408 DSM Loss: 57.2090948 Overall Loss:101.7149809
Validation loss decreased (1.427628 --> 1.101646).  Saving model ...
Updating learning rate to 0.00025
tensor(98.3925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.9548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9626994 KL Loss: 42.5695340 DSM Loss: 56.7322165 Overall Loss:101.2644496
Validation loss decreased (1.101646 --> 1.096685).  Saving model ...
Updating learning rate to 0.000125
tensor(109.4515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.7955, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9681284 KL Loss: 42.6067257 DSM Loss: 55.1956597 Overall Loss:99.7705140
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(85.2080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.5709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9678712 KL Loss: 42.5520281 DSM Loss: 54.7809702 Overall Loss:99.3008693
Validation loss decreased (1.096685 --> 1.060829).  Saving model ...
Updating learning rate to 3.125e-05
tensor(92.6538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.5428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9554511 KL Loss: 42.5577425 DSM Loss: 54.5940513 Overall Loss:99.1072450
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(101.6510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.1268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9439428 KL Loss: 42.6371836 DSM Loss: 54.9489934 Overall Loss:99.5301199
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.2943260073661804


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(173.2089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.9344, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9315742 KL Loss: 42.3509066 DSM Loss: 71.0781622 Overall Loss:115.3606430
Validation loss decreased (inf --> 2.725940).  Saving model ...
Updating learning rate to 0.0005
tensor(79.5787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9363982 KL Loss: 42.0650666 DSM Loss: 48.6185724 Overall Loss:92.6200370
Validation loss decreased (2.725940 --> 1.330216).  Saving model ...
Updating learning rate to 0.00025
tensor(110.2254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.2945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9018950 KL Loss: 41.6994873 DSM Loss: 47.4299290 Overall Loss:91.0313112
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(108.2891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.2817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9075316 KL Loss: 41.8665423 DSM Loss: 46.0140257 Overall Loss:89.7881001
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.670562744140625


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(148.1378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(136.1512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0314282 KL Loss: 42.7264626 DSM Loss: 66.4055354 Overall Loss:111.1634267
Validation loss decreased (inf --> 0.158184).  Saving model ...
Updating learning rate to 0.0005
tensor(114.2450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9771021 KL Loss: 42.5992099 DSM Loss: 58.3691906 Overall Loss:102.9455029
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(105.6913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9948112 KL Loss: 42.6728945 DSM Loss: 56.4903869 Overall Loss:101.1580918
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.6885221004486084


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(119.0760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.8412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9244277 KL Loss: 42.3441498 DSM Loss: 56.6234684 Overall Loss:100.8920453
Validation loss decreased (inf --> 9.505835).  Saving model ...
Updating learning rate to 0.0005
tensor(91.6540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.6140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9427992 KL Loss: 42.8338738 DSM Loss: 44.8963894 Overall Loss:89.6730623
Validation loss decreased (9.505835 --> 8.105110).  Saving model ...
Updating learning rate to 0.00025
tensor(68.6429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.7691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9010106 KL Loss: 42.0243449 DSM Loss: 45.0460770 Overall Loss:88.9714327
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(91.8010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9220914 KL Loss: 42.2853370 DSM Loss: 44.2656670 Overall Loss:88.4730955
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:11.542729377746582


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(149.6193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.0261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9161790 KL Loss: 42.7530385 DSM Loss: 63.8787659 Overall Loss:108.5479828
Validation loss decreased (inf --> 0.503915).  Saving model ...
Updating learning rate to 0.0005
tensor(98.1720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.6261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9229797 KL Loss: 42.3998078 DSM Loss: 55.9343212 Overall Loss:100.2571089
Validation loss decreased (0.503915 --> 0.479326).  Saving model ...
Updating learning rate to 0.00025
tensor(118.1913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.6381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9165892 KL Loss: 42.2644691 DSM Loss: 54.5962287 Overall Loss:98.7772870
Validation loss decreased (0.479326 --> 0.419207).  Saving model ...
Updating learning rate to 0.000125
tensor(88.7875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.5005, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9802037 KL Loss: 42.6604098 DSM Loss: 52.9339101 Overall Loss:97.5745240
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(93.6028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(129.6239, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9657593 KL Loss: 42.4751539 DSM Loss: 52.6897405 Overall Loss:97.1306540
Validation loss decreased (0.419207 --> 0.385166).  Saving model ...
Updating learning rate to 3.125e-05
tensor(83.7706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.5565, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9291121 KL Loss: 42.3703304 DSM Loss: 52.7100097 Overall Loss:97.0094522
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(90.7590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.1871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9367204 KL Loss: 42.3389120 DSM Loss: 53.4288629 Overall Loss:97.7044949
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5882238149642944


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(153.4642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.3366, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0244230 KL Loss: 42.4884400 DSM Loss: 71.5477084 Overall Loss:116.0605715
Validation loss decreased (inf --> 0.979058).  Saving model ...
Updating learning rate to 0.0005
tensor(105.5734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.9825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9695042 KL Loss: 42.3587920 DSM Loss: 60.1287169 Overall Loss:104.4570136
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(98.1684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.0988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9764237 KL Loss: 42.3286045 DSM Loss: 58.2527335 Overall Loss:102.5577621
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.290766954421997


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(119.9642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.6801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9558957 KL Loss: 42.5013025 DSM Loss: 59.1861986 Overall Loss:103.6433964
Validation loss decreased (inf --> 4.108322).  Saving model ...
Updating learning rate to 0.0005
tensor(95.9873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.0251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.8913123 KL Loss: 41.9652134 DSM Loss: 49.6624462 Overall Loss:93.5189720
Validation loss decreased (4.108322 --> 3.988576).  Saving model ...
Updating learning rate to 0.00025
tensor(108.4424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.1770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9713735 KL Loss: 42.2657871 DSM Loss: 47.7898742 Overall Loss:92.0270349
Validation loss decreased (3.988576 --> 3.354243).  Saving model ...
Updating learning rate to 0.000125
tensor(106.2890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.9436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9792356 KL Loss: 42.2667772 DSM Loss: 47.9788325 Overall Loss:92.2248452
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(58.9742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(121.0214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9371660 KL Loss: 41.9373685 DSM Loss: 48.2186673 Overall Loss:92.0932019
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:7.191709995269775


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(158.7032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.7364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9715481 KL Loss: 42.3718905 DSM Loss: 62.3740821 Overall Loss:106.7175204
Validation loss decreased (inf --> 2.673117).  Saving model ...
Updating learning rate to 0.0005
tensor(83.3278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.8747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9370251 KL Loss: 41.8308806 DSM Loss: 51.0312298 Overall Loss:94.7991359
Validation loss decreased (2.673117 --> 2.509390).  Saving model ...
Updating learning rate to 0.00025
tensor(95.0612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.1727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9378512 KL Loss: 41.8660478 DSM Loss: 49.4024144 Overall Loss:93.2063143
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(88.2323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.6132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9400553 KL Loss: 41.8537837 DSM Loss: 47.8645913 Overall Loss:91.6584302
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.13247495889663696


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(177.4099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.9048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9646926 KL Loss: 42.4358887 DSM Loss: 67.6817050 Overall Loss:112.0822859
Validation loss decreased (inf --> 3.531795).  Saving model ...
Updating learning rate to 0.0005
tensor(114.6574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.5332, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9364686 KL Loss: 42.0651981 DSM Loss: 48.1846205 Overall Loss:92.1862879
Validation loss decreased (3.531795 --> 2.855301).  Saving model ...
Updating learning rate to 0.00025
tensor(86.4157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.8898, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9984948 KL Loss: 42.4360180 DSM Loss: 45.6042541 Overall Loss:90.0387674
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(85.6200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.6513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 2.1396262 KL Loss: 43.0015906 DSM Loss: 45.1498029 Overall Loss:90.2910200
Validation loss decreased (2.855301 --> 2.431728).  Saving model ...
Updating learning rate to 6.25e-05
tensor(69.1564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.0339, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 2.1235301 KL Loss: 42.9392206 DSM Loss: 45.4206130 Overall Loss:90.4833634
Validation loss decreased (2.431728 --> 2.293109).  Saving model ...
Updating learning rate to 3.125e-05
tensor(73.2287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.3121, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 2.0997067 KL Loss: 42.9219901 DSM Loss: 45.4849258 Overall Loss:90.5066229
Validation loss decreased (2.293109 --> 2.228459).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(80.3916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.9138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 2.1262832 KL Loss: 42.9259687 DSM Loss: 45.5732456 Overall Loss:90.6254974
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(88.1738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.3122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 2.0862445 KL Loss: 42.9644316 DSM Loss: 45.6522604 Overall Loss:90.7029364
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.3895389139652252


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(149.5639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9455357 KL Loss: 42.3819962 DSM Loss: 58.2142942 Overall Loss:102.5418260
Validation loss decreased (inf --> 12.513551).  Saving model ...
Updating learning rate to 0.0005
tensor(77.0202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.9083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9139184 KL Loss: 42.0365755 DSM Loss: 50.3607344 Overall Loss:94.3112285
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(116.2966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.6468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9124809 KL Loss: 41.9129817 DSM Loss: 49.3243401 Overall Loss:93.1498030
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:3.3576488494873047


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(155.0435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.5065, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9213874 KL Loss: 42.0765684 DSM Loss: 60.7101898 Overall Loss:104.7081452
Validation loss decreased (inf --> 3.725333).  Saving model ...
Updating learning rate to 0.0005
tensor(96.0882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.1726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9720365 KL Loss: 42.2328363 DSM Loss: 48.8218760 Overall Loss:93.0267483
Validation loss decreased (3.725333 --> 3.352545).  Saving model ...
Updating learning rate to 0.00025
tensor(92.9253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.0788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9133549 KL Loss: 42.0353834 DSM Loss: 48.3348769 Overall Loss:92.2836155
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(92.8214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.3362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9383058 KL Loss: 42.2743628 DSM Loss: 47.8069586 Overall Loss:92.0196270
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.6000150442123413


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(150.8030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.7004, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9340719 KL Loss: 42.3232109 DSM Loss: 56.0635224 Overall Loss:100.3208050
Validation loss decreased (inf --> 6.566710).  Saving model ...
Updating learning rate to 0.0005
tensor(105.2883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.7147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0212991 KL Loss: 42.5629188 DSM Loss: 51.2286024 Overall Loss:95.8128203
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(88.7603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.7819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9457502 KL Loss: 42.3671359 DSM Loss: 49.2347940 Overall Loss:93.5476800
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:33.744529724121094


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(146.4448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(117.3988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9067174 KL Loss: 42.6232709 DSM Loss: 66.2563219 Overall Loss:110.7863100
Validation loss decreased (inf --> 0.726254).  Saving model ...
Updating learning rate to 0.0005
tensor(115.1508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.1143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9030468 KL Loss: 42.4844758 DSM Loss: 49.8763398 Overall Loss:94.2638618
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(107.1210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.5964, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8865799 KL Loss: 42.1533319 DSM Loss: 48.6128311 Overall Loss:92.6527430
Validation loss decreased (0.726254 --> 0.655917).  Saving model ...
Updating learning rate to 0.000125
tensor(81.9790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.6315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9087226 KL Loss: 42.5290926 DSM Loss: 48.5648870 Overall Loss:93.0027018
Validation loss decreased (0.655917 --> 0.539693).  Saving model ...
Updating learning rate to 6.25e-05
tensor(72.5101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.0340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.8961990 KL Loss: 42.1555907 DSM Loss: 47.9786072 Overall Loss:92.0303974
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(85.4416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.0174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.8855156 KL Loss: 42.2255575 DSM Loss: 47.6515856 Overall Loss:91.7626583
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7801973819732666


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(159.1875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.9972, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9320508 KL Loss: 42.5179549 DSM Loss: 72.0926534 Overall Loss:116.5426588
Validation loss decreased (inf --> 10.068570).  Saving model ...
Updating learning rate to 0.0005
tensor(95.1989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.8783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9423169 KL Loss: 41.7881534 DSM Loss: 53.6791096 Overall Loss:97.4095808
Validation loss decreased (10.068570 --> 8.385369).  Saving model ...
Updating learning rate to 0.00025
tensor(104.1180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9277842 KL Loss: 41.7921797 DSM Loss: 51.4823457 Overall Loss:95.2023092
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(85.4663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9675503 KL Loss: 41.7223549 DSM Loss: 49.8753191 Overall Loss:93.5652240
Validation loss decreased (8.385369 --> 8.219787).  Saving model ...
Updating learning rate to 6.25e-05
tensor(99.4541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0121, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9687539 KL Loss: 41.7159294 DSM Loss: 50.3226256 Overall Loss:94.0073092
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(110.2964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.0470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9902178 KL Loss: 41.9162829 DSM Loss: 50.1789358 Overall Loss:94.0854363
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:4.418298244476318


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(204.7845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.7478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9460521 KL Loss: 42.1683269 DSM Loss: 70.9088860 Overall Loss:115.0232642
Validation loss decreased (inf --> 2.479567).  Saving model ...
Updating learning rate to 0.0005
tensor(77.2547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.4442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0300207 KL Loss: 42.7569038 DSM Loss: 54.5579047 Overall Loss:99.3448294
Validation loss decreased (2.479567 --> 1.721741).  Saving model ...
Updating learning rate to 0.00025
tensor(94.1071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.0792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0740660 KL Loss: 42.7442535 DSM Loss: 53.4149729 Overall Loss:98.2332922
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(149.7725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.8333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9925044 KL Loss: 42.2137063 DSM Loss: 54.0006110 Overall Loss:98.2068213
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.0462321043014526


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(146.9973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.2323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9152684 KL Loss: 42.6113707 DSM Loss: 64.8197951 Overall Loss:109.3464342
Validation loss decreased (inf --> 6.551214).  Saving model ...
Updating learning rate to 0.0005
tensor(89.7895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9052528 KL Loss: 42.3119175 DSM Loss: 48.5185034 Overall Loss:92.7356740
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(110.0995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9037356 KL Loss: 42.0686970 DSM Loss: 48.0130475 Overall Loss:91.9854804
Validation loss decreased (6.551214 --> 5.627343).  Saving model ...
Updating learning rate to 0.000125
tensor(91.6593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.6529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9135156 KL Loss: 42.1195715 DSM Loss: 47.1218007 Overall Loss:91.1548874
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(73.2711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.6445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.8933113 KL Loss: 41.7453871 DSM Loss: 46.6900172 Overall Loss:90.3287157
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:5.366569995880127


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(151.3690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.8048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9538009 KL Loss: 42.5111285 DSM Loss: 63.1092685 Overall Loss:107.5741976
Validation loss decreased (inf --> 2.281778).  Saving model ...
Updating learning rate to 0.0005
tensor(97.7744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9541333 KL Loss: 42.6204899 DSM Loss: 53.6588297 Overall Loss:98.2334535
Validation loss decreased (2.281778 --> 2.273054).  Saving model ...
Updating learning rate to 0.00025
tensor(99.8637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.2275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9693953 KL Loss: 42.6767254 DSM Loss: 52.3987156 Overall Loss:97.0448361
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(113.7974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.7392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9509653 KL Loss: 42.2542434 DSM Loss: 51.5958651 Overall Loss:95.8010738
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.928607225418091


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(153.4015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.1791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9463284 KL Loss: 42.4848647 DSM Loss: 60.8792265 Overall Loss:105.3104197
Validation loss decreased (inf --> 9.495888).  Saving model ...
Updating learning rate to 0.0005
tensor(84.9789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9430832 KL Loss: 42.3452196 DSM Loss: 50.5318560 Overall Loss:94.8201589
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(92.9645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.2637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9532652 KL Loss: 42.3659720 DSM Loss: 49.2402369 Overall Loss:93.5594737
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:14.506194114685059


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(141.3638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.5104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9533214 KL Loss: 42.3862521 DSM Loss: 65.7940532 Overall Loss:110.1336268
Validation loss decreased (inf --> 4.415058).  Saving model ...
Updating learning rate to 0.0005
tensor(96.1095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.2745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9579687 KL Loss: 42.4240253 DSM Loss: 48.3468755 Overall Loss:92.7288692
Validation loss decreased (4.415058 --> 3.992451).  Saving model ...
Updating learning rate to 0.00025
tensor(84.6326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.2786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9393037 KL Loss: 42.3279507 DSM Loss: 46.2284350 Overall Loss:90.4956897
Validation loss decreased (3.992451 --> 3.892873).  Saving model ...
Updating learning rate to 0.000125
tensor(81.6567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.6630, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9269235 KL Loss: 42.2891061 DSM Loss: 46.3894098 Overall Loss:90.6054398
Validation loss decreased (3.892873 --> 3.692735).  Saving model ...
Updating learning rate to 6.25e-05
tensor(101.5618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.7949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9330385 KL Loss: 42.2825917 DSM Loss: 46.0400070 Overall Loss:90.2556376
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(99.0772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.6816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9121654 KL Loss: 42.1954489 DSM Loss: 46.4961078 Overall Loss:90.6037219
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:8.753626823425293


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(156.4558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.3583, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0082582 KL Loss: 42.5463967 DSM Loss: 64.8006228 Overall Loss:109.3552779
Validation loss decreased (inf --> 0.185921).  Saving model ...
Updating learning rate to 0.0005
tensor(103.9824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.8775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9845641 KL Loss: 42.0819221 DSM Loss: 56.4130721 Overall Loss:100.4795585
Validation loss decreased (0.185921 --> 0.125671).  Saving model ...
Updating learning rate to 0.00025
tensor(85.2231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.4377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9122275 KL Loss: 41.8004184 DSM Loss: 55.5904884 Overall Loss:99.3031346
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(103.0280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.7183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9065118 KL Loss: 41.6095345 DSM Loss: 55.4224425 Overall Loss:98.9384888
Validation loss decreased (0.125671 --> 0.095085).  Saving model ...
Updating learning rate to 6.25e-05
tensor(105.0436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.9425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9049733 KL Loss: 41.7788288 DSM Loss: 55.1501542 Overall Loss:98.8339561
Validation loss decreased (0.095085 --> 0.084757).  Saving model ...
Updating learning rate to 3.125e-05
tensor(93.6612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.4005, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9064093 KL Loss: 41.3679161 DSM Loss: 54.8243713 Overall Loss:98.0986969
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(90.6526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9261823 KL Loss: 41.9139371 DSM Loss: 54.5088009 Overall Loss:98.3489205
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.2624981999397278


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(156.8772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.9002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9869533 KL Loss: 42.3236407 DSM Loss: 63.6807426 Overall Loss:107.9913366
Validation loss decreased (inf --> 13.680787).  Saving model ...
Updating learning rate to 0.0005
tensor(61.4435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9798, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9499161 KL Loss: 41.7230742 DSM Loss: 49.2263246 Overall Loss:92.8993150
Validation loss decreased (13.680787 --> 12.336287).  Saving model ...
Updating learning rate to 0.00025
tensor(85.2065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8740476 KL Loss: 41.6204445 DSM Loss: 47.8468703 Overall Loss:91.3413623
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(71.4822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.3066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9052064 KL Loss: 41.8108365 DSM Loss: 46.4794347 Overall Loss:90.1954775
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:5.4030351638793945


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(131.6638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9512927 KL Loss: 42.3848825 DSM Loss: 57.7973116 Overall Loss:102.1334868
Validation loss decreased (inf --> 8.542284).  Saving model ...
Updating learning rate to 0.0005
tensor(81.7732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.8925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9429040 KL Loss: 41.9879569 DSM Loss: 51.4058552 Overall Loss:95.3367166
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(110.7546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.4057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9658472 KL Loss: 42.2238240 DSM Loss: 50.0390903 Overall Loss:94.2287621
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:4.209341049194336


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(148.0860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.9784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8960970 KL Loss: 41.9634836 DSM Loss: 59.5725288 Overall Loss:103.4321096
Validation loss decreased (inf --> 3.298760).  Saving model ...
Updating learning rate to 0.0005
tensor(65.3148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.2494, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9564231 KL Loss: 42.1474985 DSM Loss: 49.0487633 Overall Loss:93.1526855
Validation loss decreased (3.298760 --> 2.823618).  Saving model ...
Updating learning rate to 0.00025
tensor(101.9658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.6997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9502740 KL Loss: 42.4529739 DSM Loss: 48.4849192 Overall Loss:92.8881666
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(93.0228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.6526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9133602 KL Loss: 41.9202183 DSM Loss: 48.0093437 Overall Loss:91.8429223
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.1708803176879883


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(154.7566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.2001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9836128 KL Loss: 42.4051104 DSM Loss: 66.6731878 Overall Loss:111.0619109
Validation loss decreased (inf --> 0.442443).  Saving model ...
Updating learning rate to 0.0005
tensor(86.8187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.4292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9830250 KL Loss: 42.4370802 DSM Loss: 56.3512489 Overall Loss:100.7713541
Validation loss decreased (0.442443 --> 0.315133).  Saving model ...
Updating learning rate to 0.00025
tensor(108.6534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.5061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9836537 KL Loss: 42.6493012 DSM Loss: 56.6828497 Overall Loss:101.3158048
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(91.0433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.4088, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9681913 KL Loss: 42.2919896 DSM Loss: 55.9980351 Overall Loss:100.2582163
Validation loss decreased (0.315133 --> 0.289077).  Saving model ...
Updating learning rate to 6.25e-05
tensor(93.6937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.6977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9588283 KL Loss: 42.3800507 DSM Loss: 55.7260218 Overall Loss:100.0649008
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(79.3553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.2345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9480924 KL Loss: 42.0925656 DSM Loss: 55.3662064 Overall Loss:99.4068642
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.1820201873779297


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(152.0534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.2530, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9657524 KL Loss: 42.5859828 DSM Loss: 69.1836524 Overall Loss:113.7353877
Validation loss decreased (inf --> 1.613153).  Saving model ...
Updating learning rate to 0.0005
tensor(82.8744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(121.5095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0389706 KL Loss: 42.6684874 DSM Loss: 55.9726429 Overall Loss:100.6801005
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(86.8473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.7830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9440395 KL Loss: 41.9362870 DSM Loss: 53.7457632 Overall Loss:97.6260893
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:3.0781052112579346


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(159.3514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.4812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0134220 KL Loss: 42.5057757 DSM Loss: 65.9693093 Overall Loss:110.4885075
Validation loss decreased (inf --> 0.397052).  Saving model ...
Updating learning rate to 0.0005
tensor(93.7775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.1434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0217678 KL Loss: 42.5822541 DSM Loss: 52.0214758 Overall Loss:96.6254976
Validation loss decreased (0.397052 --> 0.203037).  Saving model ...
Updating learning rate to 0.00025
tensor(95.1064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.2491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9607839 KL Loss: 42.1422609 DSM Loss: 51.8253243 Overall Loss:95.9283689
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(100.9362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.9003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9246469 KL Loss: 42.1654156 DSM Loss: 50.7140399 Overall Loss:94.8041024
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.7665821313858032


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(128.4039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8553392 KL Loss: 42.0158017 DSM Loss: 56.2174113 Overall Loss:100.0885530
Validation loss decreased (inf --> 4.682102).  Saving model ...
Updating learning rate to 0.0005
tensor(69.0421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1777, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.8388154 KL Loss: 41.4537634 DSM Loss: 46.0227953 Overall Loss:89.3153742
Validation loss decreased (4.682102 --> 3.864183).  Saving model ...
Updating learning rate to 0.00025
tensor(84.4013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.3230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8626970 KL Loss: 41.5064330 DSM Loss: 44.1589659 Overall Loss:87.5280959
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(89.1664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.8805054 KL Loss: 41.5956986 DSM Loss: 44.2875980 Overall Loss:87.7638021
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:4.5872697830200195


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(163.5058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.9733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9051328 KL Loss: 42.5016867 DSM Loss: 57.6979047 Overall Loss:102.1047240
Validation loss decreased (inf --> 4.763195).  Saving model ...
Updating learning rate to 0.0005
tensor(98.4705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.6034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9108107 KL Loss: 42.4141621 DSM Loss: 47.5300973 Overall Loss:91.8550706
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(115.1315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.8560, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9241236 KL Loss: 42.4426066 DSM Loss: 46.1839009 Overall Loss:90.5506305
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.54805588722229


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(159.3119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.8910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9175229 KL Loss: 42.3721023 DSM Loss: 67.3236013 Overall Loss:111.6132260
Validation loss decreased (inf --> 7.192956).  Saving model ...
Updating learning rate to 0.0005
tensor(80.4520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.7956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9341992 KL Loss: 42.5704372 DSM Loss: 55.3048654 Overall Loss:99.8095016
Validation loss decreased (7.192956 --> 6.982125).  Saving model ...
Updating learning rate to 0.00025
tensor(92.4054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.9850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9036395 KL Loss: 41.9189681 DSM Loss: 54.4040373 Overall Loss:98.2266452
Validation loss decreased (6.982125 --> 6.854488).  Saving model ...
Updating learning rate to 0.000125
tensor(103.4267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9063824 KL Loss: 41.9881436 DSM Loss: 52.6070957 Overall Loss:96.5016219
Validation loss decreased (6.854488 --> 6.228945).  Saving model ...
Updating learning rate to 6.25e-05
tensor(98.7659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.3167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9064866 KL Loss: 42.3552331 DSM Loss: 52.7264936 Overall Loss:96.9882136
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(94.6020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.1238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9235506 KL Loss: 42.3049522 DSM Loss: 51.8265648 Overall Loss:96.0550683
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:10.761255264282227


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(150.0263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.1378, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9430227 KL Loss: 42.3864634 DSM Loss: 58.1540259 Overall Loss:102.4835121
Validation loss decreased (inf --> 1.586270).  Saving model ...
Updating learning rate to 0.0005
tensor(87.1974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0040938 KL Loss: 42.5372395 DSM Loss: 50.6219742 Overall Loss:95.1633078
Validation loss decreased (1.586270 --> 1.521712).  Saving model ...
Updating learning rate to 0.00025
tensor(107.6637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.5702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9770987 KL Loss: 42.3203560 DSM Loss: 48.7858127 Overall Loss:93.0832680
Validation loss decreased (1.521712 --> 1.267281).  Saving model ...
Updating learning rate to 0.000125
tensor(62.5457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.0482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9486435 KL Loss: 42.4526240 DSM Loss: 47.5386335 Overall Loss:91.9399011
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(109.6314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.0803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9312522 KL Loss: 42.3876793 DSM Loss: 47.2765220 Overall Loss:91.5954536
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:6.53164529800415


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(150.2864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(126.8792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8537841 KL Loss: 41.9118815 DSM Loss: 111.7120380 Overall Loss:155.4777032
Validation loss decreased (inf --> 0.592915).  Saving model ...
Updating learning rate to 0.0005
tensor(146.7601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.2003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9107469 KL Loss: 41.4919129 DSM Loss: 73.1949629 Overall Loss:116.5976220
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(105.1777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.2988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9543647 KL Loss: 42.4670236 DSM Loss: 53.4036398 Overall Loss:97.8250279
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8897457122802734


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(141.2039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(137.1783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9280314 KL Loss: 42.5309512 DSM Loss: 70.7554768 Overall Loss:115.2144586
Validation loss decreased (inf --> 4.714707).  Saving model ...
Updating learning rate to 0.0005
tensor(105.4705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.5688, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9797274 KL Loss: 42.7559380 DSM Loss: 52.6794918 Overall Loss:97.4151576
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(114.3568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.3787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9474517 KL Loss: 42.4839748 DSM Loss: 52.5645980 Overall Loss:96.9960247
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:8.370777130126953


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(147.8375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.4623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9394346 KL Loss: 42.5173350 DSM Loss: 58.6558402 Overall Loss:103.1126101
Validation loss decreased (inf --> 2.960165).  Saving model ...
Updating learning rate to 0.0005
tensor(80.4522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9124000 KL Loss: 42.1180424 DSM Loss: 51.4891627 Overall Loss:95.5196052
Validation loss decreased (2.960165 --> 2.219766).  Saving model ...
Updating learning rate to 0.00025
tensor(87.4828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.7257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9003376 KL Loss: 42.0021476 DSM Loss: 50.4502516 Overall Loss:94.3527369
Validation loss decreased (2.219766 --> 1.917779).  Saving model ...
Updating learning rate to 0.000125
tensor(88.5722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3179, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.8792610 KL Loss: 41.7197263 DSM Loss: 50.3411149 Overall Loss:93.9401019
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(96.7311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.5382, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9009748 KL Loss: 41.8811936 DSM Loss: 49.9589428 Overall Loss:93.7411116
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.1122625470161438


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(146.2894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.9574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9235161 KL Loss: 42.4724364 DSM Loss: 61.1273579 Overall Loss:105.5233109
Validation loss decreased (inf --> 0.408277).  Saving model ...
Updating learning rate to 0.0005
tensor(89.4438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.8909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9419056 KL Loss: 42.3260106 DSM Loss: 50.7646125 Overall Loss:95.0325283
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(90.2906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.1936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8994823 KL Loss: 41.9784210 DSM Loss: 48.4309966 Overall Loss:92.3088994
Validation loss decreased (0.408277 --> 0.365378).  Saving model ...
Updating learning rate to 0.000125
tensor(82.9600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9107082 KL Loss: 42.1274892 DSM Loss: 47.3283521 Overall Loss:91.3665499
Validation loss decreased (0.365378 --> 0.362870).  Saving model ...
Updating learning rate to 6.25e-05
tensor(76.8617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.5076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9265383 KL Loss: 42.1933160 DSM Loss: 48.6445434 Overall Loss:92.7643982
Validation loss decreased (0.362870 --> 0.353772).  Saving model ...
Updating learning rate to 3.125e-05
tensor(85.7537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.7802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.8928289 KL Loss: 42.1765756 DSM Loss: 48.2720419 Overall Loss:92.3414465
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(80.0405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9234009 KL Loss: 42.1697860 DSM Loss: 47.5322241 Overall Loss:91.6254115
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:5.104588031768799


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(177.4176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.5855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9746053 KL Loss: 42.9298938 DSM Loss: 73.4440612 Overall Loss:118.3485595
Validation loss decreased (inf --> 0.599016).  Saving model ...
Updating learning rate to 0.0005
tensor(115.1824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.1162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9700512 KL Loss: 42.7474050 DSM Loss: 65.1731422 Overall Loss:109.8905980
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(125.5779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(131.5380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9987877 KL Loss: 43.0451677 DSM Loss: 61.7562017 Overall Loss:106.8001575
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5855817198753357


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(158.3490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.3807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8978818 KL Loss: 41.9005813 DSM Loss: 60.3120726 Overall Loss:104.1105359
Validation loss decreased (inf --> 1.903702).  Saving model ...
Updating learning rate to 0.0005
tensor(113.3966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.3869, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9133889 KL Loss: 41.9664370 DSM Loss: 54.5374148 Overall Loss:98.4172403
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(90.8422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.4909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8803537 KL Loss: 41.5106435 DSM Loss: 50.3570989 Overall Loss:93.7480962
Validation loss decreased (1.903702 --> 1.531820).  Saving model ...
Updating learning rate to 0.000125
tensor(93.0226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.7024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.8918518 KL Loss: 41.3503183 DSM Loss: 49.9499573 Overall Loss:93.1921275
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(101.3464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.8465146 KL Loss: 40.9745299 DSM Loss: 49.6280118 Overall Loss:92.4490558
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:14.01766300201416


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(167.5130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9358493 KL Loss: 42.1420306 DSM Loss: 59.4414281 Overall Loss:103.5193079
Validation loss decreased (inf --> 7.248252).  Saving model ...
Updating learning rate to 0.0005
tensor(110.3088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9306976 KL Loss: 41.7723383 DSM Loss: 52.5291490 Overall Loss:96.2321855
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(111.2163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(117.0235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9033811 KL Loss: 41.6576540 DSM Loss: 51.3184301 Overall Loss:94.8794651
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:5.74660587310791


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(182.1002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.2429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9762883 KL Loss: 42.3909916 DSM Loss: 68.0184448 Overall Loss:112.3857249
Validation loss decreased (inf --> 4.399770).  Saving model ...
Updating learning rate to 0.0005
tensor(95.9178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.3257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9760504 KL Loss: 42.5105312 DSM Loss: 55.4691719 Overall Loss:99.9557536
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(106.9780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.7554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9696008 KL Loss: 42.3243047 DSM Loss: 53.7678605 Overall Loss:98.0617654
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:3.260915756225586


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(170.2397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.9940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9738698 KL Loss: 42.6951630 DSM Loss: 62.8429981 Overall Loss:107.5120311
Validation loss decreased (inf --> 11.237681).  Saving model ...
Updating learning rate to 0.0005
tensor(98.3903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.7020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9514914 KL Loss: 42.5707243 DSM Loss: 54.9089903 Overall Loss:99.4312057
Validation loss decreased (11.237681 --> 10.632690).  Saving model ...
Updating learning rate to 0.00025
tensor(105.4596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.1007, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9665753 KL Loss: 42.5624827 DSM Loss: 53.0361085 Overall Loss:97.5651673
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(89.9105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.7068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9477058 KL Loss: 42.3176193 DSM Loss: 52.9043540 Overall Loss:97.1696786
Validation loss decreased (10.632690 --> 10.090782).  Saving model ...
Updating learning rate to 6.25e-05
tensor(111.6858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.4778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9476726 KL Loss: 42.4285165 DSM Loss: 52.4731654 Overall Loss:96.8493542
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(88.1092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.5569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9473108 KL Loss: 42.4122383 DSM Loss: 52.8985420 Overall Loss:97.2580916
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:8.61497688293457


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(166.0984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.9938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0031223 KL Loss: 42.6125345 DSM Loss: 62.8467662 Overall Loss:107.4624229
Validation loss decreased (inf --> 1.669614).  Saving model ...
Updating learning rate to 0.0005
tensor(100.0409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.5905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9857109 KL Loss: 42.3883562 DSM Loss: 53.2556703 Overall Loss:97.6297375
Validation loss decreased (1.669614 --> 1.564361).  Saving model ...
Updating learning rate to 0.00025
tensor(99.3973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.8216, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9765661 KL Loss: 42.3651157 DSM Loss: 52.7664549 Overall Loss:97.1081368
Validation loss decreased (1.564361 --> 1.259991).  Saving model ...
Updating learning rate to 0.000125
tensor(103.1589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.6803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9685332 KL Loss: 42.5706494 DSM Loss: 51.6775655 Overall Loss:96.2167482
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(93.1665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.9931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9487759 KL Loss: 42.5076394 DSM Loss: 51.4993157 Overall Loss:95.9557305
Validation loss decreased (1.259991 --> 1.158848).  Saving model ...
Updating learning rate to 3.125e-05
tensor(94.5999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9536090 KL Loss: 42.5863777 DSM Loss: 51.2313646 Overall Loss:95.7713517
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(94.0287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.7801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9171232 KL Loss: 42.2558263 DSM Loss: 51.3005228 Overall Loss:95.4734720
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:5.054233074188232


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(158.9188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9317822 KL Loss: 42.0411987 DSM Loss: 60.6538374 Overall Loss:104.6268178
Validation loss decreased (inf --> 11.671743).  Saving model ...
Updating learning rate to 0.0005
tensor(136.6553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9347, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9521862 KL Loss: 41.8825232 DSM Loss: 45.2846383 Overall Loss:89.1193475
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(95.9450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.4500, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9438734 KL Loss: 41.8307329 DSM Loss: 43.9946566 Overall Loss:87.7692625
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:18.194425582885742


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(163.3697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.2621, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8992520 KL Loss: 42.4746370 DSM Loss: 80.8340684 Overall Loss:125.2079574
Validation loss decreased (inf --> 0.488148).  Saving model ...
Updating learning rate to 0.0005
tensor(88.6271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.7607, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.8374381 KL Loss: 41.6072906 DSM Loss: 59.4490231 Overall Loss:102.8937517
Validation loss decreased (0.488148 --> 0.340344).  Saving model ...
Updating learning rate to 0.00025
tensor(110.0671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.4100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9075647 KL Loss: 42.0484169 DSM Loss: 58.0283419 Overall Loss:101.9843233
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(112.0279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.2448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.8775321 KL Loss: 41.5708035 DSM Loss: 57.5297156 Overall Loss:100.9780514
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.19759728014469147


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(174.5331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0398442 KL Loss: 42.6238760 DSM Loss: 59.3093246 Overall Loss:103.9730441
Validation loss decreased (inf --> 8.695102).  Saving model ...
Updating learning rate to 0.0005
tensor(104.4821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9418, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9555441 KL Loss: 42.0150414 DSM Loss: 50.9994266 Overall Loss:94.9700118
Validation loss decreased (8.695102 --> 8.128471).  Saving model ...
Updating learning rate to 0.00025
tensor(102.4838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.5832, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9356141 KL Loss: 42.0238974 DSM Loss: 49.5741421 Overall Loss:93.5336535
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(106.4023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9395970 KL Loss: 41.9982067 DSM Loss: 49.3698632 Overall Loss:93.3076669
Validation loss decreased (8.128471 --> 7.949139).  Saving model ...
Updating learning rate to 6.25e-05
tensor(92.0527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9477039 KL Loss: 42.2639462 DSM Loss: 48.8277919 Overall Loss:93.0394419
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(99.2991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0065, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9048038 KL Loss: 41.7424611 DSM Loss: 48.6597466 Overall Loss:92.3070111
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:14.445180892944336


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(141.4186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.9499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9640339 KL Loss: 42.4081792 DSM Loss: 56.9214745 Overall Loss:101.2936874
Validation loss decreased (inf --> 17.842729).  Saving model ...
Updating learning rate to 0.0005
tensor(87.5856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.7007, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9479062 KL Loss: 42.2757887 DSM Loss: 47.4334979 Overall Loss:91.6571930
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(82.8430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.9835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9486964 KL Loss: 42.5135980 DSM Loss: 46.3637586 Overall Loss:90.8260526
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:8.311934471130371


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(131.7521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.0392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8922648 KL Loss: 42.4254564 DSM Loss: 63.6327830 Overall Loss:107.9505035
Validation loss decreased (inf --> 4.711425).  Saving model ...
Updating learning rate to 0.0005
tensor(101.6827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(124.2036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9268392 KL Loss: 42.3119928 DSM Loss: 55.1781470 Overall Loss:99.4169791
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(81.2482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.9387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8830045 KL Loss: 41.9057291 DSM Loss: 55.3712206 Overall Loss:99.1599544
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:4.442375183105469


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(165.4078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.2171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0075258 KL Loss: 42.6036769 DSM Loss: 74.6009345 Overall Loss:119.2121368
Validation loss decreased (inf --> 5.097625).  Saving model ...
Updating learning rate to 0.0005
tensor(96.2786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.0268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0129882 KL Loss: 42.6703410 DSM Loss: 56.5435713 Overall Loss:101.2269009
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(81.8632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9553133 KL Loss: 42.3145327 DSM Loss: 54.4296677 Overall Loss:98.6995139
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:7.5945329666137695


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(165.8177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.6238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9599043 KL Loss: 42.6904972 DSM Loss: 82.1904595 Overall Loss:126.8408607
Validation loss decreased (inf --> 0.837526).  Saving model ...
Updating learning rate to 0.0005
tensor(111.0085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.7776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9486736 KL Loss: 42.6762434 DSM Loss: 65.5746049 Overall Loss:110.1995219
Validation loss decreased (0.837526 --> 0.777620).  Saving model ...
Updating learning rate to 0.00025
tensor(84.7715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.5209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9684549 KL Loss: 42.8093218 DSM Loss: 62.2151747 Overall Loss:106.9929513
Validation loss decreased (0.777620 --> 0.775359).  Saving model ...
Updating learning rate to 0.000125
tensor(128.2481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.0264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9668932 KL Loss: 42.7316333 DSM Loss: 61.1896487 Overall Loss:105.8881746
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(122.3028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.6512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9597243 KL Loss: 42.8031824 DSM Loss: 61.0056380 Overall Loss:105.7685441
Validation loss decreased (0.775359 --> 0.739994).  Saving model ...
Updating learning rate to 3.125e-05
tensor(134.4859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(148.0460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9737733 KL Loss: 42.9654488 DSM Loss: 60.2021119 Overall Loss:105.1413336
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(88.4782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.4819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9688175 KL Loss: 42.7206953 DSM Loss: 59.8680548 Overall Loss:104.5575679
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8888813257217407


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(151.9533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.1399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9439247 KL Loss: 42.3274149 DSM Loss: 59.9858560 Overall Loss:104.2571951
Validation loss decreased (inf --> 1.503779).  Saving model ...
Updating learning rate to 0.0005
tensor(95.7387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.1114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9290658 KL Loss: 42.3224525 DSM Loss: 48.1342683 Overall Loss:92.3857863
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(106.7846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.6541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8918679 KL Loss: 42.0371393 DSM Loss: 47.1635935 Overall Loss:91.0926008
Validation loss decreased (1.503779 --> 1.318912).  Saving model ...
Updating learning rate to 0.000125
tensor(100.5031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.0141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9083881 KL Loss: 42.1282571 DSM Loss: 46.2675350 Overall Loss:90.3041799
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(96.6978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9068581 KL Loss: 42.1728545 DSM Loss: 45.6880587 Overall Loss:89.7677712
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.6104917526245117


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(153.4750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(124.1616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9863069 KL Loss: 42.4420554 DSM Loss: 88.0620012 Overall Loss:132.4903640
Validation loss decreased (inf --> 0.361642).  Saving model ...
Updating learning rate to 0.0005
tensor(123.8025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.3544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0216397 KL Loss: 42.5854388 DSM Loss: 60.4111540 Overall Loss:105.0182323
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(96.4331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.1743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9979539 KL Loss: 42.4635777 DSM Loss: 59.5689697 Overall Loss:104.0305014
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.3670800030231476


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(181.7081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.4862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9825009 KL Loss: 42.2784230 DSM Loss: 64.7276234 Overall Loss:108.9885474
Validation loss decreased (inf --> 3.421010).  Saving model ...
Updating learning rate to 0.0005
tensor(86.5714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9655485 KL Loss: 42.2581215 DSM Loss: 52.4316067 Overall Loss:96.6552765
Validation loss decreased (3.421010 --> 3.202115).  Saving model ...
Updating learning rate to 0.00025
tensor(93.6099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.5321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9544112 KL Loss: 42.4731097 DSM Loss: 51.5352069 Overall Loss:95.9627283
Validation loss decreased (3.202115 --> 3.079439).  Saving model ...
Updating learning rate to 0.000125
tensor(107.1837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.5829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9676676 KL Loss: 42.4618728 DSM Loss: 50.8223987 Overall Loss:95.2519387
Validation loss decreased (3.079439 --> 2.785476).  Saving model ...
Updating learning rate to 6.25e-05
tensor(97.7860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.0676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9869604 KL Loss: 42.6919719 DSM Loss: 49.8080868 Overall Loss:94.4870192
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(111.5375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.1591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 2.0075491 KL Loss: 42.9109931 DSM Loss: 49.9203803 Overall Loss:94.8389226
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:4.210203647613525


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(161.4554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.1855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0732986 KL Loss: 42.7335541 DSM Loss: 66.7741095 Overall Loss:111.5809612
Validation loss decreased (inf --> 5.451841).  Saving model ...
Updating learning rate to 0.0005
tensor(111.4108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.7871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9665887 KL Loss: 42.3376370 DSM Loss: 55.4042737 Overall Loss:99.7084994
Validation loss decreased (5.451841 --> 5.253495).  Saving model ...
Updating learning rate to 0.00025
tensor(107.8018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.6064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9459833 KL Loss: 42.4738945 DSM Loss: 54.2874639 Overall Loss:98.7073419
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(118.3881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.7944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9061445 KL Loss: 42.0522860 DSM Loss: 53.2058228 Overall Loss:97.1642528
Validation loss decreased (5.253495 --> 5.101821).  Saving model ...
Updating learning rate to 6.25e-05
tensor(68.7581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.4661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9298519 KL Loss: 42.1286458 DSM Loss: 53.7947333 Overall Loss:97.8532313
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(95.7201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.5694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9337670 KL Loss: 41.9526210 DSM Loss: 53.4995348 Overall Loss:97.3859228
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:9.908271789550781


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(170.1271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.1387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0654230 KL Loss: 42.6414205 DSM Loss: 69.0961840 Overall Loss:113.8030276
Validation loss decreased (inf --> 19.092449).  Saving model ...
Updating learning rate to 0.0005
tensor(114.6797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4027, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0042604 KL Loss: 42.2609627 DSM Loss: 52.3511985 Overall Loss:96.6164216
Validation loss decreased (19.092449 --> 18.757485).  Saving model ...
Updating learning rate to 0.00025
tensor(105.2524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2082, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9420628 KL Loss: 42.2653780 DSM Loss: 52.1150155 Overall Loss:96.3224563
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(54.5519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.0059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9903602 KL Loss: 42.6936272 DSM Loss: 50.5742277 Overall Loss:95.2582151
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:33.557010650634766


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(153.8382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.5011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9457136 KL Loss: 42.2810784 DSM Loss: 63.7378275 Overall Loss:107.9646192
Validation loss decreased (inf --> 2.368315).  Saving model ...
Updating learning rate to 0.0005
tensor(100.9733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.3167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9853281 KL Loss: 42.6131006 DSM Loss: 51.9450459 Overall Loss:96.5434745
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(75.2459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.5303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9492260 KL Loss: 42.2475370 DSM Loss: 51.3745489 Overall Loss:95.5713117
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:7.686811923980713


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(170.7041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.7293, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9163538 KL Loss: 42.1648839 DSM Loss: 54.6463236 Overall Loss:98.7275617
Validation loss decreased (inf --> 13.154738).  Saving model ...
Updating learning rate to 0.0005
tensor(91.9563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.6574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9299933 KL Loss: 42.1079331 DSM Loss: 45.2212287 Overall Loss:89.2591547
Validation loss decreased (13.154738 --> 13.092615).  Saving model ...
Updating learning rate to 0.00025
tensor(71.9100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9694443 KL Loss: 42.2944367 DSM Loss: 44.1327771 Overall Loss:88.3966587
Validation loss decreased (13.092615 --> 11.270210).  Saving model ...
Updating learning rate to 0.000125
tensor(69.9782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9597371 KL Loss: 42.1829666 DSM Loss: 43.4977856 Overall Loss:87.6404899
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(100.4847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9272501 KL Loss: 42.1702973 DSM Loss: 42.5053380 Overall Loss:86.6028855
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.778670072555542


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(156.3224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.6819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9419028 KL Loss: 41.9594746 DSM Loss: 67.8892341 Overall Loss:111.7906116
Validation loss decreased (inf --> 4.742142).  Saving model ...
Updating learning rate to 0.0005
tensor(66.6031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.8193, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9752819 KL Loss: 41.9069716 DSM Loss: 55.5207625 Overall Loss:99.4030159
Validation loss decreased (4.742142 --> 4.615665).  Saving model ...
Updating learning rate to 0.00025
tensor(116.2032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.3272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0011396 KL Loss: 41.8238255 DSM Loss: 53.5960862 Overall Loss:97.4210513
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(127.0746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.7659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9505604 KL Loss: 41.1070133 DSM Loss: 51.6586372 Overall Loss:94.7162111
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.4883289337158203


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(136.9291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.5712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0348566 KL Loss: 42.8325089 DSM Loss: 75.2048135 Overall Loss:120.0721786
Validation loss decreased (inf --> 0.857463).  Saving model ...
Updating learning rate to 0.0005
tensor(98.5242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.3439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9975717 KL Loss: 42.6691524 DSM Loss: 57.7425453 Overall Loss:102.4092692
Validation loss decreased (0.857463 --> 0.753338).  Saving model ...
Updating learning rate to 0.00025
tensor(116.7500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.6280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9840408 KL Loss: 42.7977189 DSM Loss: 56.8109656 Overall Loss:101.5927256
Validation loss decreased (0.753338 --> 0.717695).  Saving model ...
Updating learning rate to 0.000125
tensor(120.4213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.0805, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9794183 KL Loss: 42.4786800 DSM Loss: 56.2454567 Overall Loss:100.7035547
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(122.0194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.8774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9664488 KL Loss: 42.4241867 DSM Loss: 56.7609668 Overall Loss:101.1516015
Validation loss decreased (0.717695 --> 0.709295).  Saving model ...
Updating learning rate to 3.125e-05
tensor(111.0894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9545757 KL Loss: 42.4122534 DSM Loss: 55.8419917 Overall Loss:100.2088210
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(131.1780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9561557 KL Loss: 42.5740901 DSM Loss: 55.9776248 Overall Loss:100.5078702
Validation loss decreased (0.709295 --> 0.706362).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(86.2493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.5030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9637556 KL Loss: 42.4992242 DSM Loss: 55.8950887 Overall Loss:100.3580688
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(111.4316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.6455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 80 | MSE Loss: 1.9639779 KL Loss: 42.4183707 DSM Loss: 55.6684648 Overall Loss:100.0508136
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.7036937475204468


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(148.6429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.6527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9015668 KL Loss: 42.3284389 DSM Loss: 58.9537189 Overall Loss:103.1837247
Validation loss decreased (inf --> 0.179807).  Saving model ...
Updating learning rate to 0.0005
tensor(103.0526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.2351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9038154 KL Loss: 42.2475110 DSM Loss: 49.0106371 Overall Loss:93.1619637
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(95.7326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.0089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9073325 KL Loss: 42.0495016 DSM Loss: 49.1910054 Overall Loss:93.1478398
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.2821270525455475


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(150.6618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9625567 KL Loss: 42.5216149 DSM Loss: 62.4515323 Overall Loss:106.9357037
Validation loss decreased (inf --> 8.682115).  Saving model ...
Updating learning rate to 0.0005
tensor(92.5999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.1508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9878148 KL Loss: 42.5829931 DSM Loss: 48.5595157 Overall Loss:93.1303239
Validation loss decreased (8.682115 --> 8.564126).  Saving model ...
Updating learning rate to 0.00025
tensor(70.6518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7035, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9231572 KL Loss: 42.2306130 DSM Loss: 46.6101038 Overall Loss:90.7638742
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(86.5467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.9730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9095858 KL Loss: 42.0346587 DSM Loss: 46.7823813 Overall Loss:90.7266259
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:12.739044189453125


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(130.5150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.3516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8757414 KL Loss: 42.0802736 DSM Loss: 66.3683910 Overall Loss:110.3244059
Validation loss decreased (inf --> 9.573426).  Saving model ...
Updating learning rate to 0.0005
tensor(63.8157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.9894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9271148 KL Loss: 42.6931446 DSM Loss: 50.1601060 Overall Loss:94.7803657
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(59.7377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9322355 KL Loss: 42.2190652 DSM Loss: 49.6051220 Overall Loss:93.7564230
Validation loss decreased (9.573426 --> 8.581050).  Saving model ...
Updating learning rate to 0.000125
tensor(97.6979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9831512 KL Loss: 42.5807878 DSM Loss: 48.1758019 Overall Loss:92.7397408
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(68.9556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.8982, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9299391 KL Loss: 41.9011449 DSM Loss: 48.4363936 Overall Loss:92.2674779
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:5.077571392059326


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(159.4890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.7731, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0152480 KL Loss: 42.7966609 DSM Loss: 72.7938649 Overall Loss:117.6057737
Validation loss decreased (inf --> 0.631130).  Saving model ...
Updating learning rate to 0.0005
tensor(93.3890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.2475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9984129 KL Loss: 42.6234390 DSM Loss: 57.2523157 Overall Loss:101.8741677
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(118.1585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.4326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9653221 KL Loss: 42.6760522 DSM Loss: 55.3487843 Overall Loss:99.9901587
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.3187602758407593


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(142.4266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.1564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9847048 KL Loss: 42.1958152 DSM Loss: 63.4898577 Overall Loss:107.6703772
Validation loss decreased (inf --> 1.690734).  Saving model ...
Updating learning rate to 0.0005
tensor(79.5257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.7675, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9635630 KL Loss: 42.0954266 DSM Loss: 52.3172137 Overall Loss:96.3762035
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(92.8722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.7001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9670885 KL Loss: 42.3653609 DSM Loss: 50.8122862 Overall Loss:95.1447363
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.10030198097229


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(134.8772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.0029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9709982 KL Loss: 42.8135579 DSM Loss: 71.3127244 Overall Loss:116.0972806
Validation loss decreased (inf --> 1.041278).  Saving model ...
Updating learning rate to 0.0005
tensor(112.2850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.8973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9678100 KL Loss: 42.7133208 DSM Loss: 63.9843549 Overall Loss:108.6654860
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(111.3955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.9493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0740054 KL Loss: 43.1871440 DSM Loss: 63.6096821 Overall Loss:108.8708317
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.12550480663776398


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(146.1318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.0011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8870011 KL Loss: 42.2669355 DSM Loss: 67.1750320 Overall Loss:111.3289693
Validation loss decreased (inf --> 3.259901).  Saving model ...
Updating learning rate to 0.0005
tensor(83.0218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3126, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9100657 KL Loss: 42.0527483 DSM Loss: 53.5726691 Overall Loss:97.5354834
Validation loss decreased (3.259901 --> 2.612092).  Saving model ...
Updating learning rate to 0.00025
tensor(102.0127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.5909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9008108 KL Loss: 41.8903137 DSM Loss: 52.5281789 Overall Loss:96.3193036
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(110.6064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.9385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.8786147 KL Loss: 41.7681658 DSM Loss: 53.3543472 Overall Loss:97.0011282
Validation loss decreased (2.612092 --> 2.601325).  Saving model ...
Updating learning rate to 6.25e-05
tensor(73.1054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.2672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9074820 KL Loss: 41.9806283 DSM Loss: 51.4339151 Overall Loss:95.3220252
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(108.6315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.3164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9211235 KL Loss: 42.1406025 DSM Loss: 51.6715297 Overall Loss:95.7332558
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:3.601426839828491


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(199.9918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.7048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0583577 KL Loss: 42.7508755 DSM Loss: 76.9576042 Overall Loss:121.7668381
Validation loss decreased (inf --> 1.585095).  Saving model ...
Updating learning rate to 0.0005
tensor(118.6639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.2194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.1357609 KL Loss: 42.9784111 DSM Loss: 63.5133226 Overall Loss:108.6274954
Validation loss decreased (1.585095 --> 1.584170).  Saving model ...
Updating learning rate to 0.00025
tensor(135.1315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.0032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0676684 KL Loss: 42.6686295 DSM Loss: 62.8320382 Overall Loss:107.5683363
Validation loss decreased (1.584170 --> 1.282685).  Saving model ...
Updating learning rate to 0.000125
tensor(77.5784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.4516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 2.1304221 KL Loss: 43.1983942 DSM Loss: 62.3077641 Overall Loss:107.6365804
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(122.7693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.4137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 2.1712058 KL Loss: 43.0941382 DSM Loss: 61.4131912 Overall Loss:106.6785353
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_F_dva_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:23.479188919067383
      Ticker        MSE StdDev
0   AAPL_pct   5.679227    0.0
1   ABBV_pct  18.346212    0.0
2    AEP_pct   3.333968    0.0
3   AMGN_pct   4.213055    0.0
4   AMZN_pct   0.416172    0.0
..       ...        ...    ...
66    VZ_pct    1.31876    0.0
67     V_pct   2.100302    0.0
68   WFC_pct   0.125505    0.0
69   WMT_pct   3.601427    0.0
70   XOM_pct  23.479189    0.0

[71 rows x 3 columns]
