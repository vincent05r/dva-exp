Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=10, prediction_length=10, root_path='data/EcmP_stock_L_2016_24_spec_official_dva_spec', scale=0.1, sequence_length=10, target_dim=1, train_epochs=30, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.4844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7879695 KL Loss: 7.1664100 DSM Loss: 12.9575913 Overall Loss:21.9119708
Validation loss decreased (inf --> 0.958661).  Saving model ...
Updating learning rate to 0.0005
tensor(25.5330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8478002 KL Loss: 7.2429051 DSM Loss: 10.1714964 Overall Loss:19.2622018
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(26.5765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7467266 KL Loss: 7.1241317 DSM Loss: 9.6660741 Overall Loss:18.5369323
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(26.2140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7616083 KL Loss: 7.1882993 DSM Loss: 9.5294403 Overall Loss:18.4793478
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(14.7015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7780420 KL Loss: 7.2205927 DSM Loss: 9.4910368 Overall Loss:18.4896715
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(14.8943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7828124 KL Loss: 7.1552936 DSM Loss: 9.3527163 Overall Loss:18.2908223
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(14.1178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7735932 KL Loss: 7.1375783 DSM Loss: 9.4742664 Overall Loss:18.3854378
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(16.1331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7986125 KL Loss: 7.2816357 DSM Loss: 9.3688829 Overall Loss:18.4491311
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(14.1467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6418, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7404755 KL Loss: 7.1198843 DSM Loss: 9.5696490 Overall Loss:18.4300089
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(18.5436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7955811 KL Loss: 7.2842178 DSM Loss: 9.2224597 Overall Loss:18.3022586
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(14.0602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8043762 KL Loss: 7.1960907 DSM Loss: 9.4720933 Overall Loss:18.4725602
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8619795441627502


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.7671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8711495 KL Loss: 7.2442320 DSM Loss: 11.5909175 Overall Loss:20.7062989
Validation loss decreased (inf --> 0.581063).  Saving model ...
Updating learning rate to 0.0005
tensor(19.6796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7850149 KL Loss: 7.1206517 DSM Loss: 9.8121733 Overall Loss:18.7178399
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(22.6253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7679627 KL Loss: 7.1590880 DSM Loss: 9.5525128 Overall Loss:18.4795636
Validation loss decreased (0.581063 --> 0.577205).  Saving model ...
Updating learning rate to 0.000125
tensor(20.8385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7736073 KL Loss: 7.2116679 DSM Loss: 9.3256689 Overall Loss:18.3109441
Validation loss decreased (0.577205 --> 0.576224).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.6239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7591472 KL Loss: 7.1336469 DSM Loss: 9.4223464 Overall Loss:18.3151403
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(15.3764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7899378 KL Loss: 7.2071367 DSM Loss: 9.3760858 Overall Loss:18.3731602
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(17.1459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8152002 KL Loss: 7.2687975 DSM Loss: 9.2053551 Overall Loss:18.2893527
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(14.1441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7608096 KL Loss: 7.1739549 DSM Loss: 9.1716900 Overall Loss:18.1064544
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(14.3342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7874022 KL Loss: 7.2047168 DSM Loss: 9.1770972 Overall Loss:18.1692162
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(21.1387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7853099 KL Loss: 7.2442765 DSM Loss: 8.8776866 Overall Loss:17.9072730
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(18.3436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7886277 KL Loss: 7.2210874 DSM Loss: 9.0161495 Overall Loss:18.0258647
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(19.2324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7507197 KL Loss: 7.1719712 DSM Loss: 9.1041143 Overall Loss:18.0268052
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(27.4829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.8136152 KL Loss: 7.3295316 DSM Loss: 9.0407167 Overall Loss:18.1838635
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(18.0812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7830536 KL Loss: 7.1921790 DSM Loss: 9.3207699 Overall Loss:18.2960024
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5596842169761658


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.1142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7562, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8199949 KL Loss: 7.2812975 DSM Loss: 12.3934287 Overall Loss:21.4947211
Validation loss decreased (inf --> 0.665671).  Saving model ...
Updating learning rate to 0.0005
tensor(14.2792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8751923 KL Loss: 7.2804954 DSM Loss: 9.3495408 Overall Loss:18.5052285
Validation loss decreased (0.665671 --> 0.656742).  Saving model ...
Updating learning rate to 0.00025
tensor(11.4189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7552803 KL Loss: 7.1038535 DSM Loss: 9.7016758 Overall Loss:18.5608097
Validation loss decreased (0.656742 --> 0.654793).  Saving model ...
Updating learning rate to 0.000125
tensor(16.8368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0980, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7805607 KL Loss: 7.1308870 DSM Loss: 9.6107700 Overall Loss:18.5222178
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(13.6030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7899723 KL Loss: 7.1765367 DSM Loss: 9.4187101 Overall Loss:18.3852192
Validation loss decreased (0.654793 --> 0.654369).  Saving model ...
Updating learning rate to 3.125e-05
tensor(13.9754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8079752 KL Loss: 7.1384663 DSM Loss: 9.3406940 Overall Loss:18.2871354
Validation loss decreased (0.654369 --> 0.653830).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(14.0602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7607386 KL Loss: 7.1646321 DSM Loss: 9.5960586 Overall Loss:18.5214293
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(13.5369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7324194 KL Loss: 7.1487038 DSM Loss: 9.5717521 Overall Loss:18.4528751
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(19.4148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7780380 KL Loss: 7.1405855 DSM Loss: 9.3188619 Overall Loss:18.2374853
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(73.0503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7930592 KL Loss: 7.1448486 DSM Loss: 9.4172573 Overall Loss:18.3551650
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(21.1431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7474145 KL Loss: 7.1456650 DSM Loss: 9.6465667 Overall Loss:18.5396460
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(20.0200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7335082 KL Loss: 7.1748942 DSM Loss: 9.3898328 Overall Loss:18.2982351
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(14.9184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7339583 KL Loss: 7.1173169 DSM Loss: 9.5779175 Overall Loss:18.4291926
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(14.7613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7547327 KL Loss: 7.1389386 DSM Loss: 9.6070507 Overall Loss:18.5007220
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(13.5320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.6834512 KL Loss: 7.0172853 DSM Loss: 9.5365260 Overall Loss:18.2372625
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(21.6382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7400068 KL Loss: 7.0600766 DSM Loss: 9.5062954 Overall Loss:18.3063789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.147571325302124


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.1099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8510336 KL Loss: 7.3349089 DSM Loss: 11.8797538 Overall Loss:21.0656961
Validation loss decreased (inf --> 0.643268).  Saving model ...
Updating learning rate to 0.0005
tensor(15.1003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8292554 KL Loss: 7.2505766 DSM Loss: 10.4345472 Overall Loss:19.5143791
Validation loss decreased (0.643268 --> 0.626188).  Saving model ...
Updating learning rate to 0.00025
tensor(16.4653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8149064 KL Loss: 7.2993069 DSM Loss: 9.6419743 Overall Loss:18.7561875
Validation loss decreased (0.626188 --> 0.622214).  Saving model ...
Updating learning rate to 0.000125
tensor(17.5809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8353510 KL Loss: 7.2561840 DSM Loss: 9.4364688 Overall Loss:18.5280038
Validation loss decreased (0.622214 --> 0.621766).  Saving model ...
Updating learning rate to 6.25e-05
tensor(15.4325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8312169 KL Loss: 7.1969286 DSM Loss: 9.4763109 Overall Loss:18.5044564
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(20.2009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7214491 KL Loss: 7.1487561 DSM Loss: 9.4559762 Overall Loss:18.3261814
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(16.3865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7546428 KL Loss: 7.1435141 DSM Loss: 9.3709202 Overall Loss:18.2690770
Validation loss decreased (0.621766 --> 0.621758).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(16.1966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7625530 KL Loss: 7.2112066 DSM Loss: 9.3271309 Overall Loss:18.3008905
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(19.1161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7134187 KL Loss: 7.1265607 DSM Loss: 9.3005493 Overall Loss:18.1405287
Validation loss decreased (0.621758 --> 0.621724).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(16.7313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9374, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7668240 KL Loss: 7.2257111 DSM Loss: 9.3447615 Overall Loss:18.3372967
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-07
tensor(16.7205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7794657 KL Loss: 7.1823177 DSM Loss: 9.2542761 Overall Loss:18.2160594
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-07
tensor(23.6770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7227, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7399986 KL Loss: 7.2256891 DSM Loss: 9.2373106 Overall Loss:18.2029982
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-07
tensor(14.0218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7681704 KL Loss: 7.1872879 DSM Loss: 9.3311071 Overall Loss:18.2865654
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-07
tensor(16.3213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7356896 KL Loss: 7.1203751 DSM Loss: 9.1802585 Overall Loss:18.0363233
Validation loss decreased (0.621724 --> 0.621686).  Saving model ...
Updating learning rate to 6.103515625e-08
tensor(19.2439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5957, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7626192 KL Loss: 7.2474960 DSM Loss: 9.2699203 Overall Loss:18.2800354
Validation loss decreased (0.621686 --> 0.621678).  Saving model ...
Updating learning rate to 3.0517578125e-08
tensor(18.2553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7694639 KL Loss: 7.1987507 DSM Loss: 9.2615807 Overall Loss:18.2297953
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-08
tensor(26.5341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7751312 KL Loss: 7.2247308 DSM Loss: 9.3107928 Overall Loss:18.3106546
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-09
tensor(14.8897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7775162 KL Loss: 7.2205633 DSM Loss: 9.1554129 Overall Loss:18.1534924
Validation loss decreased (0.621678 --> 0.621649).  Saving model ...
Updating learning rate to 3.814697265625e-09
tensor(15.6593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.7479962 KL Loss: 7.2746738 DSM Loss: 9.2135844 Overall Loss:18.2362545
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(17.3474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3557, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.7249823 KL Loss: 7.1885810 DSM Loss: 9.2313382 Overall Loss:18.1449016
Validation loss decreased (0.621649 --> 0.621586).  Saving model ...
Updating learning rate to 9.5367431640625e-10
tensor(21.4291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9368, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 86 | MSE Loss: 1.7214886 KL Loss: 7.0635279 DSM Loss: 9.4114608 Overall Loss:18.1964773
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(23.3160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 86 | MSE Loss: 1.7415330 KL Loss: 7.1769042 DSM Loss: 9.2995473 Overall Loss:18.2179845
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(16.3538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3242, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 86 | MSE Loss: 1.7803842 KL Loss: 7.3064061 DSM Loss: 9.1394669 Overall Loss:18.2262572
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(14.3271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0433, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 86 | MSE Loss: 1.7451517 KL Loss: 7.2321278 DSM Loss: 9.2870821 Overall Loss:18.2643617
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-11
tensor(15.9784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 25, Steps: 86 | MSE Loss: 1.7140416 KL Loss: 7.2026956 DSM Loss: 9.2898144 Overall Loss:18.2065516
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.980232238769531e-11
tensor(14.7642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 26, Steps: 86 | MSE Loss: 1.7805767 KL Loss: 7.1630299 DSM Loss: 9.2280480 Overall Loss:18.1716545
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4901161193847657e-11
tensor(19.7312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 27, Steps: 86 | MSE Loss: 1.7971017 KL Loss: 7.1672678 DSM Loss: 9.2655191 Overall Loss:18.2298886
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.450580596923828e-12
tensor(12.9876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 28, Steps: 86 | MSE Loss: 1.7988141 KL Loss: 7.2995694 DSM Loss: 9.3591915 Overall Loss:18.4575751
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.725290298461914e-12
tensor(16.8911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 29, Steps: 86 | MSE Loss: 1.7836376 KL Loss: 7.2308101 DSM Loss: 9.2352436 Overall Loss:18.2496913
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.862645149230957e-12
tensor(13.7397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0457, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 30, Steps: 86 | MSE Loss: 1.7671532 KL Loss: 7.2453316 DSM Loss: 9.0497372 Overall Loss:18.0622220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6841431260108948


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.2052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8247489 KL Loss: 7.2304620 DSM Loss: 12.5775770 Overall Loss:21.6327880
Validation loss decreased (inf --> 1.926986).  Saving model ...
Updating learning rate to 0.0005
tensor(16.9149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8292506 KL Loss: 7.2439881 DSM Loss: 9.8781858 Overall Loss:18.9514245
Validation loss decreased (1.926986 --> 1.897533).  Saving model ...
Updating learning rate to 0.00025
tensor(17.0034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8133246 KL Loss: 7.2185222 DSM Loss: 9.4663989 Overall Loss:18.4982456
Validation loss decreased (1.897533 --> 1.880723).  Saving model ...
Updating learning rate to 0.000125
tensor(22.0576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7642194 KL Loss: 7.1513487 DSM Loss: 9.3522892 Overall Loss:18.2678571
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(16.8463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7719910 KL Loss: 7.1552021 DSM Loss: 9.3001991 Overall Loss:18.2273924
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(25.8102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2000, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7616122 KL Loss: 7.1931034 DSM Loss: 9.4205068 Overall Loss:18.3752225
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(22.1101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7637157 KL Loss: 7.1877903 DSM Loss: 9.3400500 Overall Loss:18.2915560
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(19.3406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7631597 KL Loss: 7.1853453 DSM Loss: 9.3047312 Overall Loss:18.2532362
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(17.7242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3054, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7578474 KL Loss: 7.1579769 DSM Loss: 9.2363608 Overall Loss:18.1521851
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(19.4725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7773783 KL Loss: 7.1902006 DSM Loss: 9.2675656 Overall Loss:18.2351444
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(26.7335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7588091 KL Loss: 7.2470484 DSM Loss: 9.2504665 Overall Loss:18.2563241
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(19.5362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7954082 KL Loss: 7.1334612 DSM Loss: 9.2067396 Overall Loss:18.1356089
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(22.0078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6563, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7396485 KL Loss: 7.1314658 DSM Loss: 9.3580638 Overall Loss:18.2291781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7773284912109375


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.8480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9196173 KL Loss: 7.3266803 DSM Loss: 11.6605904 Overall Loss:20.9068881
Validation loss decreased (inf --> 0.763439).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8161662 KL Loss: 7.2014119 DSM Loss: 9.9815164 Overall Loss:18.9990946
Validation loss decreased (0.763439 --> 0.741896).  Saving model ...
Updating learning rate to 0.00025
tensor(12.0941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7608973 KL Loss: 7.1907858 DSM Loss: 9.5634923 Overall Loss:18.5151754
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(22.9703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8871076 KL Loss: 7.3496325 DSM Loss: 9.4755358 Overall Loss:18.7122758
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(14.7952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0007, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7728338 KL Loss: 7.1538853 DSM Loss: 9.3877073 Overall Loss:18.3144263
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(22.8816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.6824506 KL Loss: 7.0801910 DSM Loss: 9.6261351 Overall Loss:18.3887767
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(16.0552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7924214 KL Loss: 7.2246393 DSM Loss: 9.4811998 Overall Loss:18.4982606
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(17.0743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7542387 KL Loss: 7.1878078 DSM Loss: 9.5904683 Overall Loss:18.5325149
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(15.2867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7915653 KL Loss: 7.1706492 DSM Loss: 9.2738876 Overall Loss:18.2361020
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(13.8563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7845781 KL Loss: 7.2612139 DSM Loss: 8.9269900 Overall Loss:17.9727818
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(19.2515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7675588 KL Loss: 7.1743370 DSM Loss: 9.5150302 Overall Loss:18.4569260
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(17.1071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7523267 KL Loss: 7.1293521 DSM Loss: 9.4751908 Overall Loss:18.3568696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6944059729576111


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(36.4308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7973265 KL Loss: 7.1326752 DSM Loss: 12.4444048 Overall Loss:21.3744066
Validation loss decreased (inf --> 0.838622).  Saving model ...
Updating learning rate to 0.0005
tensor(13.6768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8058163 KL Loss: 7.1692121 DSM Loss: 9.9682485 Overall Loss:18.9432771
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(28.2168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7623896 KL Loss: 7.1263656 DSM Loss: 9.8008095 Overall Loss:18.6895646
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(13.8468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7678572 KL Loss: 7.1012966 DSM Loss: 9.7247028 Overall Loss:18.5938565
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(15.2634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7587755 KL Loss: 7.1372152 DSM Loss: 9.7789154 Overall Loss:18.6749061
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(14.3263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7469628 KL Loss: 7.1236881 DSM Loss: 9.7460091 Overall Loss:18.6166600
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(15.4126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7907004 KL Loss: 7.1391432 DSM Loss: 9.1160211 Overall Loss:18.0458648
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(13.5120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7471920 KL Loss: 7.1039548 DSM Loss: 9.4568599 Overall Loss:18.3080068
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(27.4601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7470986 KL Loss: 7.1492858 DSM Loss: 9.4838169 Overall Loss:18.3802012
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(15.4492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8039633 KL Loss: 7.1793046 DSM Loss: 9.3614585 Overall Loss:18.3447264
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(19.6754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7218177 KL Loss: 7.0508176 DSM Loss: 9.8457370 Overall Loss:18.6183724
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6382949948310852


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.7461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8523649 KL Loss: 7.2722822 DSM Loss: 11.3934531 Overall Loss:20.5181001
Validation loss decreased (inf --> 1.506232).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8656215 KL Loss: 7.2890560 DSM Loss: 9.8950398 Overall Loss:19.0497172
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(16.8237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8583, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8089297 KL Loss: 7.1966689 DSM Loss: 9.8065286 Overall Loss:18.8121272
Validation loss decreased (1.506232 --> 1.502781).  Saving model ...
Updating learning rate to 0.000125
tensor(20.3911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7702075 KL Loss: 7.1535308 DSM Loss: 9.4212088 Overall Loss:18.3449471
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(15.1625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8004218 KL Loss: 7.2583754 DSM Loss: 9.6328926 Overall Loss:18.6916898
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(27.3119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7469959 KL Loss: 7.1297301 DSM Loss: 9.6781913 Overall Loss:18.5549173
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(14.9620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7297431 KL Loss: 7.1260857 DSM Loss: 9.5331091 Overall Loss:18.3889379
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(19.0066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7750294 KL Loss: 7.2476786 DSM Loss: 9.4008645 Overall Loss:18.4235725
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(27.3600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7541413 KL Loss: 7.1051815 DSM Loss: 9.6584817 Overall Loss:18.5178046
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(29.4109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7447982 KL Loss: 7.0929020 DSM Loss: 9.5775574 Overall Loss:18.4152575
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(19.1803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7534822 KL Loss: 7.1793859 DSM Loss: 9.0370807 Overall Loss:17.9699488
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(15.7052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1295, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7619607 KL Loss: 7.2402474 DSM Loss: 9.4814578 Overall Loss:18.4836659
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(27.2774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7638446 KL Loss: 7.2478227 DSM Loss: 9.5723377 Overall Loss:18.5840049
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.928022027015686


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.3029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4869, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7683633 KL Loss: 7.2061763 DSM Loss: 11.8949114 Overall Loss:20.8694510
Validation loss decreased (inf --> 1.115606).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8504498 KL Loss: 7.1986325 DSM Loss: 9.5834722 Overall Loss:18.6325545
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(16.7339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8059726 KL Loss: 7.2022733 DSM Loss: 9.4301765 Overall Loss:18.4384225
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(19.8186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7639594 KL Loss: 7.1540128 DSM Loss: 9.4087745 Overall Loss:18.3267467
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(25.0115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7589057 KL Loss: 7.2195386 DSM Loss: 9.0824047 Overall Loss:18.0608490
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(24.5732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9793, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7640828 KL Loss: 7.1157174 DSM Loss: 9.0931623 Overall Loss:17.9729625
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(13.9089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1646, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7770682 KL Loss: 7.1907494 DSM Loss: 9.0506557 Overall Loss:18.0184732
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(17.0184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9111, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7902829 KL Loss: 7.2281749 DSM Loss: 9.2856101 Overall Loss:18.3040679
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(16.2513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7881468 KL Loss: 7.2025657 DSM Loss: 9.2711467 Overall Loss:18.2618592
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(15.2293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0642, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7695680 KL Loss: 7.2253191 DSM Loss: 9.2939839 Overall Loss:18.2888709
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(15.3516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7767389 KL Loss: 7.2097048 DSM Loss: 9.1466641 Overall Loss:18.1331078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8930015563964844


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.5050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8042369 KL Loss: 7.1244974 DSM Loss: 12.4455258 Overall Loss:21.3742599
Validation loss decreased (inf --> 1.027130).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7692286 KL Loss: 7.1236991 DSM Loss: 9.7515136 Overall Loss:18.6444413
Validation loss decreased (1.027130 --> 1.020921).  Saving model ...
Updating learning rate to 0.00025
tensor(16.6431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0490, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7341995 KL Loss: 7.1385864 DSM Loss: 9.7165341 Overall Loss:18.5893200
Validation loss decreased (1.020921 --> 1.008809).  Saving model ...
Updating learning rate to 0.000125
tensor(18.8916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7835645 KL Loss: 7.1369028 DSM Loss: 9.6029473 Overall Loss:18.5234146
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(15.4112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7958612 KL Loss: 7.2703287 DSM Loss: 9.3057108 Overall Loss:18.3719007
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(13.7431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5974, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7585986 KL Loss: 7.0856622 DSM Loss: 9.3294472 Overall Loss:18.1737079
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(45.1730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7270290 KL Loss: 7.0856677 DSM Loss: 9.3429429 Overall Loss:18.1556396
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(26.1216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7522101 KL Loss: 7.1288810 DSM Loss: 9.4870276 Overall Loss:18.3681187
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(21.3407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7322617 KL Loss: 7.0990615 DSM Loss: 9.4302698 Overall Loss:18.2615930
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(18.6271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7466932 KL Loss: 7.1432623 DSM Loss: 9.4518335 Overall Loss:18.3417890
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(23.3417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2142, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7916943 KL Loss: 7.2046026 DSM Loss: 9.2399576 Overall Loss:18.2362545
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(17.2979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7441626 KL Loss: 7.1547525 DSM Loss: 9.1240680 Overall Loss:18.0229833
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(15.6070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7105483 KL Loss: 7.0529955 DSM Loss: 9.4752675 Overall Loss:18.2388113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7242395877838135


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.7906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7737481 KL Loss: 7.1744233 DSM Loss: 12.3257125 Overall Loss:21.2738837
Validation loss decreased (inf --> 0.722180).  Saving model ...
Updating learning rate to 0.0005
tensor(16.5786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2930, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7769530 KL Loss: 7.1480154 DSM Loss: 10.1524742 Overall Loss:19.0774426
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(16.3432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3433, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8242824 KL Loss: 7.2550087 DSM Loss: 9.5724107 Overall Loss:18.6517019
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(16.2335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7785705 KL Loss: 7.2396152 DSM Loss: 9.4401876 Overall Loss:18.4583733
Validation loss decreased (0.722180 --> 0.720445).  Saving model ...
Updating learning rate to 6.25e-05
tensor(34.9117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8076545 KL Loss: 7.2429452 DSM Loss: 9.5108089 Overall Loss:18.5614085
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(14.2618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7794634 KL Loss: 7.1797879 DSM Loss: 9.5753668 Overall Loss:18.5346181
Validation loss decreased (0.720445 --> 0.720307).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(15.3774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7963712 KL Loss: 7.2501525 DSM Loss: 9.5377126 Overall Loss:18.5842365
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(31.8992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7854798 KL Loss: 7.2198866 DSM Loss: 9.5616660 Overall Loss:18.5670325
Validation loss decreased (0.720307 --> 0.720256).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(18.9277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7460538 KL Loss: 7.1357542 DSM Loss: 9.6281008 Overall Loss:18.5099088
Validation loss decreased (0.720256 --> 0.720157).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(14.2011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7862504 KL Loss: 7.1645989 DSM Loss: 9.5542081 Overall Loss:18.5050576
Validation loss decreased (0.720157 --> 0.720138).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(18.3665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2607, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8002960 KL Loss: 7.1963073 DSM Loss: 9.5399620 Overall Loss:18.5365652
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-07
tensor(20.3085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7664145 KL Loss: 7.1374833 DSM Loss: 9.6825485 Overall Loss:18.5864465
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-07
tensor(16.2906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7551410 KL Loss: 7.0958141 DSM Loss: 9.6632371 Overall Loss:18.5141921
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.220703125e-07
tensor(13.1706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3703, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7045560 KL Loss: 7.1119888 DSM Loss: 9.5698702 Overall Loss:18.3864151
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.103515625e-08
tensor(19.1593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8355, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7575216 KL Loss: 7.1263578 DSM Loss: 9.6489619 Overall Loss:18.5328413
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.0517578125e-08
tensor(16.1055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7383050 KL Loss: 7.1263063 DSM Loss: 9.5108078 Overall Loss:18.3754190
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.52587890625e-08
tensor(21.1255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8595, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7241293 KL Loss: 7.1057303 DSM Loss: 9.6169458 Overall Loss:18.4468053
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.62939453125e-09
tensor(16.3212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7935833 KL Loss: 7.2967340 DSM Loss: 9.2597594 Overall Loss:18.3500767
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.814697265625e-09
tensor(16.8662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.8067365 KL Loss: 7.2920343 DSM Loss: 9.3409841 Overall Loss:18.4397548
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(16.6156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8355, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.7779214 KL Loss: 7.2076324 DSM Loss: 9.3742027 Overall Loss:18.3597565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8613020181655884


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(36.8121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9820, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8063625 KL Loss: 7.1667884 DSM Loss: 11.5606936 Overall Loss:20.5338444
Validation loss decreased (inf --> 1.321694).  Saving model ...
Updating learning rate to 0.0005
tensor(15.0778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8551567 KL Loss: 7.2556883 DSM Loss: 9.6185621 Overall Loss:18.7294071
Validation loss decreased (1.321694 --> 1.316990).  Saving model ...
Updating learning rate to 0.00025
tensor(34.0884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7389169 KL Loss: 7.1021201 DSM Loss: 9.9338034 Overall Loss:18.7748404
Validation loss decreased (1.316990 --> 1.316790).  Saving model ...
Updating learning rate to 0.000125
tensor(18.7830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7904600 KL Loss: 7.2358847 DSM Loss: 9.7731764 Overall Loss:18.7995210
Validation loss decreased (1.316790 --> 1.316445).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.3474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7544718 KL Loss: 7.1324256 DSM Loss: 9.5093306 Overall Loss:18.3962278
Validation loss decreased (1.316445 --> 1.315338).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.4185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7772235 KL Loss: 7.2776799 DSM Loss: 9.2913983 Overall Loss:18.3463017
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(17.4269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8057153 KL Loss: 7.2156583 DSM Loss: 9.4406310 Overall Loss:18.4620046
Validation loss decreased (1.315338 --> 1.315309).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(17.6802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7745181 KL Loss: 7.1829009 DSM Loss: 9.4858756 Overall Loss:18.4432945
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(31.9119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8454, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7735838 KL Loss: 7.1632817 DSM Loss: 9.6053585 Overall Loss:18.5422239
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(16.5664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0737, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7481860 KL Loss: 7.1919357 DSM Loss: 9.3795587 Overall Loss:18.3196804
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(14.4158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7534954 KL Loss: 7.1846328 DSM Loss: 9.5800475 Overall Loss:18.5181756
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(14.2604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7211646 KL Loss: 7.0541850 DSM Loss: 9.6679331 Overall Loss:18.4432826
Validation loss decreased (1.315309 --> 1.315220).  Saving model ...
Updating learning rate to 2.44140625e-07
tensor(23.3651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7707977 KL Loss: 7.1483331 DSM Loss: 9.4909256 Overall Loss:18.4100564
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-07
tensor(22.3310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7355641 KL Loss: 7.1613501 DSM Loss: 9.3833143 Overall Loss:18.2802285
Validation loss decreased (1.315220 --> 1.315174).  Saving model ...
Updating learning rate to 6.103515625e-08
tensor(13.7258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7871865 KL Loss: 7.2792296 DSM Loss: 9.5303754 Overall Loss:18.5967914
Validation loss decreased (1.315174 --> 1.315126).  Saving model ...
Updating learning rate to 3.0517578125e-08
tensor(17.9984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9169, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7570330 KL Loss: 7.1975509 DSM Loss: 9.4486196 Overall Loss:18.4032035
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-08
tensor(20.6315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7557084 KL Loss: 7.1958163 DSM Loss: 9.5915108 Overall Loss:18.5430354
Validation loss decreased (1.315126 --> 1.315078).  Saving model ...
Updating learning rate to 7.62939453125e-09
tensor(11.5058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7405684 KL Loss: 7.1170541 DSM Loss: 9.6365567 Overall Loss:18.4941791
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-09
tensor(15.2940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3055, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.7251586 KL Loss: 7.0915452 DSM Loss: 9.6426770 Overall Loss:18.4593807
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(23.8104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.8058513 KL Loss: 7.2506147 DSM Loss: 9.5023464 Overall Loss:18.5588124
Validation loss decreased (1.315078 --> 1.315008).  Saving model ...
Updating learning rate to 9.5367431640625e-10
tensor(15.1629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 86 | MSE Loss: 1.7585303 KL Loss: 7.1251048 DSM Loss: 9.5481091 Overall Loss:18.4317443
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(14.4394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 86 | MSE Loss: 1.8139063 KL Loss: 7.2809765 DSM Loss: 9.3245730 Overall Loss:18.4194558
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(16.1022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6119, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 86 | MSE Loss: 1.7890722 KL Loss: 7.1626007 DSM Loss: 9.2722247 Overall Loss:18.2238976
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(12.5828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 86 | MSE Loss: 1.7461001 KL Loss: 7.1244530 DSM Loss: 9.5711707 Overall Loss:18.4417239
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-11
tensor(17.8429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 25, Steps: 86 | MSE Loss: 1.7605694 KL Loss: 7.1114682 DSM Loss: 9.5511242 Overall Loss:18.4231618
Validation loss decreased (1.315008 --> 1.314954).  Saving model ...
Updating learning rate to 2.980232238769531e-11
tensor(30.1456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 26, Steps: 86 | MSE Loss: 1.7853915 KL Loss: 7.1916903 DSM Loss: 9.6781292 Overall Loss:18.6552110
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4901161193847657e-11
tensor(16.5229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 27, Steps: 86 | MSE Loss: 1.7839095 KL Loss: 7.3022244 DSM Loss: 9.3163235 Overall Loss:18.4024573
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.450580596923828e-12
tensor(16.7364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 28, Steps: 86 | MSE Loss: 1.8080648 KL Loss: 7.2320206 DSM Loss: 9.4683356 Overall Loss:18.5084209
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.725290298461914e-12
tensor(14.5046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 29, Steps: 86 | MSE Loss: 1.7611939 KL Loss: 7.2284049 DSM Loss: 9.2710105 Overall Loss:18.2606094
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.862645149230957e-12
tensor(19.1856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 30, Steps: 86 | MSE Loss: 1.7455625 KL Loss: 7.1305098 DSM Loss: 9.6290879 Overall Loss:18.5051603
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.313225746154785e-13
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9235383868217468


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.3472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8292216 KL Loss: 7.2437171 DSM Loss: 11.3424178 Overall Loss:20.4153564
Validation loss decreased (inf --> 1.076552).  Saving model ...
Updating learning rate to 0.0005
tensor(15.4295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8408620 KL Loss: 7.2289636 DSM Loss: 9.9389940 Overall Loss:19.0088196
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(14.3198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7577472 KL Loss: 7.1376843 DSM Loss: 9.8446479 Overall Loss:18.7400795
Validation loss decreased (1.076552 --> 1.070569).  Saving model ...
Updating learning rate to 0.000125
tensor(15.0929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7861052 KL Loss: 7.1784774 DSM Loss: 9.6165056 Overall Loss:18.5810883
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(15.3360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9662, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7565605 KL Loss: 7.1644487 DSM Loss: 9.6377483 Overall Loss:18.5587575
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(14.2586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7325724 KL Loss: 7.1381273 DSM Loss: 9.6298385 Overall Loss:18.5005382
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(16.4193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2320, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7233468 KL Loss: 7.1569707 DSM Loss: 9.6206012 Overall Loss:18.5009186
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(17.6933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7650290 KL Loss: 7.1996223 DSM Loss: 9.5757954 Overall Loss:18.5404467
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(17.9644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7449205 KL Loss: 7.2257958 DSM Loss: 9.5080163 Overall Loss:18.4787325
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(28.7459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7670230 KL Loss: 7.2393712 DSM Loss: 9.3930386 Overall Loss:18.3994328
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(15.7269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0454, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7160595 KL Loss: 7.1580356 DSM Loss: 9.4899957 Overall Loss:18.3640908
Validation loss decreased (1.070569 --> 1.070426).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(17.4728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7750376 KL Loss: 7.1784326 DSM Loss: 9.5000221 Overall Loss:18.4534923
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-07
tensor(19.4126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5535, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7648584 KL Loss: 7.1967624 DSM Loss: 9.5836236 Overall Loss:18.5452444
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-07
tensor(17.5607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7752918 KL Loss: 7.1919471 DSM Loss: 9.5753992 Overall Loss:18.5426381
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-08
tensor(15.7000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7083441 KL Loss: 7.1296799 DSM Loss: 9.4755583 Overall Loss:18.3135823
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-08
tensor(19.3350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.8526122 KL Loss: 7.3767453 DSM Loss: 9.4096530 Overall Loss:18.6390105
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-08
tensor(14.6469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7892500 KL Loss: 7.2363588 DSM Loss: 9.3516313 Overall Loss:18.3772401
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-09
tensor(21.9363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7831442 KL Loss: 7.2591089 DSM Loss: 9.3950715 Overall Loss:18.4373247
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-09
tensor(16.2918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.7775118 KL Loss: 7.2376661 DSM Loss: 9.3044480 Overall Loss:18.3196259
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(15.6620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.8093280 KL Loss: 7.2705275 DSM Loss: 9.4218685 Overall Loss:18.5017240
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(12.2832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 86 | MSE Loss: 1.7348677 KL Loss: 7.1919363 DSM Loss: 9.4218842 Overall Loss:18.3486883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.654748797416687


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.8075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8238336 KL Loss: 7.2116376 DSM Loss: 11.2038762 Overall Loss:20.2393473
Validation loss decreased (inf --> 0.855750).  Saving model ...
Updating learning rate to 0.0005
tensor(15.0583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7693, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8379418 KL Loss: 7.2123620 DSM Loss: 10.0487222 Overall Loss:19.0990260
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(18.0893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7222059 KL Loss: 7.0964971 DSM Loss: 9.7502980 Overall Loss:18.5690011
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(15.2181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7901030 KL Loss: 7.2167414 DSM Loss: 9.6252841 Overall Loss:18.6321285
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(27.7021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7552005 KL Loss: 7.1712477 DSM Loss: 9.5792328 Overall Loss:18.5056810
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(16.8725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8041665 KL Loss: 7.2924985 DSM Loss: 9.4867436 Overall Loss:18.5834087
Validation loss decreased (0.855750 --> 0.854501).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(23.9985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7550564 KL Loss: 7.1590259 DSM Loss: 9.5314685 Overall Loss:18.4455509
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(24.1732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7514225 KL Loss: 7.2069288 DSM Loss: 9.3175088 Overall Loss:18.2758601
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(18.7625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7253348 KL Loss: 7.1837376 DSM Loss: 9.4268700 Overall Loss:18.3359424
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(23.2709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8067006 KL Loss: 7.2534988 DSM Loss: 9.3115475 Overall Loss:18.3717467
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(18.5645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1703, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7864731 KL Loss: 7.2036029 DSM Loss: 9.5276380 Overall Loss:18.5177140
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(18.6531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7430193 KL Loss: 7.1139143 DSM Loss: 9.4903655 Overall Loss:18.3472993
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(20.1501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2188, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7842425 KL Loss: 7.2527621 DSM Loss: 9.4891059 Overall Loss:18.5261104
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(17.6689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7611265 KL Loss: 7.1536987 DSM Loss: 9.5464036 Overall Loss:18.4612288
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(28.8311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7756331 KL Loss: 7.2451057 DSM Loss: 9.3347735 Overall Loss:18.3555123
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(14.3522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.8006164 KL Loss: 7.2465716 DSM Loss: 9.3405988 Overall Loss:18.3877868
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0044962167739868


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.4193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7941407 KL Loss: 7.1962593 DSM Loss: 11.2366543 Overall Loss:20.2270542
Validation loss decreased (inf --> 1.089037).  Saving model ...
Updating learning rate to 0.0005
tensor(27.7466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7371352 KL Loss: 7.1303213 DSM Loss: 9.9247894 Overall Loss:18.7922460
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(17.2563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7672748 KL Loss: 7.0923135 DSM Loss: 9.6648312 Overall Loss:18.5244195
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(27.7556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7776486 KL Loss: 7.2074295 DSM Loss: 9.5023788 Overall Loss:18.4874569
Validation loss decreased (1.089037 --> 1.084063).  Saving model ...
Updating learning rate to 6.25e-05
tensor(24.1381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7658548 KL Loss: 7.1988452 DSM Loss: 9.5980597 Overall Loss:18.5627596
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(17.2268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7986381 KL Loss: 7.2091538 DSM Loss: 9.5300671 Overall Loss:18.5378590
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(18.3149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7893487 KL Loss: 7.2470541 DSM Loss: 9.2051274 Overall Loss:18.2415302
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(16.1148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7510807 KL Loss: 7.0936198 DSM Loss: 9.5593692 Overall Loss:18.4040696
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(16.9204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7736336 KL Loss: 7.2017690 DSM Loss: 9.4841872 Overall Loss:18.4595898
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(15.3403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7533106 KL Loss: 7.2041610 DSM Loss: 9.3057633 Overall Loss:18.2632348
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(19.1123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7589414 KL Loss: 7.1927928 DSM Loss: 9.1871640 Overall Loss:18.1388981
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(20.9495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7730145 KL Loss: 7.1967222 DSM Loss: 9.3323962 Overall Loss:18.3021328
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(17.2250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7745057 KL Loss: 7.2147564 DSM Loss: 9.4745238 Overall Loss:18.4637860
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(16.7638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.8212345 KL Loss: 7.2413377 DSM Loss: 9.5168249 Overall Loss:18.5793971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7096035480499268


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.7530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8549616 KL Loss: 7.2153283 DSM Loss: 11.4866073 Overall Loss:20.5568971
Validation loss decreased (inf --> 1.087566).  Saving model ...
Updating learning rate to 0.0005
tensor(16.3756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8496043 KL Loss: 7.2800786 DSM Loss: 9.8505674 Overall Loss:18.9802502
Validation loss decreased (1.087566 --> 1.080750).  Saving model ...
Updating learning rate to 0.00025
tensor(25.8610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8183811 KL Loss: 7.2138373 DSM Loss: 9.7937986 Overall Loss:18.8260170
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(16.3129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7822233 KL Loss: 7.2622043 DSM Loss: 9.5684409 Overall Loss:18.6128683
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(20.7869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7610429 KL Loss: 7.2000413 DSM Loss: 9.6776546 Overall Loss:18.6387387
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(16.3515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7927, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7994193 KL Loss: 7.2141918 DSM Loss: 9.4743836 Overall Loss:18.4879947
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(14.9476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7351009 KL Loss: 7.1582752 DSM Loss: 9.5392760 Overall Loss:18.4326522
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(21.7107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7416987 KL Loss: 7.1696525 DSM Loss: 9.6245499 Overall Loss:18.5359011
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(14.6924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7839872 KL Loss: 7.2584828 DSM Loss: 9.2932048 Overall Loss:18.3356749
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(17.0456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7597734 KL Loss: 7.1927346 DSM Loss: 9.4857620 Overall Loss:18.4382700
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(15.4849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7634459 KL Loss: 7.2517933 DSM Loss: 9.4409873 Overall Loss:18.4562264
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(21.0274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7464103 KL Loss: 7.1415490 DSM Loss: 9.3268131 Overall Loss:18.2147725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2033426761627197


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.5085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8439990 KL Loss: 7.2390090 DSM Loss: 12.4551362 Overall Loss:21.5381442
Validation loss decreased (inf --> 1.558179).  Saving model ...
Updating learning rate to 0.0005
tensor(24.7158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7842398 KL Loss: 7.1585022 DSM Loss: 10.0957696 Overall Loss:19.0385115
Validation loss decreased (1.558179 --> 1.534879).  Saving model ...
Updating learning rate to 0.00025
tensor(15.2875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8300266 KL Loss: 7.2554068 DSM Loss: 9.8762931 Overall Loss:18.9617265
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(14.6103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8311, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8028610 KL Loss: 7.2345664 DSM Loss: 9.5113293 Overall Loss:18.5487567
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(12.4488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.6585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7774812 KL Loss: 7.1642826 DSM Loss: 9.5792869 Overall Loss:18.5210507
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(14.8712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0331, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7450131 KL Loss: 7.1160641 DSM Loss: 9.5377101 Overall Loss:18.3987871
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(18.1746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4045, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7817234 KL Loss: 7.2767046 DSM Loss: 9.1276312 Overall Loss:18.1860592
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(12.5436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4514, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7371446 KL Loss: 7.0685255 DSM Loss: 9.0248577 Overall Loss:17.8305278
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(20.8622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7599999 KL Loss: 7.1733283 DSM Loss: 9.3139658 Overall Loss:18.2472940
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(29.0570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9793, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7528989 KL Loss: 7.1563216 DSM Loss: 9.5769001 Overall Loss:18.4861205
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(15.0757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8149200 KL Loss: 7.2356735 DSM Loss: 9.5025871 Overall Loss:18.5531806
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(15.7688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5595, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7954920 KL Loss: 7.2864999 DSM Loss: 9.1908799 Overall Loss:18.2728718
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2876139879226685


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.8009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7986444 KL Loss: 7.1943580 DSM Loss: 11.5006918 Overall Loss:20.4936943
Validation loss decreased (inf --> 0.931639).  Saving model ...
Updating learning rate to 0.0005
tensor(23.3308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8115088 KL Loss: 7.2060009 DSM Loss: 9.8785199 Overall Loss:18.8960296
Validation loss decreased (0.931639 --> 0.921736).  Saving model ...
Updating learning rate to 0.00025
tensor(20.5332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7286545 KL Loss: 7.1174253 DSM Loss: 9.7688169 Overall Loss:18.6148968
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(19.2434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7751978 KL Loss: 7.2089973 DSM Loss: 9.4996617 Overall Loss:18.4838568
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(12.4699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7683459 KL Loss: 7.1675147 DSM Loss: 9.4551744 Overall Loss:18.3910350
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(16.5959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5279, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7856628 KL Loss: 7.1556839 DSM Loss: 9.3174608 Overall Loss:18.2588074
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(16.2531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7972670 KL Loss: 7.3330501 DSM Loss: 9.3774282 Overall Loss:18.5077453
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(17.3317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7774982 KL Loss: 7.2619325 DSM Loss: 9.3630270 Overall Loss:18.4024578
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(28.1816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7953121 KL Loss: 7.2786579 DSM Loss: 9.3106865 Overall Loss:18.3846566
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(24.6159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7716840 KL Loss: 7.1677467 DSM Loss: 9.4029213 Overall Loss:18.3423521
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(19.6882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7742596 KL Loss: 7.1522765 DSM Loss: 9.4833278 Overall Loss:18.4098638
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(18.0652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7711815 KL Loss: 7.1926039 DSM Loss: 9.4466665 Overall Loss:18.4104520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7140023708343506


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.5028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7848646 KL Loss: 7.1528734 DSM Loss: 11.9500729 Overall Loss:20.8878107
Validation loss decreased (inf --> 0.707413).  Saving model ...
Updating learning rate to 0.0005
tensor(15.2369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8658922 KL Loss: 7.2561544 DSM Loss: 10.1156145 Overall Loss:19.2376611
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(19.0386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8927585 KL Loss: 7.3862663 DSM Loss: 8.9288787 Overall Loss:18.2079036
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(15.4327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7659188 KL Loss: 7.1134696 DSM Loss: 9.2130306 Overall Loss:18.0924189
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(12.3829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8826884 KL Loss: 7.2839643 DSM Loss: 9.2492713 Overall Loss:18.4159240
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(27.1215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8092236 KL Loss: 7.1506674 DSM Loss: 9.1366939 Overall Loss:18.0965850
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(13.3630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7603547 KL Loss: 7.1095412 DSM Loss: 9.4804707 Overall Loss:18.3503667
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(10.9435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7573139 KL Loss: 7.1113357 DSM Loss: 9.5017522 Overall Loss:18.3704016
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(11.7222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8117110 KL Loss: 7.1569489 DSM Loss: 9.1407578 Overall Loss:18.1094176
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(15.0839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.1964, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7899814 KL Loss: 7.1315791 DSM Loss: 9.5281159 Overall Loss:18.4496765
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(19.1653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7673623 KL Loss: 7.1079063 DSM Loss: 9.5451652 Overall Loss:18.4204338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7498695254325867


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.7855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2704, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9012733 KL Loss: 7.2991617 DSM Loss: 11.9728897 Overall Loss:21.1733245
Validation loss decreased (inf --> 0.529590).  Saving model ...
Updating learning rate to 0.0005
tensor(11.7625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7944083 KL Loss: 7.1477320 DSM Loss: 9.9524609 Overall Loss:18.8946013
Validation loss decreased (0.529590 --> 0.510323).  Saving model ...
Updating learning rate to 0.00025
tensor(18.3579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7871422 KL Loss: 7.1681267 DSM Loss: 9.9604965 Overall Loss:18.9157653
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(15.8314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8453067 KL Loss: 7.1871324 DSM Loss: 9.4454693 Overall Loss:18.4779084
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(13.5955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3686, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7613847 KL Loss: 7.0726034 DSM Loss: 9.2899137 Overall Loss:18.1239018
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(18.5639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7769719 KL Loss: 7.1861531 DSM Loss: 9.4883109 Overall Loss:18.4514359
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(12.1851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7167116 KL Loss: 7.1694247 DSM Loss: 9.4178548 Overall Loss:18.3039913
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(21.3928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8319, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7979029 KL Loss: 7.2588059 DSM Loss: 9.3117601 Overall Loss:18.3684689
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(17.2396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6686, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8171116 KL Loss: 7.3084600 DSM Loss: 9.3024872 Overall Loss:18.4280588
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(13.0578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7703057 KL Loss: 7.0663918 DSM Loss: 9.2589197 Overall Loss:18.0956172
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(22.7705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8345297 KL Loss: 7.2414587 DSM Loss: 9.3160234 Overall Loss:18.3920119
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(12.0002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7576349 KL Loss: 7.1118931 DSM Loss: 9.0500543 Overall Loss:17.9195825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6466008424758911


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.1757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8298805 KL Loss: 7.1864985 DSM Loss: 11.3848436 Overall Loss:20.4012226
Validation loss decreased (inf --> 1.523374).  Saving model ...
Updating learning rate to 0.0005
tensor(17.3978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8607103 KL Loss: 7.3288343 DSM Loss: 9.9741250 Overall Loss:19.1636697
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(14.9495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9306, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8274337 KL Loss: 7.1901528 DSM Loss: 9.8309391 Overall Loss:18.8485257
Validation loss decreased (1.523374 --> 1.511786).  Saving model ...
Updating learning rate to 0.000125
tensor(24.7797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7532360 KL Loss: 7.1713689 DSM Loss: 9.7414302 Overall Loss:18.6660350
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(28.3941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7753235 KL Loss: 7.1820910 DSM Loss: 9.6529484 Overall Loss:18.6103630
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(20.0105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7758414 KL Loss: 7.2233175 DSM Loss: 9.4502946 Overall Loss:18.4494536
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(16.5184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7888700 KL Loss: 7.2228128 DSM Loss: 9.5874542 Overall Loss:18.5991370
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(15.7731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8000204 KL Loss: 7.2756795 DSM Loss: 9.4001682 Overall Loss:18.4758680
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(16.7526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7741104 KL Loss: 7.1708391 DSM Loss: 9.4760893 Overall Loss:18.4210386
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(20.8118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7611263 KL Loss: 7.1995073 DSM Loss: 9.5978973 Overall Loss:18.5585309
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(18.3637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9244, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7827777 KL Loss: 7.2454737 DSM Loss: 9.4658397 Overall Loss:18.4940910
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(25.0709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7817084 KL Loss: 7.1414790 DSM Loss: 9.5125267 Overall Loss:18.4357142
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(19.5769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.8002036 KL Loss: 7.2683074 DSM Loss: 9.3790623 Overall Loss:18.4475732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.709597110748291


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.5803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9221839 KL Loss: 7.2884755 DSM Loss: 12.2639117 Overall Loss:21.4745711
Validation loss decreased (inf --> 1.121675).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7818055 KL Loss: 7.1185114 DSM Loss: 10.4722710 Overall Loss:19.3725879
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(23.8269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7571693 KL Loss: 7.1621637 DSM Loss: 9.8563052 Overall Loss:18.7756382
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(17.3678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7568701 KL Loss: 7.1613767 DSM Loss: 9.6435020 Overall Loss:18.5617489
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(17.0750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1557, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7554438 KL Loss: 7.1761227 DSM Loss: 9.4252275 Overall Loss:18.3567939
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(12.6535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7573161 KL Loss: 7.1283432 DSM Loss: 9.6313889 Overall Loss:18.5170481
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(13.9666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4094, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7748613 KL Loss: 7.1769707 DSM Loss: 9.5088586 Overall Loss:18.4606904
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(23.0846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7654239 KL Loss: 7.2150121 DSM Loss: 9.4816555 Overall Loss:18.4620914
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(25.2621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7898555 KL Loss: 7.2284476 DSM Loss: 9.3894721 Overall Loss:18.4077753
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(12.4840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7177997 KL Loss: 7.0263030 DSM Loss: 9.5261981 Overall Loss:18.2703007
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(20.0895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7918823 KL Loss: 7.2674288 DSM Loss: 9.2681897 Overall Loss:18.3275008
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3660008907318115


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.8027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8774708 KL Loss: 7.3308292 DSM Loss: 12.5093415 Overall Loss:21.7176416
Validation loss decreased (inf --> 0.566831).  Saving model ...
Updating learning rate to 0.0005
tensor(15.4151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7828568 KL Loss: 7.1773529 DSM Loss: 10.3503945 Overall Loss:19.3106041
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(19.5282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8715949 KL Loss: 7.2246162 DSM Loss: 9.7068996 Overall Loss:18.8031107
Validation loss decreased (0.566831 --> 0.566478).  Saving model ...
Updating learning rate to 0.000125
tensor(16.3959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7249982 KL Loss: 7.0519069 DSM Loss: 9.8387764 Overall Loss:18.6156815
Validation loss decreased (0.566478 --> 0.566207).  Saving model ...
Updating learning rate to 6.25e-05
tensor(12.0442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7780819 KL Loss: 7.1172935 DSM Loss: 9.7562332 Overall Loss:18.6516087
Validation loss decreased (0.566207 --> 0.564818).  Saving model ...
Updating learning rate to 3.125e-05
tensor(12.2855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9984, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7855052 KL Loss: 7.2834478 DSM Loss: 9.4251234 Overall Loss:18.4940764
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(14.3253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4227, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7533503 KL Loss: 7.1263119 DSM Loss: 9.6792713 Overall Loss:18.5589335
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(12.0138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7646198 KL Loss: 7.0500139 DSM Loss: 9.6176737 Overall Loss:18.4323073
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(18.9256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7434521 KL Loss: 7.0741332 DSM Loss: 9.6323237 Overall Loss:18.4499090
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(25.0026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5607, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8403403 KL Loss: 7.2998946 DSM Loss: 9.1543276 Overall Loss:18.2945625
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(18.6637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7925730 KL Loss: 7.1831357 DSM Loss: 9.4380110 Overall Loss:18.4137199
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(14.7190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7225938 KL Loss: 7.0912951 DSM Loss: 9.6810353 Overall Loss:18.4949242
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.9235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7242806 KL Loss: 7.1215911 DSM Loss: 9.4836836 Overall Loss:18.3295553
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(40.3693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.8086687 KL Loss: 7.3353364 DSM Loss: 9.0802401 Overall Loss:18.2242453
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(38.4014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7509658 KL Loss: 7.1681256 DSM Loss: 9.4621348 Overall Loss:18.3812262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.877593994140625


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.4401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7410660 KL Loss: 7.0842028 DSM Loss: 12.1138426 Overall Loss:20.9391112
Validation loss decreased (inf --> 0.625040).  Saving model ...
Updating learning rate to 0.0005
tensor(14.7271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8362057 KL Loss: 7.2919380 DSM Loss: 10.1146297 Overall Loss:19.2427733
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(41.0835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7354983 KL Loss: 7.0803065 DSM Loss: 10.1835961 Overall Loss:18.9994008
Validation loss decreased (0.625040 --> 0.617453).  Saving model ...
Updating learning rate to 0.000125
tensor(44.2170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7675181 KL Loss: 7.1071803 DSM Loss: 9.7874025 Overall Loss:18.6621008
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(44.3345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8371, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7223969 KL Loss: 7.1383254 DSM Loss: 9.6187455 Overall Loss:18.4794678
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(39.9285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2489, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7838167 KL Loss: 7.2651008 DSM Loss: 9.5054811 Overall Loss:18.5543987
Validation loss decreased (0.617453 --> 0.615289).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(14.9088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7482956 KL Loss: 7.0928984 DSM Loss: 9.7982407 Overall Loss:18.6394348
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(13.4501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3006, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7337582 KL Loss: 7.1176434 DSM Loss: 9.5573651 Overall Loss:18.4087668
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(13.4644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8122564 KL Loss: 7.2519689 DSM Loss: 9.6782755 Overall Loss:18.7425007
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(19.0154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7341919 KL Loss: 7.1117891 DSM Loss: 9.5854055 Overall Loss:18.4313865
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(12.4703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.4687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7241120 KL Loss: 7.1822341 DSM Loss: 9.7520045 Overall Loss:18.6583506
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(18.3872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7838284 KL Loss: 7.1315258 DSM Loss: 9.5459267 Overall Loss:18.4612809
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.0879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1224, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.8086938 KL Loss: 7.2667830 DSM Loss: 9.2450121 Overall Loss:18.3204889
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(12.2511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7343146 KL Loss: 7.0907445 DSM Loss: 9.7191103 Overall Loss:18.5441693
Validation loss decreased (0.615289 --> 0.615265).  Saving model ...
Updating learning rate to 6.103515625e-08
tensor(10.8774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8688, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7349454 KL Loss: 7.0831590 DSM Loss: 9.7136199 Overall Loss:18.5317242
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-08
tensor(26.1690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7353920 KL Loss: 7.0703790 DSM Loss: 9.8558364 Overall Loss:18.6616073
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-08
tensor(15.3649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5562, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7211349 KL Loss: 7.0505871 DSM Loss: 9.8002666 Overall Loss:18.5719885
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-09
tensor(12.3751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.6209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7630567 KL Loss: 7.1432200 DSM Loss: 9.5246625 Overall Loss:18.4309391
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-09
tensor(10.8629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.7530, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.7756825 KL Loss: 7.3191120 DSM Loss: 9.5146132 Overall Loss:18.6094077
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(12.7551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.7448901 KL Loss: 7.0859954 DSM Loss: 9.6369629 Overall Loss:18.4678483
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(18.6947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 86 | MSE Loss: 1.7416717 KL Loss: 7.1063123 DSM Loss: 9.7939713 Overall Loss:18.6419553
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(12.6003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 86 | MSE Loss: 1.8062720 KL Loss: 7.3095004 DSM Loss: 9.5770419 Overall Loss:18.6928142
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(14.1576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 86 | MSE Loss: 1.7843645 KL Loss: 7.1961082 DSM Loss: 9.5674920 Overall Loss:18.5479647
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(16.0228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 86 | MSE Loss: 1.8067548 KL Loss: 7.3832008 DSM Loss: 9.1600754 Overall Loss:18.3500310
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1278029680252075


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(38.3315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7146, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8228969 KL Loss: 7.1824085 DSM Loss: 12.1694899 Overall Loss:21.1747953
Validation loss decreased (inf --> 0.514707).  Saving model ...
Updating learning rate to 0.0005
tensor(14.7321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7896037 KL Loss: 7.2184276 DSM Loss: 10.0728718 Overall Loss:19.0809031
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(16.5956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7505052 KL Loss: 7.1157006 DSM Loss: 9.9555553 Overall Loss:18.8217611
Validation loss decreased (0.514707 --> 0.512702).  Saving model ...
Updating learning rate to 0.000125
tensor(19.1257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7675452 KL Loss: 7.1415563 DSM Loss: 9.5265228 Overall Loss:18.4356243
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(34.0522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1454, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7394367 KL Loss: 7.1006137 DSM Loss: 9.5841022 Overall Loss:18.4241526
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(19.4534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.5995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.6687239 KL Loss: 7.0285113 DSM Loss: 9.8194937 Overall Loss:18.5167289
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(13.4647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7650320 KL Loss: 7.2462698 DSM Loss: 9.5769489 Overall Loss:18.5882508
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(13.1257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8146119 KL Loss: 7.2790283 DSM Loss: 9.5122093 Overall Loss:18.6058494
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(28.2364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7747824 KL Loss: 7.2652310 DSM Loss: 9.3281121 Overall Loss:18.3681255
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(13.2140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.4860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7669920 KL Loss: 7.1650696 DSM Loss: 9.4610438 Overall Loss:18.3931055
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(22.0390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7839119 KL Loss: 7.1803848 DSM Loss: 9.5277972 Overall Loss:18.4920938
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(14.6580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7700095 KL Loss: 7.1454148 DSM Loss: 9.1609573 Overall Loss:18.0763817
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(14.3490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7860606 KL Loss: 7.2036250 DSM Loss: 9.2924133 Overall Loss:18.2820991
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7989423871040344


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.9486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9294209 KL Loss: 7.3202525 DSM Loss: 12.0372102 Overall Loss:21.2868836
Validation loss decreased (inf --> 0.710224).  Saving model ...
Updating learning rate to 0.0005
tensor(16.4711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6720, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8588073 KL Loss: 7.2468018 DSM Loss: 9.8860402 Overall Loss:18.9916493
Validation loss decreased (0.710224 --> 0.683432).  Saving model ...
Updating learning rate to 0.00025
tensor(16.8511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7408007 KL Loss: 7.1809349 DSM Loss: 9.7265663 Overall Loss:18.6483019
Validation loss decreased (0.683432 --> 0.682081).  Saving model ...
Updating learning rate to 0.000125
tensor(14.2621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7985078 KL Loss: 7.2370832 DSM Loss: 9.5160058 Overall Loss:18.5515968
Validation loss decreased (0.682081 --> 0.681415).  Saving model ...
Updating learning rate to 6.25e-05
tensor(29.0242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7484106 KL Loss: 7.1512464 DSM Loss: 9.5808420 Overall Loss:18.4804989
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(13.4785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4896, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7821036 KL Loss: 7.2456653 DSM Loss: 9.5568647 Overall Loss:18.5846336
Validation loss decreased (0.681415 --> 0.681190).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(15.3424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7642901 KL Loss: 7.1418468 DSM Loss: 9.2518873 Overall Loss:18.1580242
Validation loss decreased (0.681190 --> 0.681109).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(15.1363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7404590 KL Loss: 7.1399578 DSM Loss: 9.3260316 Overall Loss:18.2064483
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(15.1963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8104324 KL Loss: 7.2301440 DSM Loss: 9.5282669 Overall Loss:18.5688433
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(15.8800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7725338 KL Loss: 7.2402063 DSM Loss: 9.5287121 Overall Loss:18.5414522
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(17.4585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7917980 KL Loss: 7.2455332 DSM Loss: 9.4694660 Overall Loss:18.5067972
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(18.2068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7488930 KL Loss: 7.1589314 DSM Loss: 9.5743017 Overall Loss:18.4821260
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(16.0285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7627713 KL Loss: 7.0944327 DSM Loss: 9.4442835 Overall Loss:18.3014875
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(17.0432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7932998 KL Loss: 7.2923201 DSM Loss: 9.4388084 Overall Loss:18.5244283
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(15.7586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7900652 KL Loss: 7.2296468 DSM Loss: 9.4791547 Overall Loss:18.4988667
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(16.0673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7223981 KL Loss: 7.0856748 DSM Loss: 9.6424201 Overall Loss:18.4504930
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(15.2451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.8153240 KL Loss: 7.2271813 DSM Loss: 9.3384899 Overall Loss:18.3809951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7042719125747681


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.9118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9406, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8296428 KL Loss: 7.2602459 DSM Loss: 11.8930670 Overall Loss:20.9829558
Validation loss decreased (inf --> 0.765887).  Saving model ...
Updating learning rate to 0.0005
tensor(21.6889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4704, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7792136 KL Loss: 7.2535602 DSM Loss: 10.2030231 Overall Loss:19.2357968
Validation loss decreased (0.765887 --> 0.714214).  Saving model ...
Updating learning rate to 0.00025
tensor(16.7396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2135, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7936006 KL Loss: 7.1619357 DSM Loss: 9.8266117 Overall Loss:18.7821478
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(18.2451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7920796 KL Loss: 7.2207050 DSM Loss: 9.6941235 Overall Loss:18.7069080
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(32.6572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7718733 KL Loss: 7.1490258 DSM Loss: 9.4203314 Overall Loss:18.3412306
Validation loss decreased (0.714214 --> 0.712741).  Saving model ...
Updating learning rate to 3.125e-05
tensor(15.7810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7185169 KL Loss: 7.1609922 DSM Loss: 9.5889969 Overall Loss:18.4685059
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(13.9771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7686278 KL Loss: 7.1526983 DSM Loss: 9.7163887 Overall Loss:18.6377148
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(13.3230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7947658 KL Loss: 7.2532249 DSM Loss: 9.2912459 Overall Loss:18.3392366
Validation loss decreased (0.712741 --> 0.712676).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(15.2732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8020628 KL Loss: 7.2409408 DSM Loss: 9.5118476 Overall Loss:18.5548511
Validation loss decreased (0.712676 --> 0.712593).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(16.9452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7451387 KL Loss: 7.1773913 DSM Loss: 9.6784944 Overall Loss:18.6010243
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-07
tensor(16.4634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4419, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7801943 KL Loss: 7.1311291 DSM Loss: 9.6287152 Overall Loss:18.5400384
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-07
tensor(12.6363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7853157 KL Loss: 7.2671020 DSM Loss: 9.4788192 Overall Loss:18.5312368
Validation loss decreased (0.712593 --> 0.712573).  Saving model ...
Updating learning rate to 2.44140625e-07
tensor(22.0911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7471846 KL Loss: 7.1791878 DSM Loss: 9.6243402 Overall Loss:18.5507127
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-07
tensor(17.4298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.8193592 KL Loss: 7.2086739 DSM Loss: 9.3182939 Overall Loss:18.3463270
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-08
tensor(13.6397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7609568 KL Loss: 7.2347398 DSM Loss: 9.4530211 Overall Loss:18.4487177
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-08
tensor(19.8071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7660309 KL Loss: 7.1364815 DSM Loss: 9.5321454 Overall Loss:18.4346577
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.52587890625e-08
tensor(18.2526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7545342 KL Loss: 7.2060855 DSM Loss: 9.2701216 Overall Loss:18.2307412
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.62939453125e-09
tensor(19.0816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7894914 KL Loss: 7.1702354 DSM Loss: 9.5233041 Overall Loss:18.4830309
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.814697265625e-09
tensor(18.5367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.7815943 KL Loss: 7.2124352 DSM Loss: 9.4037197 Overall Loss:18.3977491
Validation loss decreased (0.712573 --> 0.712558).  Saving model ...
Updating learning rate to 1.9073486328125e-09
tensor(16.9968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.7072914 KL Loss: 7.1454333 DSM Loss: 9.6477259 Overall Loss:18.5004505
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(14.8117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3958, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 86 | MSE Loss: 1.8129508 KL Loss: 7.3149467 DSM Loss: 9.4308632 Overall Loss:18.5587607
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(13.6336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 86 | MSE Loss: 1.7219305 KL Loss: 7.1575810 DSM Loss: 9.5573563 Overall Loss:18.4368678
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(13.3023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 86 | MSE Loss: 1.7530084 KL Loss: 7.1553031 DSM Loss: 9.6180752 Overall Loss:18.5263866
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(17.0092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 86 | MSE Loss: 1.6847740 KL Loss: 7.1160890 DSM Loss: 9.5523417 Overall Loss:18.3532048
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.960464477539063e-11
tensor(22.7185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 25, Steps: 86 | MSE Loss: 1.7803023 KL Loss: 7.1152299 DSM Loss: 9.6294815 Overall Loss:18.5250137
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.980232238769531e-11
tensor(15.5524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 26, Steps: 86 | MSE Loss: 1.7729850 KL Loss: 7.2089624 DSM Loss: 9.4425917 Overall Loss:18.4245391
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4901161193847657e-11
tensor(17.9627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 27, Steps: 86 | MSE Loss: 1.7705371 KL Loss: 7.1884022 DSM Loss: 9.6512724 Overall Loss:18.6102117
Validation loss decreased (0.712558 --> 0.712544).  Saving model ...
Updating learning rate to 7.450580596923828e-12
tensor(18.6869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 28, Steps: 86 | MSE Loss: 1.7573265 KL Loss: 7.1349333 DSM Loss: 9.5802400 Overall Loss:18.4724997
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.725290298461914e-12
tensor(21.4354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1142, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 29, Steps: 86 | MSE Loss: 1.7739485 KL Loss: 7.1402288 DSM Loss: 9.5936674 Overall Loss:18.5078447
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.862645149230957e-12
tensor(17.0951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5343, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 30, Steps: 86 | MSE Loss: 1.7667877 KL Loss: 7.1993143 DSM Loss: 9.6264583 Overall Loss:18.5925604
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.313225746154785e-13
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5189656019210815


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(30.8089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7945550 KL Loss: 7.2263192 DSM Loss: 11.6432611 Overall Loss:20.6641353
Validation loss decreased (inf --> 1.308445).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8098263 KL Loss: 7.2069588 DSM Loss: 10.1213520 Overall Loss:19.1381370
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(19.9819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8145073 KL Loss: 7.2571094 DSM Loss: 9.6757813 Overall Loss:18.7473980
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(15.2838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7827843 KL Loss: 7.2563935 DSM Loss: 9.3767288 Overall Loss:18.4159065
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(21.5994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7809420 KL Loss: 7.1338417 DSM Loss: 9.6823111 Overall Loss:18.5970946
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(16.0805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7205, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7585415 KL Loss: 7.1822781 DSM Loss: 9.5415363 Overall Loss:18.4823558
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(18.8314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7637952 KL Loss: 7.1800342 DSM Loss: 9.5204731 Overall Loss:18.4643025
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(17.0794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7505966 KL Loss: 7.1474949 DSM Loss: 9.5165477 Overall Loss:18.4146391
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(16.1078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7866177 KL Loss: 7.2839265 DSM Loss: 9.2253514 Overall Loss:18.2958957
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(22.4252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7391, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7772922 KL Loss: 7.2264637 DSM Loss: 9.3484681 Overall Loss:18.3522240
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(16.9127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7699857 KL Loss: 7.2101816 DSM Loss: 9.4814251 Overall Loss:18.4615924
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7550681829452515


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.1797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8018097 KL Loss: 7.1859759 DSM Loss: 11.6240083 Overall Loss:20.6117939
Validation loss decreased (inf --> 1.244977).  Saving model ...
Updating learning rate to 0.0005
tensor(39.2794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7584436 KL Loss: 7.1697235 DSM Loss: 9.9335971 Overall Loss:18.8617641
Validation loss decreased (1.244977 --> 1.237276).  Saving model ...
Updating learning rate to 0.00025
tensor(24.2446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7868722 KL Loss: 7.1220302 DSM Loss: 9.8657583 Overall Loss:18.7746607
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(12.9355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7758257 KL Loss: 7.1577916 DSM Loss: 9.8506782 Overall Loss:18.7842955
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(14.6116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7162025 KL Loss: 7.2132984 DSM Loss: 9.4625697 Overall Loss:18.3920707
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(14.2717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8121460 KL Loss: 7.2750604 DSM Loss: 9.2004985 Overall Loss:18.2877050
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(14.9487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3952, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7746879 KL Loss: 7.2017630 DSM Loss: 9.2863535 Overall Loss:18.2628043
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(18.6355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7475711 KL Loss: 7.1070283 DSM Loss: 9.0651943 Overall Loss:17.9197938
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(15.3698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7465435 KL Loss: 7.1438010 DSM Loss: 9.5431648 Overall Loss:18.4335093
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(14.5631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.4320, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7442055 KL Loss: 7.1219191 DSM Loss: 9.4197566 Overall Loss:18.2858811
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(35.0983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7040, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7786498 KL Loss: 7.1844425 DSM Loss: 9.4255659 Overall Loss:18.3886581
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(15.7633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7834366 KL Loss: 7.2146431 DSM Loss: 9.2817530 Overall Loss:18.2798328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0035488605499268


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.5078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8387578 KL Loss: 7.2752040 DSM Loss: 12.0978390 Overall Loss:21.2118007
Validation loss decreased (inf --> 0.891995).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8384486 KL Loss: 7.2466820 DSM Loss: 9.9734741 Overall Loss:19.0586048
Validation loss decreased (0.891995 --> 0.822229).  Saving model ...
Updating learning rate to 0.00025
tensor(12.2597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7502353 KL Loss: 7.1611298 DSM Loss: 9.6464324 Overall Loss:18.5577975
Validation loss decreased (0.822229 --> 0.814584).  Saving model ...
Updating learning rate to 0.000125
tensor(13.6000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7752921 KL Loss: 7.1531268 DSM Loss: 9.7870866 Overall Loss:18.7155056
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(16.7995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7987, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7698943 KL Loss: 7.1963983 DSM Loss: 9.5925149 Overall Loss:18.5588074
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(13.6231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8086356 KL Loss: 7.3008787 DSM Loss: 9.4882846 Overall Loss:18.5977987
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(36.1714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7914766 KL Loss: 7.1379262 DSM Loss: 9.4598794 Overall Loss:18.3892822
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(16.7067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7991745 KL Loss: 7.1929435 DSM Loss: 9.3238181 Overall Loss:18.3159360
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(13.8439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7268346 KL Loss: 7.1175193 DSM Loss: 9.5157016 Overall Loss:18.3600555
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(15.5742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7421004 KL Loss: 7.2362259 DSM Loss: 9.3476647 Overall Loss:18.3259910
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(27.2035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7828626 KL Loss: 7.2393277 DSM Loss: 9.5377628 Overall Loss:18.5599531
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(14.7551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0846, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7699945 KL Loss: 7.2153202 DSM Loss: 9.3764055 Overall Loss:18.3617203
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(19.8728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7942448 KL Loss: 7.2085478 DSM Loss: 9.3360427 Overall Loss:18.3388354
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7084189653396606


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(20.8388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0646, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8136531 KL Loss: 7.2017266 DSM Loss: 12.4882812 Overall Loss:21.5036609
Validation loss decreased (inf --> 1.415040).  Saving model ...
Updating learning rate to 0.0005
tensor(20.1037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8113395 KL Loss: 7.1849343 DSM Loss: 10.2074875 Overall Loss:19.2037612
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(23.8492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7263355 KL Loss: 7.1569896 DSM Loss: 9.6262313 Overall Loss:18.5095564
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(16.3299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7889750 KL Loss: 7.1693881 DSM Loss: 9.5468759 Overall Loss:18.5052390
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(19.4178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4035, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8202705 KL Loss: 7.2013953 DSM Loss: 9.4093069 Overall Loss:18.4309727
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(20.9201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7919487 KL Loss: 7.1337303 DSM Loss: 9.5212103 Overall Loss:18.4468893
Validation loss decreased (1.415040 --> 1.414976).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(17.5444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7303847 KL Loss: 7.1390780 DSM Loss: 9.5942154 Overall Loss:18.4636781
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(19.4903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4874, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7042312 KL Loss: 7.1580474 DSM Loss: 9.3668252 Overall Loss:18.2291038
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(19.7102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7786610 KL Loss: 7.2034702 DSM Loss: 9.3903983 Overall Loss:18.3725294
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(12.9621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9831, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7202143 KL Loss: 7.0630103 DSM Loss: 9.5214960 Overall Loss:18.3047206
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(15.7079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7544871 KL Loss: 7.1366247 DSM Loss: 9.5003231 Overall Loss:18.3914349
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(20.5929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7586843 KL Loss: 7.1424256 DSM Loss: 9.3199934 Overall Loss:18.2211033
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.7287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7955, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7946735 KL Loss: 7.1657994 DSM Loss: 9.3190454 Overall Loss:18.2795183
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(22.1616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7497925 KL Loss: 7.1464348 DSM Loss: 9.4369179 Overall Loss:18.3331452
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(17.5216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0203, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7494040 KL Loss: 7.1784369 DSM Loss: 9.4344006 Overall Loss:18.3622414
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(22.6089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7931454 KL Loss: 7.1369446 DSM Loss: 9.3262511 Overall Loss:18.2563410
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0098026990890503


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(40.3908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7993674 KL Loss: 7.2516699 DSM Loss: 11.9582143 Overall Loss:21.0092515
Validation loss decreased (inf --> 0.360124).  Saving model ...
Updating learning rate to 0.0005
tensor(20.5267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1856, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7525860 KL Loss: 7.1643286 DSM Loss: 10.0482719 Overall Loss:18.9651865
Validation loss decreased (0.360124 --> 0.346517).  Saving model ...
Updating learning rate to 0.00025
tensor(27.8009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4863, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7598633 KL Loss: 7.1172422 DSM Loss: 9.7358144 Overall Loss:18.6129199
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(15.0579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7899113 KL Loss: 7.2489212 DSM Loss: 9.4505201 Overall Loss:18.4893525
Validation loss decreased (0.346517 --> 0.344089).  Saving model ...
Updating learning rate to 6.25e-05
tensor(22.0329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7886287 KL Loss: 7.2005622 DSM Loss: 9.5321527 Overall Loss:18.5213436
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(16.8947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7524982 KL Loss: 7.1160726 DSM Loss: 9.4213953 Overall Loss:18.2899661
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(16.8884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7815594 KL Loss: 7.2612591 DSM Loss: 9.3119023 Overall Loss:18.3547208
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(13.9023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7780695 KL Loss: 7.2328378 DSM Loss: 9.4495096 Overall Loss:18.4604169
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(43.2314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7544989 KL Loss: 7.1161765 DSM Loss: 9.4741978 Overall Loss:18.3448732
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(22.0676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7995664 KL Loss: 7.2635038 DSM Loss: 9.4539824 Overall Loss:18.5170527
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(13.6203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.4719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7933761 KL Loss: 7.1994016 DSM Loss: 9.5045247 Overall Loss:18.4973024
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(12.7170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7251873 KL Loss: 7.1459216 DSM Loss: 9.5768368 Overall Loss:18.4479458
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.9573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7564871 KL Loss: 7.1245978 DSM Loss: 9.5824220 Overall Loss:18.4635070
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(42.7570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7559443 KL Loss: 7.0855359 DSM Loss: 9.5047215 Overall Loss:18.3462017
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.0020358562469482


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.4586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8328947 KL Loss: 7.3550639 DSM Loss: 13.7526204 Overall Loss:22.9405792
Validation loss decreased (inf --> 0.949259).  Saving model ...
Updating learning rate to 0.0005
tensor(22.3165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8746603 KL Loss: 7.2742462 DSM Loss: 9.8883909 Overall Loss:19.0372973
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(16.7679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7620280 KL Loss: 7.1849529 DSM Loss: 9.6488918 Overall Loss:18.5958728
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(14.1757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7818445 KL Loss: 7.1901019 DSM Loss: 9.3266630 Overall Loss:18.2986094
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(22.1252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7334728 KL Loss: 7.0840285 DSM Loss: 9.6115781 Overall Loss:18.4290793
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(19.9524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2696, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7045100 KL Loss: 7.0887667 DSM Loss: 9.3785145 Overall Loss:18.1717912
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(18.8096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7389325 KL Loss: 7.1571778 DSM Loss: 9.4010201 Overall Loss:18.2971305
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(16.7558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0092, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7753843 KL Loss: 7.2004461 DSM Loss: 9.2992911 Overall Loss:18.2751214
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(12.0983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7358221 KL Loss: 7.1175837 DSM Loss: 9.3090716 Overall Loss:18.1624774
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(23.4830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7728241 KL Loss: 7.2096063 DSM Loss: 9.4641706 Overall Loss:18.4466011
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(14.3451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7685518 KL Loss: 7.2477797 DSM Loss: 9.4063593 Overall Loss:18.4226909
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.376818060874939


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.7512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8197, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8527356 KL Loss: 7.3516728 DSM Loss: 12.0505723 Overall Loss:21.2549806
Validation loss decreased (inf --> 0.742485).  Saving model ...
Updating learning rate to 0.0005
tensor(13.6584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8710066 KL Loss: 7.2524562 DSM Loss: 10.0552156 Overall Loss:19.1786783
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(12.5195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1359, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7836115 KL Loss: 7.2288388 DSM Loss: 9.8037811 Overall Loss:18.8162313
Validation loss decreased (0.742485 --> 0.741666).  Saving model ...
Updating learning rate to 0.000125
tensor(11.8072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7412051 KL Loss: 7.1065041 DSM Loss: 9.7267562 Overall Loss:18.5744654
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(15.1443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8404446 KL Loss: 7.2660640 DSM Loss: 9.4699944 Overall Loss:18.5765030
Validation loss decreased (0.741666 --> 0.739188).  Saving model ...
Updating learning rate to 3.125e-05
tensor(14.6691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7848697 KL Loss: 7.2435402 DSM Loss: 9.4694907 Overall Loss:18.4979006
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(13.4995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7979237 KL Loss: 7.2232379 DSM Loss: 9.4382964 Overall Loss:18.4594580
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(16.1650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7414010 KL Loss: 7.0673131 DSM Loss: 9.6571663 Overall Loss:18.4658804
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(15.5793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7512502 KL Loss: 7.1057504 DSM Loss: 9.3617796 Overall Loss:18.2187803
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(18.3152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7748423 KL Loss: 7.2060366 DSM Loss: 9.3567943 Overall Loss:18.3376733
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(16.4857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0331, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8026835 KL Loss: 7.2293568 DSM Loss: 9.5690886 Overall Loss:18.6011290
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(17.8649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7426071 KL Loss: 7.1886172 DSM Loss: 9.4034303 Overall Loss:18.3346545
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(14.0010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7855913 KL Loss: 7.1839193 DSM Loss: 9.4200406 Overall Loss:18.3895511
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(15.1035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7851208 KL Loss: 7.1416880 DSM Loss: 9.6213887 Overall Loss:18.5481975
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(17.3672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7844848 KL Loss: 7.2040520 DSM Loss: 9.4264652 Overall Loss:18.4150020
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.731558620929718


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(20.5083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8224421 KL Loss: 7.2516130 DSM Loss: 11.1957354 Overall Loss:20.2697904
Validation loss decreased (inf --> 0.778878).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8148842 KL Loss: 7.2250602 DSM Loss: 10.1444539 Overall Loss:19.1843984
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(16.2757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8596237 KL Loss: 7.2540823 DSM Loss: 9.7330611 Overall Loss:18.8467670
Validation loss decreased (0.778878 --> 0.771734).  Saving model ...
Updating learning rate to 0.000125
tensor(29.8167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7643300 KL Loss: 7.1927107 DSM Loss: 9.8627655 Overall Loss:18.8198060
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(14.0458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7190190 KL Loss: 7.0701654 DSM Loss: 9.4934799 Overall Loss:18.2826643
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(31.7955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7621466 KL Loss: 7.1755916 DSM Loss: 9.5697349 Overall Loss:18.5074732
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(20.7272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8543373 KL Loss: 7.3906499 DSM Loss: 9.1725371 Overall Loss:18.4175242
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(13.9378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7285209 KL Loss: 7.0754300 DSM Loss: 9.6532121 Overall Loss:18.4571629
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(16.6627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6565, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7830422 KL Loss: 7.1815439 DSM Loss: 9.6080741 Overall Loss:18.5726601
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(11.2608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7593970 KL Loss: 7.1919063 DSM Loss: 9.5914891 Overall Loss:18.5427924
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(20.2809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7762373 KL Loss: 7.1969931 DSM Loss: 9.5364802 Overall Loss:18.5097106
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(13.1089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.8019118 KL Loss: 7.2994078 DSM Loss: 9.0095303 Overall Loss:18.1108500
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.0277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7875966 KL Loss: 7.2144772 DSM Loss: 9.5153766 Overall Loss:18.5174505
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6570430994033813


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(30.3103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8325204 KL Loss: 7.2585059 DSM Loss: 11.5049478 Overall Loss:20.5959741
Validation loss decreased (inf --> 0.807370).  Saving model ...
Updating learning rate to 0.0005
tensor(13.3614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7249674 KL Loss: 7.1291869 DSM Loss: 10.1779119 Overall Loss:19.0320662
Validation loss decreased (0.807370 --> 0.806262).  Saving model ...
Updating learning rate to 0.00025
tensor(21.7152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7882842 KL Loss: 7.1662351 DSM Loss: 9.7302824 Overall Loss:18.6848018
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(24.4436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7806993 KL Loss: 7.1510331 DSM Loss: 9.8488749 Overall Loss:18.7806072
Validation loss decreased (0.806262 --> 0.806164).  Saving model ...
Updating learning rate to 6.25e-05
tensor(40.5356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8927, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7830284 KL Loss: 7.2215921 DSM Loss: 9.5936406 Overall Loss:18.5982611
Validation loss decreased (0.806164 --> 0.805706).  Saving model ...
Updating learning rate to 3.125e-05
tensor(14.8447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7572358 KL Loss: 7.1873869 DSM Loss: 9.7917966 Overall Loss:18.7364193
Validation loss decreased (0.805706 --> 0.805571).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(27.6229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4331, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8190562 KL Loss: 7.2672322 DSM Loss: 9.5336522 Overall Loss:18.6199405
Validation loss decreased (0.805571 --> 0.805545).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(14.9853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0417, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8101654 KL Loss: 7.3097817 DSM Loss: 9.4359645 Overall Loss:18.5559116
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(14.5841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8145682 KL Loss: 7.1860761 DSM Loss: 9.5879168 Overall Loss:18.5885611
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(27.1399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7687864 KL Loss: 7.1825098 DSM Loss: 9.6254850 Overall Loss:18.5767812
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(22.9355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7504011 KL Loss: 7.2055617 DSM Loss: 9.5996431 Overall Loss:18.5556059
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(15.2718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.8101292 KL Loss: 7.2654253 DSM Loss: 9.3492381 Overall Loss:18.4247927
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.3777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7896130 KL Loss: 7.1529249 DSM Loss: 9.4609913 Overall Loss:18.4035292
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(13.9784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.8534725 KL Loss: 7.3896091 DSM Loss: 9.1840386 Overall Loss:18.4271202
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(23.6810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2071, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7541921 KL Loss: 7.1086840 DSM Loss: 9.6048737 Overall Loss:18.4677498
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(35.8948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.3978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7878383 KL Loss: 7.1184344 DSM Loss: 9.4764488 Overall Loss:18.3827213
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(13.4051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6359, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.8056412 KL Loss: 7.2444289 DSM Loss: 9.4290818 Overall Loss:18.4791518
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6190666556358337


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.7420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7933221 KL Loss: 7.1908878 DSM Loss: 11.9596193 Overall Loss:20.9438292
Validation loss decreased (inf --> 1.159245).  Saving model ...
Updating learning rate to 0.0005
tensor(13.6746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6413, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8317903 KL Loss: 7.2279110 DSM Loss: 9.9314775 Overall Loss:18.9911787
Validation loss decreased (1.159245 --> 1.158132).  Saving model ...
Updating learning rate to 0.00025
tensor(15.5212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7683701 KL Loss: 7.1757804 DSM Loss: 9.8608293 Overall Loss:18.8049799
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(27.6455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7650521 KL Loss: 7.1966213 DSM Loss: 9.8822319 Overall Loss:18.8439054
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(24.8900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7094832 KL Loss: 7.1371341 DSM Loss: 9.7029736 Overall Loss:18.5495910
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(13.5808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7514502 KL Loss: 7.1464048 DSM Loss: 9.6412446 Overall Loss:18.5390996
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(13.8726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7880817 KL Loss: 7.1692916 DSM Loss: 9.5461647 Overall Loss:18.5035379
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(23.9170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7924970 KL Loss: 7.2458301 DSM Loss: 9.2888600 Overall Loss:18.3271869
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(15.0838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7649093 KL Loss: 7.1278723 DSM Loss: 9.6305360 Overall Loss:18.5233177
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(15.1222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7597764 KL Loss: 7.1833288 DSM Loss: 9.5499637 Overall Loss:18.4930692
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(13.2818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7562975 KL Loss: 7.1305595 DSM Loss: 9.3583399 Overall Loss:18.2451969
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(12.4938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.6999222 KL Loss: 7.0383171 DSM Loss: 9.6600785 Overall Loss:18.3983177
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.827932596206665


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.1145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8452591 KL Loss: 7.2786508 DSM Loss: 11.5877537 Overall Loss:20.7116636
Validation loss decreased (inf --> 1.429533).  Saving model ...
Updating learning rate to 0.0005
tensor(25.4301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7745795 KL Loss: 7.1766008 DSM Loss: 10.1079183 Overall Loss:19.0590985
Validation loss decreased (1.429533 --> 1.417713).  Saving model ...
Updating learning rate to 0.00025
tensor(14.3386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8197311 KL Loss: 7.2587259 DSM Loss: 9.6042702 Overall Loss:18.6827272
Validation loss decreased (1.417713 --> 1.411468).  Saving model ...
Updating learning rate to 0.000125
tensor(21.0470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7991876 KL Loss: 7.1588856 DSM Loss: 9.5056176 Overall Loss:18.4636908
Validation loss decreased (1.411468 --> 1.409610).  Saving model ...
Updating learning rate to 6.25e-05
tensor(14.2251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7932184 KL Loss: 7.2545641 DSM Loss: 9.4958949 Overall Loss:18.5436774
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(12.0796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7299, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8218725 KL Loss: 7.1701565 DSM Loss: 9.6750429 Overall Loss:18.6670720
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(17.3860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7950725 KL Loss: 7.1710308 DSM Loss: 9.4712579 Overall Loss:18.4373612
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(15.6989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7051975 KL Loss: 7.1414311 DSM Loss: 9.5229649 Overall Loss:18.3695934
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(23.0021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7575488 KL Loss: 7.1779479 DSM Loss: 9.4627451 Overall Loss:18.3982417
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(21.2926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7633210 KL Loss: 7.1653950 DSM Loss: 9.4580039 Overall Loss:18.3867198
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(15.0510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9094, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7351631 KL Loss: 7.1576685 DSM Loss: 9.2743030 Overall Loss:18.1671346
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(13.8060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7996128 KL Loss: 7.2040033 DSM Loss: 9.0724897 Overall Loss:18.0761058
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.3456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7792591 KL Loss: 7.1138106 DSM Loss: 9.4395626 Overall Loss:18.3326323
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(14.4482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3534, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.8050412 KL Loss: 7.1993628 DSM Loss: 9.0870043 Overall Loss:18.0914082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.613294780254364


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.4436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8080647 KL Loss: 7.1977645 DSM Loss: 12.6275933 Overall Loss:21.6334225
Validation loss decreased (inf --> 0.633088).  Saving model ...
Updating learning rate to 0.0005
tensor(32.1418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8108685 KL Loss: 7.2411492 DSM Loss: 10.4815164 Overall Loss:19.5335341
Validation loss decreased (0.633088 --> 0.628895).  Saving model ...
Updating learning rate to 0.00025
tensor(17.8949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8346013 KL Loss: 7.2408038 DSM Loss: 9.7126939 Overall Loss:18.7880990
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(12.3398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7927378 KL Loss: 7.1709722 DSM Loss: 9.6049341 Overall Loss:18.5686442
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(14.4577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7376867 KL Loss: 7.0841825 DSM Loss: 9.3393947 Overall Loss:18.1612640
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(17.4905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8437217 KL Loss: 7.3299923 DSM Loss: 9.4949850 Overall Loss:18.6686990
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(14.7728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8053968 KL Loss: 7.2632263 DSM Loss: 9.4432719 Overall Loss:18.5118950
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(13.9564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7928848 KL Loss: 7.1735644 DSM Loss: 9.5811122 Overall Loss:18.5475613
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(15.1818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.4918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8638582 KL Loss: 7.4295422 DSM Loss: 9.2702726 Overall Loss:18.5636729
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(19.2179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8317364 KL Loss: 7.2819223 DSM Loss: 9.1905433 Overall Loss:18.3042020
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(16.6347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7744536 KL Loss: 7.1072554 DSM Loss: 9.4107229 Overall Loss:18.2924320
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(12.5330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7975816 KL Loss: 7.1629787 DSM Loss: 9.5061472 Overall Loss:18.4667074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.4964134991168976


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(35.3161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8669129 KL Loss: 7.2809355 DSM Loss: 11.7189937 Overall Loss:20.8668420
Validation loss decreased (inf --> 0.985041).  Saving model ...
Updating learning rate to 0.0005
tensor(31.9509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3296, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8426733 KL Loss: 7.2618080 DSM Loss: 9.9700205 Overall Loss:19.0745017
Validation loss decreased (0.985041 --> 0.969978).  Saving model ...
Updating learning rate to 0.00025
tensor(24.0282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7541631 KL Loss: 7.1348562 DSM Loss: 9.9233985 Overall Loss:18.8124177
Validation loss decreased (0.969978 --> 0.965182).  Saving model ...
Updating learning rate to 0.000125
tensor(13.8475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8232454 KL Loss: 7.2548607 DSM Loss: 9.5903642 Overall Loss:18.6684702
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(14.4318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4987, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7777600 KL Loss: 7.1186572 DSM Loss: 9.5439367 Overall Loss:18.4403540
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(25.9503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7383486 KL Loss: 7.1393831 DSM Loss: 9.5781514 Overall Loss:18.4558831
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(18.3864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7327766 KL Loss: 7.1212208 DSM Loss: 9.5250052 Overall Loss:18.3790026
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(11.0676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7986524 KL Loss: 7.2427015 DSM Loss: 9.4594824 Overall Loss:18.5008363
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(12.7670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7758476 KL Loss: 7.1550456 DSM Loss: 9.3506847 Overall Loss:18.2815778
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(18.8899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7744162 KL Loss: 7.1422569 DSM Loss: 9.5766293 Overall Loss:18.4933024
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(20.1632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7588938 KL Loss: 7.1707488 DSM Loss: 9.6011112 Overall Loss:18.5307537
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(17.1348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7381597 KL Loss: 7.0864547 DSM Loss: 9.5527796 Overall Loss:18.3773937
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(16.4999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7495172 KL Loss: 7.1698837 DSM Loss: 9.4704331 Overall Loss:18.3898338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9496859908103943


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.5015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8412446 KL Loss: 7.2352721 DSM Loss: 11.2729124 Overall Loss:20.3494291
Validation loss decreased (inf --> 0.800945).  Saving model ...
Updating learning rate to 0.0005
tensor(13.7755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7701870 KL Loss: 7.0968918 DSM Loss: 10.2213703 Overall Loss:19.0884490
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(17.3541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8081819 KL Loss: 7.2293438 DSM Loss: 9.5126473 Overall Loss:18.5501731
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(16.2056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7807881 KL Loss: 7.1936508 DSM Loss: 9.5162429 Overall Loss:18.4906818
Validation loss decreased (0.800945 --> 0.787154).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.7205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7299003 KL Loss: 7.1576984 DSM Loss: 9.5747778 Overall Loss:18.4623765
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(18.1019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8153, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7781112 KL Loss: 7.1802072 DSM Loss: 9.6251574 Overall Loss:18.5834758
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(30.7808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3119, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7887071 KL Loss: 7.2665489 DSM Loss: 9.5164095 Overall Loss:18.5716655
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(17.0898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7766459 KL Loss: 7.1904630 DSM Loss: 9.5266567 Overall Loss:18.4937656
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(14.4614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8051205 KL Loss: 7.2289209 DSM Loss: 9.5318817 Overall Loss:18.5659230
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(26.5149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7849187 KL Loss: 7.2220143 DSM Loss: 9.2674990 Overall Loss:18.2744319
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(26.4030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0135, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8194770 KL Loss: 7.2940633 DSM Loss: 9.1164823 Overall Loss:18.2300225
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.1541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.8127189 KL Loss: 7.2458441 DSM Loss: 9.5988158 Overall Loss:18.6573789
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(17.4338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7407302 KL Loss: 7.0795706 DSM Loss: 9.6104033 Overall Loss:18.4307042
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(18.5557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7844406 KL Loss: 7.1755578 DSM Loss: 9.5102798 Overall Loss:18.4702781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3903337717056274


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(44.8680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9241519 KL Loss: 7.3075891 DSM Loss: 11.8065213 Overall Loss:21.0382622
Validation loss decreased (inf --> 0.826362).  Saving model ...
Updating learning rate to 0.0005
tensor(20.5433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7761419 KL Loss: 7.1118172 DSM Loss: 10.1714067 Overall Loss:19.0593658
Validation loss decreased (0.826362 --> 0.824281).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8044682 KL Loss: 7.2229484 DSM Loss: 9.7729490 Overall Loss:18.8003655
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(24.4519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7326111 KL Loss: 7.1453421 DSM Loss: 9.7255082 Overall Loss:18.6034614
Validation loss decreased (0.824281 --> 0.822507).  Saving model ...
Updating learning rate to 6.25e-05
tensor(26.7718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7874695 KL Loss: 7.1554606 DSM Loss: 9.5669112 Overall Loss:18.5098413
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(17.0610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7218219 KL Loss: 7.1529731 DSM Loss: 9.5053375 Overall Loss:18.3801325
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(17.7961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1595, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7752989 KL Loss: 7.1769784 DSM Loss: 9.5374549 Overall Loss:18.4897323
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(15.7247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7247586 KL Loss: 7.1383322 DSM Loss: 9.6449313 Overall Loss:18.5080222
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(15.1399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3602, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7752895 KL Loss: 7.2232067 DSM Loss: 9.3850341 Overall Loss:18.3835303
Validation loss decreased (0.822507 --> 0.822388).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(16.1506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7391148 KL Loss: 7.1195272 DSM Loss: 9.5948346 Overall Loss:18.4534766
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-07
tensor(18.2766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7574968 KL Loss: 7.1329490 DSM Loss: 9.4068628 Overall Loss:18.2973086
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-07
tensor(28.8559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1452, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7503676 KL Loss: 7.1337257 DSM Loss: 9.5465908 Overall Loss:18.4306842
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-07
tensor(15.0586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7849743 KL Loss: 7.2488856 DSM Loss: 9.3699269 Overall Loss:18.4037869
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-07
tensor(24.0336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7662359 KL Loss: 7.2087646 DSM Loss: 9.3977031 Overall Loss:18.3727036
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-08
tensor(17.8605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3957, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7358481 KL Loss: 7.1970335 DSM Loss: 9.5572461 Overall Loss:18.4901277
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-08
tensor(16.3296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7642722 KL Loss: 7.1574333 DSM Loss: 9.4864270 Overall Loss:18.4081327
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-08
tensor(14.6115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7745433 KL Loss: 7.2003629 DSM Loss: 9.5942211 Overall Loss:18.5691274
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-09
tensor(25.4947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7445488 KL Loss: 7.1790001 DSM Loss: 9.5997222 Overall Loss:18.5232711
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-09
tensor(17.8791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.7828790 KL Loss: 7.1833916 DSM Loss: 9.5640299 Overall Loss:18.5303005
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.739669144153595


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.3147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8005667 KL Loss: 7.2007883 DSM Loss: 11.7076788 Overall Loss:20.7090338
Validation loss decreased (inf --> 1.407428).  Saving model ...
Updating learning rate to 0.0005
tensor(19.1466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8127571 KL Loss: 7.2348702 DSM Loss: 10.1777276 Overall Loss:19.2253548
Validation loss decreased (1.407428 --> 1.400641).  Saving model ...
Updating learning rate to 0.00025
tensor(18.2774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7886542 KL Loss: 7.2929207 DSM Loss: 9.6419065 Overall Loss:18.7234814
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(21.6835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7790619 KL Loss: 7.1654835 DSM Loss: 9.6067345 Overall Loss:18.5512799
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(17.0356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7810861 KL Loss: 7.2475143 DSM Loss: 9.5040859 Overall Loss:18.5326861
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(17.8681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7921716 KL Loss: 7.2190089 DSM Loss: 9.5798639 Overall Loss:18.5910443
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(17.8909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7766867 KL Loss: 7.1670463 DSM Loss: 9.4455478 Overall Loss:18.3892808
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(14.1281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7494440 KL Loss: 7.2013105 DSM Loss: 9.5550532 Overall Loss:18.5058078
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(16.5215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0417, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7640533 KL Loss: 7.1704342 DSM Loss: 9.5737810 Overall Loss:18.5082685
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(16.5479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7612398 KL Loss: 7.1847765 DSM Loss: 9.4749740 Overall Loss:18.4209903
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(15.6048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7916342 KL Loss: 7.2439673 DSM Loss: 9.4075916 Overall Loss:18.4431930
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(15.1754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7561343 KL Loss: 7.1788531 DSM Loss: 9.5305343 Overall Loss:18.4655216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8168066740036011


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.4937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7630, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8125732 KL Loss: 7.2774903 DSM Loss: 12.1227024 Overall Loss:21.2127660
Validation loss decreased (inf --> 1.173443).  Saving model ...
Updating learning rate to 0.0005
tensor(19.8295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8536327 KL Loss: 7.2310722 DSM Loss: 10.1935622 Overall Loss:19.2782672
Validation loss decreased (1.173443 --> 1.171816).  Saving model ...
Updating learning rate to 0.00025
tensor(12.5456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8061036 KL Loss: 7.1973998 DSM Loss: 9.6538310 Overall Loss:18.6573342
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(17.9445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4686, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7972077 KL Loss: 7.2208763 DSM Loss: 9.5656734 Overall Loss:18.5837576
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(20.9483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7525002 KL Loss: 7.1914656 DSM Loss: 9.5577840 Overall Loss:18.5017498
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(14.6775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7950236 KL Loss: 7.2138887 DSM Loss: 9.4379138 Overall Loss:18.4468260
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(15.1113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3370, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7645025 KL Loss: 7.1842467 DSM Loss: 9.5020619 Overall Loss:18.4508111
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(14.0171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7739086 KL Loss: 7.1101467 DSM Loss: 9.4288972 Overall Loss:18.3129524
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(14.3214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7272472 KL Loss: 7.1386331 DSM Loss: 9.5426513 Overall Loss:18.4085316
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(21.3247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7466214 KL Loss: 7.1772358 DSM Loss: 9.4165376 Overall Loss:18.3403948
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(20.8406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5662, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7294776 KL Loss: 7.0811977 DSM Loss: 9.4786777 Overall Loss:18.2893530
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(17.5706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7227070 KL Loss: 7.1613039 DSM Loss: 9.5614405 Overall Loss:18.4454515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2068346738815308


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.6331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6334, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8574443 KL Loss: 7.3319494 DSM Loss: 12.5084524 Overall Loss:21.6978461
Validation loss decreased (inf --> 1.366201).  Saving model ...
Updating learning rate to 0.0005
tensor(12.8770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8125411 KL Loss: 7.2164851 DSM Loss: 9.6624730 Overall Loss:18.6914992
Validation loss decreased (1.366201 --> 1.328782).  Saving model ...
Updating learning rate to 0.00025
tensor(19.0380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8138047 KL Loss: 7.1374140 DSM Loss: 9.8752100 Overall Loss:18.8264287
Validation loss decreased (1.328782 --> 1.310445).  Saving model ...
Updating learning rate to 0.000125
tensor(15.6327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0509, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8169579 KL Loss: 7.2952485 DSM Loss: 9.1816222 Overall Loss:18.2938287
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(14.8375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7859522 KL Loss: 7.2163011 DSM Loss: 9.6976713 Overall Loss:18.6999246
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(16.6815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7823160 KL Loss: 7.1242624 DSM Loss: 9.7224056 Overall Loss:18.6289841
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(11.5460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7815476 KL Loss: 7.1869583 DSM Loss: 9.5187292 Overall Loss:18.4872351
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(27.0117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7628122 KL Loss: 7.1047923 DSM Loss: 9.5605176 Overall Loss:18.4281223
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(18.5737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7578449 KL Loss: 7.1563730 DSM Loss: 9.5303313 Overall Loss:18.4445492
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(13.3158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8003845 KL Loss: 7.2720690 DSM Loss: 9.3332025 Overall Loss:18.4056560
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(12.2090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7659566 KL Loss: 7.1947051 DSM Loss: 9.6393203 Overall Loss:18.5999820
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(28.2203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.8287679 KL Loss: 7.2315491 DSM Loss: 9.2200579 Overall Loss:18.2803750
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(11.8548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7704099 KL Loss: 7.1688196 DSM Loss: 9.6592508 Overall Loss:18.5984802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.5435723066329956


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(19.2057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8729561 KL Loss: 7.3374824 DSM Loss: 11.6192645 Overall Loss:20.8297030
Validation loss decreased (inf --> 0.588096).  Saving model ...
Updating learning rate to 0.0005
tensor(23.6609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8104407 KL Loss: 7.1423405 DSM Loss: 9.9034340 Overall Loss:18.8562151
Validation loss decreased (0.588096 --> 0.584445).  Saving model ...
Updating learning rate to 0.00025
tensor(13.0195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8047664 KL Loss: 7.2503178 DSM Loss: 9.6862962 Overall Loss:18.7413804
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(13.6564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7811035 KL Loss: 7.1915394 DSM Loss: 9.7248733 Overall Loss:18.6975161
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(30.5770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8265553 KL Loss: 7.2125791 DSM Loss: 9.5990554 Overall Loss:18.6381898
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(17.4785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7319127 KL Loss: 7.1385750 DSM Loss: 9.6332419 Overall Loss:18.5037297
Validation loss decreased (0.584445 --> 0.584310).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(13.9880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7512139 KL Loss: 7.1440269 DSM Loss: 9.5835306 Overall Loss:18.4787713
Validation loss decreased (0.584310 --> 0.581671).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(14.6881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7374, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7922882 KL Loss: 7.3561315 DSM Loss: 9.3399197 Overall Loss:18.4883395
Validation loss decreased (0.581671 --> 0.581668).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(37.5067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7340978 KL Loss: 7.0331532 DSM Loss: 9.5875106 Overall Loss:18.3547615
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(16.2718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2176, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7577577 KL Loss: 7.2276556 DSM Loss: 9.5297362 Overall Loss:18.5151494
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(14.3933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7273240 KL Loss: 7.1696364 DSM Loss: 9.5225527 Overall Loss:18.4195131
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(13.6433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7123236 KL Loss: 7.0634530 DSM Loss: 9.5326331 Overall Loss:18.3084097
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.8019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7631882 KL Loss: 7.1960268 DSM Loss: 9.5845089 Overall Loss:18.5437239
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(15.4104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7623619 KL Loss: 7.2684349 DSM Loss: 9.3741617 Overall Loss:18.4049585
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(22.1687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4419, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7591995 KL Loss: 7.0835190 DSM Loss: 9.7247208 Overall Loss:18.5674394
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(21.3089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.3798, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7551785 KL Loss: 7.1551332 DSM Loss: 9.6360473 Overall Loss:18.5463589
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(15.2095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7910770 KL Loss: 7.1697150 DSM Loss: 9.5085911 Overall Loss:18.4693831
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(13.6983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7758253 KL Loss: 7.2052161 DSM Loss: 9.3756410 Overall Loss:18.3566823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9698726534843445


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.9478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8583430 KL Loss: 7.2702344 DSM Loss: 11.7117766 Overall Loss:20.8403540
Validation loss decreased (inf --> 0.775436).  Saving model ...
Updating learning rate to 0.0005
tensor(32.0208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7790641 KL Loss: 7.2383393 DSM Loss: 9.6039615 Overall Loss:18.6213650
Validation loss decreased (0.775436 --> 0.772320).  Saving model ...
Updating learning rate to 0.00025
tensor(28.4502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7687149 KL Loss: 7.1781756 DSM Loss: 9.4489158 Overall Loss:18.3958063
Validation loss decreased (0.772320 --> 0.770205).  Saving model ...
Updating learning rate to 0.000125
tensor(13.4294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7785766 KL Loss: 7.1895960 DSM Loss: 9.5479741 Overall Loss:18.5161466
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(19.7270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7238169 KL Loss: 7.1498887 DSM Loss: 9.2971576 Overall Loss:18.1708631
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(15.8961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7480013 KL Loss: 7.1401299 DSM Loss: 9.4679967 Overall Loss:18.3561279
Validation loss decreased (0.770205 --> 0.769082).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(14.3139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7318854 KL Loss: 7.0981092 DSM Loss: 9.4468762 Overall Loss:18.2768707
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(14.1018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7383656 KL Loss: 7.1336029 DSM Loss: 9.4942009 Overall Loss:18.3661695
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(26.3641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7871175 KL Loss: 7.1899283 DSM Loss: 9.3001433 Overall Loss:18.2771891
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(26.9703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4704, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7400051 KL Loss: 7.2041646 DSM Loss: 9.2587892 Overall Loss:18.2029588
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(20.6505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7213597 KL Loss: 7.1015113 DSM Loss: 9.5152476 Overall Loss:18.3381185
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(18.3984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7504431 KL Loss: 7.2671559 DSM Loss: 9.4728587 Overall Loss:18.4904576
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(15.8882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.8039007 KL Loss: 7.2932223 DSM Loss: 9.2011957 Overall Loss:18.2983188
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(12.5537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7910229 KL Loss: 7.2799823 DSM Loss: 9.5270587 Overall Loss:18.5980641
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(16.4014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7367, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7641418 KL Loss: 7.1293121 DSM Loss: 9.3607336 Overall Loss:18.2541876
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(12.6910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7867353 KL Loss: 7.2353232 DSM Loss: 9.2507740 Overall Loss:18.2728325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.951222836971283


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.2088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8610912 KL Loss: 7.2681652 DSM Loss: 11.3625385 Overall Loss:20.4917948
Validation loss decreased (inf --> 1.486140).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8044994 KL Loss: 7.2100855 DSM Loss: 10.0881127 Overall Loss:19.1026976
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(15.3866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8341149 KL Loss: 7.2379146 DSM Loss: 9.7656027 Overall Loss:18.8376322
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(13.3243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.6645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8020101 KL Loss: 7.2158079 DSM Loss: 9.5486588 Overall Loss:18.5664768
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(18.6250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7399633 KL Loss: 7.0979806 DSM Loss: 9.5809495 Overall Loss:18.4188933
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(14.5887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7793045 KL Loss: 7.1533753 DSM Loss: 9.7048128 Overall Loss:18.6374927
Validation loss decreased (1.486140 --> 1.481851).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(15.7086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7793306 KL Loss: 7.2569726 DSM Loss: 9.2736447 Overall Loss:18.3099479
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(15.1319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7401990 KL Loss: 7.0977742 DSM Loss: 9.4073114 Overall Loss:18.2452846
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(12.6344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7832184 KL Loss: 7.2905248 DSM Loss: 9.3382097 Overall Loss:18.4119529
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(12.9834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4952, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7725813 KL Loss: 7.1971107 DSM Loss: 9.3424543 Overall Loss:18.3121461
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(12.9624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7762, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7745620 KL Loss: 7.2142800 DSM Loss: 9.4766598 Overall Loss:18.4655018
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(18.0115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7484424 KL Loss: 7.2206639 DSM Loss: 9.2510288 Overall Loss:18.2201352
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.3421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7393751 KL Loss: 7.1695718 DSM Loss: 9.6123242 Overall Loss:18.5212712
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(12.0340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7389737 KL Loss: 7.1109552 DSM Loss: 9.2731097 Overall Loss:18.1230387
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(13.7702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1523, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7917688 KL Loss: 7.2539852 DSM Loss: 9.4140539 Overall Loss:18.4598081
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(13.7246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7785684 KL Loss: 7.2210370 DSM Loss: 9.4107869 Overall Loss:18.4103922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3005294799804688


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(20.8475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9370444 KL Loss: 7.3875509 DSM Loss: 11.5064105 Overall Loss:20.8310058
Validation loss decreased (inf --> 0.226514).  Saving model ...
Updating learning rate to 0.0005
tensor(19.1222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.0231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.9359248 KL Loss: 7.3391013 DSM Loss: 10.2943286 Overall Loss:19.5693548
Validation loss decreased (0.226514 --> 0.220202).  Saving model ...
Updating learning rate to 0.00025
tensor(29.7487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7601601 KL Loss: 7.1409391 DSM Loss: 10.2141897 Overall Loss:19.1152891
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(15.7668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7439337 KL Loss: 7.0917195 DSM Loss: 9.9292533 Overall Loss:18.7649065
Validation loss decreased (0.220202 --> 0.212369).  Saving model ...
Updating learning rate to 6.25e-05
tensor(20.8208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7597690 KL Loss: 7.1812197 DSM Loss: 9.8650905 Overall Loss:18.8060790
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(12.9225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8595, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7531845 KL Loss: 7.0975430 DSM Loss: 9.8092835 Overall Loss:18.6600110
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(31.8177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.0873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.8232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7553488 KL Loss: 7.1964950 DSM Loss: 9.6592223 Overall Loss:18.6110661
Validation loss decreased (0.212369 --> 0.211789).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(11.3594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7965659 KL Loss: 7.3026769 DSM Loss: 9.4878296 Overall Loss:18.5870724
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(24.0474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3828, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7663657 KL Loss: 7.1625633 DSM Loss: 9.7143199 Overall Loss:18.6432487
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(18.4394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.1308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7049317 KL Loss: 7.0171994 DSM Loss: 9.5726294 Overall Loss:18.2947605
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(12.9144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0688, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7419083 KL Loss: 7.0320419 DSM Loss: 9.7587497 Overall Loss:18.5326999
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(23.6370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.5046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7523210 KL Loss: 7.1545405 DSM Loss: 9.8346224 Overall Loss:18.7414839
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(12.4323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7666475 KL Loss: 7.1988658 DSM Loss: 9.6283489 Overall Loss:18.5938621
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(16.0881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.8058237 KL Loss: 7.3122866 DSM Loss: 9.6085708 Overall Loss:18.7266811
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(13.0936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7938228 KL Loss: 7.2022152 DSM Loss: 9.5571077 Overall Loss:18.5531457
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(14.0262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7521277 KL Loss: 7.2424730 DSM Loss: 9.6215981 Overall Loss:18.6161987
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(38.2807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.6657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7528837 KL Loss: 7.1131331 DSM Loss: 9.8323245 Overall Loss:18.6983413
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.12422065436840057


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.5873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8441303 KL Loss: 7.1711448 DSM Loss: 11.8645508 Overall Loss:20.8798258
Validation loss decreased (inf --> 0.735046).  Saving model ...
Updating learning rate to 0.0005
tensor(12.1923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7261321 KL Loss: 7.1072152 DSM Loss: 10.1875816 Overall Loss:19.0209289
Validation loss decreased (0.735046 --> 0.726771).  Saving model ...
Updating learning rate to 0.00025
tensor(13.4996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7954185 KL Loss: 7.2252163 DSM Loss: 9.7126547 Overall Loss:18.7332895
Validation loss decreased (0.726771 --> 0.725844).  Saving model ...
Updating learning rate to 0.000125
tensor(13.0152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7811491 KL Loss: 7.2038532 DSM Loss: 9.6845646 Overall Loss:18.6695669
Validation loss decreased (0.725844 --> 0.723648).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.3303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7548872 KL Loss: 7.1026232 DSM Loss: 9.8600015 Overall Loss:18.7175120
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(19.3666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.4715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8005256 KL Loss: 7.4131739 DSM Loss: 9.0717063 Overall Loss:18.2854057
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(13.8519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.6260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8014903 KL Loss: 7.1684733 DSM Loss: 9.5169165 Overall Loss:18.4868801
Validation loss decreased (0.723648 --> 0.723525).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(12.5979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7418610 KL Loss: 7.1136044 DSM Loss: 9.6195060 Overall Loss:18.4749713
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(65.3625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7833947 KL Loss: 7.2982249 DSM Loss: 9.2194151 Overall Loss:18.3010346
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(13.2443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7790148 KL Loss: 7.2011733 DSM Loss: 9.2479317 Overall Loss:18.2281199
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(14.0284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8334675 KL Loss: 7.3090041 DSM Loss: 9.2533919 Overall Loss:18.3958636
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(23.3671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7286410 KL Loss: 7.1100290 DSM Loss: 9.7292434 Overall Loss:18.5679134
Validation loss decreased (0.723525 --> 0.723481).  Saving model ...
Updating learning rate to 2.44140625e-07
tensor(11.6329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7512141 KL Loss: 7.0945011 DSM Loss: 9.7906129 Overall Loss:18.6363280
Validation loss decreased (0.723481 --> 0.723443).  Saving model ...
Updating learning rate to 1.220703125e-07
tensor(18.0563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7409809 KL Loss: 7.1304265 DSM Loss: 9.6334040 Overall Loss:18.5048114
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-08
tensor(12.8586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7388402 KL Loss: 7.0153026 DSM Loss: 9.7545806 Overall Loss:18.5087235
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-08
tensor(15.0740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7438895 KL Loss: 7.1330571 DSM Loss: 9.5299950 Overall Loss:18.4069415
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.52587890625e-08
tensor(13.3144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1320, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7817910 KL Loss: 7.2132631 DSM Loss: 9.5589630 Overall Loss:18.5540169
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.62939453125e-09
tensor(49.9908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.8057781 KL Loss: 7.2598271 DSM Loss: 9.4556328 Overall Loss:18.5212379
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.814697265625e-09
tensor(35.8273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.0337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.7512802 KL Loss: 7.1601301 DSM Loss: 9.4413774 Overall Loss:18.3527878
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(12.7213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.8089928 KL Loss: 7.2883180 DSM Loss: 9.3427655 Overall Loss:18.4400763
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(17.4226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 86 | MSE Loss: 1.7914907 KL Loss: 7.1007185 DSM Loss: 9.6159432 Overall Loss:18.5081525
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(15.2639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 86 | MSE Loss: 1.8443652 KL Loss: 7.4368045 DSM Loss: 9.2384733 Overall Loss:18.5196430
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(17.1277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2117, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 86 | MSE Loss: 1.7706944 KL Loss: 7.2363267 DSM Loss: 9.1914848 Overall Loss:18.1985059
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6460967659950256


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.2912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8152716 KL Loss: 7.2594008 DSM Loss: 11.7926703 Overall Loss:20.8673427
Validation loss decreased (inf --> 2.191048).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7953053 KL Loss: 7.2152400 DSM Loss: 10.1329459 Overall Loss:19.1434913
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(26.3111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7973338 KL Loss: 7.2302698 DSM Loss: 9.6614327 Overall Loss:18.6890364
Validation loss decreased (2.191048 --> 2.189207).  Saving model ...
Updating learning rate to 0.000125
tensor(17.8984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7917316 KL Loss: 7.2632087 DSM Loss: 9.4244179 Overall Loss:18.4793582
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(26.5130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7723815 KL Loss: 7.1979726 DSM Loss: 9.4617280 Overall Loss:18.4320822
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(21.8627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7444255 KL Loss: 7.1208075 DSM Loss: 9.5961575 Overall Loss:18.4613906
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(15.9138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7225, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7721514 KL Loss: 7.2227569 DSM Loss: 9.4872579 Overall Loss:18.4821662
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(17.3766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7732388 KL Loss: 7.1905293 DSM Loss: 9.4733364 Overall Loss:18.4371044
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(34.5471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3329, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7479916 KL Loss: 7.2574499 DSM Loss: 9.4179700 Overall Loss:18.4234115
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(12.8118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2609, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7506050 KL Loss: 7.1694497 DSM Loss: 9.4484425 Overall Loss:18.3684972
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(25.8070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1834, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7891859 KL Loss: 7.1785586 DSM Loss: 9.3714715 Overall Loss:18.3392160
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(13.7758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9583, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7490371 KL Loss: 7.1578422 DSM Loss: 9.6697442 Overall Loss:18.5766234
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(16.5999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7741039 KL Loss: 7.2457334 DSM Loss: 9.4871246 Overall Loss:18.5069619
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1770182847976685


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.9259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8484411 KL Loss: 7.2448147 DSM Loss: 12.1142594 Overall Loss:21.2075150
Validation loss decreased (inf --> 0.851014).  Saving model ...
Updating learning rate to 0.0005
tensor(14.7558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8641453 KL Loss: 7.2679358 DSM Loss: 10.1669698 Overall Loss:19.2990509
Validation loss decreased (0.851014 --> 0.850994).  Saving model ...
Updating learning rate to 0.00025
tensor(14.3308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7164366 KL Loss: 7.1009621 DSM Loss: 9.6281406 Overall Loss:18.4455393
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(15.1815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8346521 KL Loss: 7.3104798 DSM Loss: 9.2339876 Overall Loss:18.3791195
Validation loss decreased (0.850994 --> 0.849162).  Saving model ...
Updating learning rate to 6.25e-05
tensor(12.0818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7490173 KL Loss: 7.1413271 DSM Loss: 9.3860777 Overall Loss:18.2764221
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(11.1690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7880675 KL Loss: 7.1984145 DSM Loss: 9.4074987 Overall Loss:18.3939807
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(35.5353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2571, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7398570 KL Loss: 7.1707035 DSM Loss: 9.5760897 Overall Loss:18.4866501
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(32.5968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7614038 KL Loss: 7.1954368 DSM Loss: 9.6119942 Overall Loss:18.5688349
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(14.0938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7157574 KL Loss: 7.1100825 DSM Loss: 9.6785808 Overall Loss:18.5044208
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(11.9396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7399252 KL Loss: 7.1417715 DSM Loss: 9.6824385 Overall Loss:18.5641351
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(26.5147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7516858 KL Loss: 7.1228145 DSM Loss: 9.3917996 Overall Loss:18.2662998
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(14.3408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7877414 KL Loss: 7.2096229 DSM Loss: 9.4014660 Overall Loss:18.3988303
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(32.0037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7355735 KL Loss: 7.1610837 DSM Loss: 9.6022620 Overall Loss:18.4989190
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(20.1199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7143443 KL Loss: 7.1072714 DSM Loss: 9.7367960 Overall Loss:18.5584118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7786107659339905


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(39.7193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8688623 KL Loss: 7.2558337 DSM Loss: 11.5348442 Overall Loss:20.6595401
Validation loss decreased (inf --> 0.849655).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7880534 KL Loss: 7.1218377 DSM Loss: 10.1471830 Overall Loss:19.0570742
Validation loss decreased (0.849655 --> 0.847440).  Saving model ...
Updating learning rate to 0.00025
tensor(15.2543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8329283 KL Loss: 7.2586093 DSM Loss: 9.8925833 Overall Loss:18.9841208
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(27.1717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6371, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7466879 KL Loss: 7.1467592 DSM Loss: 9.8713437 Overall Loss:18.7647908
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(19.0086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7518871 KL Loss: 7.1322071 DSM Loss: 9.6690020 Overall Loss:18.5530963
Validation loss decreased (0.847440 --> 0.845425).  Saving model ...
Updating learning rate to 3.125e-05
tensor(53.4964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7741073 KL Loss: 7.2177152 DSM Loss: 9.6284824 Overall Loss:18.6203048
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(17.2993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7532218 KL Loss: 7.1330136 DSM Loss: 9.7783845 Overall Loss:18.6646199
Validation loss decreased (0.845425 --> 0.845343).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(12.0831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7831077 KL Loss: 7.2584654 DSM Loss: 9.5544217 Overall Loss:18.5959947
Validation loss decreased (0.845343 --> 0.845200).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(13.4790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7037834 KL Loss: 7.0911909 DSM Loss: 9.5168099 Overall Loss:18.3117842
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(16.0807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2927, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7014107 KL Loss: 7.0686243 DSM Loss: 9.6247286 Overall Loss:18.3947637
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(18.9085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7824373 KL Loss: 7.2379813 DSM Loss: 9.4964010 Overall Loss:18.5168196
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(17.9975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7437738 KL Loss: 7.1861738 DSM Loss: 9.6551401 Overall Loss:18.5850875
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(14.4990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7812435 KL Loss: 7.1465897 DSM Loss: 9.5818304 Overall Loss:18.5096637
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(38.4087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7734030 KL Loss: 7.2645558 DSM Loss: 9.5126406 Overall Loss:18.5505994
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(18.1942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.8106123 KL Loss: 7.2473869 DSM Loss: 9.2388873 Overall Loss:18.2968864
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(30.9693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.8273724 KL Loss: 7.3739663 DSM Loss: 9.2640687 Overall Loss:18.4654074
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(14.7758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7955108 KL Loss: 7.2777496 DSM Loss: 9.6026641 Overall Loss:18.6759244
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(13.2402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7436345 KL Loss: 7.0862611 DSM Loss: 9.6225864 Overall Loss:18.4524820
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5826789140701294


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.3772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8034230 KL Loss: 7.2002836 DSM Loss: 12.1405696 Overall Loss:21.1442763
Validation loss decreased (inf --> 0.541049).  Saving model ...
Updating learning rate to 0.0005
tensor(15.5504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8668754 KL Loss: 7.2866836 DSM Loss: 10.0201107 Overall Loss:19.1736697
Validation loss decreased (0.541049 --> 0.500023).  Saving model ...
Updating learning rate to 0.00025
tensor(15.2030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8709587 KL Loss: 7.2798918 DSM Loss: 9.8764750 Overall Loss:19.0273255
Validation loss decreased (0.500023 --> 0.499541).  Saving model ...
Updating learning rate to 0.000125
tensor(14.3379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7504294 KL Loss: 7.2048918 DSM Loss: 9.5395481 Overall Loss:18.4948693
Validation loss decreased (0.499541 --> 0.499285).  Saving model ...
Updating learning rate to 6.25e-05
tensor(19.2368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7899954 KL Loss: 7.1773644 DSM Loss: 9.6532053 Overall Loss:18.6205653
Validation loss decreased (0.499285 --> 0.498650).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.1195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4055, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7767800 KL Loss: 7.2061503 DSM Loss: 9.3888865 Overall Loss:18.3718170
Validation loss decreased (0.498650 --> 0.498489).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(20.1912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8812146 KL Loss: 7.4261842 DSM Loss: 9.4159587 Overall Loss:18.7233575
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(30.1027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.0307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7986893 KL Loss: 7.2549470 DSM Loss: 9.4462248 Overall Loss:18.4998611
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(18.9187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7757483 KL Loss: 7.1314365 DSM Loss: 9.7445937 Overall Loss:18.6517784
Validation loss decreased (0.498489 --> 0.498464).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(17.0545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7419469 KL Loss: 7.1071534 DSM Loss: 9.5437318 Overall Loss:18.3928321
Validation loss decreased (0.498464 --> 0.498411).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(27.0333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8284979 KL Loss: 7.1995629 DSM Loss: 9.4289906 Overall Loss:18.4570514
Validation loss decreased (0.498411 --> 0.498398).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(29.6938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0346, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7940971 KL Loss: 7.2619349 DSM Loss: 9.6009688 Overall Loss:18.6570008
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-07
tensor(18.0224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7883632 KL Loss: 7.1453217 DSM Loss: 9.6312084 Overall Loss:18.5648932
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-07
tensor(22.8048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7800453 KL Loss: 7.1632372 DSM Loss: 9.5396184 Overall Loss:18.4829009
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-08
tensor(16.1505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.8016348 KL Loss: 7.1822094 DSM Loss: 9.4185665 Overall Loss:18.4024107
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-08
tensor(13.3746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7488301 KL Loss: 7.1576973 DSM Loss: 9.5817581 Overall Loss:18.4882855
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-08
tensor(13.7819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.7649935 KL Loss: 7.0904114 DSM Loss: 9.5653261 Overall Loss:18.4207311
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-09
tensor(12.2428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2542, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7598753 KL Loss: 7.1608192 DSM Loss: 9.4404770 Overall Loss:18.3611716
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-09
tensor(15.2219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.8059086 KL Loss: 7.2214197 DSM Loss: 9.2581157 Overall Loss:18.2854439
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(17.1727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.7670099 KL Loss: 7.1032666 DSM Loss: 9.5917270 Overall Loss:18.4620035
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(14.6915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 86 | MSE Loss: 1.7791237 KL Loss: 7.1729776 DSM Loss: 9.5035914 Overall Loss:18.4556927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7125937938690186


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.0483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5056, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7988677 KL Loss: 7.2296130 DSM Loss: 12.0986049 Overall Loss:21.1270855
Validation loss decreased (inf --> 0.957368).  Saving model ...
Updating learning rate to 0.0005
tensor(18.0175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7632711 KL Loss: 7.2190676 DSM Loss: 10.0176141 Overall Loss:18.9999528
Validation loss decreased (0.957368 --> 0.953627).  Saving model ...
Updating learning rate to 0.00025
tensor(23.8752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8216813 KL Loss: 7.2577248 DSM Loss: 9.4184946 Overall Loss:18.4979007
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(15.2373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7186728 KL Loss: 7.1312974 DSM Loss: 9.7184348 Overall Loss:18.5684051
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(15.9607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7579559 KL Loss: 7.2010175 DSM Loss: 9.7296915 Overall Loss:18.6886647
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(30.8618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8201277 KL Loss: 7.2800238 DSM Loss: 9.6204635 Overall Loss:18.7206151
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(13.6137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8358173 KL Loss: 7.3773877 DSM Loss: 9.2934507 Overall Loss:18.5066557
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(13.2366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8076059 KL Loss: 7.1989668 DSM Loss: 9.4526601 Overall Loss:18.4592327
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(15.0565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8061061 KL Loss: 7.2408263 DSM Loss: 9.5157940 Overall Loss:18.5627263
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(36.1583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7966087 KL Loss: 7.2238918 DSM Loss: 9.3758750 Overall Loss:18.3963755
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(22.0303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7743232 KL Loss: 7.1774694 DSM Loss: 9.5952874 Overall Loss:18.5470799
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(15.0178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.8108034 KL Loss: 7.2313325 DSM Loss: 9.1838977 Overall Loss:18.2260337
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1090048551559448


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.7073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1843, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8660785 KL Loss: 7.1732046 DSM Loss: 12.0045434 Overall Loss:21.0438267
Validation loss decreased (inf --> 1.100881).  Saving model ...
Updating learning rate to 0.0005
tensor(21.0592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8402691 KL Loss: 7.2424136 DSM Loss: 10.1234564 Overall Loss:19.2061390
Validation loss decreased (1.100881 --> 1.100678).  Saving model ...
Updating learning rate to 0.00025
tensor(17.8062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7668790 KL Loss: 7.1405009 DSM Loss: 9.7658229 Overall Loss:18.6732028
Validation loss decreased (1.100678 --> 1.097703).  Saving model ...
Updating learning rate to 0.000125
tensor(16.2472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7726733 KL Loss: 7.1266204 DSM Loss: 9.4478555 Overall Loss:18.3471492
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(13.1385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8059185 KL Loss: 7.1709372 DSM Loss: 9.5637217 Overall Loss:18.5405774
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(17.2896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3193, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8166778 KL Loss: 7.1561588 DSM Loss: 9.5613222 Overall Loss:18.5341588
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(18.3271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.6697067 KL Loss: 7.0219163 DSM Loss: 9.6597663 Overall Loss:18.3513892
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(15.8113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7919325 KL Loss: 7.2183328 DSM Loss: 9.4671763 Overall Loss:18.4774415
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(21.0415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3342, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7521395 KL Loss: 7.1105218 DSM Loss: 9.5128449 Overall Loss:18.3755064
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(30.0975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7394953 KL Loss: 7.0330083 DSM Loss: 9.5473309 Overall Loss:18.3198346
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(10.9584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7673900 KL Loss: 7.1405587 DSM Loss: 9.3716210 Overall Loss:18.2795697
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(14.6123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7485721 KL Loss: 7.0951790 DSM Loss: 9.6937288 Overall Loss:18.5374800
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(15.8595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7588061 KL Loss: 7.1164830 DSM Loss: 9.5735288 Overall Loss:18.4488179
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9221332669258118


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.7284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8107797 KL Loss: 7.1816232 DSM Loss: 11.2523067 Overall Loss:20.2447098
Validation loss decreased (inf --> 0.927106).  Saving model ...
Updating learning rate to 0.0005
tensor(14.4647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7736100 KL Loss: 7.1731376 DSM Loss: 9.8436237 Overall Loss:18.7903712
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(19.5701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8237907 KL Loss: 7.2204790 DSM Loss: 9.3675678 Overall Loss:18.4118373
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(15.3415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8160843 KL Loss: 7.2193776 DSM Loss: 9.5775492 Overall Loss:18.6130111
Validation loss decreased (0.927106 --> 0.926946).  Saving model ...
Updating learning rate to 6.25e-05
tensor(15.7798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7883666 KL Loss: 7.1898976 DSM Loss: 9.3435167 Overall Loss:18.3217808
Validation loss decreased (0.926946 --> 0.926510).  Saving model ...
Updating learning rate to 3.125e-05
tensor(18.3820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7886098 KL Loss: 7.2438510 DSM Loss: 9.4949182 Overall Loss:18.5273791
Validation loss decreased (0.926510 --> 0.926481).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(27.6128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2805, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7762570 KL Loss: 7.2464514 DSM Loss: 9.4205427 Overall Loss:18.4432512
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(14.8643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7337397 KL Loss: 7.0973508 DSM Loss: 9.2343259 Overall Loss:18.0654164
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(16.4870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2182, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7618460 KL Loss: 7.1731117 DSM Loss: 9.3956800 Overall Loss:18.3306379
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(24.3253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7242, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7530781 KL Loss: 7.1577472 DSM Loss: 9.1804141 Overall Loss:18.0912394
Validation loss decreased (0.926481 --> 0.926431).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(17.2483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4435, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7712098 KL Loss: 7.1508576 DSM Loss: 9.3950117 Overall Loss:18.3170790
Validation loss decreased (0.926431 --> 0.926415).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(13.5363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7599618 KL Loss: 7.2057861 DSM Loss: 9.3763755 Overall Loss:18.3421236
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-07
tensor(15.4704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.8190698 KL Loss: 7.2255606 DSM Loss: 9.2018144 Overall Loss:18.2464448
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-07
tensor(16.2516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7862231 KL Loss: 7.2113334 DSM Loss: 9.3485098 Overall Loss:18.3460664
Validation loss decreased (0.926415 --> 0.926369).  Saving model ...
Updating learning rate to 6.103515625e-08
tensor(16.9189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0762, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7798266 KL Loss: 7.2224057 DSM Loss: 9.4276967 Overall Loss:18.4299289
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-08
tensor(15.4815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7848919 KL Loss: 7.2681633 DSM Loss: 9.3938648 Overall Loss:18.4469200
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-08
tensor(16.4463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 86 | MSE Loss: 1.8238258 KL Loss: 7.2441896 DSM Loss: 9.3947905 Overall Loss:18.4628058
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-09
tensor(19.2094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 86 | MSE Loss: 1.7868041 KL Loss: 7.2136543 DSM Loss: 9.4314938 Overall Loss:18.4319523
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-09
tensor(16.7781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 86 | MSE Loss: 1.7903618 KL Loss: 7.2773371 DSM Loss: 9.2050012 Overall Loss:18.2727000
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(14.5821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6319, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 86 | MSE Loss: 1.8024876 KL Loss: 7.2624239 DSM Loss: 9.2909170 Overall Loss:18.3558285
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(15.6197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 86 | MSE Loss: 1.7789475 KL Loss: 7.2176912 DSM Loss: 9.2466734 Overall Loss:18.2433121
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(15.6211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3189, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 86 | MSE Loss: 1.8112099 KL Loss: 7.1965857 DSM Loss: 9.3537074 Overall Loss:18.3615030
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(24.2957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 86 | MSE Loss: 1.7782060 KL Loss: 7.1695989 DSM Loss: 9.4015632 Overall Loss:18.3493681
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(22.5104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 86 | MSE Loss: 1.7487079 KL Loss: 7.1355521 DSM Loss: 9.3588354 Overall Loss:18.2430954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.63522207736969


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.6587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0271, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7919597 KL Loss: 7.1506986 DSM Loss: 11.9566719 Overall Loss:20.8993301
Validation loss decreased (inf --> 0.550323).  Saving model ...
Updating learning rate to 0.0005
tensor(21.5911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8193001 KL Loss: 7.2609746 DSM Loss: 10.0942994 Overall Loss:19.1745740
Validation loss decreased (0.550323 --> 0.545085).  Saving model ...
Updating learning rate to 0.00025
tensor(44.5383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7945836 KL Loss: 7.2170090 DSM Loss: 9.5817066 Overall Loss:18.5932991
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(18.0764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8634007 KL Loss: 7.3202667 DSM Loss: 8.9765488 Overall Loss:18.1602164
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(12.7777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7593428 KL Loss: 7.1232236 DSM Loss: 9.8757672 Overall Loss:18.7583336
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(14.4144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7257751 KL Loss: 7.1132969 DSM Loss: 9.7167233 Overall Loss:18.5557952
Validation loss decreased (0.545085 --> 0.544896).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(12.5345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7518385 KL Loss: 7.2173438 DSM Loss: 9.6769890 Overall Loss:18.6461713
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(13.6276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.4870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7418487 KL Loss: 7.1536290 DSM Loss: 9.6711902 Overall Loss:18.5666678
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(20.5059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8521999 KL Loss: 7.4153745 DSM Loss: 9.4942042 Overall Loss:18.7617786
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(11.9583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7430914 KL Loss: 7.1664125 DSM Loss: 9.6122096 Overall Loss:18.5217135
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(15.8422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7528162 KL Loss: 7.1531503 DSM Loss: 9.5266589 Overall Loss:18.4326254
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(24.8379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7452029 KL Loss: 6.9980066 DSM Loss: 9.8926157 Overall Loss:18.6358252
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(15.6952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7991684 KL Loss: 7.1508749 DSM Loss: 9.5520867 Overall Loss:18.5021300
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(23.3312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7267993 KL Loss: 7.1042710 DSM Loss: 9.5958942 Overall Loss:18.4269644
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(25.7341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7004371 KL Loss: 7.0954389 DSM Loss: 9.8569660 Overall Loss:18.6528419
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(19.8287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4511, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7544435 KL Loss: 7.2021504 DSM Loss: 9.6898457 Overall Loss:18.6464395
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7793643474578857


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(31.4499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8271013 KL Loss: 7.2498318 DSM Loss: 11.4690009 Overall Loss:20.5459340
Validation loss decreased (inf --> 1.065282).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8015303 KL Loss: 7.1916906 DSM Loss: 10.0014973 Overall Loss:18.9947181
Validation loss decreased (1.065282 --> 1.063995).  Saving model ...
Updating learning rate to 0.00025
tensor(13.9650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7761039 KL Loss: 7.1768197 DSM Loss: 9.7408891 Overall Loss:18.6938127
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(18.2752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8085336 KL Loss: 7.1712830 DSM Loss: 9.6521249 Overall Loss:18.6319415
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(20.9679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7224280 KL Loss: 7.1358012 DSM Loss: 9.5815467 Overall Loss:18.4397760
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(22.3501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7714815 KL Loss: 7.2015706 DSM Loss: 9.5634223 Overall Loss:18.5364745
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(17.1619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7381130 KL Loss: 7.1412360 DSM Loss: 9.4959816 Overall Loss:18.3753305
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(15.3487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7932222 KL Loss: 7.2058546 DSM Loss: 9.4831652 Overall Loss:18.4822418
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(12.8254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7744225 KL Loss: 7.2085676 DSM Loss: 9.5615166 Overall Loss:18.5445068
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(13.1285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8120441 KL Loss: 7.2835976 DSM Loss: 9.2905155 Overall Loss:18.3861572
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(16.6912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7718939 KL Loss: 7.2680313 DSM Loss: 9.2233623 Overall Loss:18.2632874
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(20.1497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4354, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7690161 KL Loss: 7.2299445 DSM Loss: 9.3812127 Overall Loss:18.3801732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.534957766532898


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(38.5063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9563, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8619028 KL Loss: 7.2578847 DSM Loss: 11.6666709 Overall Loss:20.7864585
Validation loss decreased (inf --> 0.578028).  Saving model ...
Updating learning rate to 0.0005
tensor(36.7480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4146, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7220574 KL Loss: 7.0464976 DSM Loss: 10.0969847 Overall Loss:18.8655397
Validation loss decreased (0.578028 --> 0.573712).  Saving model ...
Updating learning rate to 0.00025
tensor(33.7519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7503406 KL Loss: 7.1233817 DSM Loss: 9.7539592 Overall Loss:18.6276816
Validation loss decreased (0.573712 --> 0.573605).  Saving model ...
Updating learning rate to 0.000125
tensor(13.7307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7432289 KL Loss: 7.1839293 DSM Loss: 9.7416642 Overall Loss:18.6688224
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(16.1774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7480177 KL Loss: 7.1858593 DSM Loss: 9.6186485 Overall Loss:18.5525254
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(13.7585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7006, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8053937 KL Loss: 7.2074551 DSM Loss: 9.6058603 Overall Loss:18.6187090
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(13.5632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7965161 KL Loss: 7.2396350 DSM Loss: 9.2436619 Overall Loss:18.2798131
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(15.5751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7678108 KL Loss: 7.1176298 DSM Loss: 9.5931627 Overall Loss:18.4786032
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(18.0766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7322660 KL Loss: 7.1009763 DSM Loss: 9.5202737 Overall Loss:18.3535159
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(11.9967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9530, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7627076 KL Loss: 7.2017549 DSM Loss: 9.4772566 Overall Loss:18.4417190
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(29.9306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9453, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7293159 KL Loss: 7.3023452 DSM Loss: 9.1942008 Overall Loss:18.2258618
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(11.8543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7809713 KL Loss: 7.1800900 DSM Loss: 9.4107151 Overall Loss:18.3717764
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(13.2023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7949412 KL Loss: 7.2089881 DSM Loss: 9.4991835 Overall Loss:18.5031129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7198870182037354


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.5636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7420184 KL Loss: 7.1164123 DSM Loss: 11.1653269 Overall Loss:20.0237575
Validation loss decreased (inf --> 1.999731).  Saving model ...
Updating learning rate to 0.0005
tensor(15.9196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8113728 KL Loss: 7.2133592 DSM Loss: 9.8116741 Overall Loss:18.8364060
Validation loss decreased (1.999731 --> 1.995588).  Saving model ...
Updating learning rate to 0.00025
tensor(16.7087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8374008 KL Loss: 7.2924068 DSM Loss: 9.5117265 Overall Loss:18.6415340
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(16.5373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7819655 KL Loss: 7.1946092 DSM Loss: 9.4072294 Overall Loss:18.3838040
Validation loss decreased (1.995588 --> 1.986501).  Saving model ...
Updating learning rate to 6.25e-05
tensor(13.6165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7009443 KL Loss: 7.1128473 DSM Loss: 9.3461252 Overall Loss:18.1599168
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(23.3383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7503261 KL Loss: 7.1764224 DSM Loss: 9.1565350 Overall Loss:18.0832836
Validation loss decreased (1.986501 --> 1.985478).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(16.5075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7639320 KL Loss: 7.1736715 DSM Loss: 9.4641274 Overall Loss:18.4017309
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(18.7735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4962, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7349588 KL Loss: 7.0903626 DSM Loss: 9.5019305 Overall Loss:18.3272518
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(14.9589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7488727 KL Loss: 7.1632211 DSM Loss: 9.3743927 Overall Loss:18.2864865
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(15.5452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7530948 KL Loss: 7.1299452 DSM Loss: 9.3579368 Overall Loss:18.2409768
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(14.1458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8582, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.8217743 KL Loss: 7.2690711 DSM Loss: 9.2239863 Overall Loss:18.3148317
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(18.4782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7468741 KL Loss: 7.1440874 DSM Loss: 9.3543156 Overall Loss:18.2452771
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(14.4188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4398, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7412294 KL Loss: 7.1171318 DSM Loss: 9.2486596 Overall Loss:18.1070206
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(19.4868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 86 | MSE Loss: 1.7968554 KL Loss: 7.2391672 DSM Loss: 9.3113518 Overall Loss:18.3473743
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(13.6957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 86 | MSE Loss: 1.7681806 KL Loss: 7.1006266 DSM Loss: 9.3300331 Overall Loss:18.1988404
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(17.6198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 86 | MSE Loss: 1.7658048 KL Loss: 7.2449670 DSM Loss: 9.2821574 Overall Loss:18.2929292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.290319561958313


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.3970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8447251 KL Loss: 7.2644731 DSM Loss: 11.4498117 Overall Loss:20.5590099
Validation loss decreased (inf --> 1.296899).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8086393 KL Loss: 7.2182770 DSM Loss: 10.0140764 Overall Loss:19.0409926
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(13.2740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2125, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8341988 KL Loss: 7.3026905 DSM Loss: 9.4481417 Overall Loss:18.5850310
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(15.7061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8036124 KL Loss: 7.2131610 DSM Loss: 9.4924123 Overall Loss:18.5091856
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(16.8761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8012040 KL Loss: 7.2112560 DSM Loss: 9.4134789 Overall Loss:18.4259389
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(16.9664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8123, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8616571 KL Loss: 7.3186275 DSM Loss: 9.2628213 Overall Loss:18.4431059
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(16.6366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8066196 KL Loss: 7.2045478 DSM Loss: 9.4010239 Overall Loss:18.4121913
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(21.5914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8174344 KL Loss: 7.2291200 DSM Loss: 9.3987106 Overall Loss:18.4452650
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(16.5313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7511191 KL Loss: 7.1300149 DSM Loss: 9.5613149 Overall Loss:18.4424489
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(16.1340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8063152 KL Loss: 7.2539148 DSM Loss: 9.4363202 Overall Loss:18.4965502
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(20.8296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7677358 KL Loss: 7.1546460 DSM Loss: 9.3709562 Overall Loss:18.2933380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3343119621276855


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(40.5187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8582786 KL Loss: 7.3039533 DSM Loss: 12.9546578 Overall Loss:22.1168897
Validation loss decreased (inf --> 1.359974).  Saving model ...
Updating learning rate to 0.0005
tensor(13.3310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8116186 KL Loss: 7.2100683 DSM Loss: 10.5116546 Overall Loss:19.5333417
Validation loss decreased (1.359974 --> 1.359747).  Saving model ...
Updating learning rate to 0.00025
tensor(18.6087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8105167 KL Loss: 7.1868762 DSM Loss: 9.8854964 Overall Loss:18.8828892
Validation loss decreased (1.359747 --> 1.349471).  Saving model ...
Updating learning rate to 0.000125
tensor(28.8732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7666900 KL Loss: 7.2204636 DSM Loss: 9.5509333 Overall Loss:18.5380868
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(15.1120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7397045 KL Loss: 7.1356264 DSM Loss: 9.7296535 Overall Loss:18.6049844
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(18.9098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8472366 KL Loss: 7.3468614 DSM Loss: 9.3738786 Overall Loss:18.5679763
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(12.2182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7740765 KL Loss: 7.1751231 DSM Loss: 9.3918883 Overall Loss:18.3410880
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(27.4130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7485500 KL Loss: 7.1002837 DSM Loss: 9.4403417 Overall Loss:18.2891753
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(16.6987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7626737 KL Loss: 7.2007700 DSM Loss: 9.6345735 Overall Loss:18.5980171
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(14.9361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7934104 KL Loss: 7.2540597 DSM Loss: 9.3293167 Overall Loss:18.3767868
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(14.1873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7793295 KL Loss: 7.1791568 DSM Loss: 9.4337965 Overall Loss:18.3922826
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(17.7656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7225, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7778180 KL Loss: 7.2778320 DSM Loss: 9.5374810 Overall Loss:18.5931310
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(18.3487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.8266322 KL Loss: 7.3150007 DSM Loss: 9.4765858 Overall Loss:18.6182188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.431489109992981


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.5942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9388, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7603834 KL Loss: 7.1403264 DSM Loss: 11.6498691 Overall Loss:20.5505789
Validation loss decreased (inf --> 1.697211).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7847934 KL Loss: 7.1907563 DSM Loss: 9.8249163 Overall Loss:18.8004661
Validation loss decreased (1.697211 --> 1.693838).  Saving model ...
Updating learning rate to 0.00025
tensor(16.9930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8062129 KL Loss: 7.1542292 DSM Loss: 9.7896507 Overall Loss:18.7500928
Validation loss decreased (1.693838 --> 1.692898).  Saving model ...
Updating learning rate to 0.000125
tensor(23.2103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7882561 KL Loss: 7.1871483 DSM Loss: 9.4094260 Overall Loss:18.3848304
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(24.2744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7799086 KL Loss: 7.1604580 DSM Loss: 9.5260426 Overall Loss:18.4664092
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(12.5145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7431264 KL Loss: 7.1298767 DSM Loss: 9.4147317 Overall Loss:18.2877348
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(14.6400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7613483 KL Loss: 7.1937267 DSM Loss: 9.5620793 Overall Loss:18.5171544
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(19.6415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5410, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7230332 KL Loss: 7.1300394 DSM Loss: 9.3412071 Overall Loss:18.1942796
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(13.7982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7510716 KL Loss: 7.2268188 DSM Loss: 9.2992766 Overall Loss:18.2771671
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(16.9057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8039643 KL Loss: 7.2586251 DSM Loss: 9.3792668 Overall Loss:18.4418561
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(24.2434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7314916 KL Loss: 7.0882451 DSM Loss: 9.6034050 Overall Loss:18.4231416
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(12.4945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7595132 KL Loss: 7.2065791 DSM Loss: 9.3564323 Overall Loss:18.3225246
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(15.8098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.7456593 KL Loss: 7.1077853 DSM Loss: 9.3891861 Overall Loss:18.2426307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6213966608047485


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.8426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8588590 KL Loss: 7.2229311 DSM Loss: 11.3274544 Overall Loss:20.4092444
Validation loss decreased (inf --> 0.676650).  Saving model ...
Updating learning rate to 0.0005
tensor(16.4471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8090839 KL Loss: 7.2770002 DSM Loss: 9.7954221 Overall Loss:18.8815061
Validation loss decreased (0.676650 --> 0.668027).  Saving model ...
Updating learning rate to 0.00025
tensor(16.8348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8080629 KL Loss: 7.2180246 DSM Loss: 9.5909671 Overall Loss:18.6170546
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(16.9121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8494, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7984154 KL Loss: 7.1998401 DSM Loss: 9.5976805 Overall Loss:18.5959359
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(19.5719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8146881 KL Loss: 7.2286484 DSM Loss: 9.3319916 Overall Loss:18.3753281
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(17.8297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8225065 KL Loss: 7.2986787 DSM Loss: 9.4459530 Overall Loss:18.5671383
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(18.5131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8060873 KL Loss: 7.1383478 DSM Loss: 9.6365617 Overall Loss:18.5809969
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(15.7014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7191215 KL Loss: 7.0283373 DSM Loss: 9.5090941 Overall Loss:18.2565530
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(29.3730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7403511 KL Loss: 7.1281654 DSM Loss: 9.4439546 Overall Loss:18.3124710
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(13.3577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8361064 KL Loss: 7.4050504 DSM Loss: 9.3186462 Overall Loss:18.5598030
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(27.6754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4680, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7842439 KL Loss: 7.2457655 DSM Loss: 9.5831704 Overall Loss:18.6131797
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(20.4406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.6382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7522041 KL Loss: 7.1826664 DSM Loss: 9.2798203 Overall Loss:18.2146907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6651403307914734


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(45.6944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8512213 KL Loss: 7.2587173 DSM Loss: 11.6071768 Overall Loss:20.7171153
Validation loss decreased (inf --> 1.375665).  Saving model ...
Updating learning rate to 0.0005
tensor(23.6322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7929830 KL Loss: 7.1315315 DSM Loss: 10.0184305 Overall Loss:18.9429450
Validation loss decreased (1.375665 --> 1.352176).  Saving model ...
Updating learning rate to 0.00025
tensor(21.6857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7868034 KL Loss: 7.1661975 DSM Loss: 9.8984650 Overall Loss:18.8514658
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(13.2121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7627517 KL Loss: 7.1481217 DSM Loss: 9.8870950 Overall Loss:18.7979685
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(19.4384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7583145 KL Loss: 7.1673304 DSM Loss: 9.4886842 Overall Loss:18.4143290
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(19.3443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7745843 KL Loss: 7.1944991 DSM Loss: 9.4117777 Overall Loss:18.3808610
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(16.9911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7530763 KL Loss: 7.1847717 DSM Loss: 9.3935291 Overall Loss:18.3313771
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(22.0685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7749608 KL Loss: 7.2060180 DSM Loss: 9.4612074 Overall Loss:18.4421860
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(20.1042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9236, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7988039 KL Loss: 7.2406408 DSM Loss: 9.4147415 Overall Loss:18.4541861
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(13.8577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7631837 KL Loss: 7.2171920 DSM Loss: 9.5051193 Overall Loss:18.4854950
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(22.7786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7243217 KL Loss: 7.1095585 DSM Loss: 9.6510646 Overall Loss:18.4849449
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(19.8905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7618930 KL Loss: 7.1639096 DSM Loss: 9.6600061 Overall Loss:18.5858086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.964461624622345


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.8840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8205362 KL Loss: 7.2990429 DSM Loss: 13.9024075 Overall Loss:23.0219867
Validation loss decreased (inf --> 0.967437).  Saving model ...
Updating learning rate to 0.0005
tensor(23.3682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8415309 KL Loss: 7.2583237 DSM Loss: 10.1188096 Overall Loss:19.2186643
Validation loss decreased (0.967437 --> 0.959185).  Saving model ...
Updating learning rate to 0.00025
tensor(25.0811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7129374 KL Loss: 7.0557096 DSM Loss: 9.9478320 Overall Loss:18.7164790
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(19.8252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8062184 KL Loss: 7.2067319 DSM Loss: 9.4694788 Overall Loss:18.4824291
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(16.4377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8077497 KL Loss: 7.2637611 DSM Loss: 9.4338470 Overall Loss:18.5053579
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(15.7430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7514755 KL Loss: 7.1005805 DSM Loss: 9.4457469 Overall Loss:18.2978029
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(20.1240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7146564 KL Loss: 7.0717000 DSM Loss: 9.5838868 Overall Loss:18.3702431
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(18.6841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7183197 KL Loss: 7.1479627 DSM Loss: 9.5249718 Overall Loss:18.3912541
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(14.7775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7808472 KL Loss: 7.2438301 DSM Loss: 9.2689665 Overall Loss:18.2936439
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(17.4741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7510057 KL Loss: 7.2310687 DSM Loss: 9.4828834 Overall Loss:18.4649578
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(18.7654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7675747 KL Loss: 7.1824590 DSM Loss: 9.5042515 Overall Loss:18.4542851
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(24.4377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7196730 KL Loss: 7.0663861 DSM Loss: 9.3841592 Overall Loss:18.1702184
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.581315517425537


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.9160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8790254 KL Loss: 7.3323304 DSM Loss: 11.6197530 Overall Loss:20.8311087
Validation loss decreased (inf --> 1.547700).  Saving model ...
Updating learning rate to 0.0005
tensor(23.9458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6398, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7793462 KL Loss: 7.1235260 DSM Loss: 10.1605633 Overall Loss:19.0634353
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(16.0716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8381184 KL Loss: 7.2802328 DSM Loss: 9.5960762 Overall Loss:18.7144273
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(18.4207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7467622 KL Loss: 7.1102355 DSM Loss: 9.6486541 Overall Loss:18.5056518
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(20.2262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1051, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7381000 KL Loss: 7.1285140 DSM Loss: 9.7863337 Overall Loss:18.6529476
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(18.9232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7585501 KL Loss: 7.1862452 DSM Loss: 9.6314612 Overall Loss:18.5762567
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(34.9898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7528873 KL Loss: 7.1745360 DSM Loss: 9.4214558 Overall Loss:18.3488789
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(27.9553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7462579 KL Loss: 7.1604907 DSM Loss: 9.6631288 Overall Loss:18.5698773
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(15.2697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7359159 KL Loss: 7.1151872 DSM Loss: 9.6343137 Overall Loss:18.4854168
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(18.0677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7480633 KL Loss: 7.1083233 DSM Loss: 9.4655334 Overall Loss:18.3219199
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(11.5343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7122988 KL Loss: 7.1047764 DSM Loss: 9.4541318 Overall Loss:18.2712070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6497835516929626


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(20.1963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8096931 KL Loss: 7.2304806 DSM Loss: 11.7678705 Overall Loss:20.8080441
Validation loss decreased (inf --> 1.054302).  Saving model ...
Updating learning rate to 0.0005
tensor(25.9420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8419253 KL Loss: 7.2837353 DSM Loss: 9.8520912 Overall Loss:18.9777518
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(16.3488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7914599 KL Loss: 7.1263169 DSM Loss: 9.6948332 Overall Loss:18.6126100
Validation loss decreased (1.054302 --> 1.052455).  Saving model ...
Updating learning rate to 0.000125
tensor(22.2835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9777, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7401540 KL Loss: 7.1929815 DSM Loss: 9.8335362 Overall Loss:18.7666717
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(14.8314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8211425 KL Loss: 7.1410426 DSM Loss: 9.3911934 Overall Loss:18.3533785
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(15.3795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7868705 KL Loss: 7.2690855 DSM Loss: 9.5245278 Overall Loss:18.5804838
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(36.0500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0426, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8230802 KL Loss: 7.2445667 DSM Loss: 9.3185334 Overall Loss:18.3861802
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(19.3422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7958519 KL Loss: 7.1526892 DSM Loss: 9.4316620 Overall Loss:18.3802031
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(16.5895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4737, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8097595 KL Loss: 7.1731793 DSM Loss: 9.4723201 Overall Loss:18.4552590
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(11.2902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2735, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.8309642 KL Loss: 7.2471925 DSM Loss: 9.4030556 Overall Loss:18.4812123
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(15.6549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7555765 KL Loss: 7.1988026 DSM Loss: 9.5814544 Overall Loss:18.5358336
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(18.3707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7436357 KL Loss: 7.0781993 DSM Loss: 9.5616155 Overall Loss:18.3834506
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(14.3605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 86 | MSE Loss: 1.8119667 KL Loss: 7.1753456 DSM Loss: 9.1465095 Overall Loss:18.1338217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7527596354484558


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.8918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4359, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8255353 KL Loss: 7.2265889 DSM Loss: 11.1434855 Overall Loss:20.1956095
Validation loss decreased (inf --> 0.886336).  Saving model ...
Updating learning rate to 0.0005
tensor(16.8368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8078225 KL Loss: 7.2459482 DSM Loss: 9.9846326 Overall Loss:19.0384032
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(30.6330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7743838 KL Loss: 7.1778341 DSM Loss: 9.7613454 Overall Loss:18.7135633
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(21.3379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7741951 KL Loss: 7.1748940 DSM Loss: 9.7481122 Overall Loss:18.6972013
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(27.5993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4831, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7447736 KL Loss: 7.1777870 DSM Loss: 9.5113296 Overall Loss:18.4338902
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(31.3696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7669820 KL Loss: 7.1834028 DSM Loss: 9.5419231 Overall Loss:18.4923078
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(16.9171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7433431 KL Loss: 7.1967540 DSM Loss: 9.5445148 Overall Loss:18.4846118
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(12.6500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7733923 KL Loss: 7.2385369 DSM Loss: 9.3618459 Overall Loss:18.3737752
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(13.2264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8006607 KL Loss: 7.2460310 DSM Loss: 9.4189509 Overall Loss:18.4656424
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(32.2212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7625620 KL Loss: 7.1584870 DSM Loss: 9.3479360 Overall Loss:18.2689849
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(34.1091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3926, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7731020 KL Loss: 7.1630914 DSM Loss: 9.3230946 Overall Loss:18.2592879
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8253087401390076


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.2771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1987, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8478849 KL Loss: 7.2526418 DSM Loss: 12.1678198 Overall Loss:21.2683465
Validation loss decreased (inf --> 1.175425).  Saving model ...
Updating learning rate to 0.0005
tensor(14.4675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7988888 KL Loss: 7.1709507 DSM Loss: 9.9736629 Overall Loss:18.9435024
Validation loss decreased (1.175425 --> 1.174741).  Saving model ...
Updating learning rate to 0.00025
tensor(13.9188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8080668 KL Loss: 7.1484068 DSM Loss: 9.8484979 Overall Loss:18.8049716
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(14.4262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7766184 KL Loss: 7.2002772 DSM Loss: 9.6137489 Overall Loss:18.5906445
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(13.7283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5583, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7768619 KL Loss: 7.1471516 DSM Loss: 9.5634514 Overall Loss:18.4874650
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(23.1752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8222338 KL Loss: 7.3022285 DSM Loss: 9.3510613 Overall Loss:18.4755235
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(17.5620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7822991 KL Loss: 7.0787564 DSM Loss: 9.4045106 Overall Loss:18.2655661
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(28.4960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8153, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7510573 KL Loss: 7.1342264 DSM Loss: 9.7137874 Overall Loss:18.5990711
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(18.0669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2857, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7743276 KL Loss: 7.1433100 DSM Loss: 9.4106269 Overall Loss:18.3282644
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(14.3979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1685, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7568840 KL Loss: 7.1745244 DSM Loss: 9.5163595 Overall Loss:18.4477679
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(22.7744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7648646 KL Loss: 7.1307881 DSM Loss: 9.3494172 Overall Loss:18.2450698
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(17.5213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7582, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 86 | MSE Loss: 1.7664128 KL Loss: 7.1048111 DSM Loss: 9.4921231 Overall Loss:18.3633469
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.042270541191101
      Ticker       MSE StdDev
0   AAPL_pct   0.86198    0.0
1   ABBV_pct  0.559684    0.0
2    AEP_pct  1.147571    0.0
3   AMGN_pct  0.684143    0.0
4   AMZN_pct  1.777328    0.0
..       ...       ...    ...
66    VZ_pct  1.581316    0.0
67     V_pct  0.649784    0.0
68   WFC_pct   0.75276    0.0
69   WMT_pct  0.825309    0.0
70   XOM_pct  1.042271    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=10, prediction_length=20, root_path='data/EcmP_stock_L_2016_24_spec_official_dva_spec', scale=0.1, sequence_length=20, target_dim=1, train_epochs=30, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.8762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9143922 KL Loss: 14.3249268 DSM Loss: 22.6448544 Overall Loss:38.8841732
Validation loss decreased (inf --> 0.894163).  Saving model ...
Updating learning rate to 0.0005
tensor(32.4408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8962109 KL Loss: 14.2883101 DSM Loss: 19.5190013 Overall Loss:35.7035221
Validation loss decreased (0.894163 --> 0.850248).  Saving model ...
Updating learning rate to 0.00025
tensor(28.2177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8943535 KL Loss: 14.3163331 DSM Loss: 19.0708891 Overall Loss:35.2815758
Validation loss decreased (0.850248 --> 0.846149).  Saving model ...
Updating learning rate to 0.000125
tensor(27.7779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9074462 KL Loss: 14.3685041 DSM Loss: 19.0180780 Overall Loss:35.2940284
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(30.9149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8849709 KL Loss: 14.3202524 DSM Loss: 18.8980951 Overall Loss:35.1033184
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(28.8826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8510262 KL Loss: 14.1831565 DSM Loss: 18.7633219 Overall Loss:34.7975046
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(47.9143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8647881 KL Loss: 14.3039197 DSM Loss: 18.9903151 Overall Loss:35.1590229
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(29.6542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8872987 KL Loss: 14.3658775 DSM Loss: 18.5750921 Overall Loss:34.8282681
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(29.5430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8583173 KL Loss: 14.1730313 DSM Loss: 18.5938876 Overall Loss:34.6252362
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(30.5873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8429669 KL Loss: 14.2556459 DSM Loss: 18.9890944 Overall Loss:35.0877073
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(32.2239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6498, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8813362 KL Loss: 14.3144036 DSM Loss: 18.6429508 Overall Loss:34.8386904
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.2954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8767785 KL Loss: 14.1789703 DSM Loss: 18.6527944 Overall Loss:34.7085431
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(33.2727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8645814 KL Loss: 14.2938674 DSM Loss: 18.9102833 Overall Loss:35.0687323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8672575950622559


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.7679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8845104 KL Loss: 14.2931132 DSM Loss: 22.9399281 Overall Loss:39.1175520
Validation loss decreased (inf --> 0.576470).  Saving model ...
Updating learning rate to 0.0005
tensor(28.6896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8769795 KL Loss: 14.2740587 DSM Loss: 18.9448792 Overall Loss:35.0959178
Validation loss decreased (0.576470 --> 0.567609).  Saving model ...
Updating learning rate to 0.00025
tensor(31.2334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8954059 KL Loss: 14.2655873 DSM Loss: 18.3527930 Overall Loss:34.5137862
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(32.9818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8489708 KL Loss: 14.2578464 DSM Loss: 18.2360169 Overall Loss:34.3428337
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(38.9158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8627074 KL Loss: 14.2180925 DSM Loss: 18.4344524 Overall Loss:34.5152524
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(30.3467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8153, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8602560 KL Loss: 14.3580058 DSM Loss: 18.3818580 Overall Loss:34.6001197
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(36.1223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8651259 KL Loss: 14.3214971 DSM Loss: 18.2504327 Overall Loss:34.4370556
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(33.9841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8595708 KL Loss: 14.2111536 DSM Loss: 18.4237807 Overall Loss:34.4945049
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(36.8293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8635037 KL Loss: 14.2054471 DSM Loss: 18.5338483 Overall Loss:34.6027991
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(35.7876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8672795 KL Loss: 14.3024610 DSM Loss: 18.3723158 Overall Loss:34.5420565
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(31.8171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8838323 KL Loss: 14.3092639 DSM Loss: 18.3112432 Overall Loss:34.5043392
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.5347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8485575 KL Loss: 14.2152257 DSM Loss: 18.2141440 Overall Loss:34.2779273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5724321603775024


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(40.0669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9741109 KL Loss: 14.5576776 DSM Loss: 21.3167170 Overall Loss:37.8485056
Validation loss decreased (inf --> 0.652771).  Saving model ...
Updating learning rate to 0.0005
tensor(77.3949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9141483 KL Loss: 14.3620120 DSM Loss: 19.1558201 Overall Loss:35.4319802
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(26.2597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8650149 KL Loss: 14.2372547 DSM Loss: 19.3553233 Overall Loss:35.4575929
Validation loss decreased (0.652771 --> 0.651410).  Saving model ...
Updating learning rate to 0.000125
tensor(41.8411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2523, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8362863 KL Loss: 14.1645925 DSM Loss: 18.9854140 Overall Loss:34.9862927
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(29.5500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9680, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8273248 KL Loss: 14.0848377 DSM Loss: 19.4859742 Overall Loss:35.3981367
Validation loss decreased (0.651410 --> 0.651289).  Saving model ...
Updating learning rate to 3.125e-05
tensor(39.8957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8534582 KL Loss: 14.2959213 DSM Loss: 18.7493013 Overall Loss:34.8986807
Validation loss decreased (0.651289 --> 0.651254).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(30.9894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8321814 KL Loss: 14.0871775 DSM Loss: 19.3488018 Overall Loss:35.2681608
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(54.6232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8406785 KL Loss: 14.2078938 DSM Loss: 19.4805210 Overall Loss:35.5290931
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(33.4197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.3105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8160644 KL Loss: 14.1517904 DSM Loss: 19.0603686 Overall Loss:35.0282234
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(28.3555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8160729 KL Loss: 14.0911838 DSM Loss: 19.0990886 Overall Loss:35.0063453
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(50.1900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8789318 KL Loss: 14.3785575 DSM Loss: 18.7519391 Overall Loss:35.0094287
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(70.9190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8308779 KL Loss: 14.0332283 DSM Loss: 19.1810080 Overall Loss:35.0451140
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(30.2902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8513483 KL Loss: 14.3159322 DSM Loss: 18.6522421 Overall Loss:34.8195225
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(29.5789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8501147 KL Loss: 14.2283597 DSM Loss: 18.8205552 Overall Loss:34.8990295
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(39.3284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8485647 KL Loss: 14.3118984 DSM Loss: 18.8447081 Overall Loss:35.0051711
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(40.1800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8006694 KL Loss: 14.0447155 DSM Loss: 19.3460758 Overall Loss:35.1914606
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.1503405570983887


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.2750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9130904 KL Loss: 14.3069819 DSM Loss: 24.3646517 Overall Loss:40.5847243
Validation loss decreased (inf --> 0.627479).  Saving model ...
Updating learning rate to 0.0005
tensor(29.8065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9285034 KL Loss: 14.2846064 DSM Loss: 19.5768758 Overall Loss:35.7899852
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(36.6868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8870341 KL Loss: 14.2637976 DSM Loss: 18.9602580 Overall Loss:35.1110895
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(31.3915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8997562 KL Loss: 14.3711383 DSM Loss: 18.8006965 Overall Loss:35.0715908
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(33.8258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8791450 KL Loss: 14.2323497 DSM Loss: 18.9190253 Overall Loss:35.0305201
Validation loss decreased (0.627479 --> 0.627410).  Saving model ...
Updating learning rate to 3.125e-05
tensor(29.0530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8426597 KL Loss: 14.1910598 DSM Loss: 18.7240299 Overall Loss:34.7577492
Validation loss decreased (0.627410 --> 0.627356).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(31.5984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8426235 KL Loss: 14.1949891 DSM Loss: 18.5551525 Overall Loss:34.5927651
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(42.8016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.3518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8562179 KL Loss: 14.3405016 DSM Loss: 18.3102050 Overall Loss:34.5069244
Validation loss decreased (0.627356 --> 0.627344).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(68.0102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.3630, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8437429 KL Loss: 14.1123715 DSM Loss: 18.6606190 Overall Loss:34.6167330
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(28.9867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8511674 KL Loss: 14.2539459 DSM Loss: 18.6725313 Overall Loss:34.7776446
Validation loss decreased (0.627344 --> 0.627327).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(35.9259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8556130 KL Loss: 14.2567007 DSM Loss: 18.7351998 Overall Loss:34.8475134
Validation loss decreased (0.627327 --> 0.627299).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(29.6364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8517221 KL Loss: 14.2601788 DSM Loss: 18.4145298 Overall Loss:34.5264306
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-07
tensor(26.4612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8614435 KL Loss: 14.3400397 DSM Loss: 18.5581321 Overall Loss:34.7596153
Validation loss decreased (0.627299 --> 0.627273).  Saving model ...
Updating learning rate to 1.220703125e-07
tensor(38.7815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8404137 KL Loss: 14.2689171 DSM Loss: 18.5366602 Overall Loss:34.6459910
Validation loss decreased (0.627273 --> 0.627273).  Saving model ...
Updating learning rate to 6.103515625e-08
tensor(45.5804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8432866 KL Loss: 14.2498659 DSM Loss: 18.7694485 Overall Loss:34.8626010
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-08
tensor(28.6806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8788720 KL Loss: 14.3066027 DSM Loss: 18.6098072 Overall Loss:34.7952820
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-08
tensor(29.7551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8444621 KL Loss: 14.1956764 DSM Loss: 18.5156500 Overall Loss:34.5557883
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-09
tensor(32.7542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.8279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3216, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 85 | MSE Loss: 1.8562771 KL Loss: 14.2107527 DSM Loss: 18.6338777 Overall Loss:34.7009074
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-09
tensor(35.4686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.3490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 85 | MSE Loss: 1.8503236 KL Loss: 14.2164486 DSM Loss: 18.6447981 Overall Loss:34.7115702
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(31.7080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 85 | MSE Loss: 1.8590820 KL Loss: 14.3846373 DSM Loss: 18.1800462 Overall Loss:34.4237656
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(40.2364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 85 | MSE Loss: 1.8566430 KL Loss: 14.2471706 DSM Loss: 18.8220347 Overall Loss:34.9258482
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(26.1722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 85 | MSE Loss: 1.8474522 KL Loss: 14.2618766 DSM Loss: 18.6248134 Overall Loss:34.7341422
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(32.1330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 85 | MSE Loss: 1.8653912 KL Loss: 14.3754399 DSM Loss: 18.3921703 Overall Loss:34.6330013
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(32.6936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 85 | MSE Loss: 1.8243522 KL Loss: 14.2513691 DSM Loss: 18.6890587 Overall Loss:34.7647798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6987868547439575


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(57.5862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9071, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8969950 KL Loss: 14.3594272 DSM Loss: 20.8997973 Overall Loss:37.1562195
Validation loss decreased (inf --> 1.674269).  Saving model ...
Updating learning rate to 0.0005
tensor(36.3670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8736648 KL Loss: 14.2214885 DSM Loss: 18.3523825 Overall Loss:34.4475358
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(29.9661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9113879 KL Loss: 14.2841869 DSM Loss: 18.2577675 Overall Loss:34.4533423
Validation loss decreased (1.674269 --> 1.669137).  Saving model ...
Updating learning rate to 0.000125
tensor(28.9360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4861, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8811720 KL Loss: 14.2750308 DSM Loss: 17.9797265 Overall Loss:34.1359291
Validation loss decreased (1.669137 --> 1.666941).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.1585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8557830 KL Loss: 14.3082461 DSM Loss: 17.7831453 Overall Loss:33.9471745
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(31.5592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8496964 KL Loss: 14.2536159 DSM Loss: 18.0179166 Overall Loss:34.1212289
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(42.2402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8545393 KL Loss: 14.1852833 DSM Loss: 18.0521980 Overall Loss:34.0920206
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(38.3523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8517364 KL Loss: 14.1988298 DSM Loss: 17.9260647 Overall Loss:33.9766310
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(32.2708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.8270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8567058 KL Loss: 14.2469591 DSM Loss: 17.6417715 Overall Loss:33.7454364
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(52.2685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4953, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8720477 KL Loss: 14.3039755 DSM Loss: 18.0990026 Overall Loss:34.2750257
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(43.7098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8865847 KL Loss: 14.2741884 DSM Loss: 17.8290186 Overall Loss:33.9897918
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(27.8576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8575145 KL Loss: 14.2063935 DSM Loss: 17.6467683 Overall Loss:33.7106763
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(38.4213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8493949 KL Loss: 14.1422929 DSM Loss: 18.0977132 Overall Loss:34.0894011
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(39.7429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8471506 KL Loss: 14.2084782 DSM Loss: 17.7267902 Overall Loss:33.7824190
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.7988340854644775


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.3261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9003200 KL Loss: 14.3629623 DSM Loss: 22.7982915 Overall Loss:39.0615736
Validation loss decreased (inf --> 0.737341).  Saving model ...
Updating learning rate to 0.0005
tensor(53.6667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1530, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8765356 KL Loss: 14.2088669 DSM Loss: 19.8220244 Overall Loss:35.9074269
Validation loss decreased (0.737341 --> 0.737252).  Saving model ...
Updating learning rate to 0.00025
tensor(27.1410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8434886 KL Loss: 14.1000090 DSM Loss: 19.3368210 Overall Loss:35.2803185
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(31.7748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8624443 KL Loss: 14.2465365 DSM Loss: 18.6667663 Overall Loss:34.7757471
Validation loss decreased (0.737252 --> 0.737241).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.4908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8945926 KL Loss: 14.3538465 DSM Loss: 18.7610672 Overall Loss:35.0095065
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(32.2848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8884981 KL Loss: 14.3554391 DSM Loss: 18.3075801 Overall Loss:34.5515172
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(26.4042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8861450 KL Loss: 14.3492550 DSM Loss: 18.5757312 Overall Loss:34.8111314
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(30.6366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8793347 KL Loss: 14.4250113 DSM Loss: 18.1122058 Overall Loss:34.4165517
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(35.1624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8934772 KL Loss: 14.2478508 DSM Loss: 18.5461147 Overall Loss:34.6874425
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(50.1465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8915714 KL Loss: 14.2980031 DSM Loss: 18.5912013 Overall Loss:34.7807759
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(48.1987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8944584 KL Loss: 14.2845851 DSM Loss: 18.8721085 Overall Loss:35.0511519
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(77.9096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8657130 KL Loss: 14.2482708 DSM Loss: 18.8698881 Overall Loss:34.9838717
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(31.4324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8924444 KL Loss: 14.4059074 DSM Loss: 18.4716565 Overall Loss:34.7700083
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(25.7299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8902534 KL Loss: 14.4117723 DSM Loss: 18.3899144 Overall Loss:34.6919399
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6964769959449768


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(72.9115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8970210 KL Loss: 14.3238328 DSM Loss: 23.8180353 Overall Loss:40.0388891
Validation loss decreased (inf --> 0.768050).  Saving model ...
Updating learning rate to 0.0005
tensor(31.4193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9461541 KL Loss: 14.4482836 DSM Loss: 19.2634815 Overall Loss:35.6579194
Validation loss decreased (0.768050 --> 0.748677).  Saving model ...
Updating learning rate to 0.00025
tensor(23.8777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9032298 KL Loss: 14.3330686 DSM Loss: 19.3242680 Overall Loss:35.5605666
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(25.3480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4173, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8452352 KL Loss: 14.0612531 DSM Loss: 19.3224668 Overall Loss:35.2289553
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(22.4813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9080157 KL Loss: 14.3972773 DSM Loss: 18.7510096 Overall Loss:35.0563027
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(26.4669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8984211 KL Loss: 14.4018667 DSM Loss: 18.7510503 Overall Loss:35.0513380
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(28.8444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8584301 KL Loss: 14.1477942 DSM Loss: 19.5208172 Overall Loss:35.5270415
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(22.8325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8521179 KL Loss: 14.2466408 DSM Loss: 18.8334561 Overall Loss:34.9322147
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(28.1170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8801083 KL Loss: 14.4581140 DSM Loss: 18.4886702 Overall Loss:34.8268922
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(22.1662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5358, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8396204 KL Loss: 14.2991166 DSM Loss: 18.8741835 Overall Loss:35.0129204
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(29.3149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8675912 KL Loss: 14.2488908 DSM Loss: 18.7824442 Overall Loss:34.8989262
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(26.1970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6457, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8925558 KL Loss: 14.3288696 DSM Loss: 18.6762163 Overall Loss:34.8976417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6342633962631226


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.3728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1127, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9712835 KL Loss: 14.5102865 DSM Loss: 24.6480429 Overall Loss:41.1296129
Validation loss decreased (inf --> 1.566238).  Saving model ...
Updating learning rate to 0.0005
tensor(41.6011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9250697 KL Loss: 14.4155734 DSM Loss: 19.6132143 Overall Loss:35.9538575
Validation loss decreased (1.566238 --> 1.561228).  Saving model ...
Updating learning rate to 0.00025
tensor(31.9351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9198425 KL Loss: 14.3781985 DSM Loss: 19.5228738 Overall Loss:35.8209148
Validation loss decreased (1.561228 --> 1.558565).  Saving model ...
Updating learning rate to 0.000125
tensor(25.5940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8401331 KL Loss: 14.2095904 DSM Loss: 18.9304291 Overall Loss:34.9801527
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(29.0007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8487486 KL Loss: 14.2237805 DSM Loss: 19.1068213 Overall Loss:35.1793506
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(24.1867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8436106 KL Loss: 14.2050125 DSM Loss: 18.9513823 Overall Loss:35.0000053
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(32.5002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.8133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8170300 KL Loss: 14.2537069 DSM Loss: 19.0221708 Overall Loss:35.0929077
Validation loss decreased (1.558565 --> 1.558431).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(34.0390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8408574 KL Loss: 14.2040349 DSM Loss: 18.4044154 Overall Loss:34.4493076
Validation loss decreased (1.558431 --> 1.558365).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(30.7887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8693230 KL Loss: 14.2902909 DSM Loss: 18.9525783 Overall Loss:35.1121923
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(36.8060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0798, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8872329 KL Loss: 14.4354179 DSM Loss: 18.5076887 Overall Loss:34.8303393
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(28.0958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8829274 KL Loss: 14.3311617 DSM Loss: 18.4858257 Overall Loss:34.6999148
Validation loss decreased (1.558365 --> 1.558154).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(34.2486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8319417 KL Loss: 14.1445609 DSM Loss: 18.9368419 Overall Loss:34.9133445
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.8684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8472235 KL Loss: 14.2015476 DSM Loss: 18.9585921 Overall Loss:35.0073633
Validation loss decreased (1.558154 --> 1.558059).  Saving model ...
Updating learning rate to 1.220703125e-07
tensor(31.7819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3572, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8548145 KL Loss: 14.1529895 DSM Loss: 18.9315555 Overall Loss:34.9393594
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-08
tensor(27.2210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2657, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8470236 KL Loss: 14.3380262 DSM Loss: 19.0121860 Overall Loss:35.1972358
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-08
tensor(46.3855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8665214 KL Loss: 14.4156490 DSM Loss: 18.6414187 Overall Loss:34.9235891
Validation loss decreased (1.558059 --> 1.558004).  Saving model ...
Updating learning rate to 1.52587890625e-08
tensor(32.5489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8672469 KL Loss: 14.2309761 DSM Loss: 19.0264521 Overall Loss:35.1246751
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.62939453125e-09
tensor(34.4997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 85 | MSE Loss: 1.8879953 KL Loss: 14.3270853 DSM Loss: 18.5070847 Overall Loss:34.7221651
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.814697265625e-09
tensor(37.6262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 85 | MSE Loss: 1.8751319 KL Loss: 14.3220800 DSM Loss: 18.6177879 Overall Loss:34.8149999
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(37.2001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 85 | MSE Loss: 1.8475690 KL Loss: 14.2459585 DSM Loss: 18.8857138 Overall Loss:34.9792415
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(29.0667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 85 | MSE Loss: 1.8468551 KL Loss: 14.2121111 DSM Loss: 18.5140357 Overall Loss:34.5730018
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(27.3881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 85 | MSE Loss: 1.8607059 KL Loss: 14.3494308 DSM Loss: 18.9097453 Overall Loss:35.1198820
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(54.0957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 85 | MSE Loss: 1.8655008 KL Loss: 14.3427028 DSM Loss: 18.8380318 Overall Loss:35.0462352
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(38.2202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 85 | MSE Loss: 1.8647358 KL Loss: 14.3934718 DSM Loss: 18.2692966 Overall Loss:34.5275043
Validation loss decreased (1.558004 --> 1.557990).  Saving model ...
Updating learning rate to 5.960464477539063e-11
tensor(29.3194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 25, Steps: 85 | MSE Loss: 1.8584686 KL Loss: 14.2651008 DSM Loss: 18.7577046 Overall Loss:34.8812741
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.980232238769531e-11
tensor(29.4882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.1405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 26, Steps: 85 | MSE Loss: 1.8542423 KL Loss: 14.2567197 DSM Loss: 18.8821420 Overall Loss:34.9931039
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4901161193847657e-11
tensor(27.1718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 27, Steps: 85 | MSE Loss: 1.8293416 KL Loss: 14.1682077 DSM Loss: 18.9077756 Overall Loss:34.9053251
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.450580596923828e-12
tensor(26.8889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 28, Steps: 85 | MSE Loss: 1.8451358 KL Loss: 14.2129369 DSM Loss: 19.1393540 Overall Loss:35.1974267
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.725290298461914e-12
tensor(27.9845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.8304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2406, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 29, Steps: 85 | MSE Loss: 1.8671713 KL Loss: 14.3419360 DSM Loss: 18.7455924 Overall Loss:34.9546994
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.862645149230957e-12
tensor(30.8015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7542, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 30, Steps: 85 | MSE Loss: 1.8462526 KL Loss: 14.2430782 DSM Loss: 18.9951929 Overall Loss:35.0845238
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.313225746154785e-13
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.942450225353241


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(45.6744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.8760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8678412 KL Loss: 14.2764361 DSM Loss: 21.9981946 Overall Loss:38.1424716
Validation loss decreased (inf --> 1.062138).  Saving model ...
Updating learning rate to 0.0005
tensor(34.4829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.5926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4288, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8668437 KL Loss: 14.2184327 DSM Loss: 18.5056287 Overall Loss:34.5909048
Validation loss decreased (1.062138 --> 1.058065).  Saving model ...
Updating learning rate to 0.00025
tensor(26.9396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8276898 KL Loss: 14.1399783 DSM Loss: 18.2947045 Overall Loss:34.2623726
Validation loss decreased (1.058065 --> 1.046805).  Saving model ...
Updating learning rate to 0.000125
tensor(32.7002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8475530 KL Loss: 14.2217052 DSM Loss: 18.0983195 Overall Loss:34.1675777
Validation loss decreased (1.046805 --> 1.046628).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.5019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8390177 KL Loss: 14.2281011 DSM Loss: 17.9518967 Overall Loss:34.0190154
Validation loss decreased (1.046628 --> 1.045393).  Saving model ...
Updating learning rate to 3.125e-05
tensor(46.3894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8446826 KL Loss: 14.2826820 DSM Loss: 17.6500354 Overall Loss:33.7774004
Validation loss decreased (1.045393 --> 1.044619).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(48.2346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.1761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8034014 KL Loss: 14.0919665 DSM Loss: 18.0564006 Overall Loss:33.9517686
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(34.4162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5335, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8538692 KL Loss: 14.2520259 DSM Loss: 17.8529820 Overall Loss:33.9588772
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(31.2707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8226153 KL Loss: 14.2390349 DSM Loss: 17.7283773 Overall Loss:33.7900275
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(31.0462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8810972 KL Loss: 14.3096573 DSM Loss: 17.5493041 Overall Loss:33.7400585
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(31.7196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8531256 KL Loss: 14.3256664 DSM Loss: 17.7146260 Overall Loss:33.8934181
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(25.4441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8687270 KL Loss: 14.3165320 DSM Loss: 17.7081701 Overall Loss:33.8934292
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(33.2609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5875, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8222412 KL Loss: 14.1306476 DSM Loss: 18.1318261 Overall Loss:34.0847149
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(35.5303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8538808 KL Loss: 14.2606550 DSM Loss: 17.8040629 Overall Loss:33.9185987
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(31.9405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8717827 KL Loss: 14.2211642 DSM Loss: 17.5403425 Overall Loss:33.6332894
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(46.3639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4224, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8612406 KL Loss: 14.2697645 DSM Loss: 17.6161345 Overall Loss:33.7471396
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8905737996101379


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.6880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8435606 KL Loss: 14.3201619 DSM Loss: 22.8343654 Overall Loss:38.9980878
Validation loss decreased (inf --> 0.957116).  Saving model ...
Updating learning rate to 0.0005
tensor(45.0458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8464637 KL Loss: 14.1688810 DSM Loss: 19.2469901 Overall Loss:35.2623347
Validation loss decreased (0.957116 --> 0.954664).  Saving model ...
Updating learning rate to 0.00025
tensor(26.9372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8600577 KL Loss: 14.2227407 DSM Loss: 18.5735360 Overall Loss:34.6563343
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(52.8418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8100760 KL Loss: 14.1643894 DSM Loss: 18.5124004 Overall Loss:34.4868660
Validation loss decreased (0.954664 --> 0.952310).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.8850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8639514 KL Loss: 14.1875646 DSM Loss: 18.1308099 Overall Loss:34.1823260
Validation loss decreased (0.952310 --> 0.952059).  Saving model ...
Updating learning rate to 3.125e-05
tensor(25.8972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8776855 KL Loss: 14.2425605 DSM Loss: 18.3285197 Overall Loss:34.4487657
Validation loss decreased (0.952059 --> 0.951891).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(40.1491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8473817 KL Loss: 14.1801081 DSM Loss: 18.6347760 Overall Loss:34.6622659
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(24.6788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8518915 KL Loss: 14.1660677 DSM Loss: 18.4175028 Overall Loss:34.4354621
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(24.0585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8172458 KL Loss: 13.9188247 DSM Loss: 18.5677630 Overall Loss:34.3038334
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(26.7982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8178863 KL Loss: 14.1014386 DSM Loss: 18.7076135 Overall Loss:34.6269382
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(28.9322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5779, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8267945 KL Loss: 14.0524969 DSM Loss: 18.5198056 Overall Loss:34.3990968
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(23.0873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8418664 KL Loss: 14.1896939 DSM Loss: 18.6388086 Overall Loss:34.6703689
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(60.4502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3189, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8666327 KL Loss: 14.3178216 DSM Loss: 17.8547450 Overall Loss:34.0391993
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(37.3544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2882, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8791756 KL Loss: 14.3360053 DSM Loss: 17.9047050 Overall Loss:34.1198857
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(30.8273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8395342 KL Loss: 14.1214812 DSM Loss: 18.6089372 Overall Loss:34.5699526
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(28.1010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8644746 KL Loss: 14.2394433 DSM Loss: 18.2859485 Overall Loss:34.3898662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7316312193870544


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.6326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8550088 KL Loss: 14.1979719 DSM Loss: 22.1705346 Overall Loss:38.2235154
Validation loss decreased (inf --> 0.689606).  Saving model ...
Updating learning rate to 0.0005
tensor(46.8004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8087121 KL Loss: 14.1715616 DSM Loss: 19.6438647 Overall Loss:35.6241383
Validation loss decreased (0.689606 --> 0.687963).  Saving model ...
Updating learning rate to 0.00025
tensor(44.6805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9048820 KL Loss: 14.4255297 DSM Loss: 18.8820053 Overall Loss:35.2124170
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(26.9365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8415487 KL Loss: 14.0713577 DSM Loss: 19.6857069 Overall Loss:35.5986131
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(31.7565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8802828 KL Loss: 14.4167519 DSM Loss: 19.2556463 Overall Loss:35.5526808
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(61.6096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8665846 KL Loss: 14.3077237 DSM Loss: 19.0184393 Overall Loss:35.1927477
Validation loss decreased (0.687963 --> 0.687784).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(31.2065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9087752 KL Loss: 14.5625298 DSM Loss: 18.1730218 Overall Loss:34.6443267
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(31.2569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8630231 KL Loss: 14.2851250 DSM Loss: 18.6595953 Overall Loss:34.8077434
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(27.2068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8480972 KL Loss: 14.1615551 DSM Loss: 19.2249583 Overall Loss:35.2346105
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(29.1427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8738808 KL Loss: 14.2696275 DSM Loss: 19.0004424 Overall Loss:35.1439506
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(27.7392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8548272 KL Loss: 14.2604627 DSM Loss: 18.6869749 Overall Loss:34.8022649
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.0520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.9148583 KL Loss: 14.4578851 DSM Loss: 19.1928385 Overall Loss:35.5655821
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(30.0557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8885216 KL Loss: 14.3911526 DSM Loss: 18.5856786 Overall Loss:34.8653527
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(30.2991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8817472 KL Loss: 14.3200652 DSM Loss: 18.7849587 Overall Loss:34.9867710
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(27.6358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8804767 KL Loss: 14.4634175 DSM Loss: 18.7967245 Overall Loss:35.1406185
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(23.7749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3957, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8755365 KL Loss: 14.2889580 DSM Loss: 18.7421130 Overall Loss:34.9066075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.865105152130127


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(57.1401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9582, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9017601 KL Loss: 14.2329499 DSM Loss: 25.2033893 Overall Loss:41.3380994
Validation loss decreased (inf --> 1.365244).  Saving model ...
Updating learning rate to 0.0005
tensor(33.7755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.6935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8799451 KL Loss: 14.1107503 DSM Loss: 20.3916443 Overall Loss:36.3823396
Validation loss decreased (1.365244 --> 1.363295).  Saving model ...
Updating learning rate to 0.00025
tensor(56.4942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9030598 KL Loss: 14.2795704 DSM Loss: 19.7426593 Overall Loss:35.9252893
Validation loss decreased (1.363295 --> 1.357220).  Saving model ...
Updating learning rate to 0.000125
tensor(39.9121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1534, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8953431 KL Loss: 14.3128497 DSM Loss: 18.7499562 Overall Loss:34.9581489
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(47.7906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8777321 KL Loss: 14.2050585 DSM Loss: 18.9768465 Overall Loss:35.0596370
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(26.1546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8396400 KL Loss: 14.2562314 DSM Loss: 19.0638183 Overall Loss:35.1596898
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(53.7976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8327675 KL Loss: 14.1301471 DSM Loss: 19.2081823 Overall Loss:35.1710969
Validation loss decreased (1.357220 --> 1.357080).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(32.2012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8548842 KL Loss: 14.3384379 DSM Loss: 18.4053378 Overall Loss:34.5986600
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(36.5163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8300621 KL Loss: 14.2254288 DSM Loss: 18.9605212 Overall Loss:35.0160121
Validation loss decreased (1.357080 --> 1.357066).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(31.2412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2370, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8996841 KL Loss: 14.4178581 DSM Loss: 18.5976535 Overall Loss:34.9151959
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-07
tensor(25.2066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.6349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8435142 KL Loss: 14.3207266 DSM Loss: 18.7897438 Overall Loss:34.9539849
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-07
tensor(24.6068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8457716 KL Loss: 14.1854483 DSM Loss: 19.0965608 Overall Loss:35.1277805
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.0011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8592291 KL Loss: 14.2517912 DSM Loss: 18.9763117 Overall Loss:35.0873317
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-07
tensor(25.2441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8917944 KL Loss: 14.4178790 DSM Loss: 18.6433235 Overall Loss:34.9529969
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-08
tensor(30.6414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8801570 KL Loss: 14.3708704 DSM Loss: 18.5078641 Overall Loss:34.7588914
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-08
tensor(25.4426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8787566 KL Loss: 14.4544045 DSM Loss: 18.6029459 Overall Loss:34.9361070
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-08
tensor(29.0171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8348919 KL Loss: 14.2462320 DSM Loss: 18.8715665 Overall Loss:34.9526903
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-09
tensor(28.2546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3088, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 85 | MSE Loss: 1.8573373 KL Loss: 14.2387472 DSM Loss: 18.8268871 Overall Loss:34.9229715
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-09
tensor(28.4431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 85 | MSE Loss: 1.8649896 KL Loss: 14.4166967 DSM Loss: 18.8795166 Overall Loss:35.1612030
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9332780838012695


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.2619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8724320 KL Loss: 14.3558151 DSM Loss: 24.4684228 Overall Loss:40.6966697
Validation loss decreased (inf --> 1.082168).  Saving model ...
Updating learning rate to 0.0005
tensor(44.1585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9157366 KL Loss: 14.3075436 DSM Loss: 19.9004936 Overall Loss:36.1237736
Validation loss decreased (1.082168 --> 1.078934).  Saving model ...
Updating learning rate to 0.00025
tensor(34.8695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.2998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8608209 KL Loss: 14.2544706 DSM Loss: 19.0707930 Overall Loss:35.1860842
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(26.5031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8732146 KL Loss: 14.2119403 DSM Loss: 19.1665191 Overall Loss:35.2516739
Validation loss decreased (1.078934 --> 1.078680).  Saving model ...
Updating learning rate to 6.25e-05
tensor(41.4825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8788104 KL Loss: 14.3967100 DSM Loss: 18.7248922 Overall Loss:35.0004127
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(29.3784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8603608 KL Loss: 14.1329350 DSM Loss: 19.1232283 Overall Loss:35.1165241
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(34.4300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6571, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8332386 KL Loss: 14.1590245 DSM Loss: 19.0490725 Overall Loss:35.0413356
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(32.7787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5173, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8264018 KL Loss: 14.1798917 DSM Loss: 19.1803680 Overall Loss:35.1866614
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(33.3631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8712291 KL Loss: 14.3356668 DSM Loss: 19.0526492 Overall Loss:35.2595452
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(35.8030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0501, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8757844 KL Loss: 14.3509623 DSM Loss: 18.8516105 Overall Loss:35.0783572
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(40.4485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8397832 KL Loss: 14.3306604 DSM Loss: 18.8688270 Overall Loss:35.0392705
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(40.7213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7980561 KL Loss: 14.1026138 DSM Loss: 19.3736859 Overall Loss:35.2743557
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(28.2857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8610073 KL Loss: 14.2083124 DSM Loss: 19.2157003 Overall Loss:35.2850199
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(46.8083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8280131 KL Loss: 14.2032688 DSM Loss: 18.9053519 Overall Loss:34.9366337
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.666307270526886


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(64.4228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9342769 KL Loss: 14.4220197 DSM Loss: 23.6869124 Overall Loss:40.0432092
Validation loss decreased (inf --> 0.826565).  Saving model ...
Updating learning rate to 0.0005
tensor(42.3016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8743384 KL Loss: 14.1886306 DSM Loss: 19.7586464 Overall Loss:35.8216154
Validation loss decreased (0.826565 --> 0.824941).  Saving model ...
Updating learning rate to 0.00025
tensor(32.6339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8624311 KL Loss: 14.2994239 DSM Loss: 18.9778932 Overall Loss:35.1397482
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(34.8457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8903769 KL Loss: 14.2865241 DSM Loss: 18.9871647 Overall Loss:35.1640659
Validation loss decreased (0.824941 --> 0.823783).  Saving model ...
Updating learning rate to 6.25e-05
tensor(40.6973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8719448 KL Loss: 14.2817036 DSM Loss: 18.8872966 Overall Loss:35.0409447
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(39.3471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8666319 KL Loss: 14.2552947 DSM Loss: 18.6295612 Overall Loss:34.7514877
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(36.2348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8786889 KL Loss: 14.3509957 DSM Loss: 18.5618938 Overall Loss:34.7915781
Validation loss decreased (0.823783 --> 0.823148).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(29.8906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8589363 KL Loss: 14.2181493 DSM Loss: 18.8184759 Overall Loss:34.8955614
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(30.2781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8855607 KL Loss: 14.3324699 DSM Loss: 18.5829245 Overall Loss:34.8009551
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(26.8111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8753999 KL Loss: 14.2678004 DSM Loss: 18.6531626 Overall Loss:34.7963632
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(30.0780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8704560 KL Loss: 14.2182776 DSM Loss: 18.7422764 Overall Loss:34.8310097
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.4134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8506651 KL Loss: 14.2598322 DSM Loss: 19.0113839 Overall Loss:35.1218812
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(37.6416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8348365 KL Loss: 14.0276293 DSM Loss: 18.9721400 Overall Loss:34.8346057
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(46.6979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2350, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8334359 KL Loss: 14.1174866 DSM Loss: 18.6447628 Overall Loss:34.5956853
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(39.8563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8858489 KL Loss: 14.3299361 DSM Loss: 18.7271559 Overall Loss:34.9429406
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(31.6660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8786359 KL Loss: 14.1893089 DSM Loss: 18.6017394 Overall Loss:34.6696841
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(32.0147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8440329 KL Loss: 14.1165952 DSM Loss: 18.8247238 Overall Loss:34.7853519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.0208905935287476


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.9106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9092942 KL Loss: 14.3609255 DSM Loss: 23.0558614 Overall Loss:39.3260811
Validation loss decreased (inf --> 1.010012).  Saving model ...
Updating learning rate to 0.0005
tensor(52.7686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9075006 KL Loss: 14.3830523 DSM Loss: 19.6320568 Overall Loss:35.9226094
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(29.1449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8931645 KL Loss: 14.2572826 DSM Loss: 19.1460830 Overall Loss:35.2965299
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(30.9177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8833715 KL Loss: 14.2519980 DSM Loss: 18.9250446 Overall Loss:35.0604141
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(36.1961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8547575 KL Loss: 14.2430783 DSM Loss: 18.7230890 Overall Loss:34.8209247
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(33.6424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8438620 KL Loss: 14.1702613 DSM Loss: 18.7971512 Overall Loss:34.8112745
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(40.8291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8904124 KL Loss: 14.3275592 DSM Loss: 18.7343641 Overall Loss:34.9523360
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(44.6088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8654180 KL Loss: 14.2248060 DSM Loss: 18.6338940 Overall Loss:34.7241180
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(40.5241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8698846 KL Loss: 14.3147828 DSM Loss: 18.6734280 Overall Loss:34.8580955
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(40.6323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8461904 KL Loss: 14.2423750 DSM Loss: 18.7278421 Overall Loss:34.8164077
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(33.1603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8839315 KL Loss: 14.3259390 DSM Loss: 18.7584594 Overall Loss:34.9683299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.699835181236267


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.8483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.2285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9738673 KL Loss: 14.5213893 DSM Loss: 22.0214512 Overall Loss:38.5167077
Validation loss decreased (inf --> 1.036408).  Saving model ...
Updating learning rate to 0.0005
tensor(38.7170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8900078 KL Loss: 14.3359502 DSM Loss: 19.3473457 Overall Loss:35.5733039
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(31.1555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9008154 KL Loss: 14.2940810 DSM Loss: 18.7329374 Overall Loss:34.9278338
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(34.1829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8264448 KL Loss: 14.0903588 DSM Loss: 19.3397097 Overall Loss:35.2565133
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(27.7052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8459689 KL Loss: 14.2704815 DSM Loss: 18.8247848 Overall Loss:34.9412351
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(27.8775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8901667 KL Loss: 14.3385415 DSM Loss: 18.9116723 Overall Loss:35.1403805
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(29.3355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8554002 KL Loss: 14.2497474 DSM Loss: 18.6714222 Overall Loss:34.7765698
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(27.9098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8643427 KL Loss: 14.2365055 DSM Loss: 18.9310351 Overall Loss:35.0318832
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(30.3979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8491791 KL Loss: 14.2075223 DSM Loss: 18.8556474 Overall Loss:34.9123490
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(27.4609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8535258 KL Loss: 14.1992855 DSM Loss: 18.8554520 Overall Loss:34.9082631
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(41.8094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8497915 KL Loss: 14.2431430 DSM Loss: 19.3756298 Overall Loss:35.4685641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.2197233438491821


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(37.2541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8630215 KL Loss: 14.2912828 DSM Loss: 23.2031875 Overall Loss:39.3574917
Validation loss decreased (inf --> 1.299730).  Saving model ...
Updating learning rate to 0.0005
tensor(45.0617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8482850 KL Loss: 14.1815126 DSM Loss: 20.1282655 Overall Loss:36.1580631
Validation loss decreased (1.299730 --> 1.298560).  Saving model ...
Updating learning rate to 0.00025
tensor(25.6228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4118, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9008143 KL Loss: 14.5210409 DSM Loss: 18.9989370 Overall Loss:35.4207923
Validation loss decreased (1.298560 --> 1.297715).  Saving model ...
Updating learning rate to 0.000125
tensor(35.1957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8659143 KL Loss: 14.1767415 DSM Loss: 19.4087479 Overall Loss:35.4514036
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(25.6460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8582754 KL Loss: 14.1668957 DSM Loss: 19.1764149 Overall Loss:35.2015861
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(29.0974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8570156 KL Loss: 14.2214193 DSM Loss: 18.9628944 Overall Loss:35.0413294
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(25.6920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4193, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8232398 KL Loss: 14.0863561 DSM Loss: 19.1113723 Overall Loss:35.0209680
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(25.8795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8457958 KL Loss: 14.2025185 DSM Loss: 19.0371973 Overall Loss:35.0855114
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(33.9860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8444423 KL Loss: 14.2551382 DSM Loss: 19.2651477 Overall Loss:35.3647282
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(21.8444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8787119 KL Loss: 14.3889865 DSM Loss: 18.9719723 Overall Loss:35.2396707
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(44.4726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.0598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8997878 KL Loss: 14.5667189 DSM Loss: 18.9974839 Overall Loss:35.4639905
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(27.3257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8908912 KL Loss: 14.4554463 DSM Loss: 18.8420853 Overall Loss:35.1884226
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(38.9468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8547422 KL Loss: 14.3330608 DSM Loss: 19.0467292 Overall Loss:35.2345322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.2646805047988892


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(61.3062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9126450 KL Loss: 14.3366655 DSM Loss: 22.2981809 Overall Loss:38.5474914
Validation loss decreased (inf --> 0.775123).  Saving model ...
Updating learning rate to 0.0005
tensor(28.0173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8572948 KL Loss: 14.1624553 DSM Loss: 19.2855539 Overall Loss:35.3053041
Validation loss decreased (0.775123 --> 0.760258).  Saving model ...
Updating learning rate to 0.00025
tensor(34.3228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9089858 KL Loss: 14.3764757 DSM Loss: 18.3652208 Overall Loss:34.6506823
Validation loss decreased (0.760258 --> 0.756565).  Saving model ...
Updating learning rate to 0.000125
tensor(38.4690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4244, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8267768 KL Loss: 14.2130107 DSM Loss: 18.9624011 Overall Loss:35.0021884
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(32.7214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8835135 KL Loss: 14.2376158 DSM Loss: 18.2896054 Overall Loss:34.4107348
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(32.8586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8618728 KL Loss: 14.3238972 DSM Loss: 18.5554759 Overall Loss:34.7412458
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(32.3240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8832646 KL Loss: 14.3495723 DSM Loss: 18.2547979 Overall Loss:34.4876350
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(53.2340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8655433 KL Loss: 14.3294463 DSM Loss: 17.9934723 Overall Loss:34.1884618
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(35.5907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8371137 KL Loss: 14.1935721 DSM Loss: 18.8080981 Overall Loss:34.8387836
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(34.2215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8674198 KL Loss: 14.2681680 DSM Loss: 18.5158384 Overall Loss:34.6514263
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(35.3221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8588040 KL Loss: 14.2387080 DSM Loss: 18.4820425 Overall Loss:34.5795545
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(33.5099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8636787 KL Loss: 14.2706757 DSM Loss: 18.6633127 Overall Loss:34.7976670
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(26.3632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8658786 KL Loss: 14.2788237 DSM Loss: 18.5016589 Overall Loss:34.6463612
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6977052092552185


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.2386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8921007 KL Loss: 14.2428880 DSM Loss: 22.4109681 Overall Loss:38.5459567
Validation loss decreased (inf --> 0.685493).  Saving model ...
Updating learning rate to 0.0005
tensor(26.9384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8964, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8913338 KL Loss: 14.2021134 DSM Loss: 19.4735247 Overall Loss:35.5669718
Validation loss decreased (0.685493 --> 0.643312).  Saving model ...
Updating learning rate to 0.00025
tensor(43.9729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9186287 KL Loss: 14.3576104 DSM Loss: 18.8226955 Overall Loss:35.0989345
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(30.3221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8560584 KL Loss: 14.2236905 DSM Loss: 19.0260838 Overall Loss:35.1058327
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(53.9290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8425374 KL Loss: 14.2168095 DSM Loss: 18.0792707 Overall Loss:34.1386176
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(22.2315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8528025 KL Loss: 14.3204673 DSM Loss: 18.8506059 Overall Loss:35.0238759
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(28.4465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9264708 KL Loss: 14.5459335 DSM Loss: 18.1765309 Overall Loss:34.6489353
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(27.0592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8705179 KL Loss: 14.2927485 DSM Loss: 17.8804638 Overall Loss:34.0437303
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(23.6807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8486339 KL Loss: 14.0713613 DSM Loss: 19.0199580 Overall Loss:34.9399532
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(22.2477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8667989 KL Loss: 14.3308687 DSM Loss: 18.3045221 Overall Loss:34.5021898
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(27.8288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8765533 KL Loss: 14.3772549 DSM Loss: 18.3483543 Overall Loss:34.6021626
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(22.3614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5609, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8400665 KL Loss: 14.1735999 DSM Loss: 18.5620306 Overall Loss:34.5756969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7670491337776184


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(86.2044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2896, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9771932 KL Loss: 14.4276205 DSM Loss: 23.2396956 Overall Loss:39.6445092
Validation loss decreased (inf --> 0.460125).  Saving model ...
Updating learning rate to 0.0005
tensor(28.9155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9811963 KL Loss: 14.4829672 DSM Loss: 19.8113616 Overall Loss:36.2755250
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(25.1364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9154137 KL Loss: 14.2194102 DSM Loss: 19.3074254 Overall Loss:35.4422493
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(41.8694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.2311, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8732510 KL Loss: 14.3063742 DSM Loss: 18.6333707 Overall Loss:34.8129959
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(24.1587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1557, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8405316 KL Loss: 14.1092302 DSM Loss: 19.0649562 Overall Loss:35.0147179
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(25.7959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2225, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8769350 KL Loss: 14.4100516 DSM Loss: 18.4130104 Overall Loss:34.6999969
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(41.7998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8890419 KL Loss: 14.2499032 DSM Loss: 18.7905405 Overall Loss:34.9294856
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(33.8397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8576867 KL Loss: 14.1876660 DSM Loss: 18.8881422 Overall Loss:34.9334949
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(30.1424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9692, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8637170 KL Loss: 14.2233000 DSM Loss: 18.7107030 Overall Loss:34.7977202
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(44.0337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8931620 KL Loss: 14.3076861 DSM Loss: 17.9580973 Overall Loss:34.1589452
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(28.9906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4426, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8658117 KL Loss: 14.2653083 DSM Loss: 18.6043505 Overall Loss:34.7354706
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6459425091743469


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.0984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9623749 KL Loss: 14.4848927 DSM Loss: 23.5883580 Overall Loss:40.0356254
Validation loss decreased (inf --> 1.487873).  Saving model ...
Updating learning rate to 0.0005
tensor(29.4033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8707750 KL Loss: 14.2718909 DSM Loss: 19.8677769 Overall Loss:36.0104426
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(31.0081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5331, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8625488 KL Loss: 14.2399111 DSM Loss: 19.6861851 Overall Loss:35.7886450
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(38.4442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8917979 KL Loss: 14.3327446 DSM Loss: 19.0789228 Overall Loss:35.3034652
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(39.3624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8445000 KL Loss: 14.2535274 DSM Loss: 19.2468058 Overall Loss:35.3448332
Validation loss decreased (1.487873 --> 1.486239).  Saving model ...
Updating learning rate to 3.125e-05
tensor(37.1154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8335338 KL Loss: 14.1542383 DSM Loss: 19.0208569 Overall Loss:35.0086290
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(45.9618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8666753 KL Loss: 14.3184039 DSM Loss: 18.8417373 Overall Loss:35.0268164
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(34.2141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8790947 KL Loss: 14.3073763 DSM Loss: 18.9330337 Overall Loss:35.1195048
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(37.7448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8572815 KL Loss: 14.2119744 DSM Loss: 19.0577309 Overall Loss:35.1269869
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(28.0879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8515882 KL Loss: 14.2187320 DSM Loss: 19.0387458 Overall Loss:35.1090659
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(28.6164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6129, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8670787 KL Loss: 14.3957809 DSM Loss: 18.7865370 Overall Loss:35.0493965
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(45.3048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8561854 KL Loss: 14.3145027 DSM Loss: 19.1946703 Overall Loss:35.3653584
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.3028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8621949 KL Loss: 14.1593882 DSM Loss: 19.1309444 Overall Loss:35.1525276
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(53.5804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8839391 KL Loss: 14.2137996 DSM Loss: 19.2700339 Overall Loss:35.3677728
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(35.9365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8715436 KL Loss: 14.3373332 DSM Loss: 19.0987566 Overall Loss:35.3076333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.7181721925735474


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.4518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8825469 KL Loss: 14.3685779 DSM Loss: 21.1330114 Overall Loss:37.3841364
Validation loss decreased (inf --> 1.099853).  Saving model ...
Updating learning rate to 0.0005
tensor(33.8733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9079037 KL Loss: 14.2935011 DSM Loss: 19.9736947 Overall Loss:36.1750996
Validation loss decreased (1.099853 --> 1.095590).  Saving model ...
Updating learning rate to 0.00025
tensor(36.5959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9135549 KL Loss: 14.3781783 DSM Loss: 19.1408174 Overall Loss:35.4325506
Validation loss decreased (1.095590 --> 1.086852).  Saving model ...
Updating learning rate to 0.000125
tensor(30.2719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0148, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8553021 KL Loss: 14.0989905 DSM Loss: 18.9173711 Overall Loss:34.8716635
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(43.2470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8765297 KL Loss: 14.2945606 DSM Loss: 18.7215014 Overall Loss:34.8925918
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(31.7186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.1952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8177071 KL Loss: 14.1502892 DSM Loss: 19.0722563 Overall Loss:35.0402525
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(33.9262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5522, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8862310 KL Loss: 14.3557069 DSM Loss: 18.3836003 Overall Loss:34.6255381
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(30.8815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8688023 KL Loss: 14.2545875 DSM Loss: 19.0410940 Overall Loss:35.1644834
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(59.4160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8582625 KL Loss: 14.2193690 DSM Loss: 18.9952187 Overall Loss:35.0728504
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(29.2500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8738548 KL Loss: 14.2820220 DSM Loss: 18.6612167 Overall Loss:34.8170935
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(46.4675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2197, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8657344 KL Loss: 14.1966795 DSM Loss: 18.8709980 Overall Loss:34.9334119
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(26.2562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8752314 KL Loss: 14.2454885 DSM Loss: 18.7554679 Overall Loss:34.8761878
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(25.5388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8658373 KL Loss: 14.1416762 DSM Loss: 18.9183496 Overall Loss:34.9258629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.385079026222229


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(41.1998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8360793 KL Loss: 14.2754009 DSM Loss: 24.4182883 Overall Loss:40.5297685
Validation loss decreased (inf --> 0.570308).  Saving model ...
Updating learning rate to 0.0005
tensor(26.4972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8819219 KL Loss: 14.2046883 DSM Loss: 21.3095238 Overall Loss:37.3961340
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(43.1835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8561790 KL Loss: 14.3319036 DSM Loss: 20.4615178 Overall Loss:36.6496003
Validation loss decreased (0.570308 --> 0.570154).  Saving model ...
Updating learning rate to 0.000125
tensor(37.5351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9206471 KL Loss: 14.3219414 DSM Loss: 19.5489944 Overall Loss:35.7915829
Validation loss decreased (0.570154 --> 0.569881).  Saving model ...
Updating learning rate to 6.25e-05
tensor(39.0461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8731121 KL Loss: 14.3488066 DSM Loss: 19.8927163 Overall Loss:36.1146353
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(32.0751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4118, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8214089 KL Loss: 13.9904288 DSM Loss: 20.6625793 Overall Loss:36.4744171
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(25.9305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8435180 KL Loss: 14.1855743 DSM Loss: 19.9025787 Overall Loss:35.9316711
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(30.8900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0092, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8310211 KL Loss: 14.2382845 DSM Loss: 19.2581025 Overall Loss:35.3274081
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(28.3009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8741659 KL Loss: 14.4301791 DSM Loss: 19.0330562 Overall Loss:35.3374012
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(41.9961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8882671 KL Loss: 14.3570102 DSM Loss: 18.7732625 Overall Loss:35.0185399
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(27.1989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8900641 KL Loss: 14.3781796 DSM Loss: 18.7877133 Overall Loss:35.0559570
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.3015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8608694 KL Loss: 14.2932726 DSM Loss: 19.2980943 Overall Loss:35.4522363
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(35.1474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8148112 KL Loss: 14.1518748 DSM Loss: 19.1636072 Overall Loss:35.1302934
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(26.7634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8828505 KL Loss: 14.4992696 DSM Loss: 18.5445973 Overall Loss:34.9267175
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8853288888931274


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(73.9094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9230251 KL Loss: 14.2661919 DSM Loss: 22.8627976 Overall Loss:39.0520146
Validation loss decreased (inf --> 0.624263).  Saving model ...
Updating learning rate to 0.0005
tensor(57.2216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8664919 KL Loss: 14.2447801 DSM Loss: 20.0240140 Overall Loss:36.1352860
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(39.6911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9449369 KL Loss: 14.4023721 DSM Loss: 19.5318731 Overall Loss:35.8791822
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(26.4848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2832, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8163009 KL Loss: 14.0888524 DSM Loss: 19.6889660 Overall Loss:35.5941192
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(23.6543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8355796 KL Loss: 14.3518811 DSM Loss: 19.1593944 Overall Loss:35.3468551
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(21.9035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2419, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8943223 KL Loss: 14.4858568 DSM Loss: 19.3314226 Overall Loss:35.7116017
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(25.7065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8314937 KL Loss: 13.9989814 DSM Loss: 19.6767116 Overall Loss:35.5071867
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(24.5180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7908437 KL Loss: 14.0772704 DSM Loss: 19.5563663 Overall Loss:35.4244803
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(28.6127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8270087 KL Loss: 14.3399495 DSM Loss: 18.8865062 Overall Loss:35.0534644
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(27.9829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8273351 KL Loss: 14.4162427 DSM Loss: 18.8121232 Overall Loss:35.0557011
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(23.5869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8953391 KL Loss: 14.6135924 DSM Loss: 18.8962118 Overall Loss:35.4051433
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.1400789022445679


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(55.8520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5656, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9776014 KL Loss: 14.4430779 DSM Loss: 23.1261667 Overall Loss:39.5468458
Validation loss decreased (inf --> 0.500335).  Saving model ...
Updating learning rate to 0.0005
tensor(38.9799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9454384 KL Loss: 14.3884436 DSM Loss: 19.0327873 Overall Loss:35.3666693
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(24.7400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8038071 KL Loss: 14.1143752 DSM Loss: 19.6244596 Overall Loss:35.5426421
Validation loss decreased (0.500335 --> 0.499855).  Saving model ...
Updating learning rate to 0.000125
tensor(39.7284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8826313 KL Loss: 14.2804521 DSM Loss: 19.1969046 Overall Loss:35.3599880
Validation loss decreased (0.499855 --> 0.497916).  Saving model ...
Updating learning rate to 6.25e-05
tensor(48.6812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8656, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8718240 KL Loss: 14.2170422 DSM Loss: 18.5350213 Overall Loss:34.6238874
Validation loss decreased (0.497916 --> 0.496290).  Saving model ...
Updating learning rate to 3.125e-05
tensor(27.2295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8184997 KL Loss: 14.1766071 DSM Loss: 18.8023289 Overall Loss:34.7974358
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(26.8591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8730513 KL Loss: 14.4855429 DSM Loss: 18.7612306 Overall Loss:35.1198249
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(34.6196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8602495 KL Loss: 14.1867664 DSM Loss: 18.9529328 Overall Loss:34.9999486
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(57.1298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8545849 KL Loss: 14.0717070 DSM Loss: 18.4721905 Overall Loss:34.3984824
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(34.5770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8729690 KL Loss: 14.1085050 DSM Loss: 18.9854380 Overall Loss:34.9669122
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(25.9182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8668182 KL Loss: 14.2767836 DSM Loss: 18.7922862 Overall Loss:34.9358880
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.9462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6996, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8383984 KL Loss: 14.1926126 DSM Loss: 19.4684974 Overall Loss:35.4995082
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(23.3301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8482745 KL Loss: 14.1884174 DSM Loss: 19.1623627 Overall Loss:35.1990545
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(23.8177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8683191 KL Loss: 14.2898105 DSM Loss: 18.7774687 Overall Loss:34.9355982
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(25.4396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8964405 KL Loss: 14.4161101 DSM Loss: 19.1028996 Overall Loss:35.4154503
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.778684139251709


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(63.6678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9869388 KL Loss: 14.5250311 DSM Loss: 22.9940350 Overall Loss:39.5060048
Validation loss decreased (inf --> 0.635936).  Saving model ...
Updating learning rate to 0.0005
tensor(33.0850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8495724 KL Loss: 14.1949530 DSM Loss: 20.0686351 Overall Loss:36.1131603
Validation loss decreased (0.635936 --> 0.631242).  Saving model ...
Updating learning rate to 0.00025
tensor(29.7509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8923391 KL Loss: 14.2899214 DSM Loss: 19.1525277 Overall Loss:35.3347882
Validation loss decreased (0.631242 --> 0.630381).  Saving model ...
Updating learning rate to 0.000125
tensor(26.7460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8846995 KL Loss: 14.2924153 DSM Loss: 19.0508766 Overall Loss:35.2279912
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(40.9692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8633827 KL Loss: 14.2428576 DSM Loss: 19.0460728 Overall Loss:35.1523132
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(44.7425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8523855 KL Loss: 14.1871139 DSM Loss: 19.0618589 Overall Loss:35.1013583
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(28.2530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3884, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8702773 KL Loss: 14.3646944 DSM Loss: 19.1328624 Overall Loss:35.3678342
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(34.9182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8548350 KL Loss: 14.3038504 DSM Loss: 18.7141308 Overall Loss:34.8728161
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(38.3827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8579535 KL Loss: 14.1609759 DSM Loss: 19.2121061 Overall Loss:35.2310355
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(36.2468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8668199 KL Loss: 14.3036076 DSM Loss: 18.8195103 Overall Loss:34.9899379
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(30.6449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8982, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.9102472 KL Loss: 14.4665915 DSM Loss: 18.7040644 Overall Loss:35.0809032
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(38.6151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8520858 KL Loss: 14.2843460 DSM Loss: 19.0546838 Overall Loss:35.1911153
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(52.2996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8709784 KL Loss: 14.2512353 DSM Loss: 18.6592851 Overall Loss:34.7814985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.716003954410553


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.4615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8893827 KL Loss: 14.2735387 DSM Loss: 23.4142007 Overall Loss:39.5771220
Validation loss decreased (inf --> 0.668966).  Saving model ...
Updating learning rate to 0.0005
tensor(30.6652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9456730 KL Loss: 14.3962089 DSM Loss: 19.8987339 Overall Loss:36.2406158
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(26.7022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8825541 KL Loss: 14.1693329 DSM Loss: 19.2614554 Overall Loss:35.3133422
Validation loss decreased (0.668966 --> 0.668871).  Saving model ...
Updating learning rate to 0.000125
tensor(34.9231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8727584 KL Loss: 14.2165732 DSM Loss: 19.4238221 Overall Loss:35.5131537
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(29.6198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8816510 KL Loss: 14.2574223 DSM Loss: 19.3884781 Overall Loss:35.5275514
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(56.9811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8946178 KL Loss: 14.2962730 DSM Loss: 19.0740026 Overall Loss:35.2648933
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(39.3360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8766882 KL Loss: 14.3051031 DSM Loss: 19.3607982 Overall Loss:35.5425895
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(29.6870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8720263 KL Loss: 14.2004645 DSM Loss: 18.8602851 Overall Loss:34.9327758
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(27.9645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8426933 KL Loss: 14.0901591 DSM Loss: 19.1899857 Overall Loss:35.1228385
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(27.9162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.9044368 KL Loss: 14.2271098 DSM Loss: 19.4038262 Overall Loss:35.5353728
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(27.2345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8570101 KL Loss: 14.2308538 DSM Loss: 19.2861930 Overall Loss:35.3740567
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(29.9948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8503984 KL Loss: 14.1986814 DSM Loss: 19.4482517 Overall Loss:35.4973316
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(30.4035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8480249 KL Loss: 14.1938700 DSM Loss: 19.2797443 Overall Loss:35.3216389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5289725065231323


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.1611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1828, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8658033 KL Loss: 14.2450473 DSM Loss: 21.7124041 Overall Loss:37.8232545
Validation loss decreased (inf --> 1.265193).  Saving model ...
Updating learning rate to 0.0005
tensor(37.4021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8698738 KL Loss: 14.2328970 DSM Loss: 19.3485515 Overall Loss:35.4513221
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(35.4678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9203186 KL Loss: 14.2805426 DSM Loss: 19.1322674 Overall Loss:35.3331285
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(28.6577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8802506 KL Loss: 14.3223128 DSM Loss: 18.8493993 Overall Loss:35.0519626
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(37.1159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8658995 KL Loss: 14.2518451 DSM Loss: 18.8287466 Overall Loss:34.9464914
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(30.9314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8567284 KL Loss: 14.2348848 DSM Loss: 18.8481896 Overall Loss:34.9398027
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(31.6036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8834553 KL Loss: 14.2837716 DSM Loss: 18.7217011 Overall Loss:34.8889282
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(24.6066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9762, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8317645 KL Loss: 14.1439815 DSM Loss: 18.9443313 Overall Loss:34.9200772
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(36.3909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1964, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8661153 KL Loss: 14.2159483 DSM Loss: 18.8950880 Overall Loss:34.9771516
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(32.5423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8467003 KL Loss: 14.2209591 DSM Loss: 18.7787688 Overall Loss:34.8464280
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(29.8464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8776758 KL Loss: 14.2832602 DSM Loss: 18.5846439 Overall Loss:34.7455798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.7705589532852173


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(66.4760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.8874, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8896176 KL Loss: 14.2997583 DSM Loss: 23.6571500 Overall Loss:39.8465259
Validation loss decreased (inf --> 1.186093).  Saving model ...
Updating learning rate to 0.0005
tensor(28.7613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9150452 KL Loss: 14.3563413 DSM Loss: 19.9932569 Overall Loss:36.2646433
Validation loss decreased (1.186093 --> 1.154233).  Saving model ...
Updating learning rate to 0.00025
tensor(25.5791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8888967 KL Loss: 14.1877588 DSM Loss: 19.1884207 Overall Loss:35.2650760
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(57.2999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8430453 KL Loss: 14.2469137 DSM Loss: 18.9010089 Overall Loss:34.9909679
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(29.9330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8321170 KL Loss: 14.0935429 DSM Loss: 19.1748282 Overall Loss:35.1004880
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(40.5790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8409900 KL Loss: 14.1509833 DSM Loss: 19.3891332 Overall Loss:35.3811064
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(29.0675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8350, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8266866 KL Loss: 14.0688886 DSM Loss: 19.1285511 Overall Loss:35.0241263
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(27.7459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8289225 KL Loss: 14.3189420 DSM Loss: 18.5303024 Overall Loss:34.6781669
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(55.5866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8136807 KL Loss: 14.0265997 DSM Loss: 19.1427020 Overall Loss:34.9829824
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(32.2968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.9682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8219553 KL Loss: 14.2575628 DSM Loss: 18.6028894 Overall Loss:34.6824074
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(52.5324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8829418 KL Loss: 14.5140447 DSM Loss: 18.3223532 Overall Loss:34.7193396
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(25.9212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8211415 KL Loss: 14.3037120 DSM Loss: 18.3624875 Overall Loss:34.4873412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.0103052854537964


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.6753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9011160 KL Loss: 14.5025400 DSM Loss: 22.6658434 Overall Loss:39.0694991
Validation loss decreased (inf --> 0.784130).  Saving model ...
Updating learning rate to 0.0005
tensor(43.1402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9243699 KL Loss: 14.3894728 DSM Loss: 19.8090506 Overall Loss:36.1228935
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(22.8407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8662344 KL Loss: 14.3185622 DSM Loss: 19.2313050 Overall Loss:35.4161016
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(30.4651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8476724 KL Loss: 14.2485759 DSM Loss: 19.4038732 Overall Loss:35.5001216
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(43.7906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9538, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9351506 KL Loss: 14.4446612 DSM Loss: 18.5426609 Overall Loss:34.9224728
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(24.6875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8980885 KL Loss: 14.3642487 DSM Loss: 18.3933317 Overall Loss:34.6556688
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(25.7001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8505839 KL Loss: 14.2032808 DSM Loss: 18.5828319 Overall Loss:34.6366965
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(28.1792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8544160 KL Loss: 14.1022903 DSM Loss: 19.3054322 Overall Loss:35.2621385
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(29.3466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8820774 KL Loss: 14.3868221 DSM Loss: 18.9169122 Overall Loss:35.1858115
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(29.3959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8429619 KL Loss: 14.1878030 DSM Loss: 19.3536045 Overall Loss:35.3843694
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(39.8615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8438945 KL Loss: 14.1631628 DSM Loss: 19.1144936 Overall Loss:35.1215510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7188757061958313


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.0897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9051629 KL Loss: 14.3376939 DSM Loss: 25.7075845 Overall Loss:41.9504410
Validation loss decreased (inf --> 1.353139).  Saving model ...
Updating learning rate to 0.0005
tensor(42.8193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9089393 KL Loss: 14.2985294 DSM Loss: 19.3070875 Overall Loss:35.5145564
Validation loss decreased (1.353139 --> 1.348185).  Saving model ...
Updating learning rate to 0.00025
tensor(34.3698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8863374 KL Loss: 14.3152518 DSM Loss: 18.9436591 Overall Loss:35.1452483
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(48.0404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8617965 KL Loss: 14.1100045 DSM Loss: 18.7008578 Overall Loss:34.6726585
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(35.7016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8465396 KL Loss: 14.1603213 DSM Loss: 18.5664867 Overall Loss:34.5733477
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(32.3330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8338004 KL Loss: 14.2601999 DSM Loss: 18.4489713 Overall Loss:34.5429716
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(45.6122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8495538 KL Loss: 14.1376798 DSM Loss: 18.5371584 Overall Loss:34.5243920
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(37.7143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8539029 KL Loss: 14.1544613 DSM Loss: 18.5120317 Overall Loss:34.5203960
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(33.3885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8587095 KL Loss: 14.2426465 DSM Loss: 18.0501082 Overall Loss:34.1514643
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(36.9030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8416241 KL Loss: 14.1182214 DSM Loss: 18.7295880 Overall Loss:34.6894333
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(30.3128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1848, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8271243 KL Loss: 14.1656994 DSM Loss: 18.9159094 Overall Loss:34.9087333
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(44.6693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8443301 KL Loss: 14.1531434 DSM Loss: 18.6650708 Overall Loss:34.6625444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.02541184425354


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.7645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6523, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9249199 KL Loss: 14.3477892 DSM Loss: 21.9422052 Overall Loss:38.2149142
Validation loss decreased (inf --> 0.333340).  Saving model ...
Updating learning rate to 0.0005
tensor(46.7991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8906271 KL Loss: 14.2469491 DSM Loss: 18.7667627 Overall Loss:34.9043392
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(26.2268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8631199 KL Loss: 14.2181022 DSM Loss: 18.8883531 Overall Loss:34.9695751
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(35.0236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8559121 KL Loss: 14.2132681 DSM Loss: 18.5280095 Overall Loss:34.5971896
Validation loss decreased (0.333340 --> 0.331554).  Saving model ...
Updating learning rate to 6.25e-05
tensor(31.7353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8597660 KL Loss: 14.2224210 DSM Loss: 18.5205480 Overall Loss:34.6027350
Validation loss decreased (0.331554 --> 0.331490).  Saving model ...
Updating learning rate to 3.125e-05
tensor(28.1338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8779, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8412628 KL Loss: 14.2411129 DSM Loss: 18.1398685 Overall Loss:34.2222441
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(28.8554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7926, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8483102 KL Loss: 14.2130903 DSM Loss: 18.3696983 Overall Loss:34.4310987
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(25.0555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8869337 KL Loss: 14.2348371 DSM Loss: 18.1820557 Overall Loss:34.3038265
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(26.1938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8644351 KL Loss: 14.2934035 DSM Loss: 18.1573238 Overall Loss:34.3151625
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(30.2884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4927, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8587559 KL Loss: 14.3140943 DSM Loss: 18.1874468 Overall Loss:34.3602971
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(33.9426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2636, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8136098 KL Loss: 13.9901455 DSM Loss: 18.6561810 Overall Loss:34.4599361
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(34.5699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8480721 KL Loss: 14.2039803 DSM Loss: 18.0307632 Overall Loss:34.0828158
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(43.9656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8495008 KL Loss: 14.1296798 DSM Loss: 18.3966494 Overall Loss:34.3758299
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(46.9497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8495861 KL Loss: 14.2154433 DSM Loss: 18.1981441 Overall Loss:34.2631735
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(36.0905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8329347 KL Loss: 14.1881631 DSM Loss: 18.3996397 Overall Loss:34.4207375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.0972776412963867


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.8278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.5807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9562678 KL Loss: 14.4629581 DSM Loss: 23.3536711 Overall Loss:39.7728969
Validation loss decreased (inf --> 0.922490).  Saving model ...
Updating learning rate to 0.0005
tensor(45.0065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9045842 KL Loss: 14.2628648 DSM Loss: 19.6556225 Overall Loss:35.8230712
Validation loss decreased (0.922490 --> 0.921641).  Saving model ...
Updating learning rate to 0.00025
tensor(29.2412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8675271 KL Loss: 14.2071744 DSM Loss: 19.3876016 Overall Loss:35.4623030
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(30.2337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8911208 KL Loss: 14.2711917 DSM Loss: 18.9045635 Overall Loss:35.0668762
Validation loss decreased (0.921641 --> 0.919390).  Saving model ...
Updating learning rate to 6.25e-05
tensor(38.4932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8423393 KL Loss: 14.1851031 DSM Loss: 19.3563719 Overall Loss:35.3838143
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(24.8247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8620925 KL Loss: 14.2795004 DSM Loss: 18.6874645 Overall Loss:34.8290574
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(26.6656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5848, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8411690 KL Loss: 14.1992570 DSM Loss: 18.9665557 Overall Loss:35.0069818
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(24.8437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8589642 KL Loss: 14.2496918 DSM Loss: 18.9285331 Overall Loss:35.0371891
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(33.7124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8612842 KL Loss: 14.3369826 DSM Loss: 18.9877811 Overall Loss:35.1860479
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(50.2398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8832640 KL Loss: 14.4082851 DSM Loss: 18.7188634 Overall Loss:35.0104123
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(26.3152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4891, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8273884 KL Loss: 14.0177285 DSM Loss: 19.0018796 Overall Loss:34.8469964
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(32.2432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.4958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.2943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8337387 KL Loss: 14.1956412 DSM Loss: 18.8173978 Overall Loss:34.8467777
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(38.2223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8520726 KL Loss: 14.2315849 DSM Loss: 18.8648721 Overall Loss:34.9485294
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(70.0411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8195496 KL Loss: 14.1668602 DSM Loss: 19.0364732 Overall Loss:35.0228830
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.3765298128128052


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(44.2108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9200884 KL Loss: 14.4047325 DSM Loss: 22.1430150 Overall Loss:38.4678360
Validation loss decreased (inf --> 0.752228).  Saving model ...
Updating learning rate to 0.0005
tensor(33.8885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9199884 KL Loss: 14.3394831 DSM Loss: 19.9081111 Overall Loss:36.1675825
Validation loss decreased (0.752228 --> 0.749161).  Saving model ...
Updating learning rate to 0.00025
tensor(34.7791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9278461 KL Loss: 14.4329534 DSM Loss: 18.9315140 Overall Loss:35.2923134
Validation loss decreased (0.749161 --> 0.747211).  Saving model ...
Updating learning rate to 0.000125
tensor(26.2546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8930420 KL Loss: 14.3427331 DSM Loss: 19.2253224 Overall Loss:35.4610975
Validation loss decreased (0.747211 --> 0.747181).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.7782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8557998 KL Loss: 14.2388592 DSM Loss: 19.2831460 Overall Loss:35.3778051
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(29.6567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5361, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8530709 KL Loss: 14.2659372 DSM Loss: 19.0740976 Overall Loss:35.1931059
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(47.9585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8762243 KL Loss: 14.3322928 DSM Loss: 19.1760591 Overall Loss:35.3845764
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(48.8581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8694310 KL Loss: 14.3267800 DSM Loss: 18.9219214 Overall Loss:35.1181325
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(28.6027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8883404 KL Loss: 14.4376204 DSM Loss: 18.5379693 Overall Loss:34.8639301
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(28.7517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8613541 KL Loss: 14.2081666 DSM Loss: 18.9301289 Overall Loss:34.9996498
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(24.5468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8375028 KL Loss: 14.1127974 DSM Loss: 19.2256847 Overall Loss:35.1759849
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(30.2312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8674289 KL Loss: 14.3200736 DSM Loss: 18.6902914 Overall Loss:34.8777936
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(28.2926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8770403 KL Loss: 14.3273980 DSM Loss: 18.8826166 Overall Loss:35.0870550
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(32.5411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8751691 KL Loss: 14.3592492 DSM Loss: 18.8094739 Overall Loss:35.0438922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.73597252368927


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(51.4506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8709674 KL Loss: 14.3334685 DSM Loss: 23.3408567 Overall Loss:39.5452926
Validation loss decreased (inf --> 0.776156).  Saving model ...
Updating learning rate to 0.0005
tensor(38.1652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9263929 KL Loss: 14.3773989 DSM Loss: 18.9521712 Overall Loss:35.2559630
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(25.5336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9933, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9980328 KL Loss: 14.5321089 DSM Loss: 18.1542012 Overall Loss:34.6843428
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(36.8108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9015693 KL Loss: 14.3244417 DSM Loss: 18.5769083 Overall Loss:34.8029194
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(37.5306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8535314 KL Loss: 14.2153203 DSM Loss: 18.7517658 Overall Loss:34.8206175
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(28.5974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8382486 KL Loss: 14.1562579 DSM Loss: 18.7975400 Overall Loss:34.7920466
Validation loss decreased (0.776156 --> 0.772334).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(34.3397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6884, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8522571 KL Loss: 14.3147212 DSM Loss: 18.4588367 Overall Loss:34.6258150
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(34.4973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8177272 KL Loss: 14.0221977 DSM Loss: 19.2850034 Overall Loss:35.1249283
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(42.3359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.8908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8608667 KL Loss: 14.1668230 DSM Loss: 18.5080579 Overall Loss:34.5357476
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(29.3208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8362790 KL Loss: 14.1772904 DSM Loss: 18.3591692 Overall Loss:34.3727386
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(48.2107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8070, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8381390 KL Loss: 14.2296629 DSM Loss: 18.3946863 Overall Loss:34.4624883
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.4322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8335293 KL Loss: 14.3470275 DSM Loss: 18.4116262 Overall Loss:34.5921831
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(34.4226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4293, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8279076 KL Loss: 14.2730180 DSM Loss: 18.6645785 Overall Loss:34.7655041
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(53.8319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8363972 KL Loss: 14.1236966 DSM Loss: 18.6610362 Overall Loss:34.6211299
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(34.3602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.5708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8420339 KL Loss: 14.1884646 DSM Loss: 18.8534829 Overall Loss:34.8839814
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(29.1163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8576034 KL Loss: 14.3742326 DSM Loss: 18.1401313 Overall Loss:34.3719673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6631881594657898


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.6329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9136124 KL Loss: 14.4233952 DSM Loss: 22.6451836 Overall Loss:38.9821912
Validation loss decreased (inf --> 0.727193).  Saving model ...
Updating learning rate to 0.0005
tensor(41.6021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8615393 KL Loss: 14.2045793 DSM Loss: 19.8260110 Overall Loss:35.8921293
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(64.7165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3642, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8469939 KL Loss: 14.2064823 DSM Loss: 19.8445288 Overall Loss:35.8980050
Validation loss decreased (0.727193 --> 0.725456).  Saving model ...
Updating learning rate to 0.000125
tensor(39.5490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7982, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8534109 KL Loss: 14.2356773 DSM Loss: 19.2711796 Overall Loss:35.3602677
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(31.7249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9013692 KL Loss: 14.3648724 DSM Loss: 18.8965832 Overall Loss:35.1628249
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(32.2602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8733525 KL Loss: 14.3011286 DSM Loss: 19.6487073 Overall Loss:35.8231884
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(28.9473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.5182, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8673278 KL Loss: 14.4032067 DSM Loss: 19.0927114 Overall Loss:35.3632459
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(25.2380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8657824 KL Loss: 14.1885380 DSM Loss: 19.3567473 Overall Loss:35.4110677
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(24.5612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8581938 KL Loss: 14.1278866 DSM Loss: 19.2709653 Overall Loss:35.2570456
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(29.5100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8384885 KL Loss: 14.2795953 DSM Loss: 18.6428853 Overall Loss:34.7609691
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(62.7910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.9091560 KL Loss: 14.4560985 DSM Loss: 19.0325137 Overall Loss:35.3977683
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.4786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8936117 KL Loss: 14.5039359 DSM Loss: 19.0120090 Overall Loss:35.4095564
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(34.7828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.8999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8327489 KL Loss: 14.1832609 DSM Loss: 19.3977637 Overall Loss:35.4137737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6331928968429565


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(44.5808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8461650 KL Loss: 14.1450696 DSM Loss: 25.7121640 Overall Loss:41.7033985
Validation loss decreased (inf --> 1.230909).  Saving model ...
Updating learning rate to 0.0005
tensor(25.2964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9025861 KL Loss: 14.3165469 DSM Loss: 20.1581062 Overall Loss:36.3772394
Validation loss decreased (1.230909 --> 1.208187).  Saving model ...
Updating learning rate to 0.00025
tensor(32.3196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1311, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8690668 KL Loss: 14.2881563 DSM Loss: 19.3410523 Overall Loss:35.4982754
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(33.7493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4398, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8794944 KL Loss: 14.2795640 DSM Loss: 19.5452118 Overall Loss:35.7042703
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(53.2753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8681714 KL Loss: 14.2159202 DSM Loss: 19.3555193 Overall Loss:35.4396110
Validation loss decreased (1.208187 --> 1.206747).  Saving model ...
Updating learning rate to 3.125e-05
tensor(27.7465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8649047 KL Loss: 14.3231416 DSM Loss: 18.9752173 Overall Loss:35.1632636
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(28.7433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8882879 KL Loss: 14.3336535 DSM Loss: 18.9555376 Overall Loss:35.1774790
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(30.8836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8856822 KL Loss: 14.3236733 DSM Loss: 19.0610412 Overall Loss:35.2703967
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(47.4655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8569084 KL Loss: 14.2175862 DSM Loss: 19.4205379 Overall Loss:35.4950323
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(52.3390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7693, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8294849 KL Loss: 14.0469258 DSM Loss: 19.5356600 Overall Loss:35.4120708
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(32.1756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8358448 KL Loss: 14.2066975 DSM Loss: 19.3916416 Overall Loss:35.4341838
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(26.1343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0188, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8297822 KL Loss: 14.1924143 DSM Loss: 18.9437573 Overall Loss:34.9659536
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(63.6571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8571722 KL Loss: 14.2922865 DSM Loss: 19.1964955 Overall Loss:35.3459544
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(56.1924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8549983 KL Loss: 14.2454736 DSM Loss: 19.1960138 Overall Loss:35.2964854
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(24.3588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8698278 KL Loss: 14.2848662 DSM Loss: 19.0444781 Overall Loss:35.1991722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8368818163871765


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(60.0162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8760992 KL Loss: 14.1743311 DSM Loss: 22.2721890 Overall Loss:38.3226192
Validation loss decreased (inf --> 1.387820).  Saving model ...
Updating learning rate to 0.0005
tensor(35.2881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9297063 KL Loss: 14.3687612 DSM Loss: 19.5659473 Overall Loss:35.8644148
Validation loss decreased (1.387820 --> 1.377320).  Saving model ...
Updating learning rate to 0.00025
tensor(26.5302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8766032 KL Loss: 14.2311008 DSM Loss: 19.4121302 Overall Loss:35.5198341
Validation loss decreased (1.377320 --> 1.374623).  Saving model ...
Updating learning rate to 0.000125
tensor(33.8225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8729672 KL Loss: 14.3073575 DSM Loss: 18.7905998 Overall Loss:34.9709245
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(50.1036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4205, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8865240 KL Loss: 14.4445505 DSM Loss: 18.2107652 Overall Loss:34.5418398
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(34.1750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8793816 KL Loss: 14.2769086 DSM Loss: 18.8219518 Overall Loss:34.9782421
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(34.6958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8660834 KL Loss: 14.2049778 DSM Loss: 18.8477152 Overall Loss:34.9187764
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(59.5906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8211952 KL Loss: 14.0587091 DSM Loss: 18.6963621 Overall Loss:34.5762661
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(28.7098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8586815 KL Loss: 14.2456813 DSM Loss: 18.6689139 Overall Loss:34.7732767
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(38.1825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.9175913 KL Loss: 14.4748036 DSM Loss: 18.4854534 Overall Loss:34.8778481
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(27.7126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8621359 KL Loss: 14.3037168 DSM Loss: 18.4734102 Overall Loss:34.6392626
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(28.1433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2602, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8479865 KL Loss: 14.1565869 DSM Loss: 19.0944152 Overall Loss:35.0989884
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(32.1669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8307285 KL Loss: 14.1307371 DSM Loss: 18.5191671 Overall Loss:34.4806327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6129995584487915


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(45.7899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8839938 KL Loss: 14.3220529 DSM Loss: 21.8860147 Overall Loss:38.0920614
Validation loss decreased (inf --> 0.598541).  Saving model ...
Updating learning rate to 0.0005
tensor(24.9948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9556089 KL Loss: 14.4450168 DSM Loss: 18.6285872 Overall Loss:35.0292130
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(29.3713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9513919 KL Loss: 14.4151209 DSM Loss: 18.9985583 Overall Loss:35.3650712
Validation loss decreased (0.598541 --> 0.594580).  Saving model ...
Updating learning rate to 0.000125
tensor(29.1962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8529459 KL Loss: 14.1885073 DSM Loss: 19.5565218 Overall Loss:35.5979749
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(57.4225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8240044 KL Loss: 14.1027433 DSM Loss: 19.4731773 Overall Loss:35.3999252
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(30.8433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8589537 KL Loss: 14.4002395 DSM Loss: 18.7106181 Overall Loss:34.9698115
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(23.2375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8192100 KL Loss: 14.1194960 DSM Loss: 18.6267767 Overall Loss:34.5654826
Validation loss decreased (0.594580 --> 0.594544).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(26.6305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6703, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8271418 KL Loss: 14.0716372 DSM Loss: 19.3282045 Overall Loss:35.2269836
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(25.2608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8956974 KL Loss: 14.5962211 DSM Loss: 18.1820666 Overall Loss:34.6739850
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(29.0895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6490, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8474869 KL Loss: 14.1650209 DSM Loss: 19.3116707 Overall Loss:35.3241784
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(30.8013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8282871 KL Loss: 14.1584881 DSM Loss: 18.7379375 Overall Loss:34.7247127
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(26.0885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2684, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8717061 KL Loss: 14.3216501 DSM Loss: 19.0312425 Overall Loss:35.2245986
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(25.0027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8456280 KL Loss: 14.3801541 DSM Loss: 18.6967880 Overall Loss:34.9225701
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(28.4661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8617245 KL Loss: 14.4652327 DSM Loss: 18.4548303 Overall Loss:34.7817876
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(25.6660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8192252 KL Loss: 14.0435705 DSM Loss: 19.3166341 Overall Loss:35.1794296
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(22.3765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8678025 KL Loss: 14.2856090 DSM Loss: 18.5209718 Overall Loss:34.6743832
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(23.9350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.6224, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8424976 KL Loss: 14.2329446 DSM Loss: 18.9161216 Overall Loss:34.9915638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4971528947353363


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(70.7329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 2.0116016 KL Loss: 14.5248796 DSM Loss: 25.0398050 Overall Loss:41.5762862
Validation loss decreased (inf --> 0.957859).  Saving model ...
Updating learning rate to 0.0005
tensor(52.7358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9111572 KL Loss: 14.3362544 DSM Loss: 20.3805427 Overall Loss:36.6279542
Validation loss decreased (0.957859 --> 0.947459).  Saving model ...
Updating learning rate to 0.00025
tensor(60.3507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9021177 KL Loss: 14.2491783 DSM Loss: 19.4187649 Overall Loss:35.5700610
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(34.9021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8421819 KL Loss: 14.1857489 DSM Loss: 19.5555574 Overall Loss:35.5834880
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(27.6743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8265574 KL Loss: 14.1361740 DSM Loss: 19.1954019 Overall Loss:35.1581330
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(31.6020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8359906 KL Loss: 14.2357177 DSM Loss: 18.7091928 Overall Loss:34.7809012
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(25.3105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8594363 KL Loss: 14.2448325 DSM Loss: 18.9977083 Overall Loss:35.1019770
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(31.6567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8380743 KL Loss: 14.1663211 DSM Loss: 19.2160960 Overall Loss:35.2204912
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(43.8495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4587, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8103169 KL Loss: 14.1289271 DSM Loss: 18.9653611 Overall Loss:34.9046049
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(33.0344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3310, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8520588 KL Loss: 14.2775655 DSM Loss: 18.9254488 Overall Loss:35.0550733
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(27.9173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8639613 KL Loss: 14.3738715 DSM Loss: 18.7944241 Overall Loss:35.0322569
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(28.4096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8431657 KL Loss: 14.2558281 DSM Loss: 19.0926642 Overall Loss:35.1916581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9501281976699829


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(62.0754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4586, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8800835 KL Loss: 14.2487134 DSM Loss: 22.6075835 Overall Loss:38.7363805
Validation loss decreased (inf --> 0.764146).  Saving model ...
Updating learning rate to 0.0005
tensor(39.8378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8964539 KL Loss: 14.2828345 DSM Loss: 19.8883401 Overall Loss:36.0676285
Validation loss decreased (0.764146 --> 0.755083).  Saving model ...
Updating learning rate to 0.00025
tensor(27.2814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5148, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8612430 KL Loss: 14.2565628 DSM Loss: 19.4357435 Overall Loss:35.5535491
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(49.1884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7583, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8564213 KL Loss: 14.2453295 DSM Loss: 18.9774095 Overall Loss:35.0791602
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(55.0042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8276676 KL Loss: 14.0918772 DSM Loss: 19.3716231 Overall Loss:35.2911679
Validation loss decreased (0.755083 --> 0.749865).  Saving model ...
Updating learning rate to 3.125e-05
tensor(42.9132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5777, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8163342 KL Loss: 14.2047809 DSM Loss: 19.1188940 Overall Loss:35.1400090
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(30.9911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7962, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8324376 KL Loss: 14.2411236 DSM Loss: 19.1133007 Overall Loss:35.1868618
Validation loss decreased (0.749865 --> 0.749146).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(41.3468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7571, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8169205 KL Loss: 14.2796088 DSM Loss: 18.8238752 Overall Loss:34.9204046
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(31.7542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8294008 KL Loss: 14.2313202 DSM Loss: 18.9834664 Overall Loss:35.0441874
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(68.2256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8740306 KL Loss: 14.3156747 DSM Loss: 19.0515500 Overall Loss:35.2412554
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(30.9554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8658057 KL Loss: 14.2631473 DSM Loss: 18.6827042 Overall Loss:34.8116572
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(50.6543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8682741 KL Loss: 14.2591047 DSM Loss: 18.4722911 Overall Loss:34.5996700
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(31.1665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8704567 KL Loss: 14.2009112 DSM Loss: 19.0656571 Overall Loss:35.1370251
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(28.3111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8378989 KL Loss: 14.2188832 DSM Loss: 19.0348694 Overall Loss:35.0916515
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(30.4230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1609, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8685224 KL Loss: 14.2234985 DSM Loss: 19.1623570 Overall Loss:35.2543779
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(25.9254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8348619 KL Loss: 14.2050967 DSM Loss: 19.1250391 Overall Loss:35.1649977
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(29.8799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8838754 KL Loss: 14.4211635 DSM Loss: 18.6177100 Overall Loss:34.9227489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.4111487865447998


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.4285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9119226 KL Loss: 14.3757708 DSM Loss: 23.3154569 Overall Loss:39.6031503
Validation loss decreased (inf --> 0.767887).  Saving model ...
Updating learning rate to 0.0005
tensor(27.3116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9524862 KL Loss: 14.3702729 DSM Loss: 20.3278619 Overall Loss:36.6506208
Validation loss decreased (0.767887 --> 0.754395).  Saving model ...
Updating learning rate to 0.00025
tensor(37.4051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8656635 KL Loss: 14.1910809 DSM Loss: 19.7021996 Overall Loss:35.7589441
Validation loss decreased (0.754395 --> 0.754072).  Saving model ...
Updating learning rate to 0.000125
tensor(27.9308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8641535 KL Loss: 14.1549345 DSM Loss: 19.5767431 Overall Loss:35.5958309
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(39.2205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8539853 KL Loss: 14.2698721 DSM Loss: 19.1776647 Overall Loss:35.3015223
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(31.2079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8869038 KL Loss: 14.4535722 DSM Loss: 18.9417537 Overall Loss:35.2822297
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(29.5943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8672745 KL Loss: 14.2058649 DSM Loss: 19.1441750 Overall Loss:35.2173143
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(36.4887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.9026790 KL Loss: 14.3188082 DSM Loss: 19.0829416 Overall Loss:35.3044285
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(34.3609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8747953 KL Loss: 14.2926825 DSM Loss: 18.8432773 Overall Loss:35.0107551
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(59.3808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8808762 KL Loss: 14.2805625 DSM Loss: 18.8003381 Overall Loss:34.9617770
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(56.4961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8605276 KL Loss: 14.2796097 DSM Loss: 18.8203895 Overall Loss:34.9605266
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(41.2548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8754890 KL Loss: 14.3256662 DSM Loss: 18.8816481 Overall Loss:35.0828033
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.6679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8604424 KL Loss: 14.2116198 DSM Loss: 19.1907369 Overall Loss:35.2627992
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7200170755386353


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.8358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9221292 KL Loss: 14.4088256 DSM Loss: 22.5655966 Overall Loss:38.8965514
Validation loss decreased (inf --> 1.466730).  Saving model ...
Updating learning rate to 0.0005
tensor(27.8135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8986096 KL Loss: 14.3311108 DSM Loss: 19.8366368 Overall Loss:36.0663572
Validation loss decreased (1.466730 --> 1.458419).  Saving model ...
Updating learning rate to 0.00025
tensor(32.9558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8604622 KL Loss: 14.1720993 DSM Loss: 19.2817868 Overall Loss:35.3143484
Validation loss decreased (1.458419 --> 1.450301).  Saving model ...
Updating learning rate to 0.000125
tensor(45.4833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8478815 KL Loss: 14.3257095 DSM Loss: 19.2755059 Overall Loss:35.4490970
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(27.0981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8288971 KL Loss: 14.0900594 DSM Loss: 18.9410100 Overall Loss:34.8599665
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(30.8218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8486461 KL Loss: 14.2561570 DSM Loss: 19.0222916 Overall Loss:35.1270948
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(33.8115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8125708 KL Loss: 14.2024255 DSM Loss: 19.1268417 Overall Loss:35.1418380
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(34.2743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8493272 KL Loss: 14.2700493 DSM Loss: 18.9726980 Overall Loss:35.0920746
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(33.0952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8430148 KL Loss: 14.2075314 DSM Loss: 18.9783067 Overall Loss:35.0288528
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(68.0336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8554124 KL Loss: 14.3296328 DSM Loss: 18.8679668 Overall Loss:35.0530121
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(38.6058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8639491 KL Loss: 14.2669607 DSM Loss: 19.0657150 Overall Loss:35.1966247
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(32.3905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8528868 KL Loss: 14.2550464 DSM Loss: 18.9820167 Overall Loss:35.0899498
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(30.7565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8442163 KL Loss: 14.2981030 DSM Loss: 19.1750377 Overall Loss:35.3173568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8232271671295166


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.9397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.0548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8988926 KL Loss: 14.2476644 DSM Loss: 23.3675980 Overall Loss:39.5141548
Validation loss decreased (inf --> 1.115016).  Saving model ...
Updating learning rate to 0.0005
tensor(47.9874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.1829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8954228 KL Loss: 14.2572299 DSM Loss: 19.2576748 Overall Loss:35.4103274
Validation loss decreased (1.115016 --> 1.092548).  Saving model ...
Updating learning rate to 0.00025
tensor(26.9306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8903818 KL Loss: 14.2261545 DSM Loss: 19.1831406 Overall Loss:35.2996771
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(33.7196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8245873 KL Loss: 14.2297638 DSM Loss: 18.8949400 Overall Loss:34.9492910
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(35.5670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8764683 KL Loss: 14.2967056 DSM Loss: 18.5702675 Overall Loss:34.7434415
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(31.8036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8952413 KL Loss: 14.4318036 DSM Loss: 18.5022840 Overall Loss:34.8293292
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(31.7890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8875222 KL Loss: 14.3020595 DSM Loss: 18.8604203 Overall Loss:35.0500019
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(44.5891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8363928 KL Loss: 14.1118703 DSM Loss: 18.8929366 Overall Loss:34.8411995
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(46.0692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8511672 KL Loss: 14.2946872 DSM Loss: 18.5668676 Overall Loss:34.7127219
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(34.1927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8535816 KL Loss: 14.1619312 DSM Loss: 18.9744274 Overall Loss:34.9899403
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(32.3624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8433529 KL Loss: 14.2550166 DSM Loss: 18.5949986 Overall Loss:34.6933680
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(27.2926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8302073 KL Loss: 14.0433316 DSM Loss: 19.1232515 Overall Loss:34.9967902
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.226628065109253


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.2753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.2365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9135613 KL Loss: 14.3664612 DSM Loss: 22.4612712 Overall Loss:38.7412938
Validation loss decreased (inf --> 1.314720).  Saving model ...
Updating learning rate to 0.0005
tensor(47.9825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9427751 KL Loss: 14.3442170 DSM Loss: 20.1001952 Overall Loss:36.3871871
Validation loss decreased (1.314720 --> 1.311795).  Saving model ...
Updating learning rate to 0.00025
tensor(27.7324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7916, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8997615 KL Loss: 14.2570015 DSM Loss: 19.8369298 Overall Loss:35.9936929
Validation loss decreased (1.311795 --> 1.308846).  Saving model ...
Updating learning rate to 0.000125
tensor(38.4950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8680755 KL Loss: 14.2553112 DSM Loss: 19.5279732 Overall Loss:35.6513598
Validation loss decreased (1.308846 --> 1.306532).  Saving model ...
Updating learning rate to 6.25e-05
tensor(31.4748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8296579 KL Loss: 14.2426034 DSM Loss: 19.2020324 Overall Loss:35.2742937
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(34.9065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.1512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8427555 KL Loss: 14.2270011 DSM Loss: 19.1392277 Overall Loss:35.2089843
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(27.4143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8418122 KL Loss: 14.2563349 DSM Loss: 18.9509734 Overall Loss:35.0491206
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(43.2309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8656656 KL Loss: 14.2958992 DSM Loss: 18.7250619 Overall Loss:34.8866267
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(24.6323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8815812 KL Loss: 14.4125673 DSM Loss: 18.7272570 Overall Loss:35.0214056
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(43.6747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8415505 KL Loss: 14.1111565 DSM Loss: 19.1600380 Overall Loss:35.1127450
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(32.7269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8445551 KL Loss: 14.2701151 DSM Loss: 19.2595589 Overall Loss:35.3742289
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(25.5216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8806643 KL Loss: 14.3822222 DSM Loss: 18.8072863 Overall Loss:35.0701728
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(35.3023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.9046312 KL Loss: 14.4439422 DSM Loss: 18.6759317 Overall Loss:35.0245050
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(28.9840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8792044 KL Loss: 14.2753468 DSM Loss: 19.0113129 Overall Loss:35.1658638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.5490262508392334


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(59.2157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9136058 KL Loss: 14.3689236 DSM Loss: 23.4789968 Overall Loss:39.7615263
Validation loss decreased (inf --> 0.581701).  Saving model ...
Updating learning rate to 0.0005
tensor(61.0778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8666860 KL Loss: 14.2614395 DSM Loss: 20.2745358 Overall Loss:36.4026613
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(38.7062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8930704 KL Loss: 14.2451158 DSM Loss: 19.2038522 Overall Loss:35.3420384
Validation loss decreased (0.581701 --> 0.579367).  Saving model ...
Updating learning rate to 0.000125
tensor(59.1638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8967912 KL Loss: 14.2944380 DSM Loss: 19.2672276 Overall Loss:35.4584568
Validation loss decreased (0.579367 --> 0.578618).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.4239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8409038 KL Loss: 14.1576652 DSM Loss: 19.4042644 Overall Loss:35.4028332
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(56.1546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5942, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8396363 KL Loss: 14.2562913 DSM Loss: 19.2812445 Overall Loss:35.3771720
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(37.3026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8140242 KL Loss: 14.1180938 DSM Loss: 19.1111891 Overall Loss:35.0433070
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(31.3277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8491384 KL Loss: 14.3521626 DSM Loss: 19.3457298 Overall Loss:35.5470308
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(26.9544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.9027571 KL Loss: 14.4422022 DSM Loss: 18.5523155 Overall Loss:34.8972748
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(31.3028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.6055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8657473 KL Loss: 14.3032965 DSM Loss: 18.6160987 Overall Loss:34.7851425
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(52.9954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8924986 KL Loss: 14.3858044 DSM Loss: 19.1286936 Overall Loss:35.4069965
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(30.1301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8592055 KL Loss: 14.2914273 DSM Loss: 18.9187261 Overall Loss:35.0693590
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(30.4908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8457357 KL Loss: 14.1762995 DSM Loss: 19.5493212 Overall Loss:35.5713563
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(39.6146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8310680 KL Loss: 14.1068784 DSM Loss: 19.6089202 Overall Loss:35.5468665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9782049655914307


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(57.2657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9593983 KL Loss: 14.2878733 DSM Loss: 21.9020233 Overall Loss:38.1492950
Validation loss decreased (inf --> 0.759846).  Saving model ...
Updating learning rate to 0.0005
tensor(30.1669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5494, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9048507 KL Loss: 14.2487335 DSM Loss: 19.5499068 Overall Loss:35.7034912
Validation loss decreased (0.759846 --> 0.753420).  Saving model ...
Updating learning rate to 0.00025
tensor(50.5736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8654363 KL Loss: 14.1640587 DSM Loss: 19.1747868 Overall Loss:35.2042817
Validation loss decreased (0.753420 --> 0.746001).  Saving model ...
Updating learning rate to 0.000125
tensor(45.6219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8399639 KL Loss: 14.1859228 DSM Loss: 18.7655402 Overall Loss:34.7914268
Validation loss decreased (0.746001 --> 0.744042).  Saving model ...
Updating learning rate to 6.25e-05
tensor(33.5009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8310342 KL Loss: 14.1152487 DSM Loss: 18.8352013 Overall Loss:34.7814842
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(48.8521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2972, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8389070 KL Loss: 14.2575885 DSM Loss: 18.4763295 Overall Loss:34.5728248
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(30.8375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6189, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8202816 KL Loss: 14.1135023 DSM Loss: 18.5776438 Overall Loss:34.5114278
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(37.2336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0126, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8694005 KL Loss: 14.2616301 DSM Loss: 18.6803004 Overall Loss:34.8113312
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(52.5991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8432756 KL Loss: 14.2848826 DSM Loss: 18.6258567 Overall Loss:34.7540149
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(29.9660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8545589 KL Loss: 14.2440023 DSM Loss: 18.5213469 Overall Loss:34.6199081
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(32.2172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8773567 KL Loss: 14.2712569 DSM Loss: 18.7223483 Overall Loss:34.8709618
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(30.0078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8511834 KL Loss: 14.2618539 DSM Loss: 18.7964189 Overall Loss:34.9094562
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(26.3261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8475459 KL Loss: 14.3030214 DSM Loss: 18.4155619 Overall Loss:34.5661290
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(29.3815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8207486 KL Loss: 14.2010710 DSM Loss: 18.6876939 Overall Loss:34.7095131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9614136219024658


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(75.1865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9462289 KL Loss: 14.4299104 DSM Loss: 22.9568607 Overall Loss:39.3330000
Validation loss decreased (inf --> 1.532387).  Saving model ...
Updating learning rate to 0.0005
tensor(25.8742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8711915 KL Loss: 14.1911975 DSM Loss: 19.6390813 Overall Loss:35.7014703
Validation loss decreased (1.532387 --> 1.525330).  Saving model ...
Updating learning rate to 0.00025
tensor(28.5577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.6322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8821112 KL Loss: 14.1905132 DSM Loss: 19.4685649 Overall Loss:35.5411892
Validation loss decreased (1.525330 --> 1.517609).  Saving model ...
Updating learning rate to 0.000125
tensor(27.4026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8752013 KL Loss: 14.3498876 DSM Loss: 19.1003275 Overall Loss:35.3254166
Validation loss decreased (1.517609 --> 1.505025).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.7598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5602, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8628665 KL Loss: 14.2580976 DSM Loss: 18.8711817 Overall Loss:34.9921458
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(29.2058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8377102 KL Loss: 14.1933844 DSM Loss: 18.9867412 Overall Loss:35.0178354
Validation loss decreased (1.505025 --> 1.503183).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(32.5221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8671218 KL Loss: 14.3426474 DSM Loss: 19.0071272 Overall Loss:35.2168963
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(26.4559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8564671 KL Loss: 14.1878545 DSM Loss: 19.0475755 Overall Loss:35.0918972
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(32.5194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8530677 KL Loss: 14.2238938 DSM Loss: 19.4052774 Overall Loss:35.4822390
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(29.7014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8457687 KL Loss: 14.1537145 DSM Loss: 19.3406918 Overall Loss:35.3401751
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(26.6848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8444475 KL Loss: 14.3343116 DSM Loss: 18.7927394 Overall Loss:34.9714984
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(25.4885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8477354 KL Loss: 14.2785570 DSM Loss: 18.7347045 Overall Loss:34.8609967
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(51.9511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8268327 KL Loss: 14.2384275 DSM Loss: 19.0763860 Overall Loss:35.1416462
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(32.4737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8948296 KL Loss: 14.4609983 DSM Loss: 19.0603800 Overall Loss:35.4162079
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(25.5652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8382028 KL Loss: 14.1061898 DSM Loss: 19.2092736 Overall Loss:35.1536661
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(29.8866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8945033 KL Loss: 14.3392776 DSM Loss: 18.6702504 Overall Loss:34.9040311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.2440464496612549


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(39.1014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8341654 KL Loss: 14.1528702 DSM Loss: 24.3277069 Overall Loss:40.3147426
Validation loss decreased (inf --> 0.213500).  Saving model ...
Updating learning rate to 0.0005
tensor(31.2178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9201728 KL Loss: 14.2986278 DSM Loss: 20.4072305 Overall Loss:36.6260311
Validation loss decreased (0.213500 --> 0.208675).  Saving model ...
Updating learning rate to 0.00025
tensor(20.0863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8884953 KL Loss: 14.4060530 DSM Loss: 19.2243498 Overall Loss:35.5188981
Validation loss decreased (0.208675 --> 0.208453).  Saving model ...
Updating learning rate to 0.000125
tensor(39.8520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9371357 KL Loss: 14.3769397 DSM Loss: 19.3208081 Overall Loss:35.6348832
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(25.9681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8978233 KL Loss: 14.3871451 DSM Loss: 19.7392449 Overall Loss:36.0242132
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(40.4247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8689844 KL Loss: 14.3445835 DSM Loss: 19.5466711 Overall Loss:35.7602391
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(27.9487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8577198 KL Loss: 14.2197097 DSM Loss: 19.5156793 Overall Loss:35.5931087
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(21.0736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8884439 KL Loss: 14.2560650 DSM Loss: 19.5377493 Overall Loss:35.6822580
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(25.4561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8335562 KL Loss: 14.0861656 DSM Loss: 19.4380364 Overall Loss:35.3577581
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(57.4180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1846, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8343342 KL Loss: 14.1993304 DSM Loss: 19.6838221 Overall Loss:35.7174866
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(57.9861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.9963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1685, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8829147 KL Loss: 14.3597569 DSM Loss: 18.3502068 Overall Loss:34.5928782
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(38.6665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6379, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8250022 KL Loss: 14.0724228 DSM Loss: 19.8172332 Overall Loss:35.7146583
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(47.6556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8740215 KL Loss: 14.3473468 DSM Loss: 19.0781877 Overall Loss:35.2995559
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.12238053977489471


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(86.8067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4027, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9442094 KL Loss: 14.3925473 DSM Loss: 22.2486430 Overall Loss:38.5853998
Validation loss decreased (inf --> 0.642211).  Saving model ...
Updating learning rate to 0.0005
tensor(22.4494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9354573 KL Loss: 14.3332569 DSM Loss: 19.8307632 Overall Loss:36.0994774
Validation loss decreased (0.642211 --> 0.636610).  Saving model ...
Updating learning rate to 0.00025
tensor(26.0905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8574698 KL Loss: 14.2547382 DSM Loss: 19.7084612 Overall Loss:35.8206691
Validation loss decreased (0.636610 --> 0.635884).  Saving model ...
Updating learning rate to 0.000125
tensor(27.5316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9204987 KL Loss: 14.4405186 DSM Loss: 19.2053029 Overall Loss:35.5663200
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(26.5038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9240904 KL Loss: 14.4314128 DSM Loss: 18.5973779 Overall Loss:34.9528810
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(64.6372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8275641 KL Loss: 14.1509705 DSM Loss: 19.3319563 Overall Loss:35.3104908
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(26.2391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8187013 KL Loss: 14.1817781 DSM Loss: 19.0295890 Overall Loss:35.0300683
Validation loss decreased (0.635884 --> 0.635856).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(53.8162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7905331 KL Loss: 14.0041028 DSM Loss: 19.6860265 Overall Loss:35.4806624
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(28.6533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0016, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8337777 KL Loss: 14.2371351 DSM Loss: 19.5320149 Overall Loss:35.6029278
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(59.0014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8577101 KL Loss: 14.4922057 DSM Loss: 18.6393585 Overall Loss:34.9892744
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(38.9175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8813136 KL Loss: 14.5480448 DSM Loss: 18.5700053 Overall Loss:34.9993638
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(73.0331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8238485 KL Loss: 14.2157830 DSM Loss: 19.4578443 Overall Loss:35.4974758
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(28.1386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8790530 KL Loss: 14.4664603 DSM Loss: 18.5524117 Overall Loss:34.8979250
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(28.4175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8456654 KL Loss: 14.1700533 DSM Loss: 19.2277673 Overall Loss:35.2434861
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(28.3261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1586, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8991814 KL Loss: 14.5288069 DSM Loss: 18.8681256 Overall Loss:35.2961138
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(60.4781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8497889 KL Loss: 14.3641144 DSM Loss: 19.0338654 Overall Loss:35.2477688
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(56.3693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8411026 KL Loss: 14.1749848 DSM Loss: 19.3511671 Overall Loss:35.3672547
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6511399149894714


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.5098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8879306 KL Loss: 14.3544671 DSM Loss: 23.7340239 Overall Loss:39.9764219
Validation loss decreased (inf --> 2.222929).  Saving model ...
Updating learning rate to 0.0005
tensor(26.5950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9009170 KL Loss: 14.3204840 DSM Loss: 19.9691051 Overall Loss:36.1905060
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(39.5672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8531675 KL Loss: 14.2836538 DSM Loss: 19.1432020 Overall Loss:35.2800234
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(33.2412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8459429 KL Loss: 14.2200968 DSM Loss: 19.2133918 Overall Loss:35.2794315
Validation loss decreased (2.222929 --> 2.222843).  Saving model ...
Updating learning rate to 6.25e-05
tensor(31.2310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8903835 KL Loss: 14.4717262 DSM Loss: 18.7953192 Overall Loss:35.1574287
Validation loss decreased (2.222843 --> 2.222712).  Saving model ...
Updating learning rate to 3.125e-05
tensor(50.0779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9182, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8937434 KL Loss: 14.3671382 DSM Loss: 18.7192152 Overall Loss:34.9800971
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(26.3243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8594155 KL Loss: 14.3015030 DSM Loss: 19.0850722 Overall Loss:35.2459908
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(39.0337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8696199 KL Loss: 14.2471940 DSM Loss: 18.8896923 Overall Loss:35.0065058
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(35.7225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8557871 KL Loss: 14.0746850 DSM Loss: 19.1366625 Overall Loss:35.0671347
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(36.4453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9366, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8707445 KL Loss: 14.1335805 DSM Loss: 19.2242086 Overall Loss:35.2285336
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(40.5639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8764233 KL Loss: 14.2925417 DSM Loss: 18.7100506 Overall Loss:34.8790156
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(38.3380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8703311 KL Loss: 14.2867565 DSM Loss: 18.5787712 Overall Loss:34.7358589
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(28.1990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8537410 KL Loss: 14.1497214 DSM Loss: 19.1025275 Overall Loss:35.1059898
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(25.8673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.2453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8403406 KL Loss: 14.1924039 DSM Loss: 19.0607444 Overall Loss:35.0934889
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(44.9372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9347, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8781149 KL Loss: 14.2390005 DSM Loss: 19.0583841 Overall Loss:35.1754993
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.1312987804412842


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(39.7039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8369706 KL Loss: 14.3332032 DSM Loss: 22.1014921 Overall Loss:38.2716660
Validation loss decreased (inf --> 0.799961).  Saving model ...
Updating learning rate to 0.0005
tensor(23.9550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8868856 KL Loss: 14.3168966 DSM Loss: 20.0520474 Overall Loss:36.2558295
Validation loss decreased (0.799961 --> 0.797944).  Saving model ...
Updating learning rate to 0.00025
tensor(25.4773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9549412 KL Loss: 14.5752766 DSM Loss: 19.1217150 Overall Loss:35.6519330
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(30.6720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2188, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8974072 KL Loss: 14.2179942 DSM Loss: 19.6869529 Overall Loss:35.8023544
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(25.5359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8247729 KL Loss: 14.2115588 DSM Loss: 19.5503138 Overall Loss:35.5866455
Validation loss decreased (0.797944 --> 0.797838).  Saving model ...
Updating learning rate to 3.125e-05
tensor(31.2885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8124449 KL Loss: 14.0960135 DSM Loss: 19.5992747 Overall Loss:35.5077332
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(38.4268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9001486 KL Loss: 14.6493083 DSM Loss: 18.3309596 Overall Loss:34.8804166
Validation loss decreased (0.797838 --> 0.797699).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(30.8280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3741, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8616130 KL Loss: 14.4539293 DSM Loss: 18.5935460 Overall Loss:34.9090882
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(26.8637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8655926 KL Loss: 14.3130674 DSM Loss: 18.7147103 Overall Loss:34.8933702
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(44.1394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8762995 KL Loss: 14.2826887 DSM Loss: 19.0652345 Overall Loss:35.2242227
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(53.6016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8584266 KL Loss: 14.2279330 DSM Loss: 18.5903080 Overall Loss:34.6766675
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(37.0294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8249722 KL Loss: 14.1168340 DSM Loss: 19.0652226 Overall Loss:35.0070285
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(24.8795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8767495 KL Loss: 14.4199964 DSM Loss: 18.2488415 Overall Loss:34.5455874
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(46.4676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8632570 KL Loss: 14.3308642 DSM Loss: 18.7635466 Overall Loss:34.9576676
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(50.2029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8488907 KL Loss: 14.2369184 DSM Loss: 19.2066680 Overall Loss:35.2924771
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(26.2770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8744660 KL Loss: 14.2883200 DSM Loss: 19.0024969 Overall Loss:35.1652827
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(55.7497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.9121035 KL Loss: 14.4275270 DSM Loss: 18.7841380 Overall Loss:35.1237684
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7667325139045715


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.1613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8646213 KL Loss: 14.2889266 DSM Loss: 22.7822624 Overall Loss:38.9358104
Validation loss decreased (inf --> 0.832571).  Saving model ...
Updating learning rate to 0.0005
tensor(31.3667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.8089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9055856 KL Loss: 14.3310132 DSM Loss: 20.4225999 Overall Loss:36.6591987
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(25.5431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8914184 KL Loss: 14.3268646 DSM Loss: 19.6443409 Overall Loss:35.8626240
Validation loss decreased (0.832571 --> 0.831072).  Saving model ...
Updating learning rate to 0.000125
tensor(49.6906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8622219 KL Loss: 14.1730681 DSM Loss: 19.8849914 Overall Loss:35.9202814
Validation loss decreased (0.831072 --> 0.830530).  Saving model ...
Updating learning rate to 6.25e-05
tensor(30.4333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8204116 KL Loss: 14.0546328 DSM Loss: 19.5817048 Overall Loss:35.4567492
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(25.7231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8472925 KL Loss: 14.3905222 DSM Loss: 19.1376113 Overall Loss:35.3754259
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(31.0275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8822785 KL Loss: 14.4663610 DSM Loss: 18.8684939 Overall Loss:35.2171333
Validation loss decreased (0.830530 --> 0.830462).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(27.8306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8911996 KL Loss: 14.2669089 DSM Loss: 19.4125286 Overall Loss:35.5706369
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(24.4558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8747967 KL Loss: 14.1744928 DSM Loss: 19.2218966 Overall Loss:35.2711862
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(29.1126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.9663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8344020 KL Loss: 14.1370054 DSM Loss: 19.6164081 Overall Loss:35.5878154
Validation loss decreased (0.830462 --> 0.830392).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(30.1048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8659905 KL Loss: 14.2535877 DSM Loss: 19.3810092 Overall Loss:35.5005874
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-07
tensor(51.1646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8523564 KL Loss: 14.1434201 DSM Loss: 19.5518136 Overall Loss:35.5475900
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-07
tensor(28.4028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8406462 KL Loss: 14.2941180 DSM Loss: 19.1857785 Overall Loss:35.3205427
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.220703125e-07
tensor(38.5974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2822, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8465155 KL Loss: 14.1866849 DSM Loss: 19.6892404 Overall Loss:35.7224408
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.103515625e-08
tensor(33.8575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8719656 KL Loss: 14.3228255 DSM Loss: 19.2614023 Overall Loss:35.4561933
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.0517578125e-08
tensor(34.1951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.9046149 KL Loss: 14.3288261 DSM Loss: 18.9768796 Overall Loss:35.2103208
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.52587890625e-08
tensor(28.4991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8678698 KL Loss: 14.2394583 DSM Loss: 19.2822883 Overall Loss:35.3896163
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.62939453125e-09
tensor(27.2847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 85 | MSE Loss: 1.8951986 KL Loss: 14.3321806 DSM Loss: 19.3087080 Overall Loss:35.5360871
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.814697265625e-09
tensor(27.0093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 85 | MSE Loss: 1.8713933 KL Loss: 14.3659313 DSM Loss: 19.0365920 Overall Loss:35.2739167
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(43.1285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 85 | MSE Loss: 1.8832179 KL Loss: 14.2775688 DSM Loss: 19.0809505 Overall Loss:35.2417373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5873528122901917


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.5955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9870444 KL Loss: 14.5368556 DSM Loss: 24.7559429 Overall Loss:41.2798428
Validation loss decreased (inf --> 0.494075).  Saving model ...
Updating learning rate to 0.0005
tensor(59.5919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9301298 KL Loss: 14.3498180 DSM Loss: 19.7900790 Overall Loss:36.0700264
Validation loss decreased (0.494075 --> 0.491868).  Saving model ...
Updating learning rate to 0.00025
tensor(31.4305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7379, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8693336 KL Loss: 14.3032147 DSM Loss: 19.1876132 Overall Loss:35.3601614
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(54.8490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8503326 KL Loss: 14.2060233 DSM Loss: 19.5106624 Overall Loss:35.5670181
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(35.1668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2417, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9067400 KL Loss: 14.4290591 DSM Loss: 19.2527431 Overall Loss:35.5885421
Validation loss decreased (0.491868 --> 0.490974).  Saving model ...
Updating learning rate to 3.125e-05
tensor(28.7414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9001742 KL Loss: 14.3450157 DSM Loss: 19.1347963 Overall Loss:35.3799862
Validation loss decreased (0.490974 --> 0.490781).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(27.3331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8269551 KL Loss: 14.0004197 DSM Loss: 19.6394546 Overall Loss:35.4668295
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(33.9297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8473412 KL Loss: 14.1508312 DSM Loss: 18.8127321 Overall Loss:34.8109045
Validation loss decreased (0.490781 --> 0.490751).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(24.6071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8793219 KL Loss: 14.3930948 DSM Loss: 18.8367401 Overall Loss:35.1091566
Validation loss decreased (0.490751 --> 0.490728).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(26.9426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8495645 KL Loss: 14.3131328 DSM Loss: 18.9771171 Overall Loss:35.1398146
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-07
tensor(31.2778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8403007 KL Loss: 14.1525596 DSM Loss: 19.2060988 Overall Loss:35.1989589
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-07
tensor(32.3823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8624382 KL Loss: 14.3607446 DSM Loss: 18.6550103 Overall Loss:34.8781931
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-07
tensor(42.5533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8779676 KL Loss: 14.3596517 DSM Loss: 18.6429936 Overall Loss:34.8806126
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-07
tensor(49.9979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8740580 KL Loss: 14.2938926 DSM Loss: 19.2455670 Overall Loss:35.4135175
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-08
tensor(37.8219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8153700 KL Loss: 14.1753046 DSM Loss: 19.4734011 Overall Loss:35.4640756
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-08
tensor(28.0351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8916, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8341579 KL Loss: 14.0906186 DSM Loss: 19.2239433 Overall Loss:35.1487198
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-08
tensor(24.7087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8791389 KL Loss: 14.3406153 DSM Loss: 19.0994690 Overall Loss:35.3192229
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-09
tensor(49.0831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 85 | MSE Loss: 1.8694179 KL Loss: 14.4384960 DSM Loss: 18.6057100 Overall Loss:34.9136237
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-09
tensor(73.5276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 85 | MSE Loss: 1.8872353 KL Loss: 14.4795420 DSM Loss: 18.1662710 Overall Loss:34.5330482
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.707050085067749


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(65.9311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9269557 KL Loss: 14.4411061 DSM Loss: 21.8303336 Overall Loss:38.1983952
Validation loss decreased (inf --> 0.983296).  Saving model ...
Updating learning rate to 0.0005
tensor(26.0878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.0517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9266792 KL Loss: 14.3707725 DSM Loss: 19.8971917 Overall Loss:36.1946435
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(61.4405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8995539 KL Loss: 14.2827846 DSM Loss: 19.5963433 Overall Loss:35.7786816
Validation loss decreased (0.983296 --> 0.980263).  Saving model ...
Updating learning rate to 0.000125
tensor(31.8835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8436933 KL Loss: 14.2832450 DSM Loss: 19.3555379 Overall Loss:35.4824761
Validation loss decreased (0.980263 --> 0.979382).  Saving model ...
Updating learning rate to 6.25e-05
tensor(53.6216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8731990 KL Loss: 14.1993908 DSM Loss: 19.2986113 Overall Loss:35.3712011
Validation loss decreased (0.979382 --> 0.978571).  Saving model ...
Updating learning rate to 3.125e-05
tensor(37.2050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8592343 KL Loss: 14.3215501 DSM Loss: 18.4190347 Overall Loss:34.5998190
Validation loss decreased (0.978571 --> 0.978174).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(30.2796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0035, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8851981 KL Loss: 14.3010801 DSM Loss: 19.3892792 Overall Loss:35.5755574
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(22.1295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1863, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8472365 KL Loss: 14.1832065 DSM Loss: 19.2475266 Overall Loss:35.2779695
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(26.3394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7514, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8306316 KL Loss: 14.0319057 DSM Loss: 19.5322281 Overall Loss:35.3947655
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(25.9359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8305871 KL Loss: 14.2415389 DSM Loss: 18.8738645 Overall Loss:34.9459906
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(26.9469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7226, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8491154 KL Loss: 14.2630698 DSM Loss: 19.0715306 Overall Loss:35.1837157
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(27.6081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8269300 KL Loss: 14.1533432 DSM Loss: 19.1897476 Overall Loss:35.1700207
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(33.7109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8735221 KL Loss: 14.3681138 DSM Loss: 18.7168538 Overall Loss:34.9584896
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(23.3528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4018, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8138738 KL Loss: 14.1595789 DSM Loss: 19.2888509 Overall Loss:35.2623036
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(43.4595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5142, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.9060570 KL Loss: 14.6096558 DSM Loss: 18.4334604 Overall Loss:34.9491732
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(26.2553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8455244 KL Loss: 14.2332581 DSM Loss: 19.4661621 Overall Loss:35.5449446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8864001035690308


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.6511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8834247 KL Loss: 14.2832945 DSM Loss: 22.4245031 Overall Loss:38.5912220
Validation loss decreased (inf --> 1.055613).  Saving model ...
Updating learning rate to 0.0005
tensor(76.8411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5533, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8836201 KL Loss: 14.3250388 DSM Loss: 19.6493457 Overall Loss:35.8580045
Validation loss decreased (1.055613 --> 1.034573).  Saving model ...
Updating learning rate to 0.00025
tensor(36.8472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2135, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8268449 KL Loss: 14.0899171 DSM Loss: 19.5834956 Overall Loss:35.5002577
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(28.7242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8549597 KL Loss: 14.1584890 DSM Loss: 19.4385384 Overall Loss:35.4519871
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(48.3187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8461878 KL Loss: 14.1367968 DSM Loss: 18.9281221 Overall Loss:34.9111067
Validation loss decreased (1.034573 --> 1.032806).  Saving model ...
Updating learning rate to 3.125e-05
tensor(34.0049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8005097 KL Loss: 14.0558185 DSM Loss: 19.1022904 Overall Loss:34.9586185
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(27.5830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8451519 KL Loss: 14.0913740 DSM Loss: 19.1246215 Overall Loss:35.0611475
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(26.1224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8606589 KL Loss: 14.1834609 DSM Loss: 18.7247940 Overall Loss:34.7689139
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(25.4639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8333206 KL Loss: 13.9828185 DSM Loss: 19.2255105 Overall Loss:35.0416496
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(22.1549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8358316 KL Loss: 14.1387514 DSM Loss: 19.3631487 Overall Loss:35.3377319
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(38.1492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8268225 KL Loss: 14.0830160 DSM Loss: 19.2243699 Overall Loss:35.1342085
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(37.6548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8620935 KL Loss: 14.2745571 DSM Loss: 18.6447875 Overall Loss:34.7814382
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(35.7358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5178, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8624770 KL Loss: 14.0720572 DSM Loss: 18.9899619 Overall Loss:34.9244961
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(44.7708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8602164 KL Loss: 14.0968843 DSM Loss: 18.9784171 Overall Loss:34.9355176
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(37.0122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2602, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8510823 KL Loss: 14.2007918 DSM Loss: 19.1142716 Overall Loss:35.1661455
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9331977963447571


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(75.0072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9153638 KL Loss: 14.4457695 DSM Loss: 22.0988303 Overall Loss:38.4599632
Validation loss decreased (inf --> 0.910638).  Saving model ...
Updating learning rate to 0.0005
tensor(32.2141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8569905 KL Loss: 14.2674589 DSM Loss: 19.6726551 Overall Loss:35.7971046
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(34.9962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8995575 KL Loss: 14.2582265 DSM Loss: 19.0408592 Overall Loss:35.1986432
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(31.7255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8655441 KL Loss: 14.2967007 DSM Loss: 19.0849652 Overall Loss:35.2472102
Validation loss decreased (0.910638 --> 0.910000).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.4110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8651284 KL Loss: 14.2940771 DSM Loss: 18.9846989 Overall Loss:35.1439047
Validation loss decreased (0.910000 --> 0.909743).  Saving model ...
Updating learning rate to 3.125e-05
tensor(26.8058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8965936 KL Loss: 14.3697257 DSM Loss: 18.8310800 Overall Loss:35.0973995
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(29.9128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9113887 KL Loss: 14.4875951 DSM Loss: 18.4126132 Overall Loss:34.8115970
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(39.3529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9563, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8732169 KL Loss: 14.1776718 DSM Loss: 18.7699885 Overall Loss:34.8208773
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(32.1784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8668062 KL Loss: 14.2667034 DSM Loss: 18.8795624 Overall Loss:35.0130719
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(35.4636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2203, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8600116 KL Loss: 14.3902319 DSM Loss: 18.5055522 Overall Loss:34.7557959
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(34.3638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8800913 KL Loss: 14.2829866 DSM Loss: 18.7239390 Overall Loss:34.8870171
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(28.5802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8507527 KL Loss: 14.2022070 DSM Loss: 18.9788964 Overall Loss:35.0318561
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(45.8380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8854647 KL Loss: 14.2817612 DSM Loss: 19.0459694 Overall Loss:35.2131954
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(43.8912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8609462 KL Loss: 14.2863135 DSM Loss: 18.7692855 Overall Loss:34.9165453
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(31.2142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8868485 KL Loss: 14.3005870 DSM Loss: 18.6632270 Overall Loss:34.8506625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.6764850616455078


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(42.6970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9553192 KL Loss: 14.3876629 DSM Loss: 24.2651280 Overall Loss:40.6081101
Validation loss decreased (inf --> 0.551229).  Saving model ...
Updating learning rate to 0.0005
tensor(25.2643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9244394 KL Loss: 14.4007989 DSM Loss: 19.8092090 Overall Loss:36.1344473
Validation loss decreased (0.551229 --> 0.548707).  Saving model ...
Updating learning rate to 0.00025
tensor(22.3215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8309388 KL Loss: 14.1069586 DSM Loss: 19.8260415 Overall Loss:35.7639390
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(26.7199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5452, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8516488 KL Loss: 14.1418666 DSM Loss: 19.6803681 Overall Loss:35.6738836
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(27.6576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7310, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9414218 KL Loss: 14.6187567 DSM Loss: 18.7913023 Overall Loss:35.3514810
Validation loss decreased (0.548707 --> 0.548635).  Saving model ...
Updating learning rate to 3.125e-05
tensor(28.5447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9168176 KL Loss: 14.5003742 DSM Loss: 18.7101262 Overall Loss:35.1273180
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(28.2653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9147552 KL Loss: 14.4015185 DSM Loss: 19.2435941 Overall Loss:35.5598677
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(42.5337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4489, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8652084 KL Loss: 14.2272832 DSM Loss: 19.4190006 Overall Loss:35.5114923
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(26.3403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8370929 KL Loss: 14.0816466 DSM Loss: 19.5940525 Overall Loss:35.5127920
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(70.7734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.9126206 KL Loss: 14.4737316 DSM Loss: 18.9117766 Overall Loss:35.2981288
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(25.0366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.2379, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8299773 KL Loss: 14.0471337 DSM Loss: 19.7223055 Overall Loss:35.5994164
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(58.8769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0525, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8641698 KL Loss: 14.1949802 DSM Loss: 19.3683090 Overall Loss:35.4274589
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(25.3544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8228, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8460081 KL Loss: 14.2238076 DSM Loss: 19.4848655 Overall Loss:35.5546812
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(68.1580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7692, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8489805 KL Loss: 14.2771664 DSM Loss: 19.0327867 Overall Loss:35.1589335
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(38.5872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8569813 KL Loss: 14.1383963 DSM Loss: 19.7141957 Overall Loss:35.7095731
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7800549268722534


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(44.0763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8992337 KL Loss: 14.3029906 DSM Loss: 24.2882308 Overall Loss:40.4904551
Validation loss decreased (inf --> 1.095096).  Saving model ...
Updating learning rate to 0.0005
tensor(29.9653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3515, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8931133 KL Loss: 14.2540199 DSM Loss: 19.8601135 Overall Loss:36.0072467
Validation loss decreased (1.095096 --> 1.088775).  Saving model ...
Updating learning rate to 0.00025
tensor(22.1599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2962, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8698217 KL Loss: 14.2470759 DSM Loss: 19.5715781 Overall Loss:35.6884755
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(31.2838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9063321 KL Loss: 14.3473737 DSM Loss: 19.1625185 Overall Loss:35.4162244
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(48.7211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8866837 KL Loss: 14.2680684 DSM Loss: 19.0281727 Overall Loss:35.1829245
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(44.8561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8532577 KL Loss: 14.1891908 DSM Loss: 18.9650525 Overall Loss:35.0075009
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(19.1213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8321830 KL Loss: 14.2564888 DSM Loss: 19.0302734 Overall Loss:35.1189453
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(21.9316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8830197 KL Loss: 14.2647904 DSM Loss: 19.0702018 Overall Loss:35.2180118
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(24.7034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8706654 KL Loss: 14.2285926 DSM Loss: 19.2371330 Overall Loss:35.3363906
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(38.6888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8598470 KL Loss: 14.2998068 DSM Loss: 19.0667433 Overall Loss:35.2263973
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(34.4783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9203, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8579803 KL Loss: 14.2984747 DSM Loss: 18.9796009 Overall Loss:35.1360560
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(42.8197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8542815 KL Loss: 14.2111327 DSM Loss: 19.1619878 Overall Loss:35.2274020
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5484766364097595


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.0779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8804386 KL Loss: 14.3041683 DSM Loss: 23.5649774 Overall Loss:39.7495844
Validation loss decreased (inf --> 0.568175).  Saving model ...
Updating learning rate to 0.0005
tensor(38.9790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8754988 KL Loss: 14.2800997 DSM Loss: 19.8042072 Overall Loss:35.9598056
Validation loss decreased (0.568175 --> 0.564131).  Saving model ...
Updating learning rate to 0.00025
tensor(21.3890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7814, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8953214 KL Loss: 14.3611290 DSM Loss: 19.4222066 Overall Loss:35.6786566
Validation loss decreased (0.564131 --> 0.562797).  Saving model ...
Updating learning rate to 0.000125
tensor(25.0875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8758826 KL Loss: 14.2938236 DSM Loss: 18.9743011 Overall Loss:35.1440073
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(27.3614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4609, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8730067 KL Loss: 14.3567152 DSM Loss: 18.8320903 Overall Loss:35.0618123
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(28.1105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9082930 KL Loss: 14.3772176 DSM Loss: 18.5153502 Overall Loss:34.8008608
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(41.2979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8085092 KL Loss: 14.0066840 DSM Loss: 19.3211496 Overall Loss:35.1363428
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(56.4527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8686397 KL Loss: 14.3729981 DSM Loss: 18.6865299 Overall Loss:34.9281678
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(26.8925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9538, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8503061 KL Loss: 14.1434434 DSM Loss: 19.2298485 Overall Loss:35.2235981
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(62.8617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8415899 KL Loss: 14.1444361 DSM Loss: 18.8392051 Overall Loss:34.8252313
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(40.3049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8568927 KL Loss: 14.3223309 DSM Loss: 18.8725665 Overall Loss:35.0517901
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(48.9453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8430299 KL Loss: 14.3392997 DSM Loss: 18.8222275 Overall Loss:35.0045570
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(49.7495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.2065, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8505912 KL Loss: 14.2346492 DSM Loss: 19.0066206 Overall Loss:35.0918612
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7118821740150452


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.1083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9457865 KL Loss: 14.2063050 DSM Loss: 21.8849695 Overall Loss:38.0370610
Validation loss decreased (inf --> 1.908138).  Saving model ...
Updating learning rate to 0.0005
tensor(32.1415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8309333 KL Loss: 14.2150364 DSM Loss: 19.2883613 Overall Loss:35.3343309
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(39.0353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5692, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9359669 KL Loss: 14.3484190 DSM Loss: 18.4774653 Overall Loss:34.7618511
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(31.8171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8565132 KL Loss: 14.3258407 DSM Loss: 18.5360435 Overall Loss:34.7183974
Validation loss decreased (1.908138 --> 1.907470).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.6503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8587869 KL Loss: 14.2638026 DSM Loss: 17.9502251 Overall Loss:34.0728147
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(46.2736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1118, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8924581 KL Loss: 14.3351493 DSM Loss: 18.3374436 Overall Loss:34.5650508
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(41.5147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8475465 KL Loss: 14.1679201 DSM Loss: 18.4901185 Overall Loss:34.5055851
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(34.6672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8605668 KL Loss: 14.3329024 DSM Loss: 17.9580565 Overall Loss:34.1515258
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(26.2155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8537239 KL Loss: 14.2872327 DSM Loss: 18.2744782 Overall Loss:34.4154345
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(37.5995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8860623 KL Loss: 14.2795796 DSM Loss: 18.2742306 Overall Loss:34.4398724
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(28.4313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8355641 KL Loss: 14.1908548 DSM Loss: 18.5163206 Overall Loss:34.5427395
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(30.5262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8955280 KL Loss: 14.3909942 DSM Loss: 18.2033082 Overall Loss:34.4898303
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.1401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8495985 KL Loss: 14.2110848 DSM Loss: 18.3431505 Overall Loss:34.4038335
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(30.6942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8391214 KL Loss: 14.1618804 DSM Loss: 18.5110623 Overall Loss:34.5120639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.28621244430542


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(44.0490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9079549 KL Loss: 14.2614729 DSM Loss: 22.7701459 Overall Loss:38.9395736
Validation loss decreased (inf --> 1.295864).  Saving model ...
Updating learning rate to 0.0005
tensor(53.0085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8893733 KL Loss: 14.3210292 DSM Loss: 19.6391536 Overall Loss:35.8495559
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(37.6356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8542091 KL Loss: 14.1859839 DSM Loss: 19.4306601 Overall Loss:35.4708530
Validation loss decreased (1.295864 --> 1.286833).  Saving model ...
Updating learning rate to 0.000125
tensor(34.9809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8483254 KL Loss: 14.2490273 DSM Loss: 19.0127164 Overall Loss:35.1100689
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(30.8067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2952, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8728282 KL Loss: 14.2345081 DSM Loss: 19.0834998 Overall Loss:35.1908361
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(29.8550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8638916 KL Loss: 14.3353279 DSM Loss: 18.9361183 Overall Loss:35.1353377
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(42.9228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8623600 KL Loss: 14.2291763 DSM Loss: 18.9411322 Overall Loss:35.0326687
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(26.6005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8958, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8460666 KL Loss: 14.2372368 DSM Loss: 19.2719843 Overall Loss:35.3552876
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(43.1151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8393251 KL Loss: 14.2804033 DSM Loss: 18.9598292 Overall Loss:35.0795577
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(30.7373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8398984 KL Loss: 14.2175753 DSM Loss: 18.9840657 Overall Loss:35.0415395
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(30.6300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7490, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8828842 KL Loss: 14.3819740 DSM Loss: 18.6009777 Overall Loss:34.8658360
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.4272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8326640 KL Loss: 14.2766225 DSM Loss: 19.0628282 Overall Loss:35.1721146
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(43.2151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5736, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8748746 KL Loss: 14.3331207 DSM Loss: 18.9423306 Overall Loss:35.1503257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.3534626960754395


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.1135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8948686 KL Loss: 14.4114066 DSM Loss: 24.8358212 Overall Loss:41.1420966
Validation loss decreased (inf --> 1.391782).  Saving model ...
Updating learning rate to 0.0005
tensor(32.9505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9418965 KL Loss: 14.3698606 DSM Loss: 20.2588099 Overall Loss:36.5705670
Validation loss decreased (1.391782 --> 1.379858).  Saving model ...
Updating learning rate to 0.00025
tensor(27.3284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8909905 KL Loss: 14.2947025 DSM Loss: 19.6525000 Overall Loss:35.8381930
Validation loss decreased (1.379858 --> 1.377310).  Saving model ...
Updating learning rate to 0.000125
tensor(29.1010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8762095 KL Loss: 14.3381118 DSM Loss: 19.3558312 Overall Loss:35.5701527
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(30.1080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1229, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8829734 KL Loss: 14.3564532 DSM Loss: 18.8074419 Overall Loss:35.0468684
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(25.7191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8887344 KL Loss: 14.2524886 DSM Loss: 19.2644511 Overall Loss:35.4056742
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(33.4364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8390534 KL Loss: 14.1213572 DSM Loss: 19.5202902 Overall Loss:35.4807009
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(32.9198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7930, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8327802 KL Loss: 14.1397561 DSM Loss: 19.4790025 Overall Loss:35.4515389
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(31.8473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2961, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8723679 KL Loss: 14.4117911 DSM Loss: 18.8884162 Overall Loss:35.1725751
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(36.5490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8212992 KL Loss: 14.1968732 DSM Loss: 19.4530798 Overall Loss:35.4712521
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(32.7747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8505013 KL Loss: 14.1766384 DSM Loss: 19.4783078 Overall Loss:35.5054473
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(30.7138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8666462 KL Loss: 14.3366163 DSM Loss: 19.4304457 Overall Loss:35.6337082
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(24.4492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8365374 KL Loss: 14.2968202 DSM Loss: 19.3190370 Overall Loss:35.4523946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.4532700777053833


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(55.5625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9837694 KL Loss: 14.5215813 DSM Loss: 22.1967201 Overall Loss:38.7020708
Validation loss decreased (inf --> 1.764542).  Saving model ...
Updating learning rate to 0.0005
tensor(27.1862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1848, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8622774 KL Loss: 14.2186495 DSM Loss: 19.9309297 Overall Loss:36.0118564
Validation loss decreased (1.764542 --> 1.758103).  Saving model ...
Updating learning rate to 0.00025
tensor(29.2427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8456637 KL Loss: 14.2052797 DSM Loss: 19.3427535 Overall Loss:35.3936966
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(27.7452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8253644 KL Loss: 14.1495164 DSM Loss: 19.2102501 Overall Loss:35.1851309
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(33.8402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8588338 KL Loss: 14.2805972 DSM Loss: 18.7910997 Overall Loss:34.9305309
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(23.1665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5447, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8729344 KL Loss: 14.3672975 DSM Loss: 18.3709431 Overall Loss:34.6111750
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(27.5980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4126, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8431076 KL Loss: 14.1129977 DSM Loss: 18.9725266 Overall Loss:34.9286318
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(27.7263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2501, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8563064 KL Loss: 14.2342862 DSM Loss: 18.8346567 Overall Loss:34.9252493
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(31.4797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8510701 KL Loss: 14.2167725 DSM Loss: 18.7307076 Overall Loss:34.7985502
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(45.4902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8722885 KL Loss: 14.4040322 DSM Loss: 18.6074785 Overall Loss:34.8837992
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(28.4442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8251178 KL Loss: 14.1463008 DSM Loss: 19.0060541 Overall Loss:34.9774726
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(42.6779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8153001 KL Loss: 14.1152992 DSM Loss: 18.9799723 Overall Loss:34.9105716
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5901105403900146


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(44.4315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9274637 KL Loss: 14.3334848 DSM Loss: 22.7038275 Overall Loss:38.9647762
Validation loss decreased (inf --> 0.652261).  Saving model ...
Updating learning rate to 0.0005
tensor(31.6483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7236, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9007692 KL Loss: 14.2647167 DSM Loss: 20.1343834 Overall Loss:36.2998694
Validation loss decreased (0.652261 --> 0.648954).  Saving model ...
Updating learning rate to 0.00025
tensor(44.0974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3494, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8700294 KL Loss: 14.2720940 DSM Loss: 19.0831001 Overall Loss:35.2252234
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(26.1849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8681132 KL Loss: 14.1917196 DSM Loss: 19.6070093 Overall Loss:35.6668419
Validation loss decreased (0.648954 --> 0.648874).  Saving model ...
Updating learning rate to 6.25e-05
tensor(50.7829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8587868 KL Loss: 14.2935346 DSM Loss: 19.1973926 Overall Loss:35.3497141
Validation loss decreased (0.648874 --> 0.648827).  Saving model ...
Updating learning rate to 3.125e-05
tensor(28.1512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8555201 KL Loss: 14.1937214 DSM Loss: 18.7851450 Overall Loss:34.8343867
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(26.7362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9118713 KL Loss: 14.5079207 DSM Loss: 18.5678200 Overall Loss:34.9876122
Validation loss decreased (0.648827 --> 0.648573).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(26.0890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.9528563 KL Loss: 14.6708419 DSM Loss: 18.3202044 Overall Loss:34.9439027
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(52.4493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.9138805 KL Loss: 14.4426608 DSM Loss: 18.4737035 Overall Loss:34.8302447
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(29.2730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8788525 KL Loss: 14.2758400 DSM Loss: 19.0949334 Overall Loss:35.2496258
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(47.2516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8919, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8581623 KL Loss: 14.1843918 DSM Loss: 19.1728391 Overall Loss:35.2153929
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(30.0854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2559, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8481262 KL Loss: 14.0597116 DSM Loss: 19.1363494 Overall Loss:35.0441872
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(26.7021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8606629 KL Loss: 14.1915003 DSM Loss: 19.0565027 Overall Loss:35.1086660
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(30.9646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8356898 KL Loss: 14.1263707 DSM Loss: 19.2378204 Overall Loss:35.1998810
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(31.2531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8876830 KL Loss: 14.3161394 DSM Loss: 18.8480210 Overall Loss:35.0518436
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(28.8560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8988526 KL Loss: 14.3129809 DSM Loss: 18.8771551 Overall Loss:35.0889886
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(44.9309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8749820 KL Loss: 14.2880876 DSM Loss: 19.2632749 Overall Loss:35.4263445
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6737028956413269


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.1296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8767005 KL Loss: 14.3203429 DSM Loss: 23.5573495 Overall Loss:39.7543929
Validation loss decreased (inf --> 1.352161).  Saving model ...
Updating learning rate to 0.0005
tensor(32.9612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8923050 KL Loss: 14.2389837 DSM Loss: 19.9285617 Overall Loss:36.0598502
Validation loss decreased (1.352161 --> 1.351647).  Saving model ...
Updating learning rate to 0.00025
tensor(33.8295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8567778 KL Loss: 14.1622805 DSM Loss: 19.4569847 Overall Loss:35.4760431
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(32.6398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8425403 KL Loss: 14.1393614 DSM Loss: 19.1002316 Overall Loss:35.0821333
Validation loss decreased (1.351647 --> 1.350239).  Saving model ...
Updating learning rate to 6.25e-05
tensor(29.7201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7607, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8608963 KL Loss: 14.2529221 DSM Loss: 19.0716643 Overall Loss:35.1854825
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(36.3809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8551377 KL Loss: 14.2379814 DSM Loss: 19.1881155 Overall Loss:35.2812347
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(29.6190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9015680 KL Loss: 14.4215017 DSM Loss: 18.6081715 Overall Loss:34.9312410
Validation loss decreased (1.350239 --> 1.349405).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(32.6727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8189618 KL Loss: 14.1199655 DSM Loss: 19.1115579 Overall Loss:35.0504853
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(32.4059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8762575 KL Loss: 14.3104393 DSM Loss: 19.0316235 Overall Loss:35.2183203
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(43.3304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8504403 KL Loss: 14.2188274 DSM Loss: 18.9757983 Overall Loss:35.0450660
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(45.7118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.0254, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8665356 KL Loss: 14.2376504 DSM Loss: 19.1626019 Overall Loss:35.2667878
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(34.3163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9355, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8638747 KL Loss: 14.2485671 DSM Loss: 18.9836646 Overall Loss:35.0961063
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(27.2930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8688989 KL Loss: 14.3026488 DSM Loss: 18.8951711 Overall Loss:35.0667189
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(35.7174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8763052 KL Loss: 14.3225086 DSM Loss: 19.1386507 Overall Loss:35.3374644
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(32.2494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0663, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8541273 KL Loss: 14.2221953 DSM Loss: 18.8642448 Overall Loss:34.9405673
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(30.3023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8659394 KL Loss: 14.2558181 DSM Loss: 18.7769888 Overall Loss:34.8987463
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(39.2572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0657, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8495661 KL Loss: 14.1241519 DSM Loss: 19.0464611 Overall Loss:35.0201792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9751691222190857


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.2680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0040, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9142363 KL Loss: 14.3455448 DSM Loss: 22.7141203 Overall Loss:38.9739016
Validation loss decreased (inf --> 0.912682).  Saving model ...
Updating learning rate to 0.0005
tensor(43.1546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9256502 KL Loss: 14.3490720 DSM Loss: 19.4166775 Overall Loss:35.6913995
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(31.2389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8578424 KL Loss: 14.1945128 DSM Loss: 19.2482749 Overall Loss:35.3006301
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(28.8117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9044331 KL Loss: 14.4007631 DSM Loss: 19.0974577 Overall Loss:35.4026541
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(30.6623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8755426 KL Loss: 14.1451168 DSM Loss: 19.1153486 Overall Loss:35.1360080
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(57.3703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8420300 KL Loss: 14.2194190 DSM Loss: 18.7775069 Overall Loss:34.8389558
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(28.9580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8293817 KL Loss: 14.2787044 DSM Loss: 18.8929661 Overall Loss:35.0010520
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(34.0821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8483339 KL Loss: 14.2745149 DSM Loss: 18.9130606 Overall Loss:35.0359090
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(33.2664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8481332 KL Loss: 14.2797499 DSM Loss: 18.9745260 Overall Loss:35.1024091
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(32.4586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8577666 KL Loss: 14.3212659 DSM Loss: 18.7126503 Overall Loss:34.8916829
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(27.6971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8597188 KL Loss: 14.2730508 DSM Loss: 18.8414237 Overall Loss:34.9741934
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.621419906616211


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(76.4282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9180358 KL Loss: 14.3985618 DSM Loss: 21.7252816 Overall Loss:38.0418790
Validation loss decreased (inf --> 1.497045).  Saving model ...
Updating learning rate to 0.0005
tensor(32.0825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1254, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8374486 KL Loss: 14.1501599 DSM Loss: 19.4857308 Overall Loss:35.4733393
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(48.8510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.7905365 KL Loss: 14.0718818 DSM Loss: 19.1628423 Overall Loss:35.0252604
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(25.8454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6703, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8450604 KL Loss: 14.1072420 DSM Loss: 19.0225970 Overall Loss:34.9748993
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(34.1691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8555892 KL Loss: 14.1909916 DSM Loss: 18.9778667 Overall Loss:35.0244476
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(29.8862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8475967 KL Loss: 14.2780125 DSM Loss: 18.5474746 Overall Loss:34.6730840
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(29.1844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8330994 KL Loss: 14.1700136 DSM Loss: 18.6547343 Overall Loss:34.6578472
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(28.3273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8508459 KL Loss: 14.2059574 DSM Loss: 18.8141913 Overall Loss:34.8709946
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(43.6980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9848, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8225204 KL Loss: 14.1312961 DSM Loss: 18.4207253 Overall Loss:34.3745417
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(31.6363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8499492 KL Loss: 14.3226568 DSM Loss: 18.2739069 Overall Loss:34.4465129
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(29.6618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8608736 KL Loss: 14.3769652 DSM Loss: 18.0267783 Overall Loss:34.2646169
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.645846426486969


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.2465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9235041 KL Loss: 14.4519833 DSM Loss: 23.0511381 Overall Loss:39.4266253
Validation loss decreased (inf --> 1.066863).  Saving model ...
Updating learning rate to 0.0005
tensor(34.4324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9117069 KL Loss: 14.3647082 DSM Loss: 19.4412742 Overall Loss:35.7176892
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(29.7694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8819171 KL Loss: 14.2298536 DSM Loss: 19.5231159 Overall Loss:35.6348868
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(61.9198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0236, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8433994 KL Loss: 14.2087938 DSM Loss: 19.2020490 Overall Loss:35.2542423
Validation loss decreased (1.066863 --> 1.063711).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.7397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8479989 KL Loss: 14.2407953 DSM Loss: 19.2560115 Overall Loss:35.3448055
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(27.9123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8556141 KL Loss: 14.2927989 DSM Loss: 19.3308759 Overall Loss:35.4792887
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(41.0317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9131257 KL Loss: 14.5142332 DSM Loss: 18.4624065 Overall Loss:34.8897654
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(32.3063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8809831 KL Loss: 14.3486115 DSM Loss: 18.7073754 Overall Loss:34.9369699
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(30.7760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8925199 KL Loss: 14.4201373 DSM Loss: 18.8624343 Overall Loss:35.1750916
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(33.9328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7668, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8634791 KL Loss: 14.3260952 DSM Loss: 19.0534131 Overall Loss:35.2429875
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(32.8960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0725, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8704437 KL Loss: 14.2122109 DSM Loss: 18.9031285 Overall Loss:34.9857830
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(45.3561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8954823 KL Loss: 14.2682549 DSM Loss: 19.4227429 Overall Loss:35.5864801
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(40.2994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8545078 KL Loss: 14.1741414 DSM Loss: 18.6705689 Overall Loss:34.6992181
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(28.3095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8707791 KL Loss: 14.2570142 DSM Loss: 19.0028164 Overall Loss:35.1306100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7531189918518066


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.4454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9153302 KL Loss: 14.3568874 DSM Loss: 23.6412315 Overall Loss:39.9134491
Validation loss decreased (inf --> 0.664216).  Saving model ...
Updating learning rate to 0.0005
tensor(35.1368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0489, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8714087 KL Loss: 14.2623966 DSM Loss: 19.5739682 Overall Loss:35.7077735
Validation loss decreased (0.664216 --> 0.658914).  Saving model ...
Updating learning rate to 0.00025
tensor(45.5137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.6618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8917762 KL Loss: 14.3468207 DSM Loss: 19.2067978 Overall Loss:35.4453946
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(30.3584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8707416 KL Loss: 14.1987310 DSM Loss: 19.3406634 Overall Loss:35.4101360
Validation loss decreased (0.658914 --> 0.657624).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.1268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8746410 KL Loss: 14.2909214 DSM Loss: 19.0151297 Overall Loss:35.1806922
Validation loss decreased (0.657624 --> 0.656514).  Saving model ...
Updating learning rate to 3.125e-05
tensor(29.2788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8292048 KL Loss: 14.1647831 DSM Loss: 19.0086052 Overall Loss:35.0025931
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(30.9643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8649075 KL Loss: 14.2803464 DSM Loss: 18.8685015 Overall Loss:35.0137556
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(26.0057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8798986 KL Loss: 14.3706527 DSM Loss: 18.7052534 Overall Loss:34.9558046
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(28.5738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8755025 KL Loss: 14.2207799 DSM Loss: 18.9149063 Overall Loss:35.0111887
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(34.7432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8574303 KL Loss: 14.2058122 DSM Loss: 19.1688805 Overall Loss:35.2321226
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(27.4674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3987, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8595321 KL Loss: 14.2977713 DSM Loss: 19.0616545 Overall Loss:35.2189581
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(30.1359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8027, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8626291 KL Loss: 14.2650235 DSM Loss: 19.1248382 Overall Loss:35.2524909
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(43.5792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0419, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8745681 KL Loss: 14.2454799 DSM Loss: 18.8844337 Overall Loss:35.0044816
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(41.7679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8279564 KL Loss: 14.1639443 DSM Loss: 18.8780573 Overall Loss:34.8699580
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(29.7244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9762, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8608550 KL Loss: 14.1228570 DSM Loss: 19.2948357 Overall Loss:35.2785474
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8071219325065613


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.4379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0834, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9097491 KL Loss: 14.3354429 DSM Loss: 23.6273766 Overall Loss:39.8725686
Validation loss decreased (inf --> 1.163112).  Saving model ...
Updating learning rate to 0.0005
tensor(26.8896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8785436 KL Loss: 14.2440193 DSM Loss: 19.6643399 Overall Loss:35.7869026
Validation loss decreased (1.163112 --> 1.115279).  Saving model ...
Updating learning rate to 0.00025
tensor(26.5724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8844576 KL Loss: 14.2108736 DSM Loss: 19.2849755 Overall Loss:35.3803070
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(24.7847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8362591 KL Loss: 14.0309441 DSM Loss: 18.8418601 Overall Loss:34.7090633
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(33.5653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9031060 KL Loss: 14.1471090 DSM Loss: 18.7951009 Overall Loss:34.8453159
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(33.6085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8591226 KL Loss: 14.1045815 DSM Loss: 19.2032760 Overall Loss:35.1669801
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(25.7578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8485700 KL Loss: 14.1421616 DSM Loss: 18.3684317 Overall Loss:34.3591632
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(48.4290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8794083 KL Loss: 14.2318167 DSM Loss: 18.7141552 Overall Loss:34.8253801
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(24.6643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.9078431 KL Loss: 14.1722521 DSM Loss: 18.7501013 Overall Loss:34.8301963
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(24.3916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6426, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8522039 KL Loss: 14.0553126 DSM Loss: 18.6148219 Overall Loss:34.5223381
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(29.2516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8639903 KL Loss: 14.0983166 DSM Loss: 18.7343841 Overall Loss:34.6966912
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(44.8131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3958, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8574768 KL Loss: 14.0612098 DSM Loss: 18.9367474 Overall Loss:34.8554338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.0419213771820068
      Ticker       MSE StdDev
0   AAPL_pct  0.867258    0.0
1   ABBV_pct  0.572432    0.0
2    AEP_pct  1.150341    0.0
3   AMGN_pct  0.698787    0.0
4   AMZN_pct  1.798834    0.0
..       ...       ...    ...
66    VZ_pct   1.62142    0.0
67     V_pct  0.645846    0.0
68   WFC_pct  0.753119    0.0
69   WMT_pct  0.807122    0.0
70   XOM_pct  1.041921    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=10, prediction_length=40, root_path='data/EcmP_stock_L_2016_24_spec_official_dva_spec', scale=0.1, sequence_length=40, target_dim=1, train_epochs=30, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.1214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.8948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0245138 KL Loss: 28.5244738 DSM Loss: 44.4254769 Overall Loss:74.9744644
Validation loss decreased (inf --> 0.858467).  Saving model ...
Updating learning rate to 0.0005
tensor(76.0774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9435259 KL Loss: 28.2938164 DSM Loss: 39.4489780 Overall Loss:69.6863202
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(89.0470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.3952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9587681 KL Loss: 28.5315877 DSM Loss: 38.4855926 Overall Loss:68.9759487
Validation loss decreased (0.858467 --> 0.857216).  Saving model ...
Updating learning rate to 0.000125
tensor(93.7229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9491955 KL Loss: 28.5226829 DSM Loss: 37.9008484 Overall Loss:68.3727266
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(74.0117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.0586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9241008 KL Loss: 28.3323352 DSM Loss: 38.2824124 Overall Loss:68.5388486
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(67.1591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8945429 KL Loss: 28.3730792 DSM Loss: 38.4110531 Overall Loss:68.6786757
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(47.7084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9108869 KL Loss: 28.3240825 DSM Loss: 38.3407757 Overall Loss:68.5757447
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(74.2052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8762, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9248368 KL Loss: 28.5559090 DSM Loss: 37.8134488 Overall Loss:68.2941942
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(69.6041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9395572 KL Loss: 28.5081444 DSM Loss: 38.4566924 Overall Loss:68.9043944
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(82.2698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.2831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9267466 KL Loss: 28.3825285 DSM Loss: 38.1335537 Overall Loss:68.4428289
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(87.1522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.3529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9178873 KL Loss: 28.4647630 DSM Loss: 38.4873515 Overall Loss:68.8700017
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(72.9135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.5836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9123341 KL Loss: 28.4855733 DSM Loss: 37.9258308 Overall Loss:68.3237380
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(67.3162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7965, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9287419 KL Loss: 28.5235422 DSM Loss: 37.6332073 Overall Loss:68.0854914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8580131530761719


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(96.3451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9580983 KL Loss: 28.6709588 DSM Loss: 46.0702333 Overall Loss:76.6992910
Validation loss decreased (inf --> 0.500788).  Saving model ...
Updating learning rate to 0.0005
tensor(66.9848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9450379 KL Loss: 28.4209200 DSM Loss: 37.8420552 Overall Loss:68.2080133
Validation loss decreased (0.500788 --> 0.495008).  Saving model ...
Updating learning rate to 0.00025
tensor(75.7642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9214242 KL Loss: 28.3981574 DSM Loss: 37.6067438 Overall Loss:67.9263256
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(68.3600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.2145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9563719 KL Loss: 28.5708195 DSM Loss: 37.1571504 Overall Loss:67.6843419
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(52.1766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6045, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9410618 KL Loss: 28.5127664 DSM Loss: 37.0424839 Overall Loss:67.4963120
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(71.8411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4515, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9361307 KL Loss: 28.3889455 DSM Loss: 36.7158008 Overall Loss:67.0408771
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(53.8063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5489, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9201123 KL Loss: 28.4251603 DSM Loss: 37.0402914 Overall Loss:67.3855638
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(72.8860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9145599 KL Loss: 28.2606414 DSM Loss: 37.3772006 Overall Loss:67.5524016
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(53.5783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9295969 KL Loss: 28.5373953 DSM Loss: 36.4258095 Overall Loss:66.8928017
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(57.5519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.1183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9162790 KL Loss: 28.4450149 DSM Loss: 36.4238088 Overall Loss:66.7851026
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(63.0661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9254273 KL Loss: 28.7287683 DSM Loss: 36.2629819 Overall Loss:66.9171775
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(77.7550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.4185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8906509 KL Loss: 28.2083000 DSM Loss: 37.1418966 Overall Loss:67.2408472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.56712406873703


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(110.3647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.4498, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9375013 KL Loss: 28.7407557 DSM Loss: 47.0413603 Overall Loss:77.7196178
Validation loss decreased (inf --> 0.651458).  Saving model ...
Updating learning rate to 0.0005
tensor(63.9974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9934718 KL Loss: 28.8519311 DSM Loss: 38.1767957 Overall Loss:69.0221985
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(81.4033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9188099 KL Loss: 28.3970622 DSM Loss: 39.4432730 Overall Loss:69.7591452
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(72.5144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9317712 KL Loss: 28.3654725 DSM Loss: 38.8633852 Overall Loss:69.1606290
Validation loss decreased (0.651458 --> 0.649665).  Saving model ...
Updating learning rate to 6.25e-05
tensor(73.0376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.4537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9561750 KL Loss: 28.7409152 DSM Loss: 37.9639958 Overall Loss:68.6610860
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(53.2859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.6734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9230545 KL Loss: 28.2880541 DSM Loss: 38.7490109 Overall Loss:68.9601196
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(97.5449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9156322 KL Loss: 28.3932488 DSM Loss: 38.4482129 Overall Loss:68.7570937
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(54.3555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3202, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9246335 KL Loss: 28.5073682 DSM Loss: 38.2176370 Overall Loss:68.6496385
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(69.8828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9127977 KL Loss: 28.4069362 DSM Loss: 37.8244803 Overall Loss:68.1442143
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(49.6597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9000140 KL Loss: 28.3292717 DSM Loss: 38.6493913 Overall Loss:68.8786769
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(62.7594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8582, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9334671 KL Loss: 28.6833124 DSM Loss: 38.1463630 Overall Loss:68.7631428
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(46.1255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4244, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9372829 KL Loss: 28.5297629 DSM Loss: 38.1535750 Overall Loss:68.6206210
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(153.7874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.2504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9159420 KL Loss: 28.3647525 DSM Loss: 38.6466795 Overall Loss:68.9273738
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(73.0299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.3728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9451250 KL Loss: 28.6742570 DSM Loss: 38.7756775 Overall Loss:69.3950594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.1309083700180054


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.2196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0075418 KL Loss: 28.6635274 DSM Loss: 45.0842704 Overall Loss:75.7553393
Validation loss decreased (inf --> 0.642852).  Saving model ...
Updating learning rate to 0.0005
tensor(67.7138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9861, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8964441 KL Loss: 28.2443163 DSM Loss: 39.0137882 Overall Loss:69.1545482
Validation loss decreased (0.642852 --> 0.639506).  Saving model ...
Updating learning rate to 0.00025
tensor(67.2391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.1274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9326217 KL Loss: 28.3649739 DSM Loss: 37.3798643 Overall Loss:67.6774599
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(70.1727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9424548 KL Loss: 28.5042110 DSM Loss: 37.4552865 Overall Loss:67.9019525
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(63.2444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2055, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9156773 KL Loss: 28.3271755 DSM Loss: 37.3440848 Overall Loss:67.5869376
Validation loss decreased (0.639506 --> 0.639470).  Saving model ...
Updating learning rate to 3.125e-05
tensor(56.0401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9117202 KL Loss: 28.3590714 DSM Loss: 37.5587488 Overall Loss:67.8295403
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(59.7124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9112158 KL Loss: 28.4676762 DSM Loss: 36.6685758 Overall Loss:67.0474677
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(80.5348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.4491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9055158 KL Loss: 28.3724722 DSM Loss: 37.6995951 Overall Loss:67.9775828
Validation loss decreased (0.639470 --> 0.639429).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(57.6719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.7392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.0850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9255869 KL Loss: 28.3429362 DSM Loss: 37.8494030 Overall Loss:68.1179254
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(53.1439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9037203 KL Loss: 28.3108701 DSM Loss: 37.1823527 Overall Loss:67.3969432
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(66.8168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9002349 KL Loss: 28.2295513 DSM Loss: 37.4993751 Overall Loss:67.6291615
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(56.0973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.0866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8949027 KL Loss: 28.3045578 DSM Loss: 37.2374605 Overall Loss:67.4369207
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(72.8284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.4488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9334819 KL Loss: 28.5981995 DSM Loss: 37.1074659 Overall Loss:67.6391472
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(59.9489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.9401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9370455 KL Loss: 28.3725049 DSM Loss: 37.6967888 Overall Loss:68.0063392
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(78.5563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9089161 KL Loss: 28.3178206 DSM Loss: 37.1173072 Overall Loss:67.3440440
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(56.8144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9164814 KL Loss: 28.4145820 DSM Loss: 37.2547497 Overall Loss:67.5858131
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(67.0103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7111, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9126226 KL Loss: 28.3244171 DSM Loss: 37.5177167 Overall Loss:67.7547562
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(76.8627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9347513 KL Loss: 28.5663692 DSM Loss: 36.9937577 Overall Loss:67.4948780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7019854187965393


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(111.2318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.5997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9248543 KL Loss: 28.4779976 DSM Loss: 49.1185523 Overall Loss:79.5214041
Validation loss decreased (inf --> 1.680120).  Saving model ...
Updating learning rate to 0.0005
tensor(58.8495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9060999 KL Loss: 28.3675452 DSM Loss: 37.4354542 Overall Loss:67.7090996
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(63.3882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2875, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9240926 KL Loss: 28.4255460 DSM Loss: 36.5058669 Overall Loss:66.8555053
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(68.0713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9218183 KL Loss: 28.4204795 DSM Loss: 36.2202167 Overall Loss:66.5625144
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(61.4345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8941428 KL Loss: 28.3390473 DSM Loss: 36.1948349 Overall Loss:66.4280249
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(58.1285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9202830 KL Loss: 28.4444313 DSM Loss: 35.8204549 Overall Loss:66.1851687
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(63.8118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9134886 KL Loss: 28.2499941 DSM Loss: 36.4635703 Overall Loss:66.6270531
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(66.5744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9062163 KL Loss: 28.3639678 DSM Loss: 36.1137635 Overall Loss:66.3839478
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(70.4623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9129140 KL Loss: 28.3735671 DSM Loss: 36.0468237 Overall Loss:66.3333046
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(66.1366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7953, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8980901 KL Loss: 28.2037522 DSM Loss: 35.9686320 Overall Loss:66.0704743
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(71.5574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8918987 KL Loss: 28.3298856 DSM Loss: 36.5634487 Overall Loss:66.7852334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.7781920433044434


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(79.0335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6731, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9886250 KL Loss: 28.7210242 DSM Loss: 44.9417671 Overall Loss:75.6514161
Validation loss decreased (inf --> 0.751455).  Saving model ...
Updating learning rate to 0.0005
tensor(83.5771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3413, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9560378 KL Loss: 28.5316170 DSM Loss: 38.0788977 Overall Loss:68.5665524
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(74.3152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8805560 KL Loss: 28.0384947 DSM Loss: 37.9014646 Overall Loss:67.8205150
Validation loss decreased (0.751455 --> 0.750003).  Saving model ...
Updating learning rate to 0.000125
tensor(104.5063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9117529 KL Loss: 28.4241864 DSM Loss: 37.1029148 Overall Loss:67.4388540
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(76.7516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9007521 KL Loss: 28.3247674 DSM Loss: 37.4816277 Overall Loss:67.7071473
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(65.0258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9060039 KL Loss: 28.3903349 DSM Loss: 37.6101175 Overall Loss:67.9064562
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(59.6290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9179315 KL Loss: 28.4999452 DSM Loss: 36.6821045 Overall Loss:67.0999811
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(65.5157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.3376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9187593 KL Loss: 28.3128726 DSM Loss: 37.6456984 Overall Loss:67.8773302
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(45.4865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3501, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9182331 KL Loss: 28.3843056 DSM Loss: 37.0816989 Overall Loss:67.3842375
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(86.9581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8982868 KL Loss: 28.2979655 DSM Loss: 37.6317039 Overall Loss:67.8279557
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(57.4532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.3315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8968128 KL Loss: 28.3641798 DSM Loss: 37.2281940 Overall Loss:67.4891868
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(45.8657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.3777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9004083 KL Loss: 28.2163819 DSM Loss: 37.4134365 Overall Loss:67.5302271
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(63.4046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.3458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9103931 KL Loss: 28.4846970 DSM Loss: 37.1702527 Overall Loss:67.5653425
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.687283456325531


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(100.5453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6972, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9310404 KL Loss: 28.5587857 DSM Loss: 44.7800620 Overall Loss:75.2698881
Validation loss decreased (inf --> 0.772711).  Saving model ...
Updating learning rate to 0.0005
tensor(45.7823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.5781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9253919 KL Loss: 28.6937241 DSM Loss: 38.4769465 Overall Loss:69.0960624
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(42.1145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.9321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8961897 KL Loss: 28.2321447 DSM Loss: 39.6742958 Overall Loss:69.8026301
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(60.2057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9562757 KL Loss: 28.6597092 DSM Loss: 38.9584818 Overall Loss:69.5744669
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(117.5907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.6307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9364720 KL Loss: 28.4831953 DSM Loss: 38.9266812 Overall Loss:69.3463484
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(80.7903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.4722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9469452 KL Loss: 28.6503197 DSM Loss: 38.2434929 Overall Loss:68.8407577
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(84.7881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.7253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9242852 KL Loss: 28.5716991 DSM Loss: 38.3415129 Overall Loss:68.8374975
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(131.4370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.6148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9021753 KL Loss: 28.3563869 DSM Loss: 38.5854457 Overall Loss:68.8440078
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(89.0738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9163512 KL Loss: 28.3772163 DSM Loss: 38.7295022 Overall Loss:69.0230700
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(66.3242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9138740 KL Loss: 28.3645689 DSM Loss: 38.7911774 Overall Loss:69.0696201
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(129.3944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.7809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9215963 KL Loss: 28.3340564 DSM Loss: 39.1207943 Overall Loss:69.3764466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5957959294319153


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(118.8872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9642656 KL Loss: 28.5898742 DSM Loss: 48.1421860 Overall Loss:78.6963258
Validation loss decreased (inf --> 1.667854).  Saving model ...
Updating learning rate to 0.0005
tensor(54.6070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6927, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9426897 KL Loss: 28.5323581 DSM Loss: 39.7587366 Overall Loss:70.2337846
Validation loss decreased (1.667854 --> 1.649748).  Saving model ...
Updating learning rate to 0.00025
tensor(49.5962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9325386 KL Loss: 28.4283346 DSM Loss: 39.1207161 Overall Loss:69.4815889
Validation loss decreased (1.649748 --> 1.649292).  Saving model ...
Updating learning rate to 0.000125
tensor(57.7238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9389019 KL Loss: 28.3828221 DSM Loss: 38.9155712 Overall Loss:69.2372950
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(93.3079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9153818 KL Loss: 28.4325213 DSM Loss: 38.3367496 Overall Loss:68.6846529
Validation loss decreased (1.649292 --> 1.646346).  Saving model ...
Updating learning rate to 3.125e-05
tensor(96.1880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9114098 KL Loss: 28.4189542 DSM Loss: 37.7557315 Overall Loss:68.0860956
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(99.9960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8656, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9237373 KL Loss: 28.4790549 DSM Loss: 37.3801207 Overall Loss:67.7829127
Validation loss decreased (1.646346 --> 1.645855).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(58.6994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.2979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9090808 KL Loss: 28.2788374 DSM Loss: 37.7599230 Overall Loss:67.9478410
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(53.8102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.7976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9282414 KL Loss: 28.6702568 DSM Loss: 37.7895749 Overall Loss:68.3880734
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(80.5717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.7997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.7134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9291415 KL Loss: 28.4687958 DSM Loss: 38.0477756 Overall Loss:68.4457128
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(63.8569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9273013 KL Loss: 28.4298768 DSM Loss: 38.5477691 Overall Loss:68.9049472
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(68.8825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9303313 KL Loss: 28.5631627 DSM Loss: 37.7727560 Overall Loss:68.2662498
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(87.1856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.1899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.7771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9259213 KL Loss: 28.5347260 DSM Loss: 38.3304126 Overall Loss:68.7910599
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(100.3582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.8299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9009902 KL Loss: 28.3179428 DSM Loss: 38.6075610 Overall Loss:68.8264941
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(95.3671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.2324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9091617 KL Loss: 28.2574137 DSM Loss: 39.0341491 Overall Loss:69.2007241
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(104.7283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.8844739 KL Loss: 28.2586016 DSM Loss: 38.4610651 Overall Loss:68.6041403
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(56.4848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9098689 KL Loss: 28.3326208 DSM Loss: 38.4954303 Overall Loss:68.7379199
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9190517067909241


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(111.1635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.5444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2227, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8701336 KL Loss: 28.3095128 DSM Loss: 43.6705897 Overall Loss:73.8502362
Validation loss decreased (inf --> 1.011659).  Saving model ...
Updating learning rate to 0.0005
tensor(78.8418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2984, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9428187 KL Loss: 28.4016483 DSM Loss: 35.4508570 Overall Loss:65.7953247
Validation loss decreased (1.011659 --> 1.003842).  Saving model ...
Updating learning rate to 0.00025
tensor(83.7668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2189, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9324047 KL Loss: 28.3674103 DSM Loss: 35.0536521 Overall Loss:65.3534675
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(62.5344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9109500 KL Loss: 28.3303188 DSM Loss: 34.3314729 Overall Loss:64.5727422
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(70.4808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.9511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.9620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8805737 KL Loss: 28.2814815 DSM Loss: 34.0343074 Overall Loss:64.1963624
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(79.5478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9095461 KL Loss: 28.4208976 DSM Loss: 33.4265867 Overall Loss:63.7570302
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(90.5881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.6490, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9393344 KL Loss: 28.6702964 DSM Loss: 33.3542731 Overall Loss:63.9639037
Validation loss decreased (1.003842 --> 1.003688).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(52.3112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3828, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9122264 KL Loss: 28.4065266 DSM Loss: 33.3402985 Overall Loss:63.6590518
Validation loss decreased (1.003688 --> 1.003674).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(69.0211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5955, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9217088 KL Loss: 28.4631853 DSM Loss: 33.7280864 Overall Loss:64.1129803
Validation loss decreased (1.003674 --> 1.003644).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(81.0073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9001829 KL Loss: 28.1959835 DSM Loss: 33.8272053 Overall Loss:63.9233716
Validation loss decreased (1.003644 --> 1.003639).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(60.6699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.4204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9148613 KL Loss: 28.3681441 DSM Loss: 34.0188128 Overall Loss:64.3018179
Validation loss decreased (1.003639 --> 1.003632).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(64.6971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9170276 KL Loss: 28.4165206 DSM Loss: 33.9502983 Overall Loss:64.2838464
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-07
tensor(72.2877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8992430 KL Loss: 28.2876953 DSM Loss: 34.1024639 Overall Loss:64.2894022
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-07
tensor(55.5029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9032358 KL Loss: 28.3704382 DSM Loss: 33.8336182 Overall Loss:64.1072922
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-08
tensor(52.7900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.5895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9194535 KL Loss: 28.4275672 DSM Loss: 33.0978848 Overall Loss:63.4449054
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-08
tensor(56.3817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9041726 KL Loss: 28.2242955 DSM Loss: 33.9640489 Overall Loss:64.0925170
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-08
tensor(55.9097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9019135 KL Loss: 28.2421713 DSM Loss: 33.1888393 Overall Loss:63.3329239
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-09
tensor(52.1332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9163462 KL Loss: 28.4393702 DSM Loss: 33.9015468 Overall Loss:64.2572635
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-09
tensor(55.5646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.9814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6952, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 83 | MSE Loss: 1.9059077 KL Loss: 28.3678898 DSM Loss: 33.8214964 Overall Loss:64.0952938
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(71.0052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 83 | MSE Loss: 1.8995206 KL Loss: 28.3232731 DSM Loss: 33.4850981 Overall Loss:63.7078919
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(55.2587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 83 | MSE Loss: 1.9164249 KL Loss: 28.2674914 DSM Loss: 33.3203890 Overall Loss:63.5043052
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.880084216594696


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(94.4098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.9552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9728834 KL Loss: 28.6561610 DSM Loss: 47.8981580 Overall Loss:78.5272021
Validation loss decreased (inf --> 0.971032).  Saving model ...
Updating learning rate to 0.0005
tensor(78.6599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.4962, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9640539 KL Loss: 28.5947230 DSM Loss: 37.7900552 Overall Loss:68.3488323
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(56.2895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.8245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9456986 KL Loss: 28.4073660 DSM Loss: 36.7525896 Overall Loss:67.1056543
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(67.5125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.0984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.6882, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9662037 KL Loss: 28.6408902 DSM Loss: 36.5996457 Overall Loss:67.2067396
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(44.4795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9104050 KL Loss: 28.1814802 DSM Loss: 36.9109220 Overall Loss:67.0028072
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(46.2585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8754680 KL Loss: 28.1680177 DSM Loss: 37.5228481 Overall Loss:67.5663338
Validation loss decreased (0.971032 --> 0.970863).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(42.9001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9142759 KL Loss: 28.7919420 DSM Loss: 35.3209097 Overall Loss:66.0271276
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(59.0015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8980419 KL Loss: 28.1321693 DSM Loss: 37.5501516 Overall Loss:67.5803629
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(84.7301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9136895 KL Loss: 28.7304399 DSM Loss: 36.3410559 Overall Loss:66.9851851
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(62.9766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.8271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8810664 KL Loss: 28.1341233 DSM Loss: 37.3994139 Overall Loss:67.4146037
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(73.1937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.3157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8888120 KL Loss: 28.0939916 DSM Loss: 37.5857227 Overall Loss:67.5685264
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(44.3210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9280173 KL Loss: 28.4124173 DSM Loss: 36.9821718 Overall Loss:67.3226066
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(71.1679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9248659 KL Loss: 28.6731628 DSM Loss: 35.5660847 Overall Loss:66.1641135
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(61.5190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9215699 KL Loss: 28.4732685 DSM Loss: 35.8168885 Overall Loss:66.2117267
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(110.7513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.8996236 KL Loss: 28.3959877 DSM Loss: 36.8306883 Overall Loss:67.1262996
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(75.5059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.8916245 KL Loss: 28.2323725 DSM Loss: 36.8137637 Overall Loss:66.9377607
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7037230730056763


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(85.3455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.8815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.0079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9755145 KL Loss: 28.6380775 DSM Loss: 45.7372178 Overall Loss:76.3508100
Validation loss decreased (inf --> 0.704709).  Saving model ...
Updating learning rate to 0.0005
tensor(126.4785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.7835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9484344 KL Loss: 28.4405205 DSM Loss: 39.5639633 Overall Loss:69.9529179
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(72.6580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9193923 KL Loss: 28.3750152 DSM Loss: 39.5886186 Overall Loss:69.8830260
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(53.5672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.6767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9255813 KL Loss: 28.3570703 DSM Loss: 38.7456371 Overall Loss:69.0282885
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(112.0788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.6892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9079918 KL Loss: 28.2860844 DSM Loss: 39.4403860 Overall Loss:69.6344623
Validation loss decreased (0.704709 --> 0.704181).  Saving model ...
Updating learning rate to 3.125e-05
tensor(69.2055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.7768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8924423 KL Loss: 28.2574958 DSM Loss: 39.1764563 Overall Loss:69.3263944
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(53.3489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.9837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9202507 KL Loss: 28.5887487 DSM Loss: 38.9926181 Overall Loss:69.5016173
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(62.6109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9210021 KL Loss: 28.3927597 DSM Loss: 38.4467123 Overall Loss:68.7604741
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(72.6417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.5380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9688, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9294482 KL Loss: 28.4804823 DSM Loss: 38.5911939 Overall Loss:69.0011241
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(61.8796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.2310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.5598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9221123 KL Loss: 28.4422685 DSM Loss: 38.8151494 Overall Loss:69.1795304
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(59.2224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.9708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9342022 KL Loss: 28.5309914 DSM Loss: 38.5351648 Overall Loss:69.0003583
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(59.5769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9316351 KL Loss: 28.5511126 DSM Loss: 38.3624532 Overall Loss:68.8452007
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(85.2047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9084577 KL Loss: 28.3659195 DSM Loss: 38.9949534 Overall Loss:69.2693306
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(79.7231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.9786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8883750 KL Loss: 28.1783730 DSM Loss: 39.0225726 Overall Loss:69.0893208
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(112.4695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.3531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9548221 KL Loss: 28.6740528 DSM Loss: 37.8932946 Overall Loss:68.5221691
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.845748782157898


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(113.9226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.6305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9874808 KL Loss: 28.8621198 DSM Loss: 42.7999991 Overall Loss:73.6495995
Validation loss decreased (inf --> 1.445352).  Saving model ...
Updating learning rate to 0.0005
tensor(54.5602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5343, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9425797 KL Loss: 28.3744204 DSM Loss: 39.8912859 Overall Loss:70.2082863
Validation loss decreased (1.445352 --> 1.444230).  Saving model ...
Updating learning rate to 0.00025
tensor(59.7700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.4877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9130834 KL Loss: 28.3794078 DSM Loss: 38.8320207 Overall Loss:69.1245120
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(60.8235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8670341 KL Loss: 28.1643521 DSM Loss: 39.0755013 Overall Loss:69.1068876
Validation loss decreased (1.444230 --> 1.444044).  Saving model ...
Updating learning rate to 6.25e-05
tensor(79.9455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.0251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9273655 KL Loss: 28.5745889 DSM Loss: 37.9177545 Overall Loss:68.4197088
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(61.3738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.7508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9396411 KL Loss: 28.6152613 DSM Loss: 37.6395722 Overall Loss:68.1944742
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(100.7058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9079485 KL Loss: 28.3186489 DSM Loss: 37.8595678 Overall Loss:68.0861654
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(59.3910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8791078 KL Loss: 28.1366737 DSM Loss: 38.6509831 Overall Loss:68.6667642
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(61.0961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9013023 KL Loss: 28.1920051 DSM Loss: 38.2718903 Overall Loss:68.3651977
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(57.7110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.0825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5129, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9195457 KL Loss: 28.6212589 DSM Loss: 38.1215917 Overall Loss:68.6623967
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(93.1554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9065351 KL Loss: 28.3042399 DSM Loss: 38.0590428 Overall Loss:68.2698181
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(112.1946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0344, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8979774 KL Loss: 28.3939867 DSM Loss: 38.3459125 Overall Loss:68.6378765
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(77.8903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6033, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9097633 KL Loss: 28.3571580 DSM Loss: 38.4809887 Overall Loss:68.7479105
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(67.1946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.2336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9208080 KL Loss: 28.4557084 DSM Loss: 37.6328653 Overall Loss:68.0093820
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9123430848121643


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(100.0294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9788226 KL Loss: 28.5514107 DSM Loss: 52.6265340 Overall Loss:83.1567676
Validation loss decreased (inf --> 1.135477).  Saving model ...
Updating learning rate to 0.0005
tensor(77.0422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9253675 KL Loss: 28.1895200 DSM Loss: 40.6045263 Overall Loss:70.7194138
Validation loss decreased (1.135477 --> 1.127719).  Saving model ...
Updating learning rate to 0.00025
tensor(66.1126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9396866 KL Loss: 28.4619893 DSM Loss: 38.9739040 Overall Loss:69.3755797
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(68.6209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.0155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.2873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8801082 KL Loss: 28.3370463 DSM Loss: 39.0751445 Overall Loss:69.2922995
Validation loss decreased (1.127719 --> 1.126381).  Saving model ...
Updating learning rate to 6.25e-05
tensor(77.9886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9769, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9206813 KL Loss: 28.3759387 DSM Loss: 38.6897117 Overall Loss:68.9863314
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(56.9381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8962, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9057507 KL Loss: 28.4318489 DSM Loss: 38.5194412 Overall Loss:68.8570407
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(81.3749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9251788 KL Loss: 28.4393553 DSM Loss: 38.7346591 Overall Loss:69.0991935
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(81.9262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9073804 KL Loss: 28.5082793 DSM Loss: 38.3713865 Overall Loss:68.7870459
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(63.8078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.1424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.0084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9516216 KL Loss: 28.5107496 DSM Loss: 38.4120530 Overall Loss:68.8744245
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(57.3271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9408921 KL Loss: 28.6464458 DSM Loss: 38.1775727 Overall Loss:68.7649100
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(62.0792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.7322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9204040 KL Loss: 28.4156530 DSM Loss: 38.1307765 Overall Loss:68.4668334
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(90.2827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.6633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9255907 KL Loss: 28.3887920 DSM Loss: 38.9884336 Overall Loss:69.3028165
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(54.4210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9244863 KL Loss: 28.3694047 DSM Loss: 38.4633814 Overall Loss:68.7572724
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(72.3444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8111, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9528921 KL Loss: 28.5263258 DSM Loss: 38.3062160 Overall Loss:68.7854339
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6647259593009949


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(96.6393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.4244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9479628 KL Loss: 28.5920081 DSM Loss: 43.1310259 Overall Loss:73.6709967
Validation loss decreased (inf --> 0.820520).  Saving model ...
Updating learning rate to 0.0005
tensor(71.4105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9365337 KL Loss: 28.4721845 DSM Loss: 38.8852644 Overall Loss:69.2939829
Validation loss decreased (0.820520 --> 0.819723).  Saving model ...
Updating learning rate to 0.00025
tensor(86.0031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.2277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9428860 KL Loss: 28.4342680 DSM Loss: 38.1405599 Overall Loss:68.5177136
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(69.2940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9246224 KL Loss: 28.4766945 DSM Loss: 37.8908133 Overall Loss:68.2921308
Validation loss decreased (0.819723 --> 0.819612).  Saving model ...
Updating learning rate to 6.25e-05
tensor(54.2074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9398, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9384066 KL Loss: 28.5529440 DSM Loss: 38.0238499 Overall Loss:68.5152004
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(87.7509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9255880 KL Loss: 28.3686532 DSM Loss: 37.8902796 Overall Loss:68.1845208
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(55.3774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.2857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9214317 KL Loss: 28.3417082 DSM Loss: 37.7802931 Overall Loss:68.0434325
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(83.4865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9105268 KL Loss: 28.2593860 DSM Loss: 37.8638735 Overall Loss:68.0337864
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(57.1162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9311168 KL Loss: 28.6057878 DSM Loss: 37.2339629 Overall Loss:67.7708670
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(75.9912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9215524 KL Loss: 28.4741722 DSM Loss: 37.2089489 Overall Loss:67.6046732
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(66.3586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.8321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9287779 KL Loss: 28.6303687 DSM Loss: 37.1431086 Overall Loss:67.7022554
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(58.0788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9290196 KL Loss: 28.4416268 DSM Loss: 37.6600931 Overall Loss:68.0307392
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(70.4138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5798, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8963444 KL Loss: 28.2580689 DSM Loss: 38.0138370 Overall Loss:68.1682505
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(83.7043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6834, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9195823 KL Loss: 28.3761848 DSM Loss: 37.8573825 Overall Loss:68.1531494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9924535751342773


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(118.2321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.7021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9604469 KL Loss: 28.5641159 DSM Loss: 45.2748087 Overall Loss:75.7993713
Validation loss decreased (inf --> 1.022510).  Saving model ...
Updating learning rate to 0.0005
tensor(69.7503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9250929 KL Loss: 28.4309486 DSM Loss: 38.7925252 Overall Loss:69.1485671
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(61.6127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9628866 KL Loss: 28.5012119 DSM Loss: 37.7542504 Overall Loss:68.2183490
Validation loss decreased (1.022510 --> 1.011547).  Saving model ...
Updating learning rate to 0.000125
tensor(60.5376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9445263 KL Loss: 28.5801870 DSM Loss: 37.6757819 Overall Loss:68.2004953
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(63.3551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9386992 KL Loss: 28.4323051 DSM Loss: 37.7948853 Overall Loss:68.1658895
Validation loss decreased (1.011547 --> 1.003273).  Saving model ...
Updating learning rate to 3.125e-05
tensor(67.0232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.7032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9399256 KL Loss: 28.3195444 DSM Loss: 37.8003943 Overall Loss:68.0598640
Validation loss decreased (1.003273 --> 1.001140).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(58.3792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9329465 KL Loss: 28.4408053 DSM Loss: 37.2597800 Overall Loss:67.6335317
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(73.9376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9078604 KL Loss: 28.4203861 DSM Loss: 37.3457850 Overall Loss:67.6740315
Validation loss decreased (1.001140 --> 1.000230).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(54.4120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9465128 KL Loss: 28.5515608 DSM Loss: 37.4079773 Overall Loss:67.9060509
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(64.8374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9217425 KL Loss: 28.4713371 DSM Loss: 37.3771328 Overall Loss:67.7702125
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(59.8503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.2505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9290333 KL Loss: 28.5981405 DSM Loss: 37.2288486 Overall Loss:67.7560221
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(59.6474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9215168 KL Loss: 28.4252154 DSM Loss: 37.1364307 Overall Loss:67.4831624
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(71.7144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3334, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9265863 KL Loss: 28.5418519 DSM Loss: 37.2521861 Overall Loss:67.7206242
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(61.8699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8976489 KL Loss: 28.2101501 DSM Loss: 38.1544913 Overall Loss:68.2622906
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(69.5451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9352502 KL Loss: 28.4701885 DSM Loss: 37.5865806 Overall Loss:67.9920191
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(71.7018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9161934 KL Loss: 28.3531886 DSM Loss: 37.3786502 Overall Loss:67.6480324
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(67.1998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9221940 KL Loss: 28.4274262 DSM Loss: 37.7737305 Overall Loss:68.1233505
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(62.8616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9129987 KL Loss: 28.3269795 DSM Loss: 37.8255572 Overall Loss:68.0655354
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.6886327266693115


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(117.0121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9400180 KL Loss: 28.6811578 DSM Loss: 49.9232748 Overall Loss:80.5444509
Validation loss decreased (inf --> 1.028440).  Saving model ...
Updating learning rate to 0.0005
tensor(56.1538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.4776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9223425 KL Loss: 28.3943689 DSM Loss: 39.8114303 Overall Loss:70.1281420
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(75.2126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9172768 KL Loss: 28.4388157 DSM Loss: 39.0445813 Overall Loss:69.4006740
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(57.2093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9157192 KL Loss: 28.3630506 DSM Loss: 38.6646269 Overall Loss:68.9433971
Validation loss decreased (1.028440 --> 1.020494).  Saving model ...
Updating learning rate to 6.25e-05
tensor(82.7657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3228, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9306749 KL Loss: 28.6670954 DSM Loss: 38.0415146 Overall Loss:68.6392846
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(60.5187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.5719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9407697 KL Loss: 28.5759463 DSM Loss: 37.7326843 Overall Loss:68.2494002
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(61.8289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(117.6898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0486, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9464257 KL Loss: 28.5730353 DSM Loss: 37.7358513 Overall Loss:68.2553120
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(95.0698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9107844 KL Loss: 28.3816771 DSM Loss: 38.8564084 Overall Loss:69.1488698
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(76.1757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9249397 KL Loss: 28.4947267 DSM Loss: 38.6504495 Overall Loss:69.0701156
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(68.2316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.3030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9511260 KL Loss: 28.7236520 DSM Loss: 37.6115364 Overall Loss:68.2863144
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(59.1279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.7702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9387361 KL Loss: 28.5439278 DSM Loss: 38.1716824 Overall Loss:68.6543460
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(58.4021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9162509 KL Loss: 28.1692474 DSM Loss: 38.1912742 Overall Loss:68.2767723
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(83.4871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.9630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9529609 KL Loss: 28.6338992 DSM Loss: 37.6545577 Overall Loss:68.2414183
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(88.2085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9405706 KL Loss: 28.5724559 DSM Loss: 38.6109750 Overall Loss:69.1240014
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2135106325149536


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(100.3720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.9480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9083368 KL Loss: 28.3624902 DSM Loss: 49.3791471 Overall Loss:79.6499739
Validation loss decreased (inf --> 1.279936).  Saving model ...
Updating learning rate to 0.0005
tensor(65.0959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9747582 KL Loss: 28.5691801 DSM Loss: 39.9389496 Overall Loss:70.4828875
Validation loss decreased (1.279936 --> 1.269070).  Saving model ...
Updating learning rate to 0.00025
tensor(71.1688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(133.9609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9570723 KL Loss: 28.4473441 DSM Loss: 40.1379410 Overall Loss:70.5423573
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(70.5020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8941094 KL Loss: 28.3399526 DSM Loss: 39.5366391 Overall Loss:69.7707012
Validation loss decreased (1.269070 --> 1.264233).  Saving model ...
Updating learning rate to 6.25e-05
tensor(51.0191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9171691 KL Loss: 28.4494652 DSM Loss: 38.5588875 Overall Loss:68.9255217
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(66.3241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.1845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9277949 KL Loss: 28.5306380 DSM Loss: 38.5345744 Overall Loss:68.9930074
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(59.3437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9321351 KL Loss: 28.6069012 DSM Loss: 38.7896734 Overall Loss:69.3287097
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(67.5556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.9162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(140.8302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9341779 KL Loss: 28.7133916 DSM Loss: 37.8345658 Overall Loss:68.4821349
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(98.8647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.1798, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9435993 KL Loss: 28.5318667 DSM Loss: 39.1116158 Overall Loss:69.5870820
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(74.3372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.8736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9217436 KL Loss: 28.2670801 DSM Loss: 38.7121922 Overall Loss:68.9010161
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(86.7324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.3014, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9105010 KL Loss: 28.3322785 DSM Loss: 39.3800705 Overall Loss:69.6228496
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(50.2861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.4764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9240212 KL Loss: 28.5193534 DSM Loss: 38.7999822 Overall Loss:69.2433567
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(134.8375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.9896, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9077796 KL Loss: 28.2644838 DSM Loss: 39.0085637 Overall Loss:69.1808273
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(69.7809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9313834 KL Loss: 28.3822916 DSM Loss: 38.8591122 Overall Loss:69.1727872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2178977727890015


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(104.7868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9757619 KL Loss: 28.5227136 DSM Loss: 46.0537725 Overall Loss:76.5522479
Validation loss decreased (inf --> 0.799204).  Saving model ...
Updating learning rate to 0.0005
tensor(83.4948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3419, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9841452 KL Loss: 28.5084903 DSM Loss: 38.1267821 Overall Loss:68.6194177
Validation loss decreased (0.799204 --> 0.789678).  Saving model ...
Updating learning rate to 0.00025
tensor(51.7664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.2654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9076789 KL Loss: 28.3046907 DSM Loss: 38.0688365 Overall Loss:68.2812061
Validation loss decreased (0.789678 --> 0.782099).  Saving model ...
Updating learning rate to 0.000125
tensor(61.6562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9257437 KL Loss: 28.4692318 DSM Loss: 37.6997681 Overall Loss:68.0947438
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(123.6345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9687309 KL Loss: 28.5218441 DSM Loss: 37.4274201 Overall Loss:67.9179951
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(62.4919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.3353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9319848 KL Loss: 28.4002602 DSM Loss: 36.7633215 Overall Loss:67.0955660
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(70.5480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.3452, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8998196 KL Loss: 28.3129986 DSM Loss: 38.0240840 Overall Loss:68.2369022
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(58.0455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.9698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9054131 KL Loss: 28.4209245 DSM Loss: 37.5749837 Overall Loss:67.9013215
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(81.3414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9123063 KL Loss: 28.3838580 DSM Loss: 37.3608707 Overall Loss:67.6570351
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(99.6363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.4413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9038643 KL Loss: 28.2881733 DSM Loss: 37.6726826 Overall Loss:67.8647202
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(63.5501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.9231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9104762 KL Loss: 28.4310539 DSM Loss: 37.2679612 Overall Loss:67.6094912
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(61.1387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9188606 KL Loss: 28.5341082 DSM Loss: 37.4261671 Overall Loss:67.8791357
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(82.3488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2129, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9087935 KL Loss: 28.4856518 DSM Loss: 37.3114066 Overall Loss:67.7058520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6823337078094482


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(100.0343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.8253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.5829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9417964 KL Loss: 28.4567133 DSM Loss: 50.5304804 Overall Loss:80.9289909
Validation loss decreased (inf --> 0.658258).  Saving model ...
Updating learning rate to 0.0005
tensor(54.8670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5447, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9459200 KL Loss: 28.4964055 DSM Loss: 39.1241561 Overall Loss:69.5664818
Validation loss decreased (0.658258 --> 0.638384).  Saving model ...
Updating learning rate to 0.00025
tensor(49.1347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.8956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9668274 KL Loss: 28.6455934 DSM Loss: 38.5606196 Overall Loss:69.1730405
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(51.0968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9206778 KL Loss: 28.2562936 DSM Loss: 39.1519182 Overall Loss:69.3288897
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(51.8191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.7537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9055640 KL Loss: 28.3518638 DSM Loss: 37.9425043 Overall Loss:68.1999321
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(55.8279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.5601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9213388 KL Loss: 28.3533805 DSM Loss: 37.4446411 Overall Loss:67.7193602
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(46.3139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9711356 KL Loss: 28.8619884 DSM Loss: 36.7254414 Overall Loss:67.5585654
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(80.8247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.0209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.6015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9018151 KL Loss: 28.4060212 DSM Loss: 37.1595326 Overall Loss:67.4673690
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(44.1395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9114147 KL Loss: 28.4577076 DSM Loss: 36.9892573 Overall Loss:67.3583795
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(54.9227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6845, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9325600 KL Loss: 28.5064983 DSM Loss: 38.0560405 Overall Loss:68.4950988
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(98.7253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.1275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9396678 KL Loss: 28.6178562 DSM Loss: 36.3697726 Overall Loss:66.9272969
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(44.7900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9075417 KL Loss: 28.3680183 DSM Loss: 37.6414331 Overall Loss:67.9169931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7373909950256348


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(138.1710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.8622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9573557 KL Loss: 28.5407488 DSM Loss: 46.1001174 Overall Loss:76.5982218
Validation loss decreased (inf --> 0.473523).  Saving model ...
Updating learning rate to 0.0005
tensor(90.5320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.1450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9991215 KL Loss: 28.5894525 DSM Loss: 38.5629654 Overall Loss:69.1515394
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(82.3712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9748608 KL Loss: 28.5658154 DSM Loss: 37.4049844 Overall Loss:67.9456605
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(73.6379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9539910 KL Loss: 28.5073600 DSM Loss: 37.6443823 Overall Loss:68.1057337
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(98.4266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9411900 KL Loss: 28.5093531 DSM Loss: 37.1278623 Overall Loss:67.5784050
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(76.8597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3228, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9161398 KL Loss: 28.3811174 DSM Loss: 37.2264549 Overall Loss:67.5237124
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(49.2138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.3564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9166133 KL Loss: 28.3134157 DSM Loss: 37.2605585 Overall Loss:67.4905873
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(51.6517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9330174 KL Loss: 28.5665092 DSM Loss: 37.3951885 Overall Loss:67.8947150
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(69.3498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.5462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9091590 KL Loss: 28.4573390 DSM Loss: 37.5939123 Overall Loss:67.9604101
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(49.2826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.1904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9126577 KL Loss: 28.3539388 DSM Loss: 37.5407228 Overall Loss:67.8073191
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(101.1342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9523626 KL Loss: 28.7535401 DSM Loss: 37.2134690 Overall Loss:67.9193719
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6275626420974731


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(137.4489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.9425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9847475 KL Loss: 28.6016160 DSM Loss: 45.2050730 Overall Loss:75.7914366
Validation loss decreased (inf --> 1.522595).  Saving model ...
Updating learning rate to 0.0005
tensor(75.6640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9761210 KL Loss: 28.5809403 DSM Loss: 39.1956694 Overall Loss:69.7527307
Validation loss decreased (1.522595 --> 1.516041).  Saving model ...
Updating learning rate to 0.00025
tensor(79.3481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9326729 KL Loss: 28.4768390 DSM Loss: 39.5595349 Overall Loss:69.9690466
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(55.9557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9671738 KL Loss: 28.5914343 DSM Loss: 38.4858091 Overall Loss:69.0444174
Validation loss decreased (1.516041 --> 1.498221).  Saving model ...
Updating learning rate to 6.25e-05
tensor(79.0169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9346089 KL Loss: 28.3829231 DSM Loss: 38.8605547 Overall Loss:69.1780864
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(63.4482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8929866 KL Loss: 28.3005342 DSM Loss: 39.2643194 Overall Loss:69.4578404
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(62.2154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.7132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9364674 KL Loss: 28.6787807 DSM Loss: 38.2503112 Overall Loss:68.8655592
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(58.9941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4845, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9374306 KL Loss: 28.5307873 DSM Loss: 38.2069175 Overall Loss:68.6751353
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(95.7089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9269588 KL Loss: 28.5609909 DSM Loss: 38.8612719 Overall Loss:69.3492214
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(79.9950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9307388 KL Loss: 28.5059814 DSM Loss: 37.8977521 Overall Loss:68.3344721
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(63.1038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9505006 KL Loss: 28.5436226 DSM Loss: 38.2372221 Overall Loss:68.7313457
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(78.8830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.9245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9527257 KL Loss: 28.7016623 DSM Loss: 38.0129071 Overall Loss:68.6672952
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(63.8860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.0929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9370296 KL Loss: 28.6089140 DSM Loss: 38.2623958 Overall Loss:68.8083393
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(62.4118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9363252 KL Loss: 28.3662086 DSM Loss: 38.1997120 Overall Loss:68.5022459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.703521728515625


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(94.2566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.9495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9425286 KL Loss: 28.6216452 DSM Loss: 43.8439724 Overall Loss:74.4081461
Validation loss decreased (inf --> 1.112582).  Saving model ...
Updating learning rate to 0.0005
tensor(82.2446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.9760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9744231 KL Loss: 28.7005725 DSM Loss: 38.9586021 Overall Loss:69.6335979
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(58.3864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9251843 KL Loss: 28.2638590 DSM Loss: 39.3402692 Overall Loss:69.5293125
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(64.0111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.3849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9474134 KL Loss: 28.7227464 DSM Loss: 38.2683273 Overall Loss:68.9384872
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(91.0503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6129, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9172402 KL Loss: 28.2448759 DSM Loss: 38.7698676 Overall Loss:68.9319835
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(63.0054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9412832 KL Loss: 28.5435248 DSM Loss: 38.1697550 Overall Loss:68.6545632
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(63.4978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9174927 KL Loss: 28.4881732 DSM Loss: 38.1468573 Overall Loss:68.5525233
Validation loss decreased (1.112582 --> 1.112384).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(62.9998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9562415 KL Loss: 28.6759556 DSM Loss: 37.8033955 Overall Loss:68.4355926
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(104.0211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.1888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9395373 KL Loss: 28.4242386 DSM Loss: 38.4640636 Overall Loss:68.8278395
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(51.8884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9185454 KL Loss: 28.2928500 DSM Loss: 38.6337301 Overall Loss:68.8451255
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(84.5824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9347462 KL Loss: 28.3825552 DSM Loss: 38.7090974 Overall Loss:69.0263990
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(47.9048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4639, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9282817 KL Loss: 28.5041461 DSM Loss: 38.0823351 Overall Loss:68.5147631
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(63.6061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.3662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8932028 KL Loss: 28.1864421 DSM Loss: 38.3548430 Overall Loss:68.4344880
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(57.0441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2982, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9496223 KL Loss: 28.6924679 DSM Loss: 38.0037808 Overall Loss:68.6458707
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(47.7782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9194693 KL Loss: 28.3572931 DSM Loss: 38.4331558 Overall Loss:68.7099181
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(48.1479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6342, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9323311 KL Loss: 28.4291556 DSM Loss: 38.4545154 Overall Loss:68.8160017
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(66.2213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9128074 KL Loss: 28.2685014 DSM Loss: 38.1907887 Overall Loss:68.3720975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.3849928379058838


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(83.8817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9284827 KL Loss: 28.5103005 DSM Loss: 44.6304831 Overall Loss:75.0692662
Validation loss decreased (inf --> 0.577588).  Saving model ...
Updating learning rate to 0.0005
tensor(49.8856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9673630 KL Loss: 28.7724723 DSM Loss: 39.0924355 Overall Loss:69.8322710
Validation loss decreased (0.577588 --> 0.575634).  Saving model ...
Updating learning rate to 0.00025
tensor(47.0213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9315851 KL Loss: 28.6424920 DSM Loss: 39.6603449 Overall Loss:70.2344224
Validation loss decreased (0.575634 --> 0.575209).  Saving model ...
Updating learning rate to 0.000125
tensor(50.1985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8961, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9092086 KL Loss: 28.0002491 DSM Loss: 39.6912279 Overall Loss:69.6006853
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(57.3158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(162.2300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8702883 KL Loss: 28.0297977 DSM Loss: 39.6852323 Overall Loss:69.5853181
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(49.3628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8818724 KL Loss: 28.3430906 DSM Loss: 38.9229495 Overall Loss:69.1479130
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(52.3022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9002571 KL Loss: 28.4756660 DSM Loss: 39.3621511 Overall Loss:69.7380744
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(47.8137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(131.7517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3178, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9296199 KL Loss: 28.6638594 DSM Loss: 39.2243481 Overall Loss:69.8178274
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(74.6318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.3393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3065, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9107501 KL Loss: 28.3883711 DSM Loss: 39.0643628 Overall Loss:69.3634836
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(48.3483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.0226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9607434 KL Loss: 28.8188711 DSM Loss: 37.9224367 Overall Loss:68.7020512
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(47.4598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.3190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8900571 KL Loss: 28.3716517 DSM Loss: 38.9760459 Overall Loss:69.2377548
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(56.5307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.5275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.3869, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9249311 KL Loss: 28.5308065 DSM Loss: 38.4243121 Overall Loss:68.8800498
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(91.0064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4310, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9492109 KL Loss: 28.7238309 DSM Loss: 38.2313734 Overall Loss:68.9044151
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8750879168510437


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.5163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.6915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9167609 KL Loss: 28.3123977 DSM Loss: 52.0645683 Overall Loss:82.2937270
Validation loss decreased (inf --> 0.652448).  Saving model ...
Updating learning rate to 0.0005
tensor(74.8875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.9203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9459659 KL Loss: 28.4757431 DSM Loss: 39.5737353 Overall Loss:69.9954443
Validation loss decreased (0.652448 --> 0.642483).  Saving model ...
Updating learning rate to 0.00025
tensor(118.0411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 2.0051292 KL Loss: 28.6920043 DSM Loss: 38.2608425 Overall Loss:68.9579758
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(50.7817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.3473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.7770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9455471 KL Loss: 28.4453360 DSM Loss: 39.5429710 Overall Loss:69.9338543
Validation loss decreased (0.642483 --> 0.642320).  Saving model ...
Updating learning rate to 6.25e-05
tensor(51.1203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.6643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9638039 KL Loss: 28.7645593 DSM Loss: 37.9456658 Overall Loss:68.6740292
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(55.1170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.5579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.1038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9540531 KL Loss: 28.4618297 DSM Loss: 39.0356800 Overall Loss:69.4515626
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(79.3000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9328871 KL Loss: 28.4547897 DSM Loss: 39.0682782 Overall Loss:69.4559550
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(50.7955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8700382 KL Loss: 28.1474949 DSM Loss: 40.0529841 Overall Loss:70.0705175
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(44.8288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.0352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9163889 KL Loss: 28.4193969 DSM Loss: 39.1086943 Overall Loss:69.4444797
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(47.6192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(129.0656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8128, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9059097 KL Loss: 28.3858899 DSM Loss: 39.2167298 Overall Loss:69.5085289
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(48.4303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9303720 KL Loss: 28.7727125 DSM Loss: 38.2537618 Overall Loss:68.9568463
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(67.3389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.5205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9206535 KL Loss: 28.7006517 DSM Loss: 38.8101066 Overall Loss:69.4314119
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(47.8717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7254, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8968383 KL Loss: 28.2558389 DSM Loss: 39.3188324 Overall Loss:69.4715097
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(54.2428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.0275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8814025 KL Loss: 28.2120815 DSM Loss: 39.0434378 Overall Loss:69.1369223
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.1265442371368408


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(124.7905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9038303 KL Loss: 28.1835703 DSM Loss: 48.5322184 Overall Loss:78.6196188
Validation loss decreased (inf --> 0.527704).  Saving model ...
Updating learning rate to 0.0005
tensor(46.9227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8705386 KL Loss: 28.0487109 DSM Loss: 40.2577784 Overall Loss:70.1770281
Validation loss decreased (0.527704 --> 0.505193).  Saving model ...
Updating learning rate to 0.00025
tensor(99.5142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9378968 KL Loss: 28.6381305 DSM Loss: 38.8705724 Overall Loss:69.4465995
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(51.1892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2051, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8839918 KL Loss: 28.0235897 DSM Loss: 39.1567429 Overall Loss:69.0643248
Validation loss decreased (0.505193 --> 0.499831).  Saving model ...
Updating learning rate to 6.25e-05
tensor(104.4417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9036844 KL Loss: 28.3560866 DSM Loss: 38.9481852 Overall Loss:69.2079563
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(47.0891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9228925 KL Loss: 28.7185322 DSM Loss: 37.4638189 Overall Loss:68.1052440
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(120.8273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.9796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0522, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9116702 KL Loss: 28.2582523 DSM Loss: 38.9010487 Overall Loss:69.0709713
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(83.5548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8921114 KL Loss: 28.1521147 DSM Loss: 38.8814986 Overall Loss:68.9257243
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(51.4041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9047, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9087074 KL Loss: 28.3900001 DSM Loss: 38.7206933 Overall Loss:69.0194003
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(80.6871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9472102 KL Loss: 28.9408972 DSM Loss: 37.7296868 Overall Loss:68.6177939
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(46.6325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9169262 KL Loss: 28.5529166 DSM Loss: 37.9700844 Overall Loss:68.4399274
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(63.0292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.0084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9146, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8583577 KL Loss: 27.9913480 DSM Loss: 39.3069301 Overall Loss:69.1566358
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(52.8415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(131.5841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3007, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9370319 KL Loss: 28.3751303 DSM Loss: 38.8756346 Overall Loss:69.1877969
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(85.0541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8413, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9253767 KL Loss: 28.5682034 DSM Loss: 37.7460950 Overall Loss:68.2396748
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.756729245185852


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.6981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.1703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9608818 KL Loss: 28.7030746 DSM Loss: 49.0299814 Overall Loss:79.6939383
Validation loss decreased (inf --> 0.655039).  Saving model ...
Updating learning rate to 0.0005
tensor(75.2588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.0827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9881256 KL Loss: 28.5353119 DSM Loss: 39.9727917 Overall Loss:70.4962291
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(70.2366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9560699 KL Loss: 28.5361020 DSM Loss: 39.5639810 Overall Loss:70.0561526
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(54.1896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9611834 KL Loss: 28.5177832 DSM Loss: 39.4656427 Overall Loss:69.9446090
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(55.2670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.3865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9119584 KL Loss: 28.3932648 DSM Loss: 39.4890352 Overall Loss:69.7942584
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(64.5463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.6005, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9211248 KL Loss: 28.5046581 DSM Loss: 38.9367015 Overall Loss:69.3624838
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(80.9244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.8325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9600243 KL Loss: 28.5496994 DSM Loss: 39.0351048 Overall Loss:69.5448285
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(65.7218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9143653 KL Loss: 28.4166445 DSM Loss: 38.3227510 Overall Loss:68.6537607
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(59.0064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.5473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9100225 KL Loss: 28.3796512 DSM Loss: 39.3426957 Overall Loss:69.6323694
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(76.6665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.1210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9165423 KL Loss: 28.4179035 DSM Loss: 39.8222986 Overall Loss:70.1567442
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(61.6331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9480790 KL Loss: 28.7449706 DSM Loss: 38.8727986 Overall Loss:69.5658484
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7020198702812195


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(128.3852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8863372 KL Loss: 28.4292727 DSM Loss: 47.1279674 Overall Loss:77.4435777
Validation loss decreased (inf --> 0.665001).  Saving model ...
Updating learning rate to 0.0005
tensor(48.8720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9481674 KL Loss: 28.5854858 DSM Loss: 39.2825663 Overall Loss:69.8162198
Validation loss decreased (0.665001 --> 0.664066).  Saving model ...
Updating learning rate to 0.00025
tensor(101.3561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9089600 KL Loss: 28.4201751 DSM Loss: 39.7188549 Overall Loss:70.0479896
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(87.2183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9412952 KL Loss: 28.6001805 DSM Loss: 39.3063960 Overall Loss:69.8478716
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(62.3177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9192489 KL Loss: 28.4740895 DSM Loss: 38.9647519 Overall Loss:69.3580905
Validation loss decreased (0.664066 --> 0.663548).  Saving model ...
Updating learning rate to 3.125e-05
tensor(53.0748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9485570 KL Loss: 28.4924361 DSM Loss: 39.1852244 Overall Loss:69.6262174
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(81.8732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9157013 KL Loss: 28.3706852 DSM Loss: 39.4807830 Overall Loss:69.7671698
Validation loss decreased (0.663548 --> 0.663536).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(74.7028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9118126 KL Loss: 28.4442182 DSM Loss: 38.8979648 Overall Loss:69.2539950
Validation loss decreased (0.663536 --> 0.663438).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(97.6308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9482356 KL Loss: 28.5113617 DSM Loss: 38.7755072 Overall Loss:69.2351042
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(55.0815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9083764 KL Loss: 28.3542260 DSM Loss: 39.4073499 Overall Loss:69.6699524
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(64.7541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9138998 KL Loss: 28.3998640 DSM Loss: 38.6999648 Overall Loss:69.0137284
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(74.8228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0327, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9371942 KL Loss: 28.5624824 DSM Loss: 37.8378734 Overall Loss:68.3375496
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(63.4567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9370392 KL Loss: 28.2479359 DSM Loss: 39.1039496 Overall Loss:69.2889248
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(102.5211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9160937 KL Loss: 28.3075134 DSM Loss: 39.1801613 Overall Loss:69.4037683
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(89.0661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.3786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9266120 KL Loss: 28.4362949 DSM Loss: 39.1962752 Overall Loss:69.5591821
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(49.7603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9356272 KL Loss: 28.4398819 DSM Loss: 38.7045849 Overall Loss:69.0800937
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(63.5693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.9285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9150120 KL Loss: 28.3984197 DSM Loss: 39.1861826 Overall Loss:69.4996140
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(67.6373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.3221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1953, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.8943892 KL Loss: 28.2361505 DSM Loss: 39.1254849 Overall Loss:69.2560243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5115135312080383


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(103.8806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9737905 KL Loss: 28.6183941 DSM Loss: 48.2503801 Overall Loss:78.8425647
Validation loss decreased (inf --> 1.290326).  Saving model ...
Updating learning rate to 0.0005
tensor(61.3647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.5342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9379814 KL Loss: 28.5149354 DSM Loss: 39.6947230 Overall Loss:70.1476399
Validation loss decreased (1.290326 --> 1.283106).  Saving model ...
Updating learning rate to 0.00025
tensor(58.2687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9329163 KL Loss: 28.4249327 DSM Loss: 38.4018149 Overall Loss:68.7596642
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(85.1522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8474, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9360765 KL Loss: 28.4707255 DSM Loss: 37.7718462 Overall Loss:68.1786478
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(56.2409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9352871 KL Loss: 28.4689577 DSM Loss: 38.1983445 Overall Loss:68.6025893
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(57.7825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8974570 KL Loss: 28.2617084 DSM Loss: 38.3489839 Overall Loss:68.5081493
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(74.1219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9084583 KL Loss: 28.3835530 DSM Loss: 38.7289478 Overall Loss:69.0209591
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(85.4336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9279317 KL Loss: 28.3976632 DSM Loss: 37.9270670 Overall Loss:68.2526625
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(60.7764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8969068 KL Loss: 28.3609042 DSM Loss: 38.2377109 Overall Loss:68.4955217
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(59.4744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.4404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9583, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9214957 KL Loss: 28.5132362 DSM Loss: 37.8081659 Overall Loss:68.2428977
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(57.6089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8868380 KL Loss: 28.3123555 DSM Loss: 38.3520607 Overall Loss:68.5512540
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(84.5498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.4698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9105391 KL Loss: 28.5742324 DSM Loss: 37.4857524 Overall Loss:67.9705237
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.7600749731063843


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(122.7255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9638584 KL Loss: 28.4289388 DSM Loss: 44.0632706 Overall Loss:74.4560676
Validation loss decreased (inf --> 1.194897).  Saving model ...
Updating learning rate to 0.0005
tensor(91.8755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.6138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9525790 KL Loss: 28.4074454 DSM Loss: 39.1614481 Overall Loss:69.5214723
Validation loss decreased (1.194897 --> 1.177618).  Saving model ...
Updating learning rate to 0.00025
tensor(93.1345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8570205 KL Loss: 28.1072711 DSM Loss: 39.2507089 Overall Loss:69.2150004
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(79.1922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9532535 KL Loss: 28.6346737 DSM Loss: 38.1966111 Overall Loss:68.7845384
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(65.8467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9795177 KL Loss: 28.6883854 DSM Loss: 36.4016985 Overall Loss:67.0696015
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(81.9490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9562353 KL Loss: 28.3721157 DSM Loss: 38.7552325 Overall Loss:69.0835832
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(74.8625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.4323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9597179 KL Loss: 28.5489386 DSM Loss: 38.2655537 Overall Loss:68.7742104
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(68.5555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9511, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9292406 KL Loss: 28.4906032 DSM Loss: 37.8632678 Overall Loss:68.2831114
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(51.2184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.6622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.2943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9140032 KL Loss: 28.3469816 DSM Loss: 38.3795902 Overall Loss:68.6405749
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(55.2870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9268582 KL Loss: 28.5576517 DSM Loss: 37.6736308 Overall Loss:68.1581404
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(57.7985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.7564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9167750 KL Loss: 28.3098512 DSM Loss: 38.4195052 Overall Loss:68.6461314
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(47.8097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.8931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9236945 KL Loss: 28.4356550 DSM Loss: 38.0969708 Overall Loss:68.4563202
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9998310208320618


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(97.4221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0346171 KL Loss: 28.5155041 DSM Loss: 44.2549356 Overall Loss:74.8050568
Validation loss decreased (inf --> 0.817862).  Saving model ...
Updating learning rate to 0.0005
tensor(65.4189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.7873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.2986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9953278 KL Loss: 28.6334032 DSM Loss: 39.2092261 Overall Loss:69.8379567
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(77.0810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9493997 KL Loss: 28.3577591 DSM Loss: 39.1200239 Overall Loss:69.4271827
Validation loss decreased (0.817862 --> 0.815421).  Saving model ...
Updating learning rate to 0.000125
tensor(64.5313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.0386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.3744, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9328787 KL Loss: 28.4788223 DSM Loss: 38.8580062 Overall Loss:69.2697073
Validation loss decreased (0.815421 --> 0.810965).  Saving model ...
Updating learning rate to 6.25e-05
tensor(78.8901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(150.8307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8402790 KL Loss: 28.0601929 DSM Loss: 38.8909822 Overall Loss:68.7914536
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(94.1433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9036586 KL Loss: 28.6007460 DSM Loss: 38.0794122 Overall Loss:68.5838161
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(47.6479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9501318 KL Loss: 28.8129216 DSM Loss: 37.6599421 Overall Loss:68.4229958
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(81.2802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9034213 KL Loss: 28.2746774 DSM Loss: 38.4634328 Overall Loss:68.6415317
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(46.9588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9141020 KL Loss: 28.3669418 DSM Loss: 38.1645423 Overall Loss:68.4455862
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(55.2911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.1883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.9792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8927426 KL Loss: 28.2249079 DSM Loss: 38.3591002 Overall Loss:68.4767508
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(52.7709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8978837 KL Loss: 28.1974502 DSM Loss: 38.5264128 Overall Loss:68.6217466
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(50.8426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9495633 KL Loss: 28.3942615 DSM Loss: 38.7352414 Overall Loss:69.0790660
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(76.5430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.4340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6832, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9184553 KL Loss: 28.5192292 DSM Loss: 38.3985365 Overall Loss:68.8362214
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(55.2510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9149862 KL Loss: 28.5330373 DSM Loss: 38.6843770 Overall Loss:69.1324003
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7136989831924438


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(126.4708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9751751 KL Loss: 28.5263853 DSM Loss: 45.6312323 Overall Loss:76.1327927
Validation loss decreased (inf --> 1.353442).  Saving model ...
Updating learning rate to 0.0005
tensor(62.1152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9575579 KL Loss: 28.6420935 DSM Loss: 38.1483600 Overall Loss:68.7480111
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(57.4923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9629801 KL Loss: 28.5012676 DSM Loss: 37.7870876 Overall Loss:68.2513351
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(90.5661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9007779 KL Loss: 28.2147882 DSM Loss: 37.5462228 Overall Loss:67.6617886
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(62.2889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9438639 KL Loss: 28.5550074 DSM Loss: 37.4119498 Overall Loss:67.9108210
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(76.7804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9019999 KL Loss: 28.2994855 DSM Loss: 37.8711145 Overall Loss:68.0726004
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(61.1170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9181031 KL Loss: 28.2901644 DSM Loss: 37.0152242 Overall Loss:67.2234915
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(75.3389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.4835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.0859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8971466 KL Loss: 28.2329677 DSM Loss: 38.0907326 Overall Loss:68.2208469
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(71.4206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9138230 KL Loss: 28.4749917 DSM Loss: 37.2883031 Overall Loss:67.6771178
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(51.9760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9221779 KL Loss: 28.3638128 DSM Loss: 37.4203934 Overall Loss:67.7063840
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(53.2722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9064981 KL Loss: 28.2946233 DSM Loss: 37.5370069 Overall Loss:67.7381278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.0017343759536743


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(87.4192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9422711 KL Loss: 28.6292162 DSM Loss: 43.9801425 Overall Loss:74.5516293
Validation loss decreased (inf --> 0.335779).  Saving model ...
Updating learning rate to 0.0005
tensor(53.9490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9248525 KL Loss: 28.3528256 DSM Loss: 35.9726653 Overall Loss:66.2503434
Validation loss decreased (0.335779 --> 0.335129).  Saving model ...
Updating learning rate to 0.00025
tensor(54.3508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8928490 KL Loss: 28.1791906 DSM Loss: 35.0009917 Overall Loss:65.0730313
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(62.6008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8755858 KL Loss: 28.2157153 DSM Loss: 34.6905122 Overall Loss:64.7818133
Validation loss decreased (0.335129 --> 0.334754).  Saving model ...
Updating learning rate to 6.25e-05
tensor(82.2208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8948002 KL Loss: 28.1541840 DSM Loss: 34.9030318 Overall Loss:64.9520159
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(77.0605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9072983 KL Loss: 28.4003243 DSM Loss: 34.3726713 Overall Loss:64.6802938
Validation loss decreased (0.334754 --> 0.334724).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(73.6771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8767722 KL Loss: 28.3358648 DSM Loss: 34.3611993 Overall Loss:64.5738360
Validation loss decreased (0.334724 --> 0.334685).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(51.7246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8771437 KL Loss: 28.2565153 DSM Loss: 34.2609655 Overall Loss:64.3946248
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(57.0679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8737765 KL Loss: 28.0908293 DSM Loss: 34.9031409 Overall Loss:64.8677462
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(50.9766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4110, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8921533 KL Loss: 28.3880897 DSM Loss: 34.4988516 Overall Loss:64.7790946
Validation loss decreased (0.334685 --> 0.334685).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(56.2928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9007688 KL Loss: 28.3578270 DSM Loss: 34.3475810 Overall Loss:64.6061766
Validation loss decreased (0.334685 --> 0.334672).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(56.9540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3663, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9067396 KL Loss: 28.3136883 DSM Loss: 34.2319044 Overall Loss:64.4523320
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-07
tensor(122.6440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4452, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9120900 KL Loss: 28.5784575 DSM Loss: 34.0126307 Overall Loss:64.5031782
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-07
tensor(60.7776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.0298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8807167 KL Loss: 28.1813716 DSM Loss: 34.7478475 Overall Loss:64.8099358
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-08
tensor(69.3205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.8795191 KL Loss: 28.2266969 DSM Loss: 34.6898769 Overall Loss:64.7960929
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-08
tensor(81.6944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.3948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.8887803 KL Loss: 28.3613637 DSM Loss: 34.2625129 Overall Loss:64.5126571
Validation loss decreased (0.334672 --> 0.334662).  Saving model ...
Updating learning rate to 1.52587890625e-08
tensor(73.3809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.5735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9121, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.8856831 KL Loss: 28.2366444 DSM Loss: 34.6652469 Overall Loss:64.7875744
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.62939453125e-09
tensor(52.1767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.8890370 KL Loss: 28.4075937 DSM Loss: 34.3053595 Overall Loss:64.6019899
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.814697265625e-09
tensor(57.1632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 83 | MSE Loss: 1.8909320 KL Loss: 28.3968914 DSM Loss: 34.5221612 Overall Loss:64.8099848
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(55.6770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.5452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7884, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 83 | MSE Loss: 1.8942758 KL Loss: 28.4867658 DSM Loss: 34.2953978 Overall Loss:64.6764394
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(80.3022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.4929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 83 | MSE Loss: 1.8866602 KL Loss: 28.2275755 DSM Loss: 34.3603214 Overall Loss:64.4745573
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(61.6550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 83 | MSE Loss: 1.8775196 KL Loss: 28.3627317 DSM Loss: 33.8930750 Overall Loss:64.1333262
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(70.7230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8822, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 83 | MSE Loss: 1.9020446 KL Loss: 28.5053732 DSM Loss: 33.8619193 Overall Loss:64.2693369
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(60.8830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.3635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 83 | MSE Loss: 1.9074854 KL Loss: 28.2996512 DSM Loss: 34.4809661 Overall Loss:64.6881029
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.960464477539063e-11
tensor(75.9546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 25, Steps: 83 | MSE Loss: 1.8971637 KL Loss: 28.3493573 DSM Loss: 34.9242922 Overall Loss:65.1708133
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.980232238769531e-11
tensor(74.2276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9007, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 26, Steps: 83 | MSE Loss: 1.9269763 KL Loss: 28.6513279 DSM Loss: 33.5792347 Overall Loss:64.1575388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.1655938625335693


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(109.8807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9637648 KL Loss: 28.4979032 DSM Loss: 45.0382648 Overall Loss:75.4999330
Validation loss decreased (inf --> 0.954140).  Saving model ...
Updating learning rate to 0.0005
tensor(57.9955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.5999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9731720 KL Loss: 28.5708847 DSM Loss: 39.5796395 Overall Loss:70.1236964
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(89.7551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7055, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9064826 KL Loss: 28.2636866 DSM Loss: 39.0805453 Overall Loss:69.2507146
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(82.4442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.8509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8587, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9165495 KL Loss: 28.3162751 DSM Loss: 39.0875601 Overall Loss:69.3203842
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(55.1959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.2100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9094540 KL Loss: 28.4600063 DSM Loss: 38.7921945 Overall Loss:69.1616546
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(60.3817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9551627 KL Loss: 28.6921536 DSM Loss: 38.5224216 Overall Loss:69.1697381
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(75.8414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9203814 KL Loss: 28.4022163 DSM Loss: 38.5979778 Overall Loss:68.9205753
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(82.4600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7382, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9369153 KL Loss: 28.5248654 DSM Loss: 38.3579365 Overall Loss:68.8197172
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(63.8329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9270947 KL Loss: 28.2960622 DSM Loss: 38.7769517 Overall Loss:69.0001084
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(60.6370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1636, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9149609 KL Loss: 28.3996951 DSM Loss: 38.3408822 Overall Loss:68.6555377
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(62.8801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.4197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9250349 KL Loss: 28.3700994 DSM Loss: 38.1845871 Overall Loss:68.4797214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.3775925636291504


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(96.1139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9917304 KL Loss: 28.7101858 DSM Loss: 44.5837048 Overall Loss:75.2856210
Validation loss decreased (inf --> 0.756159).  Saving model ...
Updating learning rate to 0.0005
tensor(45.9296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0216789 KL Loss: 28.6735588 DSM Loss: 38.8956769 Overall Loss:69.5909141
Validation loss decreased (0.756159 --> 0.752470).  Saving model ...
Updating learning rate to 0.00025
tensor(59.2987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9767387 KL Loss: 28.4659964 DSM Loss: 38.7218093 Overall Loss:69.1645445
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(67.2461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9367407 KL Loss: 28.4868429 DSM Loss: 38.8659579 Overall Loss:69.2895416
Validation loss decreased (0.752470 --> 0.751931).  Saving model ...
Updating learning rate to 6.25e-05
tensor(53.5289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.3793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.8616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9464966 KL Loss: 28.6649944 DSM Loss: 38.3660214 Overall Loss:68.9775128
Validation loss decreased (0.751931 --> 0.751248).  Saving model ...
Updating learning rate to 3.125e-05
tensor(82.2995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9596407 KL Loss: 28.5211681 DSM Loss: 38.9164413 Overall Loss:69.3972501
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(70.5149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9319808 KL Loss: 28.5433743 DSM Loss: 38.6231984 Overall Loss:69.0985533
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(102.0406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9305411 KL Loss: 28.3277310 DSM Loss: 39.0882176 Overall Loss:69.3464895
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(78.1546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9193554 KL Loss: 28.3695905 DSM Loss: 38.8053230 Overall Loss:69.0942688
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(77.1831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.4852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9388907 KL Loss: 28.4679761 DSM Loss: 38.6370221 Overall Loss:69.0438888
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(63.2271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9605248 KL Loss: 28.6707976 DSM Loss: 37.9924746 Overall Loss:68.6237970
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(67.1920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9231294 KL Loss: 28.1988973 DSM Loss: 38.8887922 Overall Loss:69.0108187
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(55.2474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9327936 KL Loss: 28.4207813 DSM Loss: 38.6700215 Overall Loss:69.0235962
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(54.7899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.4727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9470058 KL Loss: 28.6325020 DSM Loss: 37.5245961 Overall Loss:68.1041044
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(81.4200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9161355 KL Loss: 28.1686070 DSM Loss: 39.3645372 Overall Loss:69.4492795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7311606407165527


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(108.0817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9754761 KL Loss: 28.4933607 DSM Loss: 44.0375497 Overall Loss:74.5063862
Validation loss decreased (inf --> 0.803261).  Saving model ...
Updating learning rate to 0.0005
tensor(72.7272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.0436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9476915 KL Loss: 28.4081966 DSM Loss: 39.2508166 Overall Loss:69.6067048
Validation loss decreased (0.803261 --> 0.793747).  Saving model ...
Updating learning rate to 0.00025
tensor(64.7114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9229572 KL Loss: 28.4554838 DSM Loss: 37.6464663 Overall Loss:68.0249071
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(81.2626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9248820 KL Loss: 28.4502930 DSM Loss: 37.7150132 Overall Loss:68.0901879
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(65.5272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9113371 KL Loss: 28.3659807 DSM Loss: 38.2176309 Overall Loss:68.4949487
Validation loss decreased (0.793747 --> 0.787862).  Saving model ...
Updating learning rate to 3.125e-05
tensor(65.3159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.4624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9476913 KL Loss: 28.4935446 DSM Loss: 37.6017260 Overall Loss:68.0429618
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(48.6099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.0917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8938091 KL Loss: 28.2590375 DSM Loss: 37.6366701 Overall Loss:67.7895166
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(101.4547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.5221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9068352 KL Loss: 28.2570956 DSM Loss: 37.7177044 Overall Loss:67.8816349
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(51.7466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9460561 KL Loss: 28.6999385 DSM Loss: 37.6098989 Overall Loss:68.2558936
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(56.1369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.4723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.7039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8901443 KL Loss: 28.2793198 DSM Loss: 37.4031464 Overall Loss:67.5726103
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(42.6489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.0469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8789822 KL Loss: 28.1344207 DSM Loss: 38.1734060 Overall Loss:68.1868089
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(55.0730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8984601 KL Loss: 28.3883381 DSM Loss: 37.9327576 Overall Loss:68.2195557
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(114.5281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.9668, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8691531 KL Loss: 27.9885245 DSM Loss: 38.2690806 Overall Loss:68.1267577
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(58.1227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.2076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9402320 KL Loss: 28.7803317 DSM Loss: 36.4942199 Overall Loss:67.2147835
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(62.1058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.8334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9206362 KL Loss: 28.5115056 DSM Loss: 37.2058711 Overall Loss:67.6380130
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.659659206867218


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(90.5827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9484737 KL Loss: 28.6826108 DSM Loss: 46.0487121 Overall Loss:76.6797967
Validation loss decreased (inf --> 0.756990).  Saving model ...
Updating learning rate to 0.0005
tensor(65.4359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.0378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9152167 KL Loss: 28.3422414 DSM Loss: 40.7704464 Overall Loss:71.0279043
Validation loss decreased (0.756990 --> 0.756684).  Saving model ...
Updating learning rate to 0.00025
tensor(61.5347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9482483 KL Loss: 28.6355304 DSM Loss: 39.2584115 Overall Loss:69.8421903
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(63.8291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9283259 KL Loss: 28.5695772 DSM Loss: 39.2084190 Overall Loss:69.7063222
Validation loss decreased (0.756684 --> 0.755907).  Saving model ...
Updating learning rate to 6.25e-05
tensor(53.4333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6082, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9296228 KL Loss: 28.4275532 DSM Loss: 39.5352179 Overall Loss:69.8923935
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(109.0646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.6811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.4438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9272448 KL Loss: 28.3984153 DSM Loss: 39.3035628 Overall Loss:69.6292230
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(59.3749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9217238 KL Loss: 28.3768459 DSM Loss: 39.0097243 Overall Loss:69.3082939
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(87.0131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7874, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9437343 KL Loss: 28.5837811 DSM Loss: 39.0290064 Overall Loss:69.5565217
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(46.4508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9375194 KL Loss: 28.4010113 DSM Loss: 39.2259843 Overall Loss:69.5645147
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(55.0269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9498929 KL Loss: 28.7092077 DSM Loss: 38.1828467 Overall Loss:68.8419475
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(80.3349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9457500 KL Loss: 28.6338325 DSM Loss: 38.6763541 Overall Loss:69.2559363
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(53.4936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9224196 KL Loss: 28.4589659 DSM Loss: 38.5756420 Overall Loss:68.9570273
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(116.8680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9292339 KL Loss: 28.4969355 DSM Loss: 38.7680562 Overall Loss:69.1942253
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(51.0603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.1319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9493254 KL Loss: 28.4924838 DSM Loss: 39.4935917 Overall Loss:69.9354009
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6245641708374023


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(88.9800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9567137 KL Loss: 28.6722488 DSM Loss: 49.3620951 Overall Loss:79.9910578
Validation loss decreased (inf --> 1.275591).  Saving model ...
Updating learning rate to 0.0005
tensor(53.0773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9895942 KL Loss: 28.6130650 DSM Loss: 40.0708775 Overall Loss:70.6735366
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(81.1525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2099, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9559844 KL Loss: 28.3877088 DSM Loss: 39.3222690 Overall Loss:69.6659619
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(120.8201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.4958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6834, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9155226 KL Loss: 28.3234889 DSM Loss: 39.2635354 Overall Loss:69.5025471
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(67.7473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.0593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.3053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9162314 KL Loss: 28.3962153 DSM Loss: 38.9280013 Overall Loss:69.2404476
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(85.2464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8890520 KL Loss: 28.3473236 DSM Loss: 39.5785579 Overall Loss:69.8149335
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(62.6911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.8871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9362383 KL Loss: 28.7401957 DSM Loss: 37.5078958 Overall Loss:68.1843295
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(81.7553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9335041 KL Loss: 28.5328999 DSM Loss: 38.6037859 Overall Loss:69.0701895
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(46.0788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.5851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9071983 KL Loss: 28.1826416 DSM Loss: 39.2469687 Overall Loss:69.3368084
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(52.1361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8391, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9298438 KL Loss: 28.4481009 DSM Loss: 38.7083910 Overall Loss:69.0863359
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(62.2938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.9347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8820901 KL Loss: 28.2274764 DSM Loss: 39.1722841 Overall Loss:69.2818506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8315011262893677


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(108.8940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9726728 KL Loss: 28.7506292 DSM Loss: 45.5777282 Overall Loss:76.3010300
Validation loss decreased (inf --> 1.422485).  Saving model ...
Updating learning rate to 0.0005
tensor(66.4011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.2185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9555109 KL Loss: 28.6107488 DSM Loss: 38.7231853 Overall Loss:69.2894446
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(50.9791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.1590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9619707 KL Loss: 28.5916298 DSM Loss: 38.1705933 Overall Loss:68.7241935
Validation loss decreased (1.422485 --> 1.422329).  Saving model ...
Updating learning rate to 0.000125
tensor(45.0520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9248744 KL Loss: 28.3780777 DSM Loss: 38.3580103 Overall Loss:68.6609621
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(77.9122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9238179 KL Loss: 28.3882302 DSM Loss: 37.9033823 Overall Loss:68.2154302
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(59.8161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8178, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9365834 KL Loss: 28.5339921 DSM Loss: 38.6070277 Overall Loss:69.0776032
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(52.3340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8981335 KL Loss: 28.1648631 DSM Loss: 38.0943588 Overall Loss:68.1573550
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(65.8047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9327921 KL Loss: 28.5891860 DSM Loss: 37.5336537 Overall Loss:68.0556318
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(51.9336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8843, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9076450 KL Loss: 28.3290225 DSM Loss: 37.9423690 Overall Loss:68.1790365
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(54.2240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.9357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9144477 KL Loss: 28.3498352 DSM Loss: 38.1484053 Overall Loss:68.4126882
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(58.8497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.2608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9225041 KL Loss: 28.5611916 DSM Loss: 37.6699643 Overall Loss:68.1536598
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(63.4887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8848466 KL Loss: 28.1015138 DSM Loss: 38.3983071 Overall Loss:68.3846675
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(56.9438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8957541 KL Loss: 28.2752307 DSM Loss: 38.2634294 Overall Loss:68.4344139
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5887590646743774


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(93.6406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9552213 KL Loss: 28.9923124 DSM Loss: 46.3467724 Overall Loss:77.2943061
Validation loss decreased (inf --> 0.613337).  Saving model ...
Updating learning rate to 0.0005
tensor(74.5245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.4597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9283999 KL Loss: 28.6027061 DSM Loss: 39.9181735 Overall Loss:70.4492797
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(93.1192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.4918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9175749 KL Loss: 28.3822522 DSM Loss: 39.7111832 Overall Loss:70.0110103
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(88.5156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.5084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9072750 KL Loss: 28.3948391 DSM Loss: 38.5250624 Overall Loss:68.8271761
Validation loss decreased (0.613337 --> 0.613007).  Saving model ...
Updating learning rate to 6.25e-05
tensor(62.0680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3018, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8675026 KL Loss: 28.0903953 DSM Loss: 39.9246501 Overall Loss:69.8825482
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(48.5400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.4579, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9280850 KL Loss: 28.8025740 DSM Loss: 37.4971326 Overall Loss:68.2277916
Validation loss decreased (0.613007 --> 0.612771).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(128.3117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.7418, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8715137 KL Loss: 28.1716561 DSM Loss: 39.4195801 Overall Loss:69.4627498
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(93.2018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.7876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8960457 KL Loss: 28.4397005 DSM Loss: 39.0124798 Overall Loss:69.3482261
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(50.6463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(172.3240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8733777 KL Loss: 28.0192393 DSM Loss: 39.5497067 Overall Loss:69.4423237
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(85.6987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9098771 KL Loss: 28.3401360 DSM Loss: 39.0773611 Overall Loss:69.3273742
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(94.7450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.1355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9333568 KL Loss: 28.7014021 DSM Loss: 37.6873510 Overall Loss:68.3221102
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(50.8195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.3162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9153953 KL Loss: 28.6366733 DSM Loss: 38.3226219 Overall Loss:68.8746907
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(116.8021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.1893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.8203, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9211662 KL Loss: 28.4454201 DSM Loss: 38.1674420 Overall Loss:68.5340286
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(85.6712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.1605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.7036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9541976 KL Loss: 28.7971243 DSM Loss: 37.9734045 Overall Loss:68.7247263
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(81.1256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.1909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9232092 KL Loss: 28.7346695 DSM Loss: 38.5996516 Overall Loss:69.2575301
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(53.9658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(127.4910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.9289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9375571 KL Loss: 28.7091314 DSM Loss: 38.1291671 Overall Loss:68.7758554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.4931366443634033


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(117.6680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9678680 KL Loss: 28.5446463 DSM Loss: 46.3674347 Overall Loss:76.8799492
Validation loss decreased (inf --> 0.966010).  Saving model ...
Updating learning rate to 0.0005
tensor(84.7182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.3874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.8725, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9359424 KL Loss: 28.5210720 DSM Loss: 39.4466698 Overall Loss:69.9036841
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(79.5445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9484109 KL Loss: 28.2493940 DSM Loss: 39.0427517 Overall Loss:69.2405568
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(81.8696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.4441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9260483 KL Loss: 28.3195934 DSM Loss: 39.1449645 Overall Loss:69.3906059
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(45.6097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.9490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(127.4429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9154326 KL Loss: 28.3863277 DSM Loss: 38.5205373 Overall Loss:68.8222974
Validation loss decreased (0.966010 --> 0.964995).  Saving model ...
Updating learning rate to 3.125e-05
tensor(50.5330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(128.2941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8908394 KL Loss: 28.2905105 DSM Loss: 38.8384928 Overall Loss:69.0198425
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(57.8387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9236527 KL Loss: 28.5096137 DSM Loss: 38.3430919 Overall Loss:68.7763579
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(82.6637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.6314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9112497 KL Loss: 28.3554082 DSM Loss: 38.4589602 Overall Loss:68.7256178
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(57.2733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.5718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8890386 KL Loss: 28.1659781 DSM Loss: 38.4775606 Overall Loss:68.5325775
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(74.0072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.0364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9298293 KL Loss: 28.4838296 DSM Loss: 38.1207471 Overall Loss:68.5344057
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(86.2462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.3271, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9197601 KL Loss: 28.4421848 DSM Loss: 38.3110132 Overall Loss:68.6729581
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(67.3466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.6199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9084430 KL Loss: 28.4512448 DSM Loss: 37.8087109 Overall Loss:68.1683985
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(79.7185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8926101 KL Loss: 28.2139070 DSM Loss: 38.5299933 Overall Loss:68.6365101
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(74.4584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8826990 KL Loss: 28.2922101 DSM Loss: 38.8618776 Overall Loss:69.0367870
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(100.0405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9214605 KL Loss: 28.2956627 DSM Loss: 38.6845901 Overall Loss:68.9017130
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9490111470222473


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(126.4419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9887903 KL Loss: 28.8458398 DSM Loss: 46.4168954 Overall Loss:77.2515256
Validation loss decreased (inf --> 0.746647).  Saving model ...
Updating learning rate to 0.0005
tensor(86.4975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9628663 KL Loss: 28.3979589 DSM Loss: 39.8215714 Overall Loss:70.1823963
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(69.3700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.2141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9252664 KL Loss: 28.2937061 DSM Loss: 39.7657277 Overall Loss:69.9847004
Validation loss decreased (0.746647 --> 0.741142).  Saving model ...
Updating learning rate to 0.000125
tensor(57.1372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.7924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9336649 KL Loss: 28.4317675 DSM Loss: 39.3940962 Overall Loss:69.7595284
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(78.8116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8959773 KL Loss: 28.2705385 DSM Loss: 39.0063299 Overall Loss:69.1728456
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(82.6756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.8856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9029441 KL Loss: 28.4771513 DSM Loss: 38.7464783 Overall Loss:69.1265740
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(57.7680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9260923 KL Loss: 28.5519287 DSM Loss: 38.3236452 Overall Loss:68.8016661
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(80.3135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.8868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.3326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9428035 KL Loss: 28.4971839 DSM Loss: 38.6217841 Overall Loss:69.0617714
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(70.5135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9295497 KL Loss: 28.5273152 DSM Loss: 38.7716300 Overall Loss:69.2284948
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(78.4343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9331219 KL Loss: 28.2611916 DSM Loss: 39.1837620 Overall Loss:69.3780748
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(68.2425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.3914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9102018 KL Loss: 28.1804778 DSM Loss: 39.0455816 Overall Loss:69.1362612
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(84.9610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9398292 KL Loss: 28.5009372 DSM Loss: 38.4081974 Overall Loss:68.8489634
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(69.3162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.4920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9531099 KL Loss: 28.5281742 DSM Loss: 38.8236942 Overall Loss:69.3049782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.428771734237671


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(79.3501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8996165 KL Loss: 28.4255261 DSM Loss: 50.1613054 Overall Loss:80.4864481
Validation loss decreased (inf --> 0.798706).  Saving model ...
Updating learning rate to 0.0005
tensor(55.6898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9205539 KL Loss: 28.4911910 DSM Loss: 40.9236110 Overall Loss:71.3353559
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(72.2177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9577550 KL Loss: 28.6454292 DSM Loss: 39.6362629 Overall Loss:70.2394472
Validation loss decreased (0.798706 --> 0.794249).  Saving model ...
Updating learning rate to 0.000125
tensor(83.2383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9527983 KL Loss: 28.4934568 DSM Loss: 39.1158512 Overall Loss:69.5621061
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(74.8167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.6544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9513112 KL Loss: 28.5993291 DSM Loss: 38.7654348 Overall Loss:69.3160752
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(59.7775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9272081 KL Loss: 28.2643252 DSM Loss: 39.7549828 Overall Loss:69.9465162
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(65.1950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9311338 KL Loss: 28.6649836 DSM Loss: 38.7834685 Overall Loss:69.3795859
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(84.3288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.1080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4501, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9420034 KL Loss: 28.5060942 DSM Loss: 38.7857652 Overall Loss:69.2338628
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(51.9812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9418765 KL Loss: 28.5339416 DSM Loss: 39.1262009 Overall Loss:69.6020187
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(72.2704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9417746 KL Loss: 28.5673271 DSM Loss: 39.0497828 Overall Loss:69.5588848
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(79.0794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9502192 KL Loss: 28.6511758 DSM Loss: 39.0465441 Overall Loss:69.6479390
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(67.8909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0004, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9076007 KL Loss: 28.3286976 DSM Loss: 39.1350623 Overall Loss:69.3713611
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(103.0963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9195521 KL Loss: 28.3398194 DSM Loss: 39.1812837 Overall Loss:69.4406551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6298827528953552


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(95.9955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.4437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9312769 KL Loss: 28.6375080 DSM Loss: 46.0016175 Overall Loss:76.5704023
Validation loss decreased (inf --> 1.531181).  Saving model ...
Updating learning rate to 0.0005
tensor(70.3734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9392147 KL Loss: 28.4405111 DSM Loss: 39.3780747 Overall Loss:69.7578011
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(66.1953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.7184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8999047 KL Loss: 28.3800261 DSM Loss: 39.3188195 Overall Loss:69.5987502
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(80.5515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9403032 KL Loss: 28.5304937 DSM Loss: 39.0337505 Overall Loss:69.5045473
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(75.4106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9595832 KL Loss: 28.6271825 DSM Loss: 37.7087453 Overall Loss:68.2955109
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(60.4616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.6485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0636, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9268862 KL Loss: 28.4109055 DSM Loss: 38.1383581 Overall Loss:68.4761497
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(76.0938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9080404 KL Loss: 28.4058266 DSM Loss: 38.5252123 Overall Loss:68.8390792
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(90.7289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9461023 KL Loss: 28.6499414 DSM Loss: 38.3146532 Overall Loss:68.9106969
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(85.3526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.4537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2515, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9250336 KL Loss: 28.3392522 DSM Loss: 38.3744449 Overall Loss:68.6387308
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(58.7027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1092, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9144552 KL Loss: 28.3964547 DSM Loss: 38.1461106 Overall Loss:68.4570200
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(55.5188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9354205 KL Loss: 28.5601406 DSM Loss: 38.2817889 Overall Loss:68.7773500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8142642378807068


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(99.1287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.5137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9642325 KL Loss: 28.6454042 DSM Loss: 44.2369164 Overall Loss:74.8465530
Validation loss decreased (inf --> 1.106321).  Saving model ...
Updating learning rate to 0.0005
tensor(79.0770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.8243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9248346 KL Loss: 28.3458036 DSM Loss: 39.3671186 Overall Loss:69.6377570
Validation loss decreased (1.106321 --> 1.105638).  Saving model ...
Updating learning rate to 0.00025
tensor(66.1677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9185959 KL Loss: 28.4351200 DSM Loss: 38.3909365 Overall Loss:68.7446523
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(45.3740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9173769 KL Loss: 28.2658252 DSM Loss: 38.2484427 Overall Loss:68.4316449
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(58.0378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.7706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9014260 KL Loss: 28.1005967 DSM Loss: 38.4346012 Overall Loss:68.4366240
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(49.5634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8857936 KL Loss: 28.2056464 DSM Loss: 38.1890354 Overall Loss:68.2804753
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(66.4007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9204060 KL Loss: 28.4268053 DSM Loss: 38.0165266 Overall Loss:68.3637377
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(57.0776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9221278 KL Loss: 28.6207088 DSM Loss: 37.3765643 Overall Loss:67.9194008
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(58.9650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9288330 KL Loss: 28.4361857 DSM Loss: 37.4952684 Overall Loss:67.8602875
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(49.6202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.9037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9157024 KL Loss: 28.3426490 DSM Loss: 37.7584213 Overall Loss:68.0167726
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(47.7270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.9935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9165231 KL Loss: 28.4462789 DSM Loss: 37.7637211 Overall Loss:68.1265230
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(64.7199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.7754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9267285 KL Loss: 28.5506172 DSM Loss: 37.8932698 Overall Loss:68.3706151
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2245278358459473


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(85.8181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9308837 KL Loss: 28.7184061 DSM Loss: 50.6767552 Overall Loss:81.3260452
Validation loss decreased (inf --> 1.334659).  Saving model ...
Updating learning rate to 0.0005
tensor(87.1622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9276095 KL Loss: 28.4533802 DSM Loss: 41.1070043 Overall Loss:71.4879940
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(62.8147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.2209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9363441 KL Loss: 28.7061141 DSM Loss: 39.9725210 Overall Loss:70.6149790
Validation loss decreased (1.334659 --> 1.333249).  Saving model ...
Updating learning rate to 0.000125
tensor(61.7213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.4406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7279, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9536365 KL Loss: 28.6769039 DSM Loss: 39.5644715 Overall Loss:70.1950123
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(72.4389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.1377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9215607 KL Loss: 28.3631222 DSM Loss: 40.1087053 Overall Loss:70.3933877
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(90.9208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.4321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9493231 KL Loss: 28.6134913 DSM Loss: 39.5974213 Overall Loss:70.1602355
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(64.6346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.0239, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9662060 KL Loss: 28.8514292 DSM Loss: 37.8063807 Overall Loss:68.6240161
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(55.8532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.9899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.1114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9621670 KL Loss: 28.6044716 DSM Loss: 38.5848708 Overall Loss:69.1515092
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(46.0149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9289607 KL Loss: 28.3742297 DSM Loss: 39.3218164 Overall Loss:69.6250069
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(52.8704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9431534 KL Loss: 28.7539724 DSM Loss: 38.9579814 Overall Loss:69.6551068
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(49.5544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7129, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9190721 KL Loss: 28.2724461 DSM Loss: 39.1059919 Overall Loss:69.2975103
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(45.9709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.6783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9376189 KL Loss: 28.6097103 DSM Loss: 38.6975738 Overall Loss:69.2449024
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(46.8361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9469416 KL Loss: 28.5411971 DSM Loss: 38.8708960 Overall Loss:69.3590345
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.5022666454315186


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(107.7801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9498326 KL Loss: 28.1689981 DSM Loss: 45.3334617 Overall Loss:75.4522924
Validation loss decreased (inf --> 0.582603).  Saving model ...
Updating learning rate to 0.0005
tensor(53.9561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.4470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0272878 KL Loss: 28.9116429 DSM Loss: 38.6104787 Overall Loss:69.5494094
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(66.7837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9087580 KL Loss: 28.2302604 DSM Loss: 39.7352707 Overall Loss:69.8742893
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(116.7359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.3626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9261497 KL Loss: 28.4679767 DSM Loss: 39.2711541 Overall Loss:69.6652801
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(49.4136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8726628 KL Loss: 28.2574911 DSM Loss: 39.7736910 Overall Loss:69.9038451
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(77.6224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9092211 KL Loss: 28.4294464 DSM Loss: 39.4278254 Overall Loss:69.7664931
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(54.6939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9334945 KL Loss: 28.6061135 DSM Loss: 38.2767479 Overall Loss:68.8163559
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(65.4088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.0940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9294784 KL Loss: 28.4775653 DSM Loss: 39.0866222 Overall Loss:69.4936660
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(56.1113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(149.5663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9377404 KL Loss: 28.3812196 DSM Loss: 39.1276040 Overall Loss:69.4465641
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(138.4400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.8747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9238471 KL Loss: 28.5002456 DSM Loss: 38.7104658 Overall Loss:69.1345583
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(59.3660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(131.5849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9174554 KL Loss: 28.2776678 DSM Loss: 39.1436182 Overall Loss:69.3387416
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9782118797302246


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(100.9371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.1662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.9281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9763388 KL Loss: 28.5305654 DSM Loss: 44.5014963 Overall Loss:75.0084004
Validation loss decreased (inf --> 0.749713).  Saving model ...
Updating learning rate to 0.0005
tensor(78.6343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9518977 KL Loss: 28.5729260 DSM Loss: 38.9652543 Overall Loss:69.4900775
Validation loss decreased (0.749713 --> 0.749540).  Saving model ...
Updating learning rate to 0.00025
tensor(64.5291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.0672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9731, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9855622 KL Loss: 28.7987478 DSM Loss: 37.8931426 Overall Loss:68.6774529
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(85.9091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9514445 KL Loss: 28.5004396 DSM Loss: 37.9758617 Overall Loss:68.4277456
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(82.5001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9209013 KL Loss: 28.4539132 DSM Loss: 37.8876235 Overall Loss:68.2624379
Validation loss decreased (0.749540 --> 0.749210).  Saving model ...
Updating learning rate to 3.125e-05
tensor(75.2022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.2287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9146672 KL Loss: 28.3641104 DSM Loss: 37.7584996 Overall Loss:68.0372771
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(74.8937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9105563 KL Loss: 28.3756415 DSM Loss: 37.8261698 Overall Loss:68.1123677
Validation loss decreased (0.749210 --> 0.749197).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(58.9373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9315050 KL Loss: 28.5159182 DSM Loss: 37.2127719 Overall Loss:67.6601951
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(78.4133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9245329 KL Loss: 28.3719063 DSM Loss: 37.8656193 Overall Loss:68.1620585
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(62.8096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.0909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9228119 KL Loss: 28.4921178 DSM Loss: 37.3088382 Overall Loss:67.7237680
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-07
tensor(56.8379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9135599 KL Loss: 28.3803145 DSM Loss: 37.1888273 Overall Loss:67.4827017
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-07
tensor(62.9152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9211158 KL Loss: 28.5487773 DSM Loss: 37.3111864 Overall Loss:67.7810795
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-07
tensor(70.8904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8887544 KL Loss: 28.2559750 DSM Loss: 37.7787475 Overall Loss:67.9234768
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-07
tensor(57.4203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.0447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8836615 KL Loss: 28.2005709 DSM Loss: 38.1987027 Overall Loss:68.2829349
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-08
tensor(63.1863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.6911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9330720 KL Loss: 28.5613527 DSM Loss: 37.2318587 Overall Loss:67.7262832
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-08
tensor(66.3679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9070243 KL Loss: 28.4651932 DSM Loss: 37.6401249 Overall Loss:68.0123419
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-08
tensor(52.2215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9450951 KL Loss: 28.4756824 DSM Loss: 37.6967805 Overall Loss:68.1175577
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9594922065734863


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(134.0559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.6027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9609185 KL Loss: 28.5359421 DSM Loss: 47.7401523 Overall Loss:78.2370127
Validation loss decreased (inf --> 1.634324).  Saving model ...
Updating learning rate to 0.0005
tensor(51.3350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.4266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.5871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9477182 KL Loss: 28.3552093 DSM Loss: 38.9982752 Overall Loss:69.3012028
Validation loss decreased (1.634324 --> 1.600927).  Saving model ...
Updating learning rate to 0.00025
tensor(58.4564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9379238 KL Loss: 28.5245503 DSM Loss: 38.3094797 Overall Loss:68.7719537
Validation loss decreased (1.600927 --> 1.595978).  Saving model ...
Updating learning rate to 0.000125
tensor(93.5681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.7602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9500539 KL Loss: 28.7196785 DSM Loss: 37.5749264 Overall Loss:68.2446586
Validation loss decreased (1.595978 --> 1.594655).  Saving model ...
Updating learning rate to 6.25e-05
tensor(47.3065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.3231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9262438 KL Loss: 28.2973284 DSM Loss: 38.9974041 Overall Loss:69.2209760
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(85.5315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0070, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8780310 KL Loss: 28.2162471 DSM Loss: 38.4374815 Overall Loss:68.5317596
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(55.7228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.6906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8953511 KL Loss: 28.3555660 DSM Loss: 37.8893172 Overall Loss:68.1402340
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(56.6873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9059402 KL Loss: 28.3092294 DSM Loss: 38.2176515 Overall Loss:68.4328209
Validation loss decreased (1.594655 --> 1.593626).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(59.0528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9053300 KL Loss: 28.4924942 DSM Loss: 38.3105220 Overall Loss:68.7083460
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(52.0764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8965294 KL Loss: 28.2017727 DSM Loss: 38.3451645 Overall Loss:68.4434665
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(75.1489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8910957 KL Loss: 28.2898837 DSM Loss: 38.1298557 Overall Loss:68.3108349
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(54.4900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9120271 KL Loss: 28.5698389 DSM Loss: 37.8168344 Overall Loss:68.2987007
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(58.7548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.6510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9109597 KL Loss: 28.5140201 DSM Loss: 37.6690228 Overall Loss:68.0940026
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(50.1711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.7343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9096981 KL Loss: 28.3786652 DSM Loss: 38.4111383 Overall Loss:68.6995015
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(54.2182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.3477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9002542 KL Loss: 28.4555270 DSM Loss: 37.8919543 Overall Loss:68.2477356
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(58.5898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.8915638 KL Loss: 28.2670181 DSM Loss: 38.1866956 Overall Loss:68.3452776
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(47.7804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9094428 KL Loss: 28.4406466 DSM Loss: 38.2991416 Overall Loss:68.6492310
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(64.2903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9396423 KL Loss: 28.6778618 DSM Loss: 38.2761372 Overall Loss:68.8936416
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2076209783554077


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(78.9097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.6588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8949014 KL Loss: 28.5220124 DSM Loss: 46.9004664 Overall Loss:77.3173805
Validation loss decreased (inf --> 0.208302).  Saving model ...
Updating learning rate to 0.0005
tensor(86.4132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9828965 KL Loss: 28.8494911 DSM Loss: 40.6144943 Overall Loss:71.4468820
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(43.7235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.7864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8996300 KL Loss: 28.1374793 DSM Loss: 41.0713996 Overall Loss:71.1085091
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(55.9598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.9876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9251640 KL Loss: 28.4840416 DSM Loss: 40.3745905 Overall Loss:70.7837962
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(121.1703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8949000 KL Loss: 28.2648334 DSM Loss: 40.1010692 Overall Loss:70.2608028
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(61.3933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9260410 KL Loss: 28.5308043 DSM Loss: 39.4477424 Overall Loss:69.9045875
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(55.5525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.9663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5342, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9186517 KL Loss: 28.5143189 DSM Loss: 39.6443704 Overall Loss:70.0773411
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(63.9175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.4527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9326838 KL Loss: 28.5870290 DSM Loss: 39.4526619 Overall Loss:69.9723744
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(76.4585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(161.3830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9037649 KL Loss: 28.1559727 DSM Loss: 39.7448594 Overall Loss:69.8045972
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(47.8103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.1265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(124.1549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9009883 KL Loss: 28.1864036 DSM Loss: 40.4688390 Overall Loss:70.5562308
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(94.7089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9172375 KL Loss: 28.3181448 DSM Loss: 40.0782773 Overall Loss:70.3136593
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.11687497794628143


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(93.5326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0083535 KL Loss: 28.8485561 DSM Loss: 43.8887480 Overall Loss:74.7456577
Validation loss decreased (inf --> 0.658840).  Saving model ...
Updating learning rate to 0.0005
tensor(93.6063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.9695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9966021 KL Loss: 28.8255777 DSM Loss: 39.4237287 Overall Loss:70.2459089
Validation loss decreased (0.658840 --> 0.654288).  Saving model ...
Updating learning rate to 0.00025
tensor(68.0988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.3697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9884266 KL Loss: 28.5378636 DSM Loss: 39.8017950 Overall Loss:70.3280849
Validation loss decreased (0.654288 --> 0.653216).  Saving model ...
Updating learning rate to 0.000125
tensor(136.1903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.4123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.0054942 KL Loss: 28.7510581 DSM Loss: 38.7291864 Overall Loss:69.4857385
Validation loss decreased (0.653216 --> 0.653038).  Saving model ...
Updating learning rate to 6.25e-05
tensor(49.5821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(140.7146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.6357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9050361 KL Loss: 28.2961541 DSM Loss: 39.4654138 Overall Loss:69.6666041
Validation loss decreased (0.653038 --> 0.652289).  Saving model ...
Updating learning rate to 3.125e-05
tensor(55.1874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.6532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.3831, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8925995 KL Loss: 28.2879880 DSM Loss: 39.5025087 Overall Loss:69.6830959
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(47.9150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.4887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9378480 KL Loss: 28.7920962 DSM Loss: 38.4269176 Overall Loss:69.1568623
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(97.6560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.3058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.7903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9403016 KL Loss: 28.5617128 DSM Loss: 38.5453466 Overall Loss:69.0473611
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(94.5728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(132.8875, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9168021 KL Loss: 28.4745171 DSM Loss: 39.1496437 Overall Loss:69.5409628
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(94.1408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.4316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9008996 KL Loss: 28.3592046 DSM Loss: 39.5117132 Overall Loss:69.7718170
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(57.5380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.2715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9113754 KL Loss: 28.4221115 DSM Loss: 38.1911572 Overall Loss:68.5246437
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(94.3618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8756635 KL Loss: 28.0145364 DSM Loss: 40.1355116 Overall Loss:70.0257117
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(122.9249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(131.1493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9079308 KL Loss: 28.4069818 DSM Loss: 39.2748302 Overall Loss:69.5897426
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(47.2362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.6181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9072404 KL Loss: 28.2790127 DSM Loss: 39.4425898 Overall Loss:69.6288426
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(93.8619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.8102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9196126 KL Loss: 28.4039216 DSM Loss: 39.1684614 Overall Loss:69.4919958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6515389084815979


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(86.9040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.5446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4861, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9863994 KL Loss: 28.5451816 DSM Loss: 50.2752287 Overall Loss:80.8068096
Validation loss decreased (inf --> 2.301164).  Saving model ...
Updating learning rate to 0.0005
tensor(88.8390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.6535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.2691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9786837 KL Loss: 28.4829099 DSM Loss: 40.4010078 Overall Loss:70.8626014
Validation loss decreased (2.301164 --> 2.298374).  Saving model ...
Updating learning rate to 0.00025
tensor(79.6803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.5413, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9718336 KL Loss: 28.4366379 DSM Loss: 39.8905040 Overall Loss:70.2989756
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(73.0968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8498, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9266089 KL Loss: 28.3949633 DSM Loss: 39.2184159 Overall Loss:69.5399875
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(63.0611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9353546 KL Loss: 28.5627428 DSM Loss: 38.2293819 Overall Loss:68.7274794
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(60.6975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9437749 KL Loss: 28.4961023 DSM Loss: 37.5381905 Overall Loss:67.9780676
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(44.1748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9384090 KL Loss: 28.4334174 DSM Loss: 37.9819978 Overall Loss:68.3538241
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(62.0105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.4889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9305154 KL Loss: 28.4955209 DSM Loss: 38.0954133 Overall Loss:68.5214493
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(76.4702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.1534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9387930 KL Loss: 28.5200689 DSM Loss: 37.9864831 Overall Loss:68.4453448
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(55.2052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9510750 KL Loss: 28.6603395 DSM Loss: 37.0126292 Overall Loss:67.6240437
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(56.3629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9417663 KL Loss: 28.3466090 DSM Loss: 37.7888514 Overall Loss:68.0772267
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(59.8834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9334213 KL Loss: 28.5212719 DSM Loss: 37.9517789 Overall Loss:68.4064722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.1020307540893555


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(91.6255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9255994 KL Loss: 28.3394376 DSM Loss: 46.5220864 Overall Loss:76.7871238
Validation loss decreased (inf --> 0.835144).  Saving model ...
Updating learning rate to 0.0005
tensor(51.1497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9954671 KL Loss: 28.5268913 DSM Loss: 39.8484797 Overall Loss:70.3708382
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(61.5651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.7337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9751733 KL Loss: 28.6158224 DSM Loss: 38.5424132 Overall Loss:69.1334090
Validation loss decreased (0.835144 --> 0.834949).  Saving model ...
Updating learning rate to 0.000125
tensor(50.9104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(121.1496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.9619, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9213243 KL Loss: 28.5214756 DSM Loss: 39.0467504 Overall Loss:69.4895505
Validation loss decreased (0.834949 --> 0.834873).  Saving model ...
Updating learning rate to 6.25e-05
tensor(85.7714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9313945 KL Loss: 28.3706024 DSM Loss: 39.6012916 Overall Loss:69.9032882
Validation loss decreased (0.834873 --> 0.834675).  Saving model ...
Updating learning rate to 3.125e-05
tensor(75.8172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.0641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2958, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9251643 KL Loss: 28.4990009 DSM Loss: 38.6045181 Overall Loss:69.0286829
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(85.5162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9516969 KL Loss: 28.6380096 DSM Loss: 38.3908443 Overall Loss:68.9805505
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(57.6095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7556, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9543325 KL Loss: 28.6141210 DSM Loss: 38.4676092 Overall Loss:69.0360624
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(54.5742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6329, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9918000 KL Loss: 28.8826125 DSM Loss: 37.7495122 Overall Loss:68.6239249
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(55.8507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9319788 KL Loss: 28.5994648 DSM Loss: 38.1976714 Overall Loss:68.7291151
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(57.0881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.6385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9434205 KL Loss: 28.5075429 DSM Loss: 37.8108345 Overall Loss:68.2617981
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(63.6003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9203319 KL Loss: 28.4043010 DSM Loss: 38.9187912 Overall Loss:69.2434240
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(69.2154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9603575 KL Loss: 28.6071460 DSM Loss: 38.7723524 Overall Loss:69.3398559
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(56.2887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9214673 KL Loss: 28.4237378 DSM Loss: 38.3068291 Overall Loss:68.6520336
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(83.6338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6710, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9608844 KL Loss: 28.6957728 DSM Loss: 37.9025616 Overall Loss:68.5592188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7517393231391907


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.5730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9322889 KL Loss: 28.7301072 DSM Loss: 46.3871423 Overall Loss:77.0495380
Validation loss decreased (inf --> 0.863684).  Saving model ...
Updating learning rate to 0.0005
tensor(73.8408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(124.8445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9115290 KL Loss: 28.3101575 DSM Loss: 41.2955302 Overall Loss:71.5172166
Validation loss decreased (0.863684 --> 0.862943).  Saving model ...
Updating learning rate to 0.00025
tensor(65.4892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9120697 KL Loss: 28.4276163 DSM Loss: 40.2756641 Overall Loss:70.6153501
Validation loss decreased (0.862943 --> 0.862170).  Saving model ...
Updating learning rate to 0.000125
tensor(81.9972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9049110 KL Loss: 28.5096594 DSM Loss: 38.8457027 Overall Loss:69.2602733
Validation loss decreased (0.862170 --> 0.861289).  Saving model ...
Updating learning rate to 6.25e-05
tensor(72.1301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.1831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9410437 KL Loss: 28.5710002 DSM Loss: 39.3204879 Overall Loss:69.8325318
Validation loss decreased (0.861289 --> 0.860711).  Saving model ...
Updating learning rate to 3.125e-05
tensor(57.1873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9385326 KL Loss: 28.4911098 DSM Loss: 39.4146163 Overall Loss:69.8442585
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(58.0761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4080, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9400241 KL Loss: 28.3924143 DSM Loss: 39.3763413 Overall Loss:69.7087793
Validation loss decreased (0.860711 --> 0.860660).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(60.3343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.7876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4306, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9168597 KL Loss: 28.3743497 DSM Loss: 38.8125348 Overall Loss:69.1037442
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(81.4315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9310, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9610636 KL Loss: 28.7799374 DSM Loss: 39.0027318 Overall Loss:69.7437330
Validation loss decreased (0.860660 --> 0.860609).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(66.3080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.4661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9215359 KL Loss: 28.4421048 DSM Loss: 39.2299761 Overall Loss:69.5936174
Validation loss decreased (0.860609 --> 0.860579).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(89.0147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.7634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.0316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9285196 KL Loss: 28.3486713 DSM Loss: 39.9049703 Overall Loss:70.1821610
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-07
tensor(94.7917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.8818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9554310 KL Loss: 28.7381147 DSM Loss: 38.9944737 Overall Loss:69.6880192
Validation loss decreased (0.860579 --> 0.860563).  Saving model ...
Updating learning rate to 2.44140625e-07
tensor(52.8591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.9868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9246100 KL Loss: 28.4586904 DSM Loss: 39.3447233 Overall Loss:69.7280237
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-07
tensor(61.8282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.1452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4343, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9175619 KL Loss: 28.4229907 DSM Loss: 39.6903325 Overall Loss:70.0308851
Validation loss decreased (0.860563 --> 0.860552).  Saving model ...
Updating learning rate to 6.103515625e-08
tensor(59.3269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.8102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9283427 KL Loss: 28.2969467 DSM Loss: 39.9874525 Overall Loss:70.2127414
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-08
tensor(55.9370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9071, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9335829 KL Loss: 28.5704893 DSM Loss: 39.1447371 Overall Loss:69.6488089
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-08
tensor(73.5489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9134910 KL Loss: 28.4166260 DSM Loss: 39.6307789 Overall Loss:69.9608962
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-09
tensor(78.7956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.2617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9228047 KL Loss: 28.3891019 DSM Loss: 39.5031491 Overall Loss:69.8150559
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-09
tensor(50.7471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.6576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 83 | MSE Loss: 1.9203055 KL Loss: 28.3681670 DSM Loss: 39.1570998 Overall Loss:69.4455723
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(73.0884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 83 | MSE Loss: 1.9258474 KL Loss: 28.3048302 DSM Loss: 39.4250589 Overall Loss:69.6557369
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(57.8224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 83 | MSE Loss: 1.9387489 KL Loss: 28.4522070 DSM Loss: 39.0587665 Overall Loss:69.4497224
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(59.2686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 83 | MSE Loss: 1.9230884 KL Loss: 28.4412383 DSM Loss: 39.4767949 Overall Loss:69.8411215
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(58.1280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.0583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 83 | MSE Loss: 1.9268042 KL Loss: 28.3938626 DSM Loss: 39.1169651 Overall Loss:69.4376320
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(44.7245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 83 | MSE Loss: 1.9046697 KL Loss: 28.2474301 DSM Loss: 39.9209249 Overall Loss:70.0730249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5788577198982239


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(98.7066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.9737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9275670 KL Loss: 28.6570706 DSM Loss: 46.8320428 Overall Loss:77.4166803
Validation loss decreased (inf --> 0.495370).  Saving model ...
Updating learning rate to 0.0005
tensor(55.3100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.5031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9363343 KL Loss: 28.7190837 DSM Loss: 39.4143295 Overall Loss:70.0697479
Validation loss decreased (0.495370 --> 0.495011).  Saving model ...
Updating learning rate to 0.00025
tensor(48.7990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.1992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4919, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9282963 KL Loss: 28.4491631 DSM Loss: 38.9769901 Overall Loss:69.3544491
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(59.0059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9267848 KL Loss: 28.4268893 DSM Loss: 39.4594183 Overall Loss:69.8130921
Validation loss decreased (0.495011 --> 0.494968).  Saving model ...
Updating learning rate to 6.25e-05
tensor(55.8178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.2020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9149451 KL Loss: 28.2498026 DSM Loss: 39.8558357 Overall Loss:70.0205834
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(52.3990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8680, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9114300 KL Loss: 28.4606808 DSM Loss: 38.6279882 Overall Loss:69.0000988
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(52.3167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.4576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9338901 KL Loss: 28.6693102 DSM Loss: 38.9413079 Overall Loss:69.5445084
Validation loss decreased (0.494968 --> 0.494934).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(54.4861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2115, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9653711 KL Loss: 28.7081448 DSM Loss: 38.7268990 Overall Loss:69.4004148
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(71.6377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.4142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(144.7837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9160538 KL Loss: 28.3935184 DSM Loss: 38.9159627 Overall Loss:69.2255347
Validation loss decreased (0.494934 --> 0.494897).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(50.0291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.9852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8976921 KL Loss: 28.3854485 DSM Loss: 39.1684036 Overall Loss:69.4515443
Validation loss decreased (0.494897 --> 0.494879).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(58.4846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9616174 KL Loss: 28.8711409 DSM Loss: 37.7956392 Overall Loss:68.6283971
Validation loss decreased (0.494879 --> 0.494863).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(84.4073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9207109 KL Loss: 28.4783260 DSM Loss: 39.3530536 Overall Loss:69.7520906
Validation loss decreased (0.494863 --> 0.494851).  Saving model ...
Updating learning rate to 2.44140625e-07
tensor(49.4482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1515, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9490592 KL Loss: 28.7004569 DSM Loss: 37.6971665 Overall Loss:68.3466825
Validation loss decreased (0.494851 --> 0.494846).  Saving model ...
Updating learning rate to 1.220703125e-07
tensor(74.1731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9085674 KL Loss: 28.3722539 DSM Loss: 38.9136621 Overall Loss:69.1944835
Validation loss decreased (0.494846 --> 0.494836).  Saving model ...
Updating learning rate to 6.103515625e-08
tensor(72.2151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2319, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9394517 KL Loss: 28.7076581 DSM Loss: 38.7244016 Overall Loss:69.3715115
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-08
tensor(89.3026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9542260 KL Loss: 28.7230527 DSM Loss: 37.6296111 Overall Loss:68.3068896
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-08
tensor(82.8711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9117753 KL Loss: 28.4359214 DSM Loss: 39.1370238 Overall Loss:69.4847205
Validation loss decreased (0.494836 --> 0.494829).  Saving model ...
Updating learning rate to 7.62939453125e-09
tensor(51.2852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4662, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9140259 KL Loss: 28.2725819 DSM Loss: 39.0838196 Overall Loss:69.2704274
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-09
tensor(47.7721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 83 | MSE Loss: 1.9693210 KL Loss: 28.8319056 DSM Loss: 38.8726509 Overall Loss:69.6738773
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(59.1497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4346, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 83 | MSE Loss: 1.9168956 KL Loss: 28.4033495 DSM Loss: 39.0712729 Overall Loss:69.3915179
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-10
tensor(66.9687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 21, Steps: 83 | MSE Loss: 1.9353251 KL Loss: 28.6950502 DSM Loss: 38.0236976 Overall Loss:68.6540729
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-10
tensor(85.9201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 22, Steps: 83 | MSE Loss: 1.9223520 KL Loss: 28.5717180 DSM Loss: 38.9213513 Overall Loss:69.4154214
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-10
tensor(56.0760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 23, Steps: 83 | MSE Loss: 1.9720178 KL Loss: 28.9852111 DSM Loss: 37.4313666 Overall Loss:68.3885958
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078125e-10
tensor(56.0721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.1673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.3304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 24, Steps: 83 | MSE Loss: 1.9346694 KL Loss: 28.7835456 DSM Loss: 37.8535215 Overall Loss:68.5717357
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.960464477539063e-11
tensor(80.0914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 25, Steps: 83 | MSE Loss: 1.8919835 KL Loss: 28.1687839 DSM Loss: 39.2086173 Overall Loss:69.2693845
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.980232238769531e-11
tensor(79.6340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.8429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 26, Steps: 83 | MSE Loss: 1.9329406 KL Loss: 28.5731566 DSM Loss: 38.9016015 Overall Loss:69.4076985
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4901161193847657e-11
tensor(65.0362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 27, Steps: 83 | MSE Loss: 1.8798090 KL Loss: 28.0838223 DSM Loss: 38.9706441 Overall Loss:68.9342752
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6863725781440735


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(97.7841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9055853 KL Loss: 28.4664424 DSM Loss: 47.1363536 Overall Loss:77.5083811
Validation loss decreased (inf --> 1.005289).  Saving model ...
Updating learning rate to 0.0005
tensor(50.9664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9709015 KL Loss: 28.4764512 DSM Loss: 39.5734947 Overall Loss:70.0208472
Validation loss decreased (1.005289 --> 1.000224).  Saving model ...
Updating learning rate to 0.00025
tensor(49.5894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9011202 KL Loss: 28.2651092 DSM Loss: 39.4351940 Overall Loss:69.6014238
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(75.7199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(133.5360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9158179 KL Loss: 28.4402612 DSM Loss: 38.8448399 Overall Loss:69.2009191
Validation loss decreased (1.000224 --> 0.999870).  Saving model ...
Updating learning rate to 6.25e-05
tensor(72.4300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9594846 KL Loss: 28.6190476 DSM Loss: 38.2287010 Overall Loss:68.8072331
Validation loss decreased (0.999870 --> 0.999746).  Saving model ...
Updating learning rate to 3.125e-05
tensor(50.1382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.1875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9178765 KL Loss: 28.2652951 DSM Loss: 38.5926682 Overall Loss:68.7758397
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(60.2923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9159328 KL Loss: 28.4519976 DSM Loss: 38.7026887 Overall Loss:69.0706193
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(61.6822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7215, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9227209 KL Loss: 28.3730236 DSM Loss: 38.0963705 Overall Loss:68.3921148
Validation loss decreased (0.999746 --> 0.999635).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(75.6243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9125145 KL Loss: 28.3746977 DSM Loss: 38.4443698 Overall Loss:68.7315820
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(65.4361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9249561 KL Loss: 28.3902928 DSM Loss: 38.4823070 Overall Loss:68.7975558
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(51.2394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.1947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.9796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9240130 KL Loss: 28.4863425 DSM Loss: 38.4866342 Overall Loss:68.8969897
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(67.6661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8908712 KL Loss: 28.2140658 DSM Loss: 38.5991353 Overall Loss:68.7040721
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(85.3379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9159456 KL Loss: 28.4225441 DSM Loss: 38.1040435 Overall Loss:68.4425331
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(82.9482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8987950 KL Loss: 28.2979526 DSM Loss: 38.1496193 Overall Loss:68.3463666
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(83.6178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.8772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9706962 KL Loss: 28.7227399 DSM Loss: 37.9559482 Overall Loss:68.6493842
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(86.4082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.5728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.8894781 KL Loss: 28.1256381 DSM Loss: 38.7984767 Overall Loss:68.8135932
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(64.8394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9151973 KL Loss: 28.5311173 DSM Loss: 38.1771625 Overall Loss:68.6234775
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(78.7839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7118, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9049441 KL Loss: 28.3397546 DSM Loss: 38.3481833 Overall Loss:68.5928821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8833482265472412


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(143.5115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.7090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.5931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9732716 KL Loss: 28.8277962 DSM Loss: 48.8045088 Overall Loss:79.6055765
Validation loss decreased (inf --> 1.043800).  Saving model ...
Updating learning rate to 0.0005
tensor(82.2819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9801903 KL Loss: 28.5317634 DSM Loss: 40.5205492 Overall Loss:71.0325031
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(57.5397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9002704 KL Loss: 28.0966685 DSM Loss: 39.8558839 Overall Loss:69.8528225
Validation loss decreased (1.043800 --> 1.040399).  Saving model ...
Updating learning rate to 0.000125
tensor(66.1547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9694831 KL Loss: 28.4657048 DSM Loss: 38.3081472 Overall Loss:68.7433352
Validation loss decreased (1.040399 --> 1.037617).  Saving model ...
Updating learning rate to 6.25e-05
tensor(60.9651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9029312 KL Loss: 28.1373793 DSM Loss: 38.4239691 Overall Loss:68.4642795
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(48.6286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.6765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.0068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9523197 KL Loss: 28.3293516 DSM Loss: 37.8845411 Overall Loss:68.1662126
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(55.7974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.3966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9629137 KL Loss: 28.4237750 DSM Loss: 38.2187988 Overall Loss:68.6054877
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(57.2488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7769, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9506607 KL Loss: 28.3297850 DSM Loss: 37.9714893 Overall Loss:68.2519347
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(53.1493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.7069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9053124 KL Loss: 28.2108391 DSM Loss: 38.7022575 Overall Loss:68.8184091
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(58.5471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9331159 KL Loss: 28.2228332 DSM Loss: 38.1402009 Overall Loss:68.2961501
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(69.0415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9002053 KL Loss: 27.9927187 DSM Loss: 38.5330339 Overall Loss:68.4259584
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(63.2113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9217974 KL Loss: 28.2329070 DSM Loss: 37.9943345 Overall Loss:68.1490385
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(77.3223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.7302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9207190 KL Loss: 28.3336301 DSM Loss: 38.1455493 Overall Loss:68.3998986
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(66.8321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.7729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9256666 KL Loss: 28.3027246 DSM Loss: 38.3010216 Overall Loss:68.5294124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9076164364814758


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(117.2890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9379798 KL Loss: 28.5519167 DSM Loss: 44.8590724 Overall Loss:75.3489686
Validation loss decreased (inf --> 0.911195).  Saving model ...
Updating learning rate to 0.0005
tensor(59.6365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.2684, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9372867 KL Loss: 28.5471633 DSM Loss: 38.4121998 Overall Loss:68.8966498
Validation loss decreased (0.911195 --> 0.911021).  Saving model ...
Updating learning rate to 0.00025
tensor(82.7498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9338223 KL Loss: 28.5516079 DSM Loss: 37.4785304 Overall Loss:67.9639603
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(61.3588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9211995 KL Loss: 28.3771563 DSM Loss: 38.3222016 Overall Loss:68.6205579
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(60.4555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1501, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9244176 KL Loss: 28.3844329 DSM Loss: 37.8544213 Overall Loss:68.1632720
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(55.9170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9173794 KL Loss: 28.4421762 DSM Loss: 37.3607423 Overall Loss:67.7202979
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(58.6578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9192862 KL Loss: 28.4886943 DSM Loss: 37.6658711 Overall Loss:68.0738515
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(76.0665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9099438 KL Loss: 28.4265366 DSM Loss: 37.5698729 Overall Loss:67.9063532
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(62.9869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.8641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9027105 KL Loss: 28.3141068 DSM Loss: 38.2770861 Overall Loss:68.4939036
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(68.9269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9108436 KL Loss: 28.3861589 DSM Loss: 37.4818502 Overall Loss:67.7788527
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(61.7434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.3811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9120710 KL Loss: 28.4317544 DSM Loss: 37.4170853 Overall Loss:67.7609109
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(68.6954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9257630 KL Loss: 28.4050251 DSM Loss: 37.8157634 Overall Loss:68.1465512
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.5732436180114746


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(104.3402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9841020 KL Loss: 28.8450349 DSM Loss: 49.8953134 Overall Loss:80.7244504
Validation loss decreased (inf --> 0.550135).  Saving model ...
Updating learning rate to 0.0005
tensor(51.7635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7843, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0017884 KL Loss: 28.5233214 DSM Loss: 40.6547562 Overall Loss:71.1798663
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(83.3721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.0443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9822367 KL Loss: 28.7023300 DSM Loss: 38.6872812 Overall Loss:69.3718476
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(69.2538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.0702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.0025444 KL Loss: 28.6542195 DSM Loss: 39.6767532 Overall Loss:70.3335171
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(47.3280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.8251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9294148 KL Loss: 28.3875511 DSM Loss: 39.0551754 Overall Loss:69.3721413
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(49.6063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.3264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9621928 KL Loss: 28.8596633 DSM Loss: 38.2640906 Overall Loss:69.0859469
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(59.3953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(136.2014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8846709 KL Loss: 28.0422457 DSM Loss: 40.1830920 Overall Loss:70.1100089
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(54.4064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(139.6592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9418304 KL Loss: 28.7497082 DSM Loss: 38.5930084 Overall Loss:69.2845465
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(96.8187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9662, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9164873 KL Loss: 28.3052733 DSM Loss: 39.3709930 Overall Loss:69.5927537
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(75.4470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.5651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9275816 KL Loss: 28.6217127 DSM Loss: 39.3946241 Overall Loss:69.9439182
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(54.1754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.0812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9366858 KL Loss: 28.5214581 DSM Loss: 39.6668008 Overall Loss:70.1249447
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7735752463340759


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(98.9775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.3690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9736031 KL Loss: 28.5973129 DSM Loss: 45.5279085 Overall Loss:76.0988245
Validation loss decreased (inf --> 1.088233).  Saving model ...
Updating learning rate to 0.0005
tensor(79.4794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9300314 KL Loss: 28.4618856 DSM Loss: 40.1270147 Overall Loss:70.5189317
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(43.6826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9438560 KL Loss: 28.4287319 DSM Loss: 39.9316485 Overall Loss:70.3042358
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(81.8513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.4683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9500228 KL Loss: 28.5703799 DSM Loss: 39.1451951 Overall Loss:69.6655981
Validation loss decreased (1.088233 --> 1.087790).  Saving model ...
Updating learning rate to 6.25e-05
tensor(39.7498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9025960 KL Loss: 28.2933622 DSM Loss: 39.3799675 Overall Loss:69.5759257
Validation loss decreased (1.087790 --> 1.085128).  Saving model ...
Updating learning rate to 3.125e-05
tensor(61.1208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9341598 KL Loss: 28.4536810 DSM Loss: 38.8294865 Overall Loss:69.2173274
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(116.5761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.4005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6573, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9230800 KL Loss: 28.4056995 DSM Loss: 38.6292287 Overall Loss:68.9580083
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(81.3929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9848, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8962611 KL Loss: 28.1736893 DSM Loss: 39.5730228 Overall Loss:69.6429732
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(71.8746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9091558 KL Loss: 28.2914163 DSM Loss: 39.2388665 Overall Loss:69.4394390
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(89.4531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9128512 KL Loss: 28.3207278 DSM Loss: 38.8257199 Overall Loss:69.0592991
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(71.9712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.1066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9194698 KL Loss: 28.3234747 DSM Loss: 39.2705140 Overall Loss:69.5134585
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(67.2083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2686, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9259440 KL Loss: 28.4616246 DSM Loss: 38.5657102 Overall Loss:68.9532789
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(61.4024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9221548 KL Loss: 28.5620588 DSM Loss: 38.3719246 Overall Loss:68.8561382
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(84.5525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0452, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9135845 KL Loss: 28.3027732 DSM Loss: 39.1125078 Overall Loss:69.3288653
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(46.7847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9207746 KL Loss: 28.4396841 DSM Loss: 38.5913363 Overall Loss:68.9517945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5530368089675903


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(116.0320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.8275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0196953 KL Loss: 28.8353467 DSM Loss: 44.0554554 Overall Loss:74.9104970
Validation loss decreased (inf --> 0.580688).  Saving model ...
Updating learning rate to 0.0005
tensor(51.9294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.5899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.0168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0063209 KL Loss: 28.7195441 DSM Loss: 38.5544038 Overall Loss:69.2802686
Validation loss decreased (0.580688 --> 0.579486).  Saving model ...
Updating learning rate to 0.00025
tensor(117.7486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9217171 KL Loss: 28.3237800 DSM Loss: 39.1403390 Overall Loss:69.3858363
Validation loss decreased (0.579486 --> 0.577514).  Saving model ...
Updating learning rate to 0.000125
tensor(53.6292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.5503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.1033, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9466413 KL Loss: 28.4171291 DSM Loss: 38.6392165 Overall Loss:69.0029869
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(54.7640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.4003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8542, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9275841 KL Loss: 28.2230353 DSM Loss: 38.5174053 Overall Loss:68.6680249
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(81.9118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0188, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9015631 KL Loss: 28.3696724 DSM Loss: 38.5896057 Overall Loss:68.8608409
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(104.0558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9083640 KL Loss: 28.4881885 DSM Loss: 38.5523875 Overall Loss:68.9489400
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(57.9819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1486, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9393326 KL Loss: 28.6122930 DSM Loss: 38.2259543 Overall Loss:68.7775796
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(89.5008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9107283 KL Loss: 28.2371376 DSM Loss: 38.1759188 Overall Loss:68.3237844
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(90.1275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.2373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8843624 KL Loss: 28.1732562 DSM Loss: 39.2273226 Overall Loss:69.2849411
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(47.2097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9351735 KL Loss: 28.5098323 DSM Loss: 38.1670638 Overall Loss:68.6120696
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(67.5593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.0365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9169355 KL Loss: 28.3414625 DSM Loss: 39.0517858 Overall Loss:69.3101840
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(83.6324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9386535 KL Loss: 28.6286797 DSM Loss: 38.2967490 Overall Loss:68.8640821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.69541335105896


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(103.1290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9057753 KL Loss: 28.3899378 DSM Loss: 42.0801554 Overall Loss:72.3758691
Validation loss decreased (inf --> 1.957120).  Saving model ...
Updating learning rate to 0.0005
tensor(63.2956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9639837 KL Loss: 28.5131603 DSM Loss: 36.8177685 Overall Loss:67.2949125
Validation loss decreased (1.957120 --> 1.955436).  Saving model ...
Updating learning rate to 0.00025
tensor(54.4066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.1904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9283292 KL Loss: 28.4864641 DSM Loss: 36.6228189 Overall Loss:67.0376123
Validation loss decreased (1.955436 --> 1.952559).  Saving model ...
Updating learning rate to 0.000125
tensor(72.5975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8905654 KL Loss: 28.2790762 DSM Loss: 37.0558088 Overall Loss:67.2254505
Validation loss decreased (1.952559 --> 1.951639).  Saving model ...
Updating learning rate to 6.25e-05
tensor(52.1703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.7729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9334546 KL Loss: 28.4667604 DSM Loss: 36.9090948 Overall Loss:67.3093095
Validation loss decreased (1.951639 --> 1.948343).  Saving model ...
Updating learning rate to 3.125e-05
tensor(56.8186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1580, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9162459 KL Loss: 28.3554266 DSM Loss: 36.4348565 Overall Loss:66.7065295
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(53.1521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9145656 KL Loss: 28.4603388 DSM Loss: 36.8115968 Overall Loss:67.1865011
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(61.8498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9416034 KL Loss: 28.6904854 DSM Loss: 36.3670348 Overall Loss:66.9991234
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(59.5801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9180149 KL Loss: 28.3698367 DSM Loss: 36.7607623 Overall Loss:67.0486139
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(71.3092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9160428 KL Loss: 28.3810163 DSM Loss: 36.7562344 Overall Loss:67.0532934
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(62.4894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8832363 KL Loss: 28.2358768 DSM Loss: 36.5958298 Overall Loss:66.7149428
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(77.4784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9185532 KL Loss: 28.3853738 DSM Loss: 37.0238218 Overall Loss:67.3277485
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(72.2021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9032651 KL Loss: 28.4111723 DSM Loss: 36.8771786 Overall Loss:67.1916162
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(89.6888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9123296 KL Loss: 28.3424798 DSM Loss: 36.5789825 Overall Loss:66.8337918
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(57.6092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9150589 KL Loss: 28.3395812 DSM Loss: 36.7194799 Overall Loss:66.9741199
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2642345428466797


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(108.1472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.3793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9441213 KL Loss: 28.3755686 DSM Loss: 46.0146511 Overall Loss:76.3343413
Validation loss decreased (inf --> 1.315386).  Saving model ...
Updating learning rate to 0.0005
tensor(83.3961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6875, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9165665 KL Loss: 28.3454916 DSM Loss: 39.4079310 Overall Loss:69.6699888
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(81.4419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9211042 KL Loss: 28.3667141 DSM Loss: 39.0817962 Overall Loss:69.3696143
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(68.4289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.6011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9197601 KL Loss: 28.3712913 DSM Loss: 38.2909283 Overall Loss:68.5819799
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(60.0754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.9549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9279369 KL Loss: 28.4376494 DSM Loss: 38.5338968 Overall Loss:68.8994833
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(58.4104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.3569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8919591 KL Loss: 28.2593586 DSM Loss: 38.5281067 Overall Loss:68.6794245
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(63.1055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.2256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9025487 KL Loss: 28.4945392 DSM Loss: 38.2097451 Overall Loss:68.6068333
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(63.5190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9364766 KL Loss: 28.6224690 DSM Loss: 37.8585476 Overall Loss:68.4174929
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(71.2730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.0739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1463, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9286394 KL Loss: 28.4896293 DSM Loss: 37.9999679 Overall Loss:68.4182361
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(65.5942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9310893 KL Loss: 28.6300025 DSM Loss: 37.8258047 Overall Loss:68.3868964
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(63.4056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9242667 KL Loss: 28.1905390 DSM Loss: 38.1936024 Overall Loss:68.3084074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.3438524007797241


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(99.8684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.9703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0258161 KL Loss: 29.0300326 DSM Loss: 50.7913177 Overall Loss:81.8471666
Validation loss decreased (inf --> 1.393297).  Saving model ...
Updating learning rate to 0.0005
tensor(71.6201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0848, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0054030 KL Loss: 28.5912573 DSM Loss: 40.8964781 Overall Loss:71.4931381
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(61.3410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9526329 KL Loss: 28.6625305 DSM Loss: 39.2461337 Overall Loss:69.8612973
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(57.4836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.2650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.4199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9729241 KL Loss: 28.6112635 DSM Loss: 39.4234751 Overall Loss:70.0076626
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(61.3733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.8637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.7355, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9840699 KL Loss: 28.7134563 DSM Loss: 39.0776557 Overall Loss:69.7751817
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(59.1205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9474513 KL Loss: 28.5301568 DSM Loss: 39.2910805 Overall Loss:69.7686882
Validation loss decreased (1.393297 --> 1.393271).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(57.5766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.9482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9068322 KL Loss: 28.3205541 DSM Loss: 39.1831996 Overall Loss:69.4105860
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(86.8188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9093288 KL Loss: 28.2848485 DSM Loss: 39.4421794 Overall Loss:69.6363569
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(74.4895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.7957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3710, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9177903 KL Loss: 28.2985382 DSM Loss: 39.6888166 Overall Loss:69.9051452
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(64.6632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9322447 KL Loss: 28.6517201 DSM Loss: 39.2303391 Overall Loss:69.8143036
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(62.2296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9245222 KL Loss: 28.5198695 DSM Loss: 39.3838123 Overall Loss:69.8282044
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(67.9909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9430251 KL Loss: 28.5904207 DSM Loss: 39.1645960 Overall Loss:69.6980418
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(82.3681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9171574 KL Loss: 28.3863757 DSM Loss: 39.6972501 Overall Loss:70.0007835
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(64.5227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.9591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8913596 KL Loss: 28.4162881 DSM Loss: 39.4877656 Overall Loss:69.7954130
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(76.3078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9321219 KL Loss: 28.5926459 DSM Loss: 38.9628097 Overall Loss:69.4875775
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(60.0884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9453391 KL Loss: 28.5361989 DSM Loss: 39.0894676 Overall Loss:69.5710055
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.4689958095550537


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(126.8578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.9637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9586182 KL Loss: 28.6256900 DSM Loss: 43.4313453 Overall Loss:74.0156534
Validation loss decreased (inf --> 1.898018).  Saving model ...
Updating learning rate to 0.0005
tensor(77.1746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7252, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9307777 KL Loss: 28.4028918 DSM Loss: 38.8083934 Overall Loss:69.1420626
Validation loss decreased (1.898018 --> 1.879632).  Saving model ...
Updating learning rate to 0.00025
tensor(82.0394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9457394 KL Loss: 28.5783611 DSM Loss: 38.0811291 Overall Loss:68.6052298
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(54.8308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9236064 KL Loss: 28.3719914 DSM Loss: 38.5194744 Overall Loss:68.8150723
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(87.2233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9295702 KL Loss: 28.3476592 DSM Loss: 38.5454070 Overall Loss:68.8226364
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(61.7320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3805, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9310100 KL Loss: 28.4545051 DSM Loss: 38.2229279 Overall Loss:68.6084429
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(79.1680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9606395 KL Loss: 28.5702166 DSM Loss: 37.8183251 Overall Loss:68.3491813
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(81.6584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.3170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9349867 KL Loss: 28.4843393 DSM Loss: 38.4782142 Overall Loss:68.8975401
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(81.9329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9053164 KL Loss: 28.3234844 DSM Loss: 38.5063325 Overall Loss:68.7351329
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(87.1288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.4177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9308491 KL Loss: 28.5682663 DSM Loss: 37.8308811 Overall Loss:68.3299966
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(85.6995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9584109 KL Loss: 28.8171289 DSM Loss: 37.2730618 Overall Loss:68.0486018
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(74.1526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.1506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9344776 KL Loss: 28.5352310 DSM Loss: 37.6652946 Overall Loss:68.1350031
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5678961277008057


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(131.1729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.0608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0136622 KL Loss: 28.7306064 DSM Loss: 44.2028557 Overall Loss:74.9471243
Validation loss decreased (inf --> 0.660344).  Saving model ...
Updating learning rate to 0.0005
tensor(53.0564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.9942, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9531756 KL Loss: 28.3931578 DSM Loss: 40.2437791 Overall Loss:70.5901122
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(57.2978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9576300 KL Loss: 28.7215984 DSM Loss: 38.8235014 Overall Loss:69.5027295
Validation loss decreased (0.660344 --> 0.658981).  Saving model ...
Updating learning rate to 0.000125
tensor(86.6944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.3742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9024137 KL Loss: 28.2278523 DSM Loss: 39.6600816 Overall Loss:69.7903476
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(56.2448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.2160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9090198 KL Loss: 28.3240772 DSM Loss: 38.9578427 Overall Loss:69.1909398
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(138.8556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.2333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8966909 KL Loss: 28.5135135 DSM Loss: 38.9756678 Overall Loss:69.3858725
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(56.0756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9471193 KL Loss: 28.6146800 DSM Loss: 38.3797844 Overall Loss:68.9415839
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(50.8086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.8455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9279957 KL Loss: 28.4437428 DSM Loss: 38.8547295 Overall Loss:69.2264681
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(48.9643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9088011 KL Loss: 28.3705710 DSM Loss: 38.9705517 Overall Loss:69.2499240
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(46.9462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9461896 KL Loss: 28.7856802 DSM Loss: 37.9751657 Overall Loss:68.7070356
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(52.7111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9561423 KL Loss: 28.7005008 DSM Loss: 37.9865680 Overall Loss:68.6432108
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(90.5293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9047071 KL Loss: 28.4217351 DSM Loss: 38.1647916 Overall Loss:68.4912337
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(58.7793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.1556, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9423361 KL Loss: 28.4459721 DSM Loss: 38.6861922 Overall Loss:69.0745003
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6624591946601868


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(111.7549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.4076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9990258 KL Loss: 28.7110258 DSM Loss: 46.4042767 Overall Loss:77.1143282
Validation loss decreased (inf --> 1.412094).  Saving model ...
Updating learning rate to 0.0005
tensor(64.6636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.6797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.3981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9670549 KL Loss: 28.5236463 DSM Loss: 40.1704195 Overall Loss:70.6611205
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(80.2831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.6453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9324120 KL Loss: 28.4468051 DSM Loss: 39.1766574 Overall Loss:69.5558743
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(54.6423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9493826 KL Loss: 28.5279602 DSM Loss: 38.7519857 Overall Loss:69.2293282
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(58.7738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9089714 KL Loss: 28.3296273 DSM Loss: 39.3874915 Overall Loss:69.6260900
Validation loss decreased (1.412094 --> 1.411763).  Saving model ...
Updating learning rate to 3.125e-05
tensor(53.8065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8957321 KL Loss: 28.2981837 DSM Loss: 39.1025298 Overall Loss:69.2964458
Validation loss decreased (1.411763 --> 1.411292).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(65.1746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7884, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9162179 KL Loss: 28.4525635 DSM Loss: 39.0023673 Overall Loss:69.3711487
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(67.0811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.4054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9293772 KL Loss: 28.4568600 DSM Loss: 38.5181817 Overall Loss:68.9044189
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(67.0823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9011478 KL Loss: 28.3221115 DSM Loss: 38.9331901 Overall Loss:69.1564493
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(53.6046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6692, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9144078 KL Loss: 28.5050582 DSM Loss: 38.8571111 Overall Loss:69.2765769
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(74.1135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9013454 KL Loss: 28.2850883 DSM Loss: 39.1132278 Overall Loss:69.2996617
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(77.0527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9208314 KL Loss: 28.4855669 DSM Loss: 38.4760983 Overall Loss:68.8824967
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(73.8423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9228355 KL Loss: 28.5531382 DSM Loss: 38.3735813 Overall Loss:68.8495548
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(58.3827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.2356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9303431 KL Loss: 28.5618274 DSM Loss: 38.9929993 Overall Loss:69.4851696
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(69.4511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5657, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9509947 KL Loss: 28.7891590 DSM Loss: 38.4918592 Overall Loss:69.2320127
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(62.7590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9079634 KL Loss: 28.4936872 DSM Loss: 38.8862031 Overall Loss:69.2878537
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9750515222549438


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(110.2366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.3583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9522091 KL Loss: 28.6749702 DSM Loss: 55.2672163 Overall Loss:85.8943956
Validation loss decreased (inf --> 0.892452).  Saving model ...
Updating learning rate to 0.0005
tensor(66.3785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9719874 KL Loss: 28.5964192 DSM Loss: 39.2214573 Overall Loss:69.7898636
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(57.1978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9822, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9852168 KL Loss: 28.6896991 DSM Loss: 38.6878811 Overall Loss:69.3627968
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(63.1809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0657, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9553526 KL Loss: 28.4811059 DSM Loss: 38.4329002 Overall Loss:68.8693585
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(65.5637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9422040 KL Loss: 28.4690710 DSM Loss: 38.5138974 Overall Loss:68.9251726
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(76.6534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0406, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9392240 KL Loss: 28.4094092 DSM Loss: 38.6024734 Overall Loss:68.9511062
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(67.2849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9422041 KL Loss: 28.3658469 DSM Loss: 38.6640566 Overall Loss:68.9721074
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(62.4290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9642358 KL Loss: 28.6438008 DSM Loss: 37.5714861 Overall Loss:68.1795224
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(83.1511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9389716 KL Loss: 28.4584624 DSM Loss: 38.4052192 Overall Loss:68.8026532
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(74.6124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9194045 KL Loss: 28.3901862 DSM Loss: 38.5550335 Overall Loss:68.8646243
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(69.6616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0279, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9491644 KL Loss: 28.5666683 DSM Loss: 37.9929684 Overall Loss:68.5088008
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.6189602613449097


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(88.9800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9430013 KL Loss: 28.4936954 DSM Loss: 43.2340488 Overall Loss:73.6707458
Validation loss decreased (inf --> 1.547759).  Saving model ...
Updating learning rate to 0.0005
tensor(100.7771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.5963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9043995 KL Loss: 28.1886508 DSM Loss: 38.8663987 Overall Loss:68.9594489
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(53.7394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.6269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9355001 KL Loss: 28.4685318 DSM Loss: 38.6505436 Overall Loss:69.0545753
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(47.5441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8845163 KL Loss: 28.2395762 DSM Loss: 37.9572988 Overall Loss:68.0813913
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(59.3662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9260783 KL Loss: 28.5611652 DSM Loss: 37.9216671 Overall Loss:68.4089106
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(51.1585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3239, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9385539 KL Loss: 28.4490433 DSM Loss: 38.4579136 Overall Loss:68.8455105
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(49.2932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2018, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9268185 KL Loss: 28.4904292 DSM Loss: 36.8131562 Overall Loss:67.2304034
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(64.8793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8967515 KL Loss: 28.1539979 DSM Loss: 37.8490195 Overall Loss:67.8997686
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(54.0690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8972874 KL Loss: 28.5181043 DSM Loss: 37.3733501 Overall Loss:67.7887415
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(87.8286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8865837 KL Loss: 28.1133770 DSM Loss: 37.6771907 Overall Loss:67.6771511
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(58.4674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9241436 KL Loss: 28.5555193 DSM Loss: 37.4803517 Overall Loss:67.9600148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6260144114494324


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(108.0108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9342195 KL Loss: 28.5108979 DSM Loss: 47.9705664 Overall Loss:78.4156840
Validation loss decreased (inf --> 1.068847).  Saving model ...
Updating learning rate to 0.0005
tensor(69.7442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.9393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9428818 KL Loss: 28.4345950 DSM Loss: 39.6964588 Overall Loss:70.0739356
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(61.9586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.4922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9727425 KL Loss: 28.5392375 DSM Loss: 39.0192383 Overall Loss:69.5312186
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(93.3643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9536917 KL Loss: 28.4291829 DSM Loss: 38.4065133 Overall Loss:68.7893879
Validation loss decreased (1.068847 --> 1.068760).  Saving model ...
Updating learning rate to 6.25e-05
tensor(48.5527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.3461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9215822 KL Loss: 28.4705511 DSM Loss: 38.9061728 Overall Loss:69.2983060
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(89.4258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9444618 KL Loss: 28.3743499 DSM Loss: 38.1554323 Overall Loss:68.4742443
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(112.4116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.2327, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9245458 KL Loss: 28.4616689 DSM Loss: 38.2977994 Overall Loss:68.6840146
Validation loss decreased (1.068760 --> 1.068552).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(47.4983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.8125, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9361426 KL Loss: 28.3735384 DSM Loss: 38.7420512 Overall Loss:69.0517319
Validation loss decreased (1.068552 --> 1.068498).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(57.2311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9035868 KL Loss: 28.1339565 DSM Loss: 38.6295431 Overall Loss:68.6670864
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(58.7291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.8029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9149833 KL Loss: 28.2732841 DSM Loss: 38.6403723 Overall Loss:68.8286398
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(78.9584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9271951 KL Loss: 28.4779228 DSM Loss: 38.1761765 Overall Loss:68.5812947
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(89.8100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.6212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9184010 KL Loss: 28.3947198 DSM Loss: 37.7968485 Overall Loss:68.1099692
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(56.9965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9210552 KL Loss: 28.4747134 DSM Loss: 38.6065759 Overall Loss:69.0023446
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(59.9100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.1309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9176734 KL Loss: 28.2342717 DSM Loss: 37.9760174 Overall Loss:68.1279625
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(61.4499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4636, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9276572 KL Loss: 28.4422318 DSM Loss: 38.2057428 Overall Loss:68.5756320
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(46.7735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.8202, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9421967 KL Loss: 28.5339853 DSM Loss: 37.7679060 Overall Loss:68.2440878
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(58.4119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9186089 KL Loss: 28.2386386 DSM Loss: 38.1812158 Overall Loss:68.3384631
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(43.6572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.8747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9083860 KL Loss: 28.1668610 DSM Loss: 38.5810739 Overall Loss:68.6563208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.73233962059021


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(106.3117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9382602 KL Loss: 28.5185769 DSM Loss: 47.6944203 Overall Loss:78.1512572
Validation loss decreased (inf --> 0.714340).  Saving model ...
Updating learning rate to 0.0005
tensor(76.1584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.4168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.6435, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9498498 KL Loss: 28.4507775 DSM Loss: 40.5063863 Overall Loss:70.9070139
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(65.7186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.5529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9228430 KL Loss: 28.2571280 DSM Loss: 39.8295030 Overall Loss:70.0094740
Validation loss decreased (0.714340 --> 0.714162).  Saving model ...
Updating learning rate to 0.000125
tensor(68.2407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.2155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9361681 KL Loss: 28.5883113 DSM Loss: 38.3654637 Overall Loss:68.8899429
Validation loss decreased (0.714162 --> 0.713468).  Saving model ...
Updating learning rate to 6.25e-05
tensor(77.9887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.8673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9546751 KL Loss: 28.6205410 DSM Loss: 38.0069093 Overall Loss:68.5821255
Validation loss decreased (0.713468 --> 0.713172).  Saving model ...
Updating learning rate to 3.125e-05
tensor(66.2771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.8429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9153, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9510217 KL Loss: 28.3465738 DSM Loss: 38.2082418 Overall Loss:68.5058373
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(61.3841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.6266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9538712 KL Loss: 28.6103614 DSM Loss: 37.9688222 Overall Loss:68.5330545
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(66.3318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2996, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9303727 KL Loss: 28.3360297 DSM Loss: 38.2510683 Overall Loss:68.5174707
Validation loss decreased (0.713172 --> 0.713105).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(54.6464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9111712 KL Loss: 28.3054256 DSM Loss: 38.3610125 Overall Loss:68.5776090
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(66.2941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9152959 KL Loss: 28.4948247 DSM Loss: 37.9871038 Overall Loss:68.3972243
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(74.6946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5271, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9264881 KL Loss: 28.5538807 DSM Loss: 38.3959354 Overall Loss:68.8763044
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(100.1978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.8000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9260152 KL Loss: 28.4599535 DSM Loss: 38.4110696 Overall Loss:68.7970377
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(76.2877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.3497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.7593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9345900 KL Loss: 28.6715409 DSM Loss: 37.7619352 Overall Loss:68.3680660
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(57.9044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9013186 KL Loss: 28.2726729 DSM Loss: 38.3125819 Overall Loss:68.4865734
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(58.0994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.9503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9152786 KL Loss: 28.2204922 DSM Loss: 39.1644344 Overall Loss:69.3002053
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(55.6967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.6405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9117167 KL Loss: 28.2213436 DSM Loss: 38.5301827 Overall Loss:68.6632430
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(60.2538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 1.9157557 KL Loss: 28.4396791 DSM Loss: 38.4316327 Overall Loss:68.7870676
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(68.7333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 1.9123341 KL Loss: 28.3459071 DSM Loss: 38.9438118 Overall Loss:69.2020526
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7859742641448975


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(93.1061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.1886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9345317 KL Loss: 28.5694887 DSM Loss: 44.3575840 Overall Loss:74.8616042
Validation loss decreased (inf --> 1.133566).  Saving model ...
Updating learning rate to 0.0005
tensor(105.3903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.7923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9310079 KL Loss: 28.3913463 DSM Loss: 38.5599862 Overall Loss:68.8823405
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(47.9465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9362345 KL Loss: 28.3763112 DSM Loss: 38.6305273 Overall Loss:68.9430732
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(56.5306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4169, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9957889 KL Loss: 28.5319798 DSM Loss: 37.5781802 Overall Loss:68.1059490
Validation loss decreased (1.133566 --> 1.128703).  Saving model ...
Updating learning rate to 6.25e-05
tensor(88.1958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9660198 KL Loss: 28.2853586 DSM Loss: 37.3029712 Overall Loss:67.5543500
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(68.0994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8942168 KL Loss: 28.2083046 DSM Loss: 37.9601148 Overall Loss:68.0626358
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(72.8313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8971725 KL Loss: 28.1320105 DSM Loss: 38.1729065 Overall Loss:68.2020891
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(55.8236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.9556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8860598 KL Loss: 28.1236270 DSM Loss: 38.0505330 Overall Loss:68.0602197
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(71.0162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9153189 KL Loss: 28.2308844 DSM Loss: 38.2911800 Overall Loss:68.4373834
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(77.1158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9193894 KL Loss: 28.2464763 DSM Loss: 38.3177350 Overall Loss:68.4836008
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(80.7236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9430865 KL Loss: 28.6453628 DSM Loss: 37.3338398 Overall Loss:67.9222885
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(69.8645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9202285 KL Loss: 28.3895219 DSM Loss: 37.6034446 Overall Loss:67.9131953
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(41.4294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9039746 KL Loss: 28.3864195 DSM Loss: 38.1196425 Overall Loss:68.4100364
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(46.9918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.9222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8967396 KL Loss: 28.1023590 DSM Loss: 38.3228750 Overall Loss:68.3219735
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.0007210969924927
      Ticker       MSE StdDev
0   AAPL_pct  0.858013    0.0
1   ABBV_pct  0.567124    0.0
2    AEP_pct  1.130908    0.0
3   AMGN_pct  0.701985    0.0
4   AMZN_pct  1.778192    0.0
..       ...       ...    ...
66    VZ_pct   1.61896    0.0
67     V_pct  0.626014    0.0
68   WFC_pct   0.73234    0.0
69   WMT_pct  0.785974    0.0
70   XOM_pct  1.000721    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=10, prediction_length=60, root_path='data/EcmP_stock_L_2016_24_spec_official_dva_spec', scale=0.1, sequence_length=60, target_dim=1, train_epochs=30, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(201.9311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.9079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0543815 KL Loss: 43.0073256 DSM Loss: 67.4073759 Overall Loss:112.4690833
Validation loss decreased (inf --> 0.810502).  Saving model ...
Updating learning rate to 0.0005
tensor(84.8948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.3589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9987983 KL Loss: 42.8382029 DSM Loss: 59.1969986 Overall Loss:104.0339995
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(100.9985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.7925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9541717 KL Loss: 42.6121229 DSM Loss: 58.7324480 Overall Loss:103.2987428
Validation loss decreased (0.810502 --> 0.810316).  Saving model ...
Updating learning rate to 0.000125
tensor(117.4205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.9250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9721846 KL Loss: 42.8857708 DSM Loss: 58.0622534 Overall Loss:102.9202085
Validation loss decreased (0.810316 --> 0.808543).  Saving model ...
Updating learning rate to 6.25e-05
tensor(96.3269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.3058, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9385381 KL Loss: 42.5503040 DSM Loss: 58.0787729 Overall Loss:102.5676151
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(89.7889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9588719 KL Loss: 42.8138900 DSM Loss: 57.2375330 Overall Loss:102.0102953
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(87.5784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.8036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9553034 KL Loss: 42.7794654 DSM Loss: 57.8948100 Overall Loss:102.6295791
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(99.1244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9717647 KL Loss: 42.6468195 DSM Loss: 57.6417197 Overall Loss:102.2603038
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(90.4432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.2670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 80 | MSE Loss: 1.9684517 KL Loss: 42.9208685 DSM Loss: 57.2176708 Overall Loss:102.1069905
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(82.5806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.5787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 80 | MSE Loss: 1.9407497 KL Loss: 42.6491682 DSM Loss: 58.1119726 Overall Loss:102.7018905
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(97.8624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.3889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 80 | MSE Loss: 1.9600292 KL Loss: 42.6251381 DSM Loss: 58.3334960 Overall Loss:102.9186627
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(143.5212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.7397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 80 | MSE Loss: 1.9389790 KL Loss: 42.4167342 DSM Loss: 57.8616116 Overall Loss:102.2173248
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(92.4976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.2578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 80 | MSE Loss: 1.9594326 KL Loss: 42.8791574 DSM Loss: 58.0891523 Overall Loss:102.9277422
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(89.0211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.1307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 80 | MSE Loss: 1.9561266 KL Loss: 42.6330241 DSM Loss: 58.3958760 Overall Loss:102.9850269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8634956479072571


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_spec_official_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(156.4264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(132.0263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0082012 KL Loss: 42.9093470 DSM Loss: 67.7505908 Overall Loss:112.6681383
Validation loss decreased (inf --> 0.446410).  Saving model ...
Updating learning rate to 0.0005
tensor(107.8508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.0062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9921157 KL Loss: 42.6891589 DSM Loss: 57.8536764 Overall Loss:102.5349504
Validation loss decreased (0.446410 --> 0.440643).  Saving model ...
Updating learning rate to 0.00025
tensor(91.0501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9527009 KL Loss: 42.4819479 DSM Loss: 57.8329596 Overall Loss:102.2676083
Validation loss decreased (0.440643 --> 0.438639).  Saving model ...
Updating learning rate to 0.000125
tensor(82.5771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9520579 KL Loss: 42.6217752 DSM Loss: 56.8385540 Overall Loss:101.4123875
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(109.0612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.2424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9414282 KL Loss: 42.6196517 DSM Loss: 56.4017382 Overall Loss:100.9628180
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(102.2291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.1801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9603690 KL Loss: 42.5687734 DSM Loss: 56.5890173 Overall Loss:101.1181599
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(89.2545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(131.7665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9417991 KL Loss: 42.6079355 DSM Loss: 56.4520801 Overall Loss:101.0018145
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(104.8655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.8741, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9421986 KL Loss: 42.4300744 DSM Loss: 56.2855232 Overall Loss:100.6577963
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(94.8538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0215, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 80 | MSE Loss: 1.9420001 KL Loss: 42.5231904 DSM Loss: 56.6415610 Overall Loss:101.1067517
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(123.0321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.4819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 80 | MSE Loss: 1.9214995 KL Loss: 42.3878994 DSM Loss: 56.7356574 Overall Loss:101.0450565
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(93.9586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(129.4956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 80 | MSE Loss: 1.9451695 KL Loss: 42.6684338 DSM Loss: 56.1175528 Overall Loss:100.7311559
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(105.6488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.9209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 80 | MSE Loss: 1.9377054 KL Loss: 42.6351202 DSM Loss: 55.9940485 Overall Loss:100.5668741
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
