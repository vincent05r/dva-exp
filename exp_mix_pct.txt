Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=9, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=10, root_path='data/EcmP_stock_L_2016_24_mix', scale=0.1, sequence_length=10, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(39.8719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8032180 KL Loss: 7.1802443 DSM Loss: 11.6816965 Overall Loss:20.6651588
Validation loss decreased (inf --> 0.971852).  Saving model ...
Updating learning rate to 0.0005
tensor(18.0045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8793311 KL Loss: 7.2974233 DSM Loss: 9.6380446 Overall Loss:18.8147990
Validation loss decreased (0.971852 --> 0.955609).  Saving model ...
Updating learning rate to 0.00025
tensor(23.3980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6098, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7179237 KL Loss: 7.0783275 DSM Loss: 9.6793297 Overall Loss:18.4755808
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(13.0739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8132045 KL Loss: 7.2460467 DSM Loss: 9.3700413 Overall Loss:18.4292925
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8605286478996277


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.7946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7052, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8489355 KL Loss: 7.2725606 DSM Loss: 11.3836397 Overall Loss:20.5051360
Validation loss decreased (inf --> 0.586914).  Saving model ...
Updating learning rate to 0.0005
tensor(15.2053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7782805 KL Loss: 7.2063588 DSM Loss: 9.7081551 Overall Loss:18.6927944
Validation loss decreased (0.586914 --> 0.576850).  Saving model ...
Updating learning rate to 0.00025
tensor(16.6963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0509, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8227710 KL Loss: 7.2349404 DSM Loss: 9.6232173 Overall Loss:18.6809287
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(26.3653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8104756 KL Loss: 7.2042406 DSM Loss: 9.3013143 Overall Loss:18.3160306
Validation loss decreased (0.576850 --> 0.576736).  Saving model ...
Updating learning rate to 6.25e-05
tensor(15.8528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7329271 KL Loss: 7.1311344 DSM Loss: 9.3273807 Overall Loss:18.1914422
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(14.7970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7850332 KL Loss: 7.2851609 DSM Loss: 9.0864881 Overall Loss:18.1566822
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5604916214942932


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.8074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4224, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8376434 KL Loss: 7.2638786 DSM Loss: 11.9293061 Overall Loss:21.0308282
Validation loss decreased (inf --> 0.654382).  Saving model ...
Updating learning rate to 0.0005
tensor(15.8571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8024598 KL Loss: 7.2009937 DSM Loss: 10.0358169 Overall Loss:19.0392702
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(14.3949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7524663 KL Loss: 7.1484656 DSM Loss: 9.9367373 Overall Loss:18.8376692
Validation loss decreased (0.654382 --> 0.653378).  Saving model ...
Updating learning rate to 0.000125
tensor(15.8716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7627378 KL Loss: 7.1733888 DSM Loss: 9.7737376 Overall Loss:18.7098640
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(15.2350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8187494 KL Loss: 7.2528861 DSM Loss: 9.4838536 Overall Loss:18.5554892
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1467210054397583


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.3956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8694537 KL Loss: 7.3177322 DSM Loss: 13.0433096 Overall Loss:22.2304954
Validation loss decreased (inf --> 0.626546).  Saving model ...
Updating learning rate to 0.0005
tensor(24.0364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7675312 KL Loss: 7.1535893 DSM Loss: 9.8568623 Overall Loss:18.7779828
Validation loss decreased (0.626546 --> 0.620425).  Saving model ...
Updating learning rate to 0.00025
tensor(20.3693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5000, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7671242 KL Loss: 7.1135645 DSM Loss: 9.8451554 Overall Loss:18.7258441
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(31.1297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7213815 KL Loss: 7.1741738 DSM Loss: 9.3581201 Overall Loss:18.2536753
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6844402551651001


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.2822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8230553 KL Loss: 7.1887754 DSM Loss: 11.2190728 Overall Loss:20.2309034
Validation loss decreased (inf --> 1.945316).  Saving model ...
Updating learning rate to 0.0005
tensor(16.5454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8382455 KL Loss: 7.1904015 DSM Loss: 9.7586712 Overall Loss:18.7873180
Validation loss decreased (1.945316 --> 1.915409).  Saving model ...
Updating learning rate to 0.00025
tensor(22.5014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7973805 KL Loss: 7.1702621 DSM Loss: 9.5522443 Overall Loss:18.5198870
Validation loss decreased (1.915409 --> 1.898682).  Saving model ...
Updating learning rate to 0.000125
tensor(16.9904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8237971 KL Loss: 7.2213599 DSM Loss: 9.3387285 Overall Loss:18.3838855
Validation loss decreased (1.898682 --> 1.893148).  Saving model ...
Updating learning rate to 6.25e-05
tensor(23.4186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7883557 KL Loss: 7.2131758 DSM Loss: 9.4509186 Overall Loss:18.4524500
Validation loss decreased (1.893148 --> 1.887435).  Saving model ...
Updating learning rate to 3.125e-05
tensor(17.7961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7708770 KL Loss: 7.1808089 DSM Loss: 9.2263484 Overall Loss:18.1780343
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(17.7541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2692, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7596887 KL Loss: 7.1511727 DSM Loss: 9.3693448 Overall Loss:18.2802061
Validation loss decreased (1.887435 --> 1.886555).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(17.2752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7413997 KL Loss: 7.1335734 DSM Loss: 9.3215065 Overall Loss:18.1964796
Validation loss decreased (1.886555 --> 1.885941).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(21.2567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7465886 KL Loss: 7.1390090 DSM Loss: 9.2902008 Overall Loss:18.1757982
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.953125e-06
tensor(16.6014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7562123 KL Loss: 7.1025543 DSM Loss: 9.3403295 Overall Loss:18.1990961
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7776439189910889


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.7204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8316297 KL Loss: 7.3085487 DSM Loss: 12.3017784 Overall Loss:21.4419569
Validation loss decreased (inf --> 0.748529).  Saving model ...
Updating learning rate to 0.0005
tensor(16.2403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7865249 KL Loss: 7.1690699 DSM Loss: 10.1603437 Overall Loss:19.1159386
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(29.2789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7441781 KL Loss: 7.1158480 DSM Loss: 9.9344161 Overall Loss:18.7944422
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6970745325088501


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.9732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8527961 KL Loss: 7.2544013 DSM Loss: 12.4812960 Overall Loss:21.5884934
Validation loss decreased (inf --> 0.849603).  Saving model ...
Updating learning rate to 0.0005
tensor(19.9275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4685, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8196434 KL Loss: 7.2092146 DSM Loss: 10.1387421 Overall Loss:19.1676001
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(12.9917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8002228 KL Loss: 7.2098020 DSM Loss: 9.8228134 Overall Loss:18.8328382
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6337100863456726


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(31.0119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8615331 KL Loss: 7.2764069 DSM Loss: 11.6568712 Overall Loss:20.7948111
Validation loss decreased (inf --> 1.524769).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7887888 KL Loss: 7.2318743 DSM Loss: 9.8666304 Overall Loss:18.8872936
Validation loss decreased (1.524769 --> 1.503172).  Saving model ...
Updating learning rate to 0.00025
tensor(15.1663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8306938 KL Loss: 7.2804402 DSM Loss: 9.7168955 Overall Loss:18.8280294
Validation loss decreased (1.503172 --> 1.502607).  Saving model ...
Updating learning rate to 0.000125
tensor(16.9122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8094297 KL Loss: 7.1851587 DSM Loss: 9.6428930 Overall Loss:18.6374815
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(20.5629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7576686 KL Loss: 7.1741723 DSM Loss: 9.5583861 Overall Loss:18.4902269
Validation loss decreased (1.502607 --> 1.502107).  Saving model ...
Updating learning rate to 3.125e-05
tensor(17.3221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7345773 KL Loss: 7.2070852 DSM Loss: 9.5841976 Overall Loss:18.5258601
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(17.1003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8132529 KL Loss: 7.2687640 DSM Loss: 9.3767053 Overall Loss:18.4587222
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9276906251907349


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(35.5514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2474, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8357817 KL Loss: 7.2614326 DSM Loss: 11.6316577 Overall Loss:20.7288720
Validation loss decreased (inf --> 1.122131).  Saving model ...
Updating learning rate to 0.0005
tensor(14.8310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7962257 KL Loss: 7.2091884 DSM Loss: 10.0311916 Overall Loss:19.0366056
Validation loss decreased (1.122131 --> 1.113286).  Saving model ...
Updating learning rate to 0.00025
tensor(25.2125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9926, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8042835 KL Loss: 7.1640324 DSM Loss: 9.4402797 Overall Loss:18.4085956
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.3819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8224126 KL Loss: 7.2782325 DSM Loss: 9.3353141 Overall Loss:18.4359593
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8921886682510376


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.6597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8000395 KL Loss: 7.1843878 DSM Loss: 12.8064811 Overall Loss:21.7909083
Validation loss decreased (inf --> 1.048194).  Saving model ...
Updating learning rate to 0.0005
tensor(20.0980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7752125 KL Loss: 7.1862507 DSM Loss: 10.2934586 Overall Loss:19.2549218
Validation loss decreased (1.048194 --> 1.021519).  Saving model ...
Updating learning rate to 0.00025
tensor(30.7818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7391872 KL Loss: 7.1204564 DSM Loss: 9.8270813 Overall Loss:18.6867248
Validation loss decreased (1.021519 --> 1.010119).  Saving model ...
Updating learning rate to 0.000125
tensor(15.4791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7866050 KL Loss: 7.1853648 DSM Loss: 9.5242227 Overall Loss:18.4961926
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(15.3026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8218707 KL Loss: 7.2100008 DSM Loss: 9.3131880 Overall Loss:18.3450594
Validation loss decreased (1.010119 --> 1.008574).  Saving model ...
Updating learning rate to 3.125e-05
tensor(18.3926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7884992 KL Loss: 7.2123469 DSM Loss: 9.3425542 Overall Loss:18.3434003
Validation loss decreased (1.008574 --> 1.008450).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(17.5418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8114287 KL Loss: 7.2921219 DSM Loss: 9.3326594 Overall Loss:18.4362099
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(14.5944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.0560, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7470055 KL Loss: 7.0792855 DSM Loss: 9.5852481 Overall Loss:18.4115392
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7213745713233948


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.7091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8553887 KL Loss: 7.2509195 DSM Loss: 11.8113496 Overall Loss:20.9176580
Validation loss decreased (inf --> 0.730583).  Saving model ...
Updating learning rate to 0.0005
tensor(18.7592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8906624 KL Loss: 7.2998902 DSM Loss: 9.9081851 Overall Loss:19.0987379
Validation loss decreased (0.730583 --> 0.723181).  Saving model ...
Updating learning rate to 0.00025
tensor(14.9537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8964, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8002410 KL Loss: 7.2222269 DSM Loss: 9.8595287 Overall Loss:18.8819965
Validation loss decreased (0.723181 --> 0.720943).  Saving model ...
Updating learning rate to 0.000125
tensor(15.6132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7587424 KL Loss: 7.1597943 DSM Loss: 9.6605665 Overall Loss:18.5791031
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(21.4492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5762, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7892430 KL Loss: 7.2170287 DSM Loss: 9.5730926 Overall Loss:18.5793644
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8623484969139099


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.5603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9566185 KL Loss: 7.3649914 DSM Loss: 10.9110987 Overall Loss:20.2327087
Validation loss decreased (inf --> 1.313622).  Saving model ...
Updating learning rate to 0.0005
tensor(14.4283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8231810 KL Loss: 7.2033587 DSM Loss: 10.1826742 Overall Loss:19.2092139
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(19.3736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8629634 KL Loss: 7.2096245 DSM Loss: 9.6901664 Overall Loss:18.7627542
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9233091473579407


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.3828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8810640 KL Loss: 7.2660200 DSM Loss: 11.0737163 Overall Loss:20.2208003
Validation loss decreased (inf --> 1.072936).  Saving model ...
Updating learning rate to 0.0005
tensor(20.0722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0071, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7851179 KL Loss: 7.1906543 DSM Loss: 10.1335832 Overall Loss:19.1093554
Validation loss decreased (1.072936 --> 1.070332).  Saving model ...
Updating learning rate to 0.00025
tensor(14.8465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4498, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7852555 KL Loss: 7.1394582 DSM Loss: 9.7433513 Overall Loss:18.6680649
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(17.5444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7927548 KL Loss: 7.2023813 DSM Loss: 9.6474253 Overall Loss:18.6425615
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6562557220458984


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(35.6694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8485739 KL Loss: 7.2442776 DSM Loss: 11.5747344 Overall Loss:20.6675861
Validation loss decreased (inf --> 0.854743).  Saving model ...
Updating learning rate to 0.0005
tensor(19.2646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7967934 KL Loss: 7.1474365 DSM Loss: 9.9359989 Overall Loss:18.8802288
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(21.6947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6602, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7825977 KL Loss: 7.2116730 DSM Loss: 9.7770151 Overall Loss:18.7712858
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0054843425750732


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.6273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8565825 KL Loss: 7.2539020 DSM Loss: 11.2131351 Overall Loss:20.3236197
Validation loss decreased (inf --> 1.090047).  Saving model ...
Updating learning rate to 0.0005
tensor(16.8321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8356014 KL Loss: 7.2432143 DSM Loss: 10.0322262 Overall Loss:19.1110419
Validation loss decreased (1.090047 --> 1.078747).  Saving model ...
Updating learning rate to 0.00025
tensor(16.9034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7344955 KL Loss: 7.1248625 DSM Loss: 9.7932742 Overall Loss:18.6526322
Validation loss decreased (1.078747 --> 1.065943).  Saving model ...
Updating learning rate to 0.000125
tensor(22.5734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8076463 KL Loss: 7.2333749 DSM Loss: 9.6322621 Overall Loss:18.6732833
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(26.3755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7433184 KL Loss: 7.1602571 DSM Loss: 9.5090249 Overall Loss:18.4126006
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7026859521865845


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.0651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8477778 KL Loss: 7.3883881 DSM Loss: 13.6440854 Overall Loss:22.8802513
Validation loss decreased (inf --> 1.094798).  Saving model ...
Updating learning rate to 0.0005
tensor(16.3456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8188926 KL Loss: 7.2302568 DSM Loss: 10.1800570 Overall Loss:19.2292064
Validation loss decreased (1.094798 --> 1.088130).  Saving model ...
Updating learning rate to 0.00025
tensor(20.1817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8130257 KL Loss: 7.2276881 DSM Loss: 9.6972613 Overall Loss:18.7379749
Validation loss decreased (1.088130 --> 1.075163).  Saving model ...
Updating learning rate to 0.000125
tensor(28.3713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3857, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7410093 KL Loss: 7.1460315 DSM Loss: 9.6865294 Overall Loss:18.5735700
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(22.3394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7672187 KL Loss: 7.2155181 DSM Loss: 9.6402547 Overall Loss:18.6229915
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2047940492630005


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.2704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8109198 KL Loss: 7.1409253 DSM Loss: 12.3863860 Overall Loss:21.3382311
Validation loss decreased (inf --> 1.535248).  Saving model ...
Updating learning rate to 0.0005
tensor(18.0442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6332, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7948792 KL Loss: 7.1863260 DSM Loss: 9.8622971 Overall Loss:18.8435023
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(14.0068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8626744 KL Loss: 7.3112401 DSM Loss: 9.3114723 Overall Loss:18.4853869
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2881301641464233


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.8374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7865907 KL Loss: 7.2204991 DSM Loss: 11.2896395 Overall Loss:20.2967293
Validation loss decreased (inf --> 0.938708).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7312556 KL Loss: 7.1655976 DSM Loss: 9.9236089 Overall Loss:18.8204620
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(15.6167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8019052 KL Loss: 7.2131394 DSM Loss: 9.8313884 Overall Loss:18.8464330
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7134239673614502


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.1419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8074549 KL Loss: 7.1552911 DSM Loss: 11.4180404 Overall Loss:20.3807864
Validation loss decreased (inf --> 0.710731).  Saving model ...
Updating learning rate to 0.0005
tensor(15.0253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2480, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8482712 KL Loss: 7.2809505 DSM Loss: 9.8057906 Overall Loss:18.9350124
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(14.5273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7957726 KL Loss: 7.2031162 DSM Loss: 9.5135915 Overall Loss:18.5124804
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7512345910072327


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.9543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7993446 KL Loss: 7.2103593 DSM Loss: 11.3961160 Overall Loss:20.4058199
Validation loss decreased (inf --> 0.512138).  Saving model ...
Updating learning rate to 0.0005
tensor(13.5602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7911092 KL Loss: 7.1734885 DSM Loss: 10.1673838 Overall Loss:19.1319815
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(12.7127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8200524 KL Loss: 7.2362681 DSM Loss: 9.7696139 Overall Loss:18.8259344
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6440685987472534


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.6893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8137034 KL Loss: 7.1949899 DSM Loss: 11.7424275 Overall Loss:20.7511207
Validation loss decreased (inf --> 1.545292).  Saving model ...
Updating learning rate to 0.0005
tensor(15.9999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7821198 KL Loss: 7.1380383 DSM Loss: 10.0446721 Overall Loss:18.9648302
Validation loss decreased (1.545292 --> 1.531917).  Saving model ...
Updating learning rate to 0.00025
tensor(24.0201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8216762 KL Loss: 7.1978758 DSM Loss: 9.5869725 Overall Loss:18.6065244
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(23.5083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7931758 KL Loss: 7.2437426 DSM Loss: 9.6222594 Overall Loss:18.6591777
Validation loss decreased (1.531917 --> 1.530157).  Saving model ...
Updating learning rate to 6.25e-05
tensor(20.9120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7341867 KL Loss: 7.1018066 DSM Loss: 9.5706510 Overall Loss:18.4066443
Validation loss decreased (1.530157 --> 1.527980).  Saving model ...
Updating learning rate to 3.125e-05
tensor(18.3548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7455033 KL Loss: 7.2059341 DSM Loss: 9.4546035 Overall Loss:18.4060408
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(21.5261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2486, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7091816 KL Loss: 7.0523488 DSM Loss: 9.6612855 Overall Loss:18.4228158
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7148869037628174


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.0011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8443453 KL Loss: 7.2800388 DSM Loss: 11.3539730 Overall Loss:20.4783572
Validation loss decreased (inf --> 1.096300).  Saving model ...
Updating learning rate to 0.0005
tensor(14.0417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.6296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8037961 KL Loss: 7.1705561 DSM Loss: 10.0029484 Overall Loss:18.9773006
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(22.5327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7462231 KL Loss: 7.1385833 DSM Loss: 9.7883519 Overall Loss:18.6731585
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3757046461105347


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(31.9650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7881142 KL Loss: 7.2402644 DSM Loss: 11.4485304 Overall Loss:20.4769089
Validation loss decreased (inf --> 0.574228).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7471903 KL Loss: 7.1370994 DSM Loss: 10.1847370 Overall Loss:19.0690268
Validation loss decreased (0.574228 --> 0.571764).  Saving model ...
Updating learning rate to 0.00025
tensor(15.3472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3980, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8315765 KL Loss: 7.2499999 DSM Loss: 9.4168884 Overall Loss:18.4984647
Validation loss decreased (0.571764 --> 0.566389).  Saving model ...
Updating learning rate to 0.000125
tensor(12.8696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7733677 KL Loss: 7.1460862 DSM Loss: 9.8858572 Overall Loss:18.8053109
Validation loss decreased (0.566389 --> 0.565601).  Saving model ...
Updating learning rate to 6.25e-05
tensor(13.0877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7492331 KL Loss: 7.1028489 DSM Loss: 9.6992225 Overall Loss:18.5513045
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(13.0122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7801491 KL Loss: 7.2341778 DSM Loss: 9.8024010 Overall Loss:18.8167280
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8759139776229858


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.3117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8729213 KL Loss: 7.2851892 DSM Loss: 11.4690405 Overall Loss:20.6271511
Validation loss decreased (inf --> 0.616047).  Saving model ...
Updating learning rate to 0.0005
tensor(13.9602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8334850 KL Loss: 7.3103673 DSM Loss: 10.1254235 Overall Loss:19.2692757
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(19.8688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8356321 KL Loss: 7.2400374 DSM Loss: 9.6419536 Overall Loss:18.7176230
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1282519102096558


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(41.4570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6572, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8535741 KL Loss: 7.2707028 DSM Loss: 11.6084514 Overall Loss:20.7327283
Validation loss decreased (inf --> 0.514640).  Saving model ...
Updating learning rate to 0.0005
tensor(11.9849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7794707 KL Loss: 7.1647781 DSM Loss: 10.0799749 Overall Loss:19.0242237
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(15.5474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8133585 KL Loss: 7.1916762 DSM Loss: 9.7594683 Overall Loss:18.7645029
Validation loss decreased (0.514640 --> 0.514557).  Saving model ...
Updating learning rate to 0.000125
tensor(13.0617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8096338 KL Loss: 7.2803501 DSM Loss: 9.3401907 Overall Loss:18.4301746
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(17.2448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3933, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8427901 KL Loss: 7.4306692 DSM Loss: 9.0192676 Overall Loss:18.2927269
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7841058373451233


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(20.6786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6930, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8561252 KL Loss: 7.2768645 DSM Loss: 11.9932997 Overall Loss:21.1262895
Validation loss decreased (inf --> 0.686257).  Saving model ...
Updating learning rate to 0.0005
tensor(21.6884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8506066 KL Loss: 7.2902194 DSM Loss: 10.0399068 Overall Loss:19.1807327
Validation loss decreased (0.686257 --> 0.683175).  Saving model ...
Updating learning rate to 0.00025
tensor(14.5263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.9055745 KL Loss: 7.3305859 DSM Loss: 9.3433275 Overall Loss:18.5794879
Validation loss decreased (0.683175 --> 0.681884).  Saving model ...
Updating learning rate to 0.000125
tensor(14.1325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7851580 KL Loss: 7.2223750 DSM Loss: 9.6092459 Overall Loss:18.6167788
Validation loss decreased (0.681884 --> 0.681031).  Saving model ...
Updating learning rate to 6.25e-05
tensor(20.8484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7759825 KL Loss: 7.2097207 DSM Loss: 9.6774509 Overall Loss:18.6631541
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(28.6261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7532225 KL Loss: 7.1088255 DSM Loss: 9.7210439 Overall Loss:18.5830919
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7042549252510071


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.6830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8060565 KL Loss: 7.3281794 DSM Loss: 13.5486179 Overall Loss:22.6828536
Validation loss decreased (inf --> 0.710369).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0288, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8089440 KL Loss: 7.2172583 DSM Loss: 10.1209483 Overall Loss:19.1471507
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(23.5909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8083539 KL Loss: 7.2181299 DSM Loss: 9.7121104 Overall Loss:18.7385943
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5234519243240356


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.7169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8358999 KL Loss: 7.2500901 DSM Loss: 11.9562153 Overall Loss:21.0422052
Validation loss decreased (inf --> 1.344383).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8003063 KL Loss: 7.1898675 DSM Loss: 10.1704471 Overall Loss:19.1606210
Validation loss decreased (1.344383 --> 1.310662).  Saving model ...
Updating learning rate to 0.00025
tensor(14.8595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7876496 KL Loss: 7.2109594 DSM Loss: 9.7737316 Overall Loss:18.7723407
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(20.3276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7530736 KL Loss: 7.1230658 DSM Loss: 9.6269766 Overall Loss:18.5031160
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7557626962661743


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.0807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8058918 KL Loss: 7.1929723 DSM Loss: 11.3755540 Overall Loss:20.3744181
Validation loss decreased (inf --> 1.236088).  Saving model ...
Updating learning rate to 0.0005
tensor(14.0641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8147311 KL Loss: 7.1834690 DSM Loss: 9.9950522 Overall Loss:18.9932523
Validation loss decreased (1.236088 --> 1.235250).  Saving model ...
Updating learning rate to 0.00025
tensor(14.5866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7653075 KL Loss: 7.1030383 DSM Loss: 9.7252506 Overall Loss:18.5935963
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(15.4713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7803258 KL Loss: 7.2223708 DSM Loss: 9.5540525 Overall Loss:18.5567491
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0092811584472656


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(50.4167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8509267 KL Loss: 7.2804515 DSM Loss: 11.3548581 Overall Loss:20.4862363
Validation loss decreased (inf --> 0.814127).  Saving model ...
Updating learning rate to 0.0005
tensor(18.0157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8594510 KL Loss: 7.2482826 DSM Loss: 10.0901835 Overall Loss:19.1979171
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(12.9948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7806748 KL Loss: 7.0964174 DSM Loss: 9.9063619 Overall Loss:18.7834541
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7091006636619568


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.8886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8052226 KL Loss: 7.2084075 DSM Loss: 12.8622223 Overall Loss:21.8758525
Validation loss decreased (inf --> 1.431503).  Saving model ...
Updating learning rate to 0.0005
tensor(14.6196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8342842 KL Loss: 7.2014394 DSM Loss: 9.9574807 Overall Loss:18.9932043
Validation loss decreased (1.431503 --> 1.419010).  Saving model ...
Updating learning rate to 0.00025
tensor(15.4975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8194674 KL Loss: 7.2027751 DSM Loss: 9.5572262 Overall Loss:18.5794688
Validation loss decreased (1.419010 --> 1.414598).  Saving model ...
Updating learning rate to 0.000125
tensor(15.2672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2413, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7791195 KL Loss: 7.1154006 DSM Loss: 9.6539136 Overall Loss:18.5484337
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(18.8438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7565877 KL Loss: 7.1952371 DSM Loss: 9.4269053 Overall Loss:18.3787300
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0097911357879639


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.0684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7767783 KL Loss: 7.1973730 DSM Loss: 13.2882436 Overall Loss:22.2623949
Validation loss decreased (inf --> 0.360130).  Saving model ...
Updating learning rate to 0.0005
tensor(13.6936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7670135 KL Loss: 7.1266491 DSM Loss: 9.9174392 Overall Loss:18.8111019
Validation loss decreased (0.360130 --> 0.356437).  Saving model ...
Updating learning rate to 0.00025
tensor(14.9588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8566229 KL Loss: 7.2714238 DSM Loss: 9.6819722 Overall Loss:18.8100189
Validation loss decreased (0.356437 --> 0.347625).  Saving model ...
Updating learning rate to 0.000125
tensor(21.7572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3178, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7871896 KL Loss: 7.1406078 DSM Loss: 9.3988482 Overall Loss:18.3266458
Validation loss decreased (0.347625 --> 0.344102).  Saving model ...
Updating learning rate to 6.25e-05
tensor(37.8281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7747666 KL Loss: 7.1603838 DSM Loss: 9.4049030 Overall Loss:18.3400535
Validation loss decreased (0.344102 --> 0.343423).  Saving model ...
Updating learning rate to 3.125e-05
tensor(18.4780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7079140 KL Loss: 7.1556131 DSM Loss: 9.3618459 Overall Loss:18.2253730
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(15.1234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4335, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7318420 KL Loss: 7.1005269 DSM Loss: 9.5405047 Overall Loss:18.3728736
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.999173879623413


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.1786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8331819 KL Loss: 7.2933968 DSM Loss: 11.7428718 Overall Loss:20.8694505
Validation loss decreased (inf --> 0.945281).  Saving model ...
Updating learning rate to 0.0005
tensor(19.7289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8890957 KL Loss: 7.2870229 DSM Loss: 9.5680728 Overall Loss:18.7441912
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(29.6882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8354993 KL Loss: 7.2717994 DSM Loss: 9.5816233 Overall Loss:18.6889220
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3685683012008667


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(30.2758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7637288 KL Loss: 7.1825603 DSM Loss: 12.1764969 Overall Loss:21.1227860
Validation loss decreased (inf --> 0.740569).  Saving model ...
Updating learning rate to 0.0005
tensor(16.9633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8803954 KL Loss: 7.3161265 DSM Loss: 9.4437626 Overall Loss:18.6402844
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(21.9617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7983917 KL Loss: 7.1509751 DSM Loss: 9.9383304 Overall Loss:18.8876973
Validation loss decreased (0.740569 --> 0.739529).  Saving model ...
Updating learning rate to 0.000125
tensor(27.1728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7686345 KL Loss: 7.2054111 DSM Loss: 9.6363568 Overall Loss:18.6104023
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(20.3579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7809877 KL Loss: 7.1242956 DSM Loss: 9.3178848 Overall Loss:18.2231681
Validation loss decreased (0.739529 --> 0.738828).  Saving model ...
Updating learning rate to 3.125e-05
tensor(17.8583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7673616 KL Loss: 7.2510177 DSM Loss: 9.5404271 Overall Loss:18.5588064
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(19.2141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7676410 KL Loss: 7.1585685 DSM Loss: 9.4759514 Overall Loss:18.4021608
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7326286435127258


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(21.3052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7939528 KL Loss: 7.2055822 DSM Loss: 11.7053438 Overall Loss:20.7048788
Validation loss decreased (inf --> 0.798011).  Saving model ...
Updating learning rate to 0.0005
tensor(16.0781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7793022 KL Loss: 7.1419259 DSM Loss: 10.1972292 Overall Loss:19.1184572
Validation loss decreased (0.798011 --> 0.797661).  Saving model ...
Updating learning rate to 0.00025
tensor(13.1021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8062329 KL Loss: 7.1851654 DSM Loss: 9.5675526 Overall Loss:18.5589509
Validation loss decreased (0.797661 --> 0.796551).  Saving model ...
Updating learning rate to 0.000125
tensor(17.5657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7902991 KL Loss: 7.1814605 DSM Loss: 9.7763673 Overall Loss:18.7481269
Validation loss decreased (0.796551 --> 0.787926).  Saving model ...
Updating learning rate to 6.25e-05
tensor(37.5185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8343, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7956804 KL Loss: 7.2027730 DSM Loss: 9.6000167 Overall Loss:18.5984701
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(16.0166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7418177 KL Loss: 7.1579818 DSM Loss: 9.3933228 Overall Loss:18.2931220
Validation loss decreased (0.787926 --> 0.785879).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(15.0907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7530917 KL Loss: 7.1722153 DSM Loss: 9.5792326 Overall Loss:18.5045396
Validation loss decreased (0.785879 --> 0.784909).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(12.8232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7835698 KL Loss: 7.1783227 DSM Loss: 9.4414451 Overall Loss:18.4033376
Validation loss decreased (0.784909 --> 0.783291).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(11.7390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8034873 KL Loss: 7.1521717 DSM Loss: 9.4823051 Overall Loss:18.4379641
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.953125e-06
tensor(26.2099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7569696 KL Loss: 7.1204156 DSM Loss: 9.4670796 Overall Loss:18.3444648
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6535938382148743


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(19.4965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8476408 KL Loss: 7.2940608 DSM Loss: 12.1791378 Overall Loss:21.3208392
Validation loss decreased (inf --> 0.826879).  Saving model ...
Updating learning rate to 0.0005
tensor(17.3246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8542252 KL Loss: 7.2759094 DSM Loss: 10.0382952 Overall Loss:19.1684298
Validation loss decreased (0.826879 --> 0.803836).  Saving model ...
Updating learning rate to 0.00025
tensor(13.7223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8367258 KL Loss: 7.2018121 DSM Loss: 9.8940849 Overall Loss:18.9326229
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(16.7630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7986752 KL Loss: 7.2081590 DSM Loss: 9.6282346 Overall Loss:18.6350687
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6253268122673035


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.7298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9366542 KL Loss: 7.3784611 DSM Loss: 12.8290696 Overall Loss:22.1441848
Validation loss decreased (inf --> 1.173286).  Saving model ...
Updating learning rate to 0.0005
tensor(18.5848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9875, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8490288 KL Loss: 7.2662795 DSM Loss: 10.0039799 Overall Loss:19.1192882
Validation loss decreased (1.173286 --> 1.164536).  Saving model ...
Updating learning rate to 0.00025
tensor(11.9919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7804464 KL Loss: 7.2250274 DSM Loss: 9.8162326 Overall Loss:18.8217064
Validation loss decreased (1.164536 --> 1.159019).  Saving model ...
Updating learning rate to 0.000125
tensor(13.7433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7492212 KL Loss: 7.1342865 DSM Loss: 9.7220941 Overall Loss:18.6056018
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(15.1254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7505658 KL Loss: 7.1879178 DSM Loss: 9.7696969 Overall Loss:18.7081806
Validation loss decreased (1.159019 --> 1.158784).  Saving model ...
Updating learning rate to 3.125e-05
tensor(18.1914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3922, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7939356 KL Loss: 7.2424179 DSM Loss: 9.4390344 Overall Loss:18.4753879
Validation loss decreased (1.158784 --> 1.158402).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(17.2829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7920888 KL Loss: 7.1889660 DSM Loss: 9.4848971 Overall Loss:18.4659517
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(13.9464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8375, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7554548 KL Loss: 7.1307682 DSM Loss: 9.5825554 Overall Loss:18.4687784
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8256076574325562


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.0438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8043670 KL Loss: 7.2119240 DSM Loss: 13.6239148 Overall Loss:22.6402057
Validation loss decreased (inf --> 1.408537).  Saving model ...
Updating learning rate to 0.0005
tensor(25.6343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0607, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8096157 KL Loss: 7.1695078 DSM Loss: 10.2788760 Overall Loss:19.2579994
Validation loss decreased (1.408537 --> 1.407147).  Saving model ...
Updating learning rate to 0.00025
tensor(29.2195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7935856 KL Loss: 7.1738968 DSM Loss: 9.6736466 Overall Loss:18.6411289
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(19.1791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6014, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7908601 KL Loss: 7.1719961 DSM Loss: 9.6558819 Overall Loss:18.6187380
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6132151484489441


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.7318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8019466 KL Loss: 7.1485337 DSM Loss: 12.7921867 Overall Loss:21.7426669
Validation loss decreased (inf --> 0.631151).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8080684 KL Loss: 7.2482121 DSM Loss: 10.1356108 Overall Loss:19.1918912
Validation loss decreased (0.631151 --> 0.630738).  Saving model ...
Updating learning rate to 0.00025
tensor(13.5375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7835009 KL Loss: 7.1572552 DSM Loss: 9.9845855 Overall Loss:18.9253415
Validation loss decreased (0.630738 --> 0.630170).  Saving model ...
Updating learning rate to 0.000125
tensor(16.3820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8297278 KL Loss: 7.3492832 DSM Loss: 9.1822760 Overall Loss:18.3612871
Validation loss decreased (0.630170 --> 0.629729).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.2661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.0163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8065617 KL Loss: 7.1398016 DSM Loss: 9.5174906 Overall Loss:18.4638539
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(49.7215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7883803 KL Loss: 7.1992829 DSM Loss: 9.5582898 Overall Loss:18.5459531
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.4929148852825165


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.4851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8522249 KL Loss: 7.3092300 DSM Loss: 12.1677343 Overall Loss:21.3291891
Validation loss decreased (inf --> 0.979023).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8430388 KL Loss: 7.2771270 DSM Loss: 9.8166323 Overall Loss:18.9367982
Validation loss decreased (0.979023 --> 0.968477).  Saving model ...
Updating learning rate to 0.00025
tensor(26.6106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7713844 KL Loss: 7.1738633 DSM Loss: 9.7811312 Overall Loss:18.7263790
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(36.2916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8011718 KL Loss: 7.1964361 DSM Loss: 9.6196601 Overall Loss:18.6172680
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9497649669647217


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(26.3870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8421265 KL Loss: 7.1898613 DSM Loss: 11.5208845 Overall Loss:20.5528724
Validation loss decreased (inf --> 0.808800).  Saving model ...
Updating learning rate to 0.0005
tensor(15.6228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8201142 KL Loss: 7.2372386 DSM Loss: 9.9142527 Overall Loss:18.9716053
Validation loss decreased (0.808800 --> 0.808155).  Saving model ...
Updating learning rate to 0.00025
tensor(13.4499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7310, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7978235 KL Loss: 7.1266438 DSM Loss: 9.7067444 Overall Loss:18.6312117
Validation loss decreased (0.808155 --> 0.786675).  Saving model ...
Updating learning rate to 0.000125
tensor(17.6267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7220329 KL Loss: 7.1293950 DSM Loss: 9.8074537 Overall Loss:18.6588817
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(19.3142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7842814 KL Loss: 7.1881561 DSM Loss: 9.5820425 Overall Loss:18.5544801
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3894840478897095


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(36.4332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7967331 KL Loss: 7.1968975 DSM Loss: 11.7018639 Overall Loss:20.6954945
Validation loss decreased (inf --> 0.819919).  Saving model ...
Updating learning rate to 0.0005
tensor(16.3208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8354834 KL Loss: 7.2431517 DSM Loss: 9.9855434 Overall Loss:19.0641784
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(16.4964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8055561 KL Loss: 7.2838562 DSM Loss: 9.6099957 Overall Loss:18.6994080
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7410861849784851


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(37.1611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8255566 KL Loss: 7.1690460 DSM Loss: 12.4094091 Overall Loss:21.4040117
Validation loss decreased (inf --> 1.413029).  Saving model ...
Updating learning rate to 0.0005
tensor(15.4778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7764852 KL Loss: 7.1792638 DSM Loss: 10.1670758 Overall Loss:19.1228247
Validation loss decreased (1.413029 --> 1.399931).  Saving model ...
Updating learning rate to 0.00025
tensor(14.4379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7770587 KL Loss: 7.1771357 DSM Loss: 9.6891632 Overall Loss:18.6433575
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(16.3936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8298395 KL Loss: 7.2780993 DSM Loss: 9.6396344 Overall Loss:18.7475731
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8156509399414062


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.5669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7960371 KL Loss: 7.2472035 DSM Loss: 12.9141078 Overall Loss:21.9573484
Validation loss decreased (inf --> 1.206892).  Saving model ...
Updating learning rate to 0.0005
tensor(22.1994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7967686 KL Loss: 7.1591361 DSM Loss: 10.4348368 Overall Loss:19.3907415
Validation loss decreased (1.206892 --> 1.188104).  Saving model ...
Updating learning rate to 0.00025
tensor(16.8567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7909481 KL Loss: 7.2251410 DSM Loss: 9.7363261 Overall Loss:18.7524152
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(14.6027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0236, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8046616 KL Loss: 7.2678906 DSM Loss: 9.4062104 Overall Loss:18.4787626
Validation loss decreased (1.188104 --> 1.174163).  Saving model ...
Updating learning rate to 6.25e-05
tensor(15.2008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2233, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7329804 KL Loss: 7.2256341 DSM Loss: 9.5643953 Overall Loss:18.5230098
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(18.4008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8053921 KL Loss: 7.2012818 DSM Loss: 9.2940070 Overall Loss:18.3006810
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2068867683410645


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(28.2303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5027, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8297114 KL Loss: 7.2410433 DSM Loss: 11.6562786 Overall Loss:20.7270332
Validation loss decreased (inf --> 1.331594).  Saving model ...
Updating learning rate to 0.0005
tensor(12.1547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8972455 KL Loss: 7.3052418 DSM Loss: 10.0341964 Overall Loss:19.2366837
Validation loss decreased (1.331594 --> 1.331017).  Saving model ...
Updating learning rate to 0.00025
tensor(16.8011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8182, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8071809 KL Loss: 7.1543328 DSM Loss: 9.8517248 Overall Loss:18.8132385
Validation loss decreased (1.331017 --> 1.315443).  Saving model ...
Updating learning rate to 0.000125
tensor(35.3703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7961686 KL Loss: 7.2216685 DSM Loss: 9.6335527 Overall Loss:18.6513897
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(14.5519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7863838 KL Loss: 7.1556318 DSM Loss: 9.7393693 Overall Loss:18.6813849
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.5494811534881592


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.7828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8791699 KL Loss: 7.4202737 DSM Loss: 10.5147014 Overall Loss:19.8141449
Validation loss decreased (inf --> 0.582487).  Saving model ...
Updating learning rate to 0.0005
tensor(17.3921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0004, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8428504 KL Loss: 7.2044705 DSM Loss: 10.1738472 Overall Loss:19.2211680
Validation loss decreased (0.582487 --> 0.582248).  Saving model ...
Updating learning rate to 0.00025
tensor(12.9463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.0263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7550507 KL Loss: 7.0647936 DSM Loss: 9.5207388 Overall Loss:18.3405832
Validation loss decreased (0.582248 --> 0.581899).  Saving model ...
Updating learning rate to 0.000125
tensor(13.4566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7362011 KL Loss: 7.1662774 DSM Loss: 9.6714449 Overall Loss:18.5739236
Validation loss decreased (0.581899 --> 0.581340).  Saving model ...
Updating learning rate to 6.25e-05
tensor(21.0071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7813691 KL Loss: 7.1985711 DSM Loss: 9.6697517 Overall Loss:18.6496920
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(13.4767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7394748 KL Loss: 7.1767606 DSM Loss: 9.7043105 Overall Loss:18.6205459
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9701525568962097


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(34.8788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7685658 KL Loss: 7.1612039 DSM Loss: 11.5687785 Overall Loss:20.4985483
Validation loss decreased (inf --> 0.768809).  Saving model ...
Updating learning rate to 0.0005
tensor(16.3386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7413327 KL Loss: 7.1256574 DSM Loss: 10.0123006 Overall Loss:18.8792907
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(17.0911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7965, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7867383 KL Loss: 7.1843791 DSM Loss: 9.7976492 Overall Loss:18.7687666
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9517250657081604


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(27.1531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8816983 KL Loss: 7.2943919 DSM Loss: 11.9532590 Overall Loss:21.1293492
Validation loss decreased (inf --> 1.488199).  Saving model ...
Updating learning rate to 0.0005
tensor(14.7333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7536231 KL Loss: 7.1925383 DSM Loss: 10.0002333 Overall Loss:18.9463949
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(25.4219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8741814 KL Loss: 7.3304167 DSM Loss: 9.5343773 Overall Loss:18.7389753
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2995953559875488


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(18.8086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8348845 KL Loss: 7.2103087 DSM Loss: 11.5954167 Overall Loss:20.6406100
Validation loss decreased (inf --> 0.235884).  Saving model ...
Updating learning rate to 0.0005
tensor(24.8775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.9737155 KL Loss: 7.4224770 DSM Loss: 9.8368549 Overall Loss:19.2330476
Validation loss decreased (0.235884 --> 0.228370).  Saving model ...
Updating learning rate to 0.00025
tensor(17.1128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7191882 KL Loss: 7.1313102 DSM Loss: 9.6133087 Overall Loss:18.4638072
Validation loss decreased (0.228370 --> 0.213710).  Saving model ...
Updating learning rate to 0.000125
tensor(17.1893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7821788 KL Loss: 7.1330194 DSM Loss: 9.8340868 Overall Loss:18.7492851
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(20.5195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7611810 KL Loss: 7.1396429 DSM Loss: 9.5557253 Overall Loss:18.4565491
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.12564760446548462


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(41.1429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8008842 KL Loss: 7.2178259 DSM Loss: 11.2386206 Overall Loss:20.2573307
Validation loss decreased (inf --> 0.726187).  Saving model ...
Updating learning rate to 0.0005
tensor(13.8001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0058, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7760756 KL Loss: 7.2142770 DSM Loss: 10.0201378 Overall Loss:19.0104905
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(26.1775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.0360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7798439 KL Loss: 7.1250316 DSM Loss: 9.6570862 Overall Loss:18.5619617
Validation loss decreased (0.726187 --> 0.724588).  Saving model ...
Updating learning rate to 0.000125
tensor(16.6430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7409549 KL Loss: 7.2014577 DSM Loss: 9.5387519 Overall Loss:18.4811644
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(42.8951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7525061 KL Loss: 7.1173383 DSM Loss: 9.7947062 Overall Loss:18.6645507
Validation loss decreased (0.724588 --> 0.723514).  Saving model ...
Updating learning rate to 3.125e-05
tensor(13.9168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7125508 KL Loss: 7.1209812 DSM Loss: 9.7474125 Overall Loss:18.5809444
Validation loss decreased (0.723514 --> 0.723451).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(15.0319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0236, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7568204 KL Loss: 7.1828623 DSM Loss: 9.5458838 Overall Loss:18.4855666
Validation loss decreased (0.723451 --> 0.723145).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(12.5804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7741989 KL Loss: 7.1682521 DSM Loss: 9.1437125 Overall Loss:18.0861633
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(14.7810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7472563 KL Loss: 7.1263573 DSM Loss: 9.5597915 Overall Loss:18.4334051
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6467354893684387


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(33.8223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8419035 KL Loss: 7.3049886 DSM Loss: 12.3837516 Overall Loss:21.5306436
Validation loss decreased (inf --> 2.202140).  Saving model ...
Updating learning rate to 0.0005
tensor(16.4980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7853257 KL Loss: 7.1558086 DSM Loss: 10.3617523 Overall Loss:19.3028867
Validation loss decreased (2.202140 --> 2.190819).  Saving model ...
Updating learning rate to 0.00025
tensor(20.1880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7599248 KL Loss: 7.1706584 DSM Loss: 9.5211305 Overall Loss:18.4517136
Validation loss decreased (2.190819 --> 2.189697).  Saving model ...
Updating learning rate to 0.000125
tensor(15.0060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7367505 KL Loss: 7.1453497 DSM Loss: 9.6285790 Overall Loss:18.5106793
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(15.1539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7984374 KL Loss: 7.2143957 DSM Loss: 9.2591301 Overall Loss:18.2719632
Validation loss decreased (2.189697 --> 2.189364).  Saving model ...
Updating learning rate to 3.125e-05
tensor(14.7236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7057490 KL Loss: 7.1255910 DSM Loss: 9.6336037 Overall Loss:18.4649436
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(14.9069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7621576 KL Loss: 7.1652904 DSM Loss: 9.4993744 Overall Loss:18.4268222
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1713612079620361


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.0905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8383789 KL Loss: 7.3148362 DSM Loss: 11.7245879 Overall Loss:20.8778029
Validation loss decreased (inf --> 0.853828).  Saving model ...
Updating learning rate to 0.0005
tensor(14.0596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8605608 KL Loss: 7.2620922 DSM Loss: 9.6799782 Overall Loss:18.8026312
Validation loss decreased (0.853828 --> 0.850266).  Saving model ...
Updating learning rate to 0.00025
tensor(15.4919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8720476 KL Loss: 7.2761983 DSM Loss: 9.7551642 Overall Loss:18.9034101
Validation loss decreased (0.850266 --> 0.849052).  Saving model ...
Updating learning rate to 0.000125
tensor(13.2060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7805606 KL Loss: 7.2449418 DSM Loss: 9.4547182 Overall Loss:18.4802207
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(29.4597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7915384 KL Loss: 7.1803534 DSM Loss: 9.6407034 Overall Loss:18.6125951
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.777393639087677


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.1247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8124804 KL Loss: 7.1821913 DSM Loss: 12.2537673 Overall Loss:21.2484390
Validation loss decreased (inf --> 0.867220).  Saving model ...
Updating learning rate to 0.0005
tensor(20.6772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8011776 KL Loss: 7.1728407 DSM Loss: 10.2129798 Overall Loss:19.1869982
Validation loss decreased (0.867220 --> 0.850647).  Saving model ...
Updating learning rate to 0.00025
tensor(15.3808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8344472 KL Loss: 7.2780719 DSM Loss: 9.6242039 Overall Loss:18.7367230
Validation loss decreased (0.850647 --> 0.845500).  Saving model ...
Updating learning rate to 0.000125
tensor(18.9501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7989771 KL Loss: 7.2398099 DSM Loss: 9.5555954 Overall Loss:18.5943823
Validation loss decreased (0.845500 --> 0.845450).  Saving model ...
Updating learning rate to 6.25e-05
tensor(33.2398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7478901 KL Loss: 7.1030250 DSM Loss: 9.7310968 Overall Loss:18.5820120
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(15.0276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7441286 KL Loss: 7.1159124 DSM Loss: 9.5942504 Overall Loss:18.4542913
Validation loss decreased (0.845450 --> 0.845341).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(27.4127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5123, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7083965 KL Loss: 7.1981626 DSM Loss: 9.5545614 Overall Loss:18.4611206
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(13.7805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7328055 KL Loss: 7.2325407 DSM Loss: 9.4509863 Overall Loss:18.4163325
Validation loss decreased (0.845341 --> 0.845189).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(12.8645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7478533 KL Loss: 7.1238770 DSM Loss: 9.6414356 Overall Loss:18.5131659
Validation loss decreased (0.845189 --> 0.845146).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(12.5217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7596108 KL Loss: 7.2241851 DSM Loss: 9.5218105 Overall Loss:18.5056064
EarlyStopping counter: 1 out of 2
Updating learning rate to 9.765625e-07
tensor(15.9315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0371, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 86 | MSE Loss: 1.7595309 KL Loss: 7.2128422 DSM Loss: 9.4661815 Overall Loss:18.4385546
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5818912982940674


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.6490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8691285 KL Loss: 7.2198406 DSM Loss: 11.3739972 Overall Loss:20.4629662
Validation loss decreased (inf --> 0.502130).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8114879 KL Loss: 7.1901563 DSM Loss: 10.1679912 Overall Loss:19.1696353
Validation loss decreased (0.502130 --> 0.500585).  Saving model ...
Updating learning rate to 0.00025
tensor(13.7822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8428136 KL Loss: 7.2646960 DSM Loss: 9.9795223 Overall Loss:19.0870319
Validation loss decreased (0.500585 --> 0.500201).  Saving model ...
Updating learning rate to 0.000125
tensor(18.4099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7847017 KL Loss: 7.1941395 DSM Loss: 9.5089331 Overall Loss:18.4877742
Validation loss decreased (0.500201 --> 0.498924).  Saving model ...
Updating learning rate to 6.25e-05
tensor(12.3019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8418, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7969553 KL Loss: 7.1684338 DSM Loss: 9.7592038 Overall Loss:18.7245928
Validation loss decreased (0.498924 --> 0.498454).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.3794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7671433 KL Loss: 7.1968621 DSM Loss: 9.6580062 Overall Loss:18.6220117
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(28.9276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8148132 KL Loss: 7.2462040 DSM Loss: 9.2368309 Overall Loss:18.2978483
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7134849429130554


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.8202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7777152 KL Loss: 7.1914820 DSM Loss: 11.7443752 Overall Loss:20.7135724
Validation loss decreased (inf --> 0.953498).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7852468 KL Loss: 7.2073450 DSM Loss: 10.1104579 Overall Loss:19.1030496
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(14.6473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7918184 KL Loss: 7.1445976 DSM Loss: 9.8306846 Overall Loss:18.7671005
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1064133644104004


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.6324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8577088 KL Loss: 7.2484399 DSM Loss: 12.0088715 Overall Loss:21.1150202
Validation loss decreased (inf --> 1.121033).  Saving model ...
Updating learning rate to 0.0005
tensor(13.9474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8746490 KL Loss: 7.2040358 DSM Loss: 9.6559468 Overall Loss:18.7346316
Validation loss decreased (1.121033 --> 1.105521).  Saving model ...
Updating learning rate to 0.00025
tensor(29.3617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8075986 KL Loss: 7.1659171 DSM Loss: 9.6039440 Overall Loss:18.5774597
Validation loss decreased (1.105521 --> 1.096234).  Saving model ...
Updating learning rate to 0.000125
tensor(12.1630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7724734 KL Loss: 7.1409275 DSM Loss: 9.7975142 Overall Loss:18.7109151
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(22.5302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7838429 KL Loss: 7.1618097 DSM Loss: 9.6393398 Overall Loss:18.5849923
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9233654737472534


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(25.4080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8273473 KL Loss: 7.2288708 DSM Loss: 11.7862675 Overall Loss:20.8424856
Validation loss decreased (inf --> 0.930437).  Saving model ...
Updating learning rate to 0.0005
tensor(15.4354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8015347 KL Loss: 7.2364551 DSM Loss: 9.9031402 Overall Loss:18.9411300
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(19.0638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1052, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7685916 KL Loss: 7.1449764 DSM Loss: 9.6211139 Overall Loss:18.5346820
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.6414052248001099


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(37.4593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 2.0087967 KL Loss: 7.4218409 DSM Loss: 12.2572401 Overall Loss:21.6878777
Validation loss decreased (inf --> 0.552534).  Saving model ...
Updating learning rate to 0.0005
tensor(31.4904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8658402 KL Loss: 7.2301201 DSM Loss: 10.1194273 Overall Loss:19.2153877
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(14.0350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7319052 KL Loss: 7.0590513 DSM Loss: 10.1010679 Overall Loss:18.8920244
Validation loss decreased (0.552534 --> 0.550229).  Saving model ...
Updating learning rate to 0.000125
tensor(14.0414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1125, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7225018 KL Loss: 7.1283801 DSM Loss: 9.5276632 Overall Loss:18.3785450
Validation loss decreased (0.550229 --> 0.545828).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.8532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7348110 KL Loss: 7.0890100 DSM Loss: 9.8876144 Overall Loss:18.7114353
Validation loss decreased (0.545828 --> 0.544856).  Saving model ...
Updating learning rate to 3.125e-05
tensor(22.4220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7225825 KL Loss: 7.1092785 DSM Loss: 9.3659953 Overall Loss:18.1978563
Validation loss decreased (0.544856 --> 0.544776).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(13.2776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.6899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7455421 KL Loss: 7.2223679 DSM Loss: 9.3095016 Overall Loss:18.2774115
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(21.1047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7712063 KL Loss: 7.1947678 DSM Loss: 9.6497918 Overall Loss:18.6157657
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7778858542442322


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(18.6606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8575916 KL Loss: 7.2277462 DSM Loss: 11.3938461 Overall Loss:20.4791838
Validation loss decreased (inf --> 1.078097).  Saving model ...
Updating learning rate to 0.0005
tensor(21.9141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3342, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8646319 KL Loss: 7.2755573 DSM Loss: 9.9341851 Overall Loss:19.0743744
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(23.1673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3860, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8246794 KL Loss: 7.2265890 DSM Loss: 9.4821448 Overall Loss:18.5334130
Validation loss decreased (1.078097 --> 1.067488).  Saving model ...
Updating learning rate to 0.000125
tensor(20.6592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7599424 KL Loss: 7.1355150 DSM Loss: 9.5457968 Overall Loss:18.4412542
Validation loss decreased (1.067488 --> 1.064046).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.2039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.5552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8112666 KL Loss: 7.1456329 DSM Loss: 9.1720009 Overall Loss:18.1289005
Validation loss decreased (1.064046 --> 1.063856).  Saving model ...
Updating learning rate to 3.125e-05
tensor(25.3322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7787849 KL Loss: 7.1584429 DSM Loss: 9.2785750 Overall Loss:18.2158028
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(20.6675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6675, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7714629 KL Loss: 7.1785988 DSM Loss: 9.5783140 Overall Loss:18.5283758
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5369115471839905


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.4167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9010708 KL Loss: 7.3251000 DSM Loss: 11.7340348 Overall Loss:20.9602056
Validation loss decreased (inf --> 0.573140).  Saving model ...
Updating learning rate to 0.0005
tensor(11.8952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7305510 KL Loss: 7.1014411 DSM Loss: 9.9383699 Overall Loss:18.7703621
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(32.0885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.0181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7530902 KL Loss: 7.1184042 DSM Loss: 9.5743548 Overall Loss:18.4458492
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7147778272628784


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(29.0376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8397900 KL Loss: 7.1934758 DSM Loss: 11.5702405 Overall Loss:20.6035062
Validation loss decreased (inf --> 1.986722).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8415051 KL Loss: 7.2263041 DSM Loss: 9.6159051 Overall Loss:18.6837143
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(15.5653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7936717 KL Loss: 7.1935697 DSM Loss: 9.4696812 Overall Loss:18.4569227
Validation loss decreased (1.986722 --> 1.983629).  Saving model ...
Updating learning rate to 0.000125
tensor(16.1550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7386163 KL Loss: 7.1077063 DSM Loss: 9.4978207 Overall Loss:18.3441434
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(14.7958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7987666 KL Loss: 7.2109199 DSM Loss: 9.2966052 Overall Loss:18.3062916
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2922930717468262


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(31.2163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8649254 KL Loss: 7.3481792 DSM Loss: 11.6131938 Overall Loss:20.8262983
Validation loss decreased (inf --> 1.300738).  Saving model ...
Updating learning rate to 0.0005
tensor(17.8969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7748666 KL Loss: 7.1700027 DSM Loss: 10.0241851 Overall Loss:18.9690545
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(19.4446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7397804 KL Loss: 7.1418114 DSM Loss: 9.7364796 Overall Loss:18.6180715
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3275930881500244


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(34.1794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8630859 KL Loss: 7.3002737 DSM Loss: 11.4556807 Overall Loss:20.6190404
Validation loss decreased (inf --> 1.348892).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8084443 KL Loss: 7.2143122 DSM Loss: 10.2971999 Overall Loss:19.3199565
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(16.5189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7398119 KL Loss: 7.1496775 DSM Loss: 10.0692435 Overall Loss:18.9587329
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.4268587827682495


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.8111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8628476 KL Loss: 7.2794155 DSM Loss: 11.8789378 Overall Loss:21.0212008
Validation loss decreased (inf --> 1.698200).  Saving model ...
Updating learning rate to 0.0005
tensor(15.6524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7446240 KL Loss: 7.1645763 DSM Loss: 10.1450789 Overall Loss:19.0542790
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(27.5921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8194051 KL Loss: 7.1890702 DSM Loss: 9.5807539 Overall Loss:18.5892293
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6203737258911133


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.4060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8782866 KL Loss: 7.2954625 DSM Loss: 11.2471860 Overall Loss:20.4209351
Validation loss decreased (inf --> 0.672306).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7622759 KL Loss: 7.1744336 DSM Loss: 9.9424002 Overall Loss:18.8791097
Validation loss decreased (0.672306 --> 0.668750).  Saving model ...
Updating learning rate to 0.00025
tensor(23.1732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5148, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8390147 KL Loss: 7.2776943 DSM Loss: 9.7587766 Overall Loss:18.8754855
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(62.4429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8434227 KL Loss: 7.2656716 DSM Loss: 9.5350469 Overall Loss:18.6441411
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6673548817634583


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.9623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2480, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8482211 KL Loss: 7.2713884 DSM Loss: 11.6224663 Overall Loss:20.7420760
Validation loss decreased (inf --> 1.351061).  Saving model ...
Updating learning rate to 0.0005
tensor(19.8853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8116004 KL Loss: 7.1639851 DSM Loss: 10.1267243 Overall Loss:19.1023098
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(15.3560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8308365 KL Loss: 7.1995365 DSM Loss: 9.6090862 Overall Loss:18.6394592
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9633439779281616


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(22.1820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8534035 KL Loss: 7.2553899 DSM Loss: 11.8840543 Overall Loss:20.9928477
Validation loss decreased (inf --> 0.962271).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8123593 KL Loss: 7.2014906 DSM Loss: 10.1315338 Overall Loss:19.1453837
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(18.8433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8010469 KL Loss: 7.2020892 DSM Loss: 9.8116144 Overall Loss:18.8147507
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.5848972797393799


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(24.6092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8344827 KL Loss: 7.2856693 DSM Loss: 11.6116916 Overall Loss:20.7318436
Validation loss decreased (inf --> 1.555502).  Saving model ...
Updating learning rate to 0.0005
tensor(20.6354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9571, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7900939 KL Loss: 7.1877645 DSM Loss: 10.2328371 Overall Loss:19.2106954
Validation loss decreased (1.555502 --> 1.547785).  Saving model ...
Updating learning rate to 0.00025
tensor(16.2055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1384, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8135208 KL Loss: 7.1819820 DSM Loss: 9.7345465 Overall Loss:18.7300492
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(27.3530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7296263 KL Loss: 7.1134618 DSM Loss: 9.8311781 Overall Loss:18.6742662
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6468009948730469


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(45.4402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8440634 KL Loss: 7.2194691 DSM Loss: 11.2665854 Overall Loss:20.3301179
Validation loss decreased (inf --> 1.076325).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8716692 KL Loss: 7.3274573 DSM Loss: 9.7825945 Overall Loss:18.9817210
Validation loss decreased (1.076325 --> 1.055783).  Saving model ...
Updating learning rate to 0.00025
tensor(15.3017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7394193 KL Loss: 7.0470617 DSM Loss: 9.7480853 Overall Loss:18.5345663
Validation loss decreased (1.055783 --> 1.052121).  Saving model ...
Updating learning rate to 0.000125
tensor(12.8714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8233022 KL Loss: 7.1922927 DSM Loss: 9.6014056 Overall Loss:18.6170005
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(21.1411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5055, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8023700 KL Loss: 7.1600961 DSM Loss: 9.4081676 Overall Loss:18.3706336
Validation loss decreased (1.052121 --> 1.051911).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.9554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7773663 KL Loss: 7.2550575 DSM Loss: 9.3677800 Overall Loss:18.4002039
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(25.6538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7960562 KL Loss: 7.1534516 DSM Loss: 9.2528999 Overall Loss:18.2024078
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7542516589164734


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(32.1728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8393042 KL Loss: 7.2456307 DSM Loss: 11.8515466 Overall Loss:20.9364813
Validation loss decreased (inf --> 0.891468).  Saving model ...
Updating learning rate to 0.0005
tensor(37.2727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7655696 KL Loss: 7.1895227 DSM Loss: 10.0247446 Overall Loss:18.9798367
Validation loss decreased (0.891468 --> 0.887955).  Saving model ...
Updating learning rate to 0.00025
tensor(31.6930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7304720 KL Loss: 7.1450090 DSM Loss: 9.6707910 Overall Loss:18.5462721
Validation loss decreased (0.887955 --> 0.885977).  Saving model ...
Updating learning rate to 0.000125
tensor(17.3781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7974872 KL Loss: 7.2052743 DSM Loss: 9.4408858 Overall Loss:18.4436474
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(12.3399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9040, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7753416 KL Loss: 7.2049794 DSM Loss: 9.5470447 Overall Loss:18.5273658
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8257081508636475


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1388
val 192
test 393
tensor(23.1348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7893942 KL Loss: 7.2067130 DSM Loss: 11.7738159 Overall Loss:20.7699230
Validation loss decreased (inf --> 1.180763).  Saving model ...
Updating learning rate to 0.0005
tensor(12.3233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7583519 KL Loss: 7.1151348 DSM Loss: 10.0898135 Overall Loss:18.9633002
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(15.3153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8008358 KL Loss: 7.1733303 DSM Loss: 9.5933989 Overall Loss:18.5675650
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0380662679672241
      Ticker       MSE StdDev
0   AAPL_pct  0.860529    0.0
1   ABBV_pct  0.560492    0.0
2    AEP_pct  1.146721    0.0
3   AMGN_pct   0.68444    0.0
4   AMZN_pct  1.777644    0.0
..       ...       ...    ...
66    VZ_pct  1.584897    0.0
67     V_pct  0.646801    0.0
68   WFC_pct  0.754252    0.0
69   WMT_pct  0.825708    0.0
70   XOM_pct  1.038066    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=9, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=20, root_path='data/EcmP_stock_L_2016_24_mix', scale=0.1, sequence_length=20, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.4438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3271, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9098993 KL Loss: 14.2946841 DSM Loss: 22.8247140 Overall Loss:39.0292973
Validation loss decreased (inf --> 0.847879).  Saving model ...
Updating learning rate to 0.0005
tensor(25.7066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9269923 KL Loss: 14.4315273 DSM Loss: 19.2156064 Overall Loss:35.5741259
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(33.4579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8819173 KL Loss: 14.1665165 DSM Loss: 19.1582404 Overall Loss:35.2066744
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8715845346450806


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.8971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9141507 KL Loss: 14.3734876 DSM Loss: 24.1854628 Overall Loss:40.4731008
Validation loss decreased (inf --> 0.577137).  Saving model ...
Updating learning rate to 0.0005
tensor(46.3338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8637516 KL Loss: 14.2453896 DSM Loss: 19.6158174 Overall Loss:35.7249584
Validation loss decreased (0.577137 --> 0.567998).  Saving model ...
Updating learning rate to 0.00025
tensor(37.7974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9081718 KL Loss: 14.3128981 DSM Loss: 18.8157504 Overall Loss:35.0368202
Validation loss decreased (0.567998 --> 0.567489).  Saving model ...
Updating learning rate to 0.000125
tensor(29.1024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1426, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8791499 KL Loss: 14.3619722 DSM Loss: 18.8721582 Overall Loss:35.1132803
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(41.0589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8759023 KL Loss: 14.3125032 DSM Loss: 18.3713302 Overall Loss:34.5597358
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5671061873435974


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(76.9255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0379, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8612133 KL Loss: 14.2594895 DSM Loss: 23.4824865 Overall Loss:39.6031891
Validation loss decreased (inf --> 0.653111).  Saving model ...
Updating learning rate to 0.0005
tensor(32.3663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9018506 KL Loss: 14.2470243 DSM Loss: 19.2338501 Overall Loss:35.3827250
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(26.1083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8756030 KL Loss: 14.1773516 DSM Loss: 19.6250836 Overall Loss:35.6780381
Validation loss decreased (0.653111 --> 0.651913).  Saving model ...
Updating learning rate to 0.000125
tensor(28.1252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8862186 KL Loss: 14.2198748 DSM Loss: 18.9247251 Overall Loss:35.0308183
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(51.5307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4869, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8390131 KL Loss: 14.0537942 DSM Loss: 19.4030664 Overall Loss:35.2958735
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.1485527753829956


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.9567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9181008 KL Loss: 14.2593712 DSM Loss: 23.3043846 Overall Loss:39.4818570
Validation loss decreased (inf --> 0.640374).  Saving model ...
Updating learning rate to 0.0005
tensor(39.2575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8956625 KL Loss: 14.1870112 DSM Loss: 19.4687876 Overall Loss:35.5514612
Validation loss decreased (0.640374 --> 0.628120).  Saving model ...
Updating learning rate to 0.00025
tensor(36.8681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4361, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8432903 KL Loss: 14.1827284 DSM Loss: 18.7967148 Overall Loss:34.8227338
Validation loss decreased (0.628120 --> 0.626807).  Saving model ...
Updating learning rate to 0.000125
tensor(25.9966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8445881 KL Loss: 14.2399288 DSM Loss: 18.5824117 Overall Loss:34.6669284
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(32.0741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8593725 KL Loss: 14.2094855 DSM Loss: 18.6647286 Overall Loss:34.7335865
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.699152946472168


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.2256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7580, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8944950 KL Loss: 14.3566023 DSM Loss: 22.3031654 Overall Loss:38.5542628
Validation loss decreased (inf --> 1.677977).  Saving model ...
Updating learning rate to 0.0005
tensor(35.1788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0930, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8594559 KL Loss: 14.2162585 DSM Loss: 18.9264720 Overall Loss:35.0021864
Validation loss decreased (1.677977 --> 1.675231).  Saving model ...
Updating learning rate to 0.00025
tensor(38.2697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8456251 KL Loss: 14.1610118 DSM Loss: 18.1443802 Overall Loss:34.1510173
Validation loss decreased (1.675231 --> 1.665123).  Saving model ...
Updating learning rate to 0.000125
tensor(35.7281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8639707 KL Loss: 14.1918431 DSM Loss: 18.0328307 Overall Loss:34.0886446
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(29.7969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4692, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8360587 KL Loss: 14.1200720 DSM Loss: 18.1334127 Overall Loss:34.0895431
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.798679232597351


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.3826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9006881 KL Loss: 14.3499238 DSM Loss: 22.9398144 Overall Loss:39.1904263
Validation loss decreased (inf --> 0.744203).  Saving model ...
Updating learning rate to 0.0005
tensor(29.2052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8801272 KL Loss: 14.2408879 DSM Loss: 19.6045131 Overall Loss:35.7255280
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(28.6562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9232096 KL Loss: 14.3862823 DSM Loss: 19.0557996 Overall Loss:35.3652914
Validation loss decreased (0.744203 --> 0.734605).  Saving model ...
Updating learning rate to 0.000125
tensor(45.4098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9319929 KL Loss: 14.3109482 DSM Loss: 18.4330426 Overall Loss:34.6759837
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(35.5470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8438716 KL Loss: 14.1519506 DSM Loss: 19.0702571 Overall Loss:35.0660792
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6953354477882385


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.1080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1514, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9100958 KL Loss: 14.3918864 DSM Loss: 24.4320816 Overall Loss:40.7340637
Validation loss decreased (inf --> 0.778136).  Saving model ...
Updating learning rate to 0.0005
tensor(25.0859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8955027 KL Loss: 14.2336143 DSM Loss: 19.8814005 Overall Loss:36.0105176
Validation loss decreased (0.778136 --> 0.753678).  Saving model ...
Updating learning rate to 0.00025
tensor(25.8837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9227765 KL Loss: 14.3569182 DSM Loss: 19.3015031 Overall Loss:35.5811979
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(51.9878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8958231 KL Loss: 14.3904843 DSM Loss: 19.1561113 Overall Loss:35.4424186
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6209630370140076


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(67.5182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9208296 KL Loss: 14.3921333 DSM Loss: 23.1481610 Overall Loss:39.4611237
Validation loss decreased (inf --> 1.561968).  Saving model ...
Updating learning rate to 0.0005
tensor(31.8749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8612182 KL Loss: 14.2061647 DSM Loss: 19.7336106 Overall Loss:35.8009932
Validation loss decreased (1.561968 --> 1.561056).  Saving model ...
Updating learning rate to 0.00025
tensor(29.1170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5070, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9625535 KL Loss: 14.4834112 DSM Loss: 18.8022929 Overall Loss:35.2482576
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(34.6877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8893089 KL Loss: 14.3418470 DSM Loss: 18.6234660 Overall Loss:34.8546219
Validation loss decreased (1.561056 --> 1.560590).  Saving model ...
Updating learning rate to 6.25e-05
tensor(33.6871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3820, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8501436 KL Loss: 14.3058893 DSM Loss: 18.9384749 Overall Loss:35.0945078
Validation loss decreased (1.560590 --> 1.559723).  Saving model ...
Updating learning rate to 3.125e-05
tensor(48.4327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8583876 KL Loss: 14.2567871 DSM Loss: 18.8037596 Overall Loss:34.9189344
Validation loss decreased (1.559723 --> 1.558337).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(31.4928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9476533 KL Loss: 14.4892269 DSM Loss: 18.3595770 Overall Loss:34.7964573
Validation loss decreased (1.558337 --> 1.556247).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(26.4036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8363929 KL Loss: 14.1116206 DSM Loss: 19.1729187 Overall Loss:35.1209325
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(30.4939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8576440 KL Loss: 14.2717537 DSM Loss: 18.9487047 Overall Loss:35.0781022
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9422091245651245


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.1433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9190238 KL Loss: 14.3382123 DSM Loss: 21.9349932 Overall Loss:38.1922293
Validation loss decreased (inf --> 1.076748).  Saving model ...
Updating learning rate to 0.0005
tensor(27.7601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.4483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9352116 KL Loss: 14.3977870 DSM Loss: 18.3824573 Overall Loss:34.7154557
Validation loss decreased (1.076748 --> 1.046620).  Saving model ...
Updating learning rate to 0.00025
tensor(35.7057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8787054 KL Loss: 14.2289130 DSM Loss: 18.0103890 Overall Loss:34.1180073
Validation loss decreased (1.046620 --> 1.043762).  Saving model ...
Updating learning rate to 0.000125
tensor(30.3370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1533, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8036868 KL Loss: 14.1721962 DSM Loss: 18.0051423 Overall Loss:33.9810254
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(43.6964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9366, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8604333 KL Loss: 14.2386822 DSM Loss: 18.1661255 Overall Loss:34.2652411
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8914347887039185


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(41.4957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9401531 KL Loss: 14.4378060 DSM Loss: 22.3254303 Overall Loss:38.7033896
Validation loss decreased (inf --> 0.959635).  Saving model ...
Updating learning rate to 0.0005
tensor(36.4111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9487178 KL Loss: 14.3364919 DSM Loss: 19.1970692 Overall Loss:35.4822791
Validation loss decreased (0.959635 --> 0.958141).  Saving model ...
Updating learning rate to 0.00025
tensor(23.4538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8804832 KL Loss: 14.2716977 DSM Loss: 18.7729894 Overall Loss:34.9251703
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(24.5358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8663254 KL Loss: 14.1670888 DSM Loss: 18.5648451 Overall Loss:34.5982594
Validation loss decreased (0.958141 --> 0.950547).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.9844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7945473 KL Loss: 13.9621510 DSM Loss: 18.6183972 Overall Loss:34.3750954
Validation loss decreased (0.950547 --> 0.949988).  Saving model ...
Updating learning rate to 3.125e-05
tensor(30.7196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8348385 KL Loss: 14.1905508 DSM Loss: 18.2589539 Overall Loss:34.2843432
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(33.3568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8726304 KL Loss: 14.1851698 DSM Loss: 18.0797641 Overall Loss:34.1375642
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7336494326591492


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(45.3337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 2.0389813 KL Loss: 14.6099909 DSM Loss: 23.7799049 Overall Loss:40.4288771
Validation loss decreased (inf --> 0.691354).  Saving model ...
Updating learning rate to 0.0005
tensor(29.7584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9172189 KL Loss: 14.2280212 DSM Loss: 20.1431381 Overall Loss:36.2883781
Validation loss decreased (0.691354 --> 0.689809).  Saving model ...
Updating learning rate to 0.00025
tensor(34.2725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8946198 KL Loss: 14.3255562 DSM Loss: 19.3139637 Overall Loss:35.5341399
Validation loss decreased (0.689809 --> 0.688197).  Saving model ...
Updating learning rate to 0.000125
tensor(43.8151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8870840 KL Loss: 14.3006077 DSM Loss: 19.0084671 Overall Loss:35.1961588
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(51.9545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8629616 KL Loss: 14.1678625 DSM Loss: 19.2490845 Overall Loss:35.2799087
Validation loss decreased (0.688197 --> 0.687942).  Saving model ...
Updating learning rate to 3.125e-05
tensor(34.4521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8269236 KL Loss: 14.1248958 DSM Loss: 19.3345699 Overall Loss:35.2863894
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(32.5976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8686413 KL Loss: 14.2702771 DSM Loss: 18.7950073 Overall Loss:34.9339257
Validation loss decreased (0.687942 --> 0.687669).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(25.3633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8266571 KL Loss: 14.2298073 DSM Loss: 18.6961766 Overall Loss:34.7526409
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(35.4980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8226908 KL Loss: 14.0782659 DSM Loss: 19.1229674 Overall Loss:35.0239241
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8648493885993958


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(45.3477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9337261 KL Loss: 14.3661007 DSM Loss: 23.8798435 Overall Loss:40.1796703
Validation loss decreased (inf --> 1.356833).  Saving model ...
Updating learning rate to 0.0005
tensor(30.0385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8573486 KL Loss: 14.2743685 DSM Loss: 19.7875489 Overall Loss:35.9192657
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(37.2798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8957272 KL Loss: 14.2926545 DSM Loss: 19.6165395 Overall Loss:35.8049213
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9346060156822205


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(78.7237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8972502 KL Loss: 14.2867247 DSM Loss: 25.3710675 Overall Loss:41.5550425
Validation loss decreased (inf --> 1.082342).  Saving model ...
Updating learning rate to 0.0005
tensor(40.2303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.8871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1118, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8708985 KL Loss: 14.2504351 DSM Loss: 19.8906758 Overall Loss:36.0120093
Validation loss decreased (1.082342 --> 1.079456).  Saving model ...
Updating learning rate to 0.00025
tensor(34.5041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9062430 KL Loss: 14.3002419 DSM Loss: 19.4732994 Overall Loss:35.6797844
Validation loss decreased (1.079456 --> 1.078743).  Saving model ...
Updating learning rate to 0.000125
tensor(28.1732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3335, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8961350 KL Loss: 14.3205777 DSM Loss: 19.1427503 Overall Loss:35.3594630
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(35.0359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8643245 KL Loss: 14.2533981 DSM Loss: 18.7793731 Overall Loss:34.8970956
Validation loss decreased (1.078743 --> 1.078424).  Saving model ...
Updating learning rate to 3.125e-05
tensor(38.1326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2225, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8548191 KL Loss: 14.2188243 DSM Loss: 18.4714757 Overall Loss:34.5451191
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(31.8776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8623259 KL Loss: 14.2080879 DSM Loss: 19.0103756 Overall Loss:35.0807892
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6667211651802063


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(55.6477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9002945 KL Loss: 14.3289685 DSM Loss: 21.8996438 Overall Loss:38.1289069
Validation loss decreased (inf --> 0.822243).  Saving model ...
Updating learning rate to 0.0005
tensor(34.5958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9397311 KL Loss: 14.3919781 DSM Loss: 19.1410438 Overall Loss:35.4727528
Validation loss decreased (0.822243 --> 0.821735).  Saving model ...
Updating learning rate to 0.00025
tensor(34.1086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9068148 KL Loss: 14.2596227 DSM Loss: 19.1218480 Overall Loss:35.2882854
Validation loss decreased (0.821735 --> 0.821035).  Saving model ...
Updating learning rate to 0.000125
tensor(25.0836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4332, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8517806 KL Loss: 14.1386136 DSM Loss: 19.1159984 Overall Loss:35.1063927
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(34.6102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8526611 KL Loss: 14.2387593 DSM Loss: 18.7328533 Overall Loss:34.8242739
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.0213170051574707


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.5296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8901250 KL Loss: 14.3969655 DSM Loss: 23.4740846 Overall Loss:39.7611750
Validation loss decreased (inf --> 0.993352).  Saving model ...
Updating learning rate to 0.0005
tensor(29.0087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8865757 KL Loss: 14.2615375 DSM Loss: 19.4459483 Overall Loss:35.5940614
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(33.6725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8755336 KL Loss: 14.2839403 DSM Loss: 18.9792518 Overall Loss:35.1387255
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.6981861591339111


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(66.5652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8947281 KL Loss: 14.4263662 DSM Loss: 22.9374146 Overall Loss:39.2585088
Validation loss decreased (inf --> 1.041965).  Saving model ...
Updating learning rate to 0.0005
tensor(32.4171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8635497 KL Loss: 14.2068726 DSM Loss: 19.9333010 Overall Loss:36.0037230
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(32.1312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8939365 KL Loss: 14.3252158 DSM Loss: 19.1091344 Overall Loss:35.3282868
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.219862937927246


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.4512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8702714 KL Loss: 14.2168659 DSM Loss: 22.6360417 Overall Loss:38.7231790
Validation loss decreased (inf --> 1.301782).  Saving model ...
Updating learning rate to 0.0005
tensor(26.8230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9160182 KL Loss: 14.2667542 DSM Loss: 19.9196471 Overall Loss:36.1024198
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(30.6812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8047, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8265252 KL Loss: 14.1643227 DSM Loss: 19.2909097 Overall Loss:35.2817575
Validation loss decreased (1.301782 --> 1.297503).  Saving model ...
Updating learning rate to 0.000125
tensor(38.6640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0696, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9305351 KL Loss: 14.3700551 DSM Loss: 19.1169756 Overall Loss:35.4175657
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(48.1845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9027327 KL Loss: 14.3100318 DSM Loss: 18.9873003 Overall Loss:35.2000648
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.2643136978149414


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.4369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0779, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8899967 KL Loss: 14.3085895 DSM Loss: 23.5169613 Overall Loss:39.7155475
Validation loss decreased (inf --> 0.757619).  Saving model ...
Updating learning rate to 0.0005
tensor(31.7454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8618960 KL Loss: 14.2643298 DSM Loss: 19.7004653 Overall Loss:35.8266911
Validation loss decreased (0.757619 --> 0.755513).  Saving model ...
Updating learning rate to 0.00025
tensor(46.2401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9105345 KL Loss: 14.3571040 DSM Loss: 18.7688277 Overall Loss:35.0364662
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(39.6529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8928504 KL Loss: 14.3551156 DSM Loss: 18.4641260 Overall Loss:34.7120918
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.69975346326828


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(41.3366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8619653 KL Loss: 14.3190488 DSM Loss: 23.2413547 Overall Loss:39.4223688
Validation loss decreased (inf --> 0.646211).  Saving model ...
Updating learning rate to 0.0005
tensor(53.1697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9307867 KL Loss: 14.3920024 DSM Loss: 18.9077661 Overall Loss:35.2305552
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(24.7385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8489902 KL Loss: 14.2866615 DSM Loss: 19.0411362 Overall Loss:35.1767880
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7648082971572876


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(43.5532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9028899 KL Loss: 14.3468330 DSM Loss: 22.5164078 Overall Loss:38.7661307
Validation loss decreased (inf --> 0.481388).  Saving model ...
Updating learning rate to 0.0005
tensor(58.5371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9977235 KL Loss: 14.4650708 DSM Loss: 18.7517341 Overall Loss:35.2145283
Validation loss decreased (0.481388 --> 0.481227).  Saving model ...
Updating learning rate to 0.00025
tensor(30.7021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4203, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9536174 KL Loss: 14.4068891 DSM Loss: 18.5412519 Overall Loss:34.9017584
Validation loss decreased (0.481227 --> 0.475686).  Saving model ...
Updating learning rate to 0.000125
tensor(43.1073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.3556, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8238981 KL Loss: 14.1374564 DSM Loss: 18.9011984 Overall Loss:34.8625527
Validation loss decreased (0.475686 --> 0.462945).  Saving model ...
Updating learning rate to 6.25e-05
tensor(24.2501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0594, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8383200 KL Loss: 14.2131936 DSM Loss: 18.7548098 Overall Loss:34.8063234
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(58.4115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2463, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8491731 KL Loss: 14.1322060 DSM Loss: 18.9861909 Overall Loss:34.9675700
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.641966700553894


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(51.8895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9447209 KL Loss: 14.3853768 DSM Loss: 21.8309272 Overall Loss:38.1610250
Validation loss decreased (inf --> 1.491168).  Saving model ...
Updating learning rate to 0.0005
tensor(42.5372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8878091 KL Loss: 14.3904585 DSM Loss: 19.4413609 Overall Loss:35.7196286
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(35.2606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8718971 KL Loss: 14.0949219 DSM Loss: 19.3282791 Overall Loss:35.2950982
Validation loss decreased (1.491168 --> 1.489295).  Saving model ...
Updating learning rate to 0.000125
tensor(36.2027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8630538 KL Loss: 14.2628132 DSM Loss: 19.2271199 Overall Loss:35.3529869
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(39.2315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3375, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8360703 KL Loss: 14.2002972 DSM Loss: 19.4652962 Overall Loss:35.5016637
Validation loss decreased (1.489295 --> 1.487283).  Saving model ...
Updating learning rate to 3.125e-05
tensor(44.6367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8080, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8730854 KL Loss: 14.1825998 DSM Loss: 19.2790864 Overall Loss:35.3347718
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(45.7585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8601138 KL Loss: 14.2890392 DSM Loss: 19.1295428 Overall Loss:35.2786959
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.718644618988037


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(40.1815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9098314 KL Loss: 14.4216206 DSM Loss: 24.1095274 Overall Loss:40.4409794
Validation loss decreased (inf --> 1.101865).  Saving model ...
Updating learning rate to 0.0005
tensor(33.2355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8830343 KL Loss: 14.2213339 DSM Loss: 19.9539692 Overall Loss:36.0583371
Validation loss decreased (1.101865 --> 1.101229).  Saving model ...
Updating learning rate to 0.00025
tensor(28.5201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8709401 KL Loss: 14.1823574 DSM Loss: 19.6246508 Overall Loss:35.6779483
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(32.1632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8568290 KL Loss: 14.1265595 DSM Loss: 19.0903366 Overall Loss:35.0737250
Validation loss decreased (1.101229 --> 1.097311).  Saving model ...
Updating learning rate to 6.25e-05
tensor(29.6505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8424364 KL Loss: 14.2251827 DSM Loss: 18.6407339 Overall Loss:34.7083528
Validation loss decreased (1.097311 --> 1.093544).  Saving model ...
Updating learning rate to 3.125e-05
tensor(29.8121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.0917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8280484 KL Loss: 14.0089157 DSM Loss: 19.2238195 Overall Loss:35.0607835
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(29.4978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8398619 KL Loss: 14.2105039 DSM Loss: 19.0106474 Overall Loss:35.0610132
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.3851070404052734


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(78.3185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8909976 KL Loss: 14.2826479 DSM Loss: 23.8130611 Overall Loss:39.9867065
Validation loss decreased (inf --> 0.579697).  Saving model ...
Updating learning rate to 0.0005
tensor(27.0407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9779819 KL Loss: 14.5171858 DSM Loss: 19.5320437 Overall Loss:36.0272115
Validation loss decreased (0.579697 --> 0.577385).  Saving model ...
Updating learning rate to 0.00025
tensor(30.0998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9205490 KL Loss: 14.3140922 DSM Loss: 19.2040146 Overall Loss:35.4386559
Validation loss decreased (0.577385 --> 0.570115).  Saving model ...
Updating learning rate to 0.000125
tensor(27.4800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9087935 KL Loss: 14.2344082 DSM Loss: 19.3855562 Overall Loss:35.5287578
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(48.0411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0820, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8828440 KL Loss: 14.2923773 DSM Loss: 18.9529942 Overall Loss:35.1282152
Validation loss decreased (0.570115 --> 0.570000).  Saving model ...
Updating learning rate to 3.125e-05
tensor(25.6047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9469506 KL Loss: 14.4904458 DSM Loss: 18.5223802 Overall Loss:34.9597764
Validation loss decreased (0.570000 --> 0.569979).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(25.3139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8611516 KL Loss: 14.2138012 DSM Loss: 18.8098650 Overall Loss:34.8848176
Validation loss decreased (0.569979 --> 0.569813).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(27.3281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8952133 KL Loss: 14.1696798 DSM Loss: 18.4117875 Overall Loss:34.4766808
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(22.4768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4471, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8995436 KL Loss: 14.2840542 DSM Loss: 19.1594180 Overall Loss:35.3430158
Validation loss decreased (0.569813 --> 0.569784).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(47.5785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4692, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8677413 KL Loss: 14.1807788 DSM Loss: 19.3800141 Overall Loss:35.4285342
Validation loss decreased (0.569784 --> 0.569690).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(25.8434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0205, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8484307 KL Loss: 14.0694434 DSM Loss: 19.3237737 Overall Loss:35.2416473
EarlyStopping counter: 1 out of 2
Updating learning rate to 4.8828125e-07
tensor(25.9406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8363742 KL Loss: 14.0338307 DSM Loss: 19.4236485 Overall Loss:35.2938534
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8834921717643738


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(42.6655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9765886 KL Loss: 14.6925871 DSM Loss: 23.1659716 Overall Loss:39.8351475
Validation loss decreased (inf --> 0.665342).  Saving model ...
Updating learning rate to 0.0005
tensor(27.0681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0374, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8460950 KL Loss: 14.1405328 DSM Loss: 20.3871745 Overall Loss:36.3738022
Validation loss decreased (0.665342 --> 0.629001).  Saving model ...
Updating learning rate to 0.00025
tensor(23.6272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9588384 KL Loss: 14.3209596 DSM Loss: 18.9332115 Overall Loss:35.2130095
Validation loss decreased (0.629001 --> 0.624956).  Saving model ...
Updating learning rate to 0.000125
tensor(53.2639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8975039 KL Loss: 14.1690360 DSM Loss: 19.1903467 Overall Loss:35.2568865
Validation loss decreased (0.624956 --> 0.624792).  Saving model ...
Updating learning rate to 6.25e-05
tensor(30.1267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9183649 KL Loss: 14.2702376 DSM Loss: 19.1886828 Overall Loss:35.3772853
Validation loss decreased (0.624792 --> 0.624569).  Saving model ...
Updating learning rate to 3.125e-05
tensor(23.0136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8054800 KL Loss: 13.9250979 DSM Loss: 19.6388691 Overall Loss:35.3694470
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(57.7803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8579030 KL Loss: 14.1157399 DSM Loss: 18.9711508 Overall Loss:34.9447937
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.1421324014663696


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(49.1403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8568272 KL Loss: 14.0778291 DSM Loss: 26.1419784 Overall Loss:42.0766349
Validation loss decreased (inf --> 0.504306).  Saving model ...
Updating learning rate to 0.0005
tensor(48.8120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9435449 KL Loss: 14.5258724 DSM Loss: 18.5578517 Overall Loss:35.0272688
Validation loss decreased (0.504306 --> 0.503373).  Saving model ...
Updating learning rate to 0.00025
tensor(28.1081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8860, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9282097 KL Loss: 14.4058627 DSM Loss: 19.1469365 Overall Loss:35.4810091
Validation loss decreased (0.503373 --> 0.495045).  Saving model ...
Updating learning rate to 0.000125
tensor(52.5603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1435, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8253216 KL Loss: 14.1007912 DSM Loss: 18.8198837 Overall Loss:34.7459966
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(33.6062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7897926 KL Loss: 14.0688903 DSM Loss: 19.0092925 Overall Loss:34.8679752
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7862124443054199


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(59.7081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9288581 KL Loss: 14.3571994 DSM Loss: 22.2833325 Overall Loss:38.5693898
Validation loss decreased (inf --> 0.632388).  Saving model ...
Updating learning rate to 0.0005
tensor(50.6219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9554989 KL Loss: 14.3508552 DSM Loss: 19.5633212 Overall Loss:35.8696752
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(29.5867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8917042 KL Loss: 14.2583888 DSM Loss: 19.4310404 Overall Loss:35.5811334
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7177589535713196


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(64.1508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9435135 KL Loss: 14.3089138 DSM Loss: 22.5604996 Overall Loss:38.8129268
Validation loss decreased (inf --> 0.686918).  Saving model ...
Updating learning rate to 0.0005
tensor(33.5728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8938371 KL Loss: 14.2123079 DSM Loss: 20.1366585 Overall Loss:36.2428033
Validation loss decreased (0.686918 --> 0.668779).  Saving model ...
Updating learning rate to 0.00025
tensor(44.9234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8916991 KL Loss: 14.2529403 DSM Loss: 19.5160591 Overall Loss:35.6606982
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(32.8258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8409708 KL Loss: 14.1049617 DSM Loss: 19.3205461 Overall Loss:35.2664787
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5289415717124939


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(57.8558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9318930 KL Loss: 14.3741240 DSM Loss: 23.0808305 Overall Loss:39.3868474
Validation loss decreased (inf --> 1.278150).  Saving model ...
Updating learning rate to 0.0005
tensor(33.5743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8907722 KL Loss: 14.2574380 DSM Loss: 19.4643759 Overall Loss:35.6125859
Validation loss decreased (1.278150 --> 1.277774).  Saving model ...
Updating learning rate to 0.00025
tensor(28.8110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8514194 KL Loss: 14.1473687 DSM Loss: 18.9807087 Overall Loss:34.9794968
Validation loss decreased (1.277774 --> 1.263854).  Saving model ...
Updating learning rate to 0.000125
tensor(37.7614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.3053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8592099 KL Loss: 14.2523311 DSM Loss: 18.7053272 Overall Loss:34.8168680
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(35.6598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8211283 KL Loss: 14.1549862 DSM Loss: 18.9888100 Overall Loss:34.9649241
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.7702010869979858


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(43.5583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.8436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9161169 KL Loss: 14.2731539 DSM Loss: 23.1408695 Overall Loss:39.3301406
Validation loss decreased (inf --> 1.155492).  Saving model ...
Updating learning rate to 0.0005
tensor(28.8467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7197, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8817346 KL Loss: 14.2493066 DSM Loss: 19.3295083 Overall Loss:35.4605496
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(26.7512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8956503 KL Loss: 14.2576318 DSM Loss: 19.0067627 Overall Loss:35.1600447
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.011139988899231


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(66.0312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9958421 KL Loss: 14.5077658 DSM Loss: 24.1187694 Overall Loss:40.6223774
Validation loss decreased (inf --> 0.793080).  Saving model ...
Updating learning rate to 0.0005
tensor(29.6231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6306, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8987061 KL Loss: 14.1478869 DSM Loss: 19.8827709 Overall Loss:35.9293640
Validation loss decreased (0.793080 --> 0.782433).  Saving model ...
Updating learning rate to 0.00025
tensor(32.9304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.8147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8528470 KL Loss: 14.2915375 DSM Loss: 19.3042413 Overall Loss:35.4486257
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(47.7870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9119923 KL Loss: 14.2440614 DSM Loss: 19.1382207 Overall Loss:35.2942744
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7179723381996155


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(64.9922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9904796 KL Loss: 14.3913848 DSM Loss: 22.3026058 Overall Loss:38.6844701
Validation loss decreased (inf --> 1.348334).  Saving model ...
Updating learning rate to 0.0005
tensor(27.9742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9057920 KL Loss: 14.2788846 DSM Loss: 18.8964665 Overall Loss:35.0811431
Validation loss decreased (1.348334 --> 1.346705).  Saving model ...
Updating learning rate to 0.00025
tensor(25.5538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8798182 KL Loss: 14.2173633 DSM Loss: 18.7158799 Overall Loss:34.8130614
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(39.4897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8753460 KL Loss: 14.2336036 DSM Loss: 18.5763754 Overall Loss:34.6853247
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.023977279663086


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(43.3805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9455500 KL Loss: 14.3921011 DSM Loss: 21.6508016 Overall Loss:37.9884525
Validation loss decreased (inf --> 0.339681).  Saving model ...
Updating learning rate to 0.0005
tensor(40.1494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9067622 KL Loss: 14.3105315 DSM Loss: 18.8063946 Overall Loss:35.0236883
Validation loss decreased (0.339681 --> 0.336282).  Saving model ...
Updating learning rate to 0.00025
tensor(24.4732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8788487 KL Loss: 14.2266812 DSM Loss: 18.6423506 Overall Loss:34.7478807
Validation loss decreased (0.336282 --> 0.331451).  Saving model ...
Updating learning rate to 0.000125
tensor(31.9304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8429850 KL Loss: 14.1729827 DSM Loss: 18.2815899 Overall Loss:34.2975575
Validation loss decreased (0.331451 --> 0.331418).  Saving model ...
Updating learning rate to 6.25e-05
tensor(30.0927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8187505 KL Loss: 14.1380058 DSM Loss: 18.1876779 Overall Loss:34.1444344
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(25.4836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8834869 KL Loss: 14.4582125 DSM Loss: 17.8221424 Overall Loss:34.1638419
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.0964784622192383


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(38.0365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9128421 KL Loss: 14.4747858 DSM Loss: 21.8898880 Overall Loss:38.2775157
Validation loss decreased (inf --> 0.942553).  Saving model ...
Updating learning rate to 0.0005
tensor(52.7143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9730486 KL Loss: 14.4386181 DSM Loss: 19.0442422 Overall Loss:35.4559089
Validation loss decreased (0.942553 --> 0.938404).  Saving model ...
Updating learning rate to 0.00025
tensor(32.6839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8973706 KL Loss: 14.2175782 DSM Loss: 19.5091991 Overall Loss:35.6241480
Validation loss decreased (0.938404 --> 0.918915).  Saving model ...
Updating learning rate to 0.000125
tensor(26.4215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8236364 KL Loss: 14.1065391 DSM Loss: 19.3603348 Overall Loss:35.2905103
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(29.2463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8378382 KL Loss: 14.2697854 DSM Loss: 18.8234913 Overall Loss:34.9311149
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.377204418182373


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(55.6735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8526849 KL Loss: 14.2547789 DSM Loss: 22.9345641 Overall Loss:39.0420280
Validation loss decreased (inf --> 0.749983).  Saving model ...
Updating learning rate to 0.0005
tensor(36.7582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8875997 KL Loss: 14.2089501 DSM Loss: 19.7275440 Overall Loss:35.8240941
Validation loss decreased (0.749983 --> 0.748037).  Saving model ...
Updating learning rate to 0.00025
tensor(37.8502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8680043 KL Loss: 14.2955654 DSM Loss: 19.2754850 Overall Loss:35.4390549
Validation loss decreased (0.748037 --> 0.747403).  Saving model ...
Updating learning rate to 0.000125
tensor(47.9719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8570213 KL Loss: 14.2147192 DSM Loss: 18.9899450 Overall Loss:35.0616856
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(31.1259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8605539 KL Loss: 14.3145567 DSM Loss: 18.6361135 Overall Loss:34.8112242
Validation loss decreased (0.747403 --> 0.747009).  Saving model ...
Updating learning rate to 3.125e-05
tensor(45.2238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8605808 KL Loss: 14.2358784 DSM Loss: 18.8373766 Overall Loss:34.9338359
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(26.5144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8579086 KL Loss: 14.2963290 DSM Loss: 18.6828025 Overall Loss:34.8370399
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7367163896560669


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(55.2085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9106925 KL Loss: 14.3906334 DSM Loss: 22.0453474 Overall Loss:38.3466733
Validation loss decreased (inf --> 0.776549).  Saving model ...
Updating learning rate to 0.0005
tensor(27.9692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9501, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9069309 KL Loss: 14.2489658 DSM Loss: 19.6773296 Overall Loss:35.8332263
Validation loss decreased (0.776549 --> 0.768177).  Saving model ...
Updating learning rate to 0.00025
tensor(35.2737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8676601 KL Loss: 14.2539666 DSM Loss: 19.1626555 Overall Loss:35.2842820
Validation loss decreased (0.768177 --> 0.764505).  Saving model ...
Updating learning rate to 0.000125
tensor(29.4529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8656927 KL Loss: 14.2309489 DSM Loss: 18.6894590 Overall Loss:34.7861007
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(78.4114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8500, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8582885 KL Loss: 14.2069915 DSM Loss: 18.8992272 Overall Loss:34.9645072
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6660124659538269


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.9211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9586019 KL Loss: 14.4994961 DSM Loss: 24.4879909 Overall Loss:40.9460887
Validation loss decreased (inf --> 0.725530).  Saving model ...
Updating learning rate to 0.0005
tensor(30.8807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9692351 KL Loss: 14.3992266 DSM Loss: 20.0048511 Overall Loss:36.3733130
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(37.0564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8598506 KL Loss: 14.2124020 DSM Loss: 19.6173345 Overall Loss:35.6895869
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6363200545310974


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(44.2789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3368, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9130101 KL Loss: 14.2392941 DSM Loss: 23.4088499 Overall Loss:39.5611544
Validation loss decreased (inf --> 1.222318).  Saving model ...
Updating learning rate to 0.0005
tensor(56.8243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1861, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8700708 KL Loss: 14.1600551 DSM Loss: 19.7164597 Overall Loss:35.7465854
Validation loss decreased (1.222318 --> 1.207613).  Saving model ...
Updating learning rate to 0.00025
tensor(31.1145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8715026 KL Loss: 14.3028080 DSM Loss: 18.8453223 Overall Loss:35.0196328
Validation loss decreased (1.207613 --> 1.207213).  Saving model ...
Updating learning rate to 0.000125
tensor(37.6076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0874, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8768324 KL Loss: 14.1576544 DSM Loss: 19.0278492 Overall Loss:35.0623360
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(31.9603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5018, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8245215 KL Loss: 14.1439673 DSM Loss: 19.4593814 Overall Loss:35.4278699
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8374758958816528


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.8831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9015740 KL Loss: 14.3970777 DSM Loss: 21.6800103 Overall Loss:37.9786622
Validation loss decreased (inf --> 1.377690).  Saving model ...
Updating learning rate to 0.0005
tensor(37.9565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8704, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8895052 KL Loss: 14.1612732 DSM Loss: 19.6180358 Overall Loss:35.6688142
Validation loss decreased (1.377690 --> 1.374266).  Saving model ...
Updating learning rate to 0.00025
tensor(49.1168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8543700 KL Loss: 14.1783299 DSM Loss: 19.3278654 Overall Loss:35.3605651
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(45.8728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8434796 KL Loss: 14.1750368 DSM Loss: 18.7200967 Overall Loss:34.7386129
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6130627989768982


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(50.7237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9138893 KL Loss: 14.2443616 DSM Loss: 23.5059094 Overall Loss:39.6641603
Validation loss decreased (inf --> 0.600209).  Saving model ...
Updating learning rate to 0.0005
tensor(61.9748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9462620 KL Loss: 14.5644112 DSM Loss: 19.4283812 Overall Loss:35.9390546
Validation loss decreased (0.600209 --> 0.596086).  Saving model ...
Updating learning rate to 0.00025
tensor(24.6667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8056, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8379450 KL Loss: 14.1591940 DSM Loss: 19.7486677 Overall Loss:35.7458068
Validation loss decreased (0.596086 --> 0.594520).  Saving model ...
Updating learning rate to 0.000125
tensor(24.5413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8667734 KL Loss: 14.1735885 DSM Loss: 19.5389622 Overall Loss:35.5793240
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(40.8027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8788063 KL Loss: 14.3193356 DSM Loss: 19.3162943 Overall Loss:35.5144361
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.49758967757225037


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(39.2205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9172553 KL Loss: 14.3510618 DSM Loss: 22.4905013 Overall Loss:38.7588182
Validation loss decreased (inf --> 0.955965).  Saving model ...
Updating learning rate to 0.0005
tensor(32.0024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8703922 KL Loss: 14.2497180 DSM Loss: 19.5883688 Overall Loss:35.7084789
Validation loss decreased (0.955965 --> 0.951570).  Saving model ...
Updating learning rate to 0.00025
tensor(44.7027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0244, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8653395 KL Loss: 14.1463972 DSM Loss: 19.2279425 Overall Loss:35.2396794
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(51.2503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8547713 KL Loss: 14.1553187 DSM Loss: 19.1065372 Overall Loss:35.1166272
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9523727893829346


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.5403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9012077 KL Loss: 14.3721504 DSM Loss: 22.1524088 Overall Loss:38.4257669
Validation loss decreased (inf --> 0.741982).  Saving model ...
Updating learning rate to 0.0005
tensor(35.9824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6382, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9243812 KL Loss: 14.4208364 DSM Loss: 19.6376862 Overall Loss:35.9829038
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(30.3935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8497750 KL Loss: 14.1979952 DSM Loss: 19.3853532 Overall Loss:35.4331234
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.407940149307251


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.0471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0490, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9089651 KL Loss: 14.4249841 DSM Loss: 25.7193064 Overall Loss:42.0532556
Validation loss decreased (inf --> 0.757775).  Saving model ...
Updating learning rate to 0.0005
tensor(59.3020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7953, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9732963 KL Loss: 14.4466111 DSM Loss: 19.8037275 Overall Loss:36.2236349
Validation loss decreased (0.757775 --> 0.756922).  Saving model ...
Updating learning rate to 0.00025
tensor(58.8530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8469153 KL Loss: 14.1791820 DSM Loss: 19.5349881 Overall Loss:35.5610853
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(35.8606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8472623 KL Loss: 14.2871224 DSM Loss: 19.2773924 Overall Loss:35.4117769
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7159270644187927


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(70.7914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8807893 KL Loss: 14.3520075 DSM Loss: 23.3608958 Overall Loss:39.5936925
Validation loss decreased (inf --> 1.451856).  Saving model ...
Updating learning rate to 0.0005
tensor(32.7731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8375929 KL Loss: 14.2509258 DSM Loss: 20.6319164 Overall Loss:36.7204350
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(31.6677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8411088 KL Loss: 14.1766861 DSM Loss: 20.0545640 Overall Loss:36.0723588
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8236225843429565


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(71.8964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8532721 KL Loss: 14.2668249 DSM Loss: 23.0449355 Overall Loss:39.1650324
Validation loss decreased (inf --> 1.096202).  Saving model ...
Updating learning rate to 0.0005
tensor(46.9477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9149995 KL Loss: 14.2871363 DSM Loss: 19.5750753 Overall Loss:35.7772110
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(35.7849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8704499 KL Loss: 14.1980408 DSM Loss: 19.2802331 Overall Loss:35.3487236
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.2262389659881592


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.4625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9650081 KL Loss: 14.4513685 DSM Loss: 23.5051864 Overall Loss:39.9215632
Validation loss decreased (inf --> 1.323187).  Saving model ...
Updating learning rate to 0.0005
tensor(27.1011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.8637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8121728 KL Loss: 14.0544727 DSM Loss: 20.3852587 Overall Loss:36.2519041
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(44.7021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8730811 KL Loss: 14.2190107 DSM Loss: 19.6041916 Overall Loss:35.6962835
Validation loss decreased (1.323187 --> 1.315960).  Saving model ...
Updating learning rate to 0.000125
tensor(34.1436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0668, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8578191 KL Loss: 14.2614580 DSM Loss: 19.2846911 Overall Loss:35.4039681
Validation loss decreased (1.315960 --> 1.312882).  Saving model ...
Updating learning rate to 6.25e-05
tensor(25.9081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8772220 KL Loss: 14.1026388 DSM Loss: 18.1610608 Overall Loss:34.1409215
Validation loss decreased (1.312882 --> 1.312314).  Saving model ...
Updating learning rate to 3.125e-05
tensor(27.2941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8350575 KL Loss: 14.0859310 DSM Loss: 19.4071215 Overall Loss:35.3281101
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(26.4575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8612604 KL Loss: 14.2770414 DSM Loss: 19.4865581 Overall Loss:35.6248598
Validation loss decreased (1.312314 --> 1.310783).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(30.6442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8731511 KL Loss: 14.1990399 DSM Loss: 19.1566364 Overall Loss:35.2288272
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(28.7614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8592990 KL Loss: 14.1785676 DSM Loss: 18.8611371 Overall Loss:34.8990038
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.5532675981521606


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.5246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9694479 KL Loss: 14.4433559 DSM Loss: 22.9759486 Overall Loss:39.3887522
Validation loss decreased (inf --> 0.583090).  Saving model ...
Updating learning rate to 0.0005
tensor(49.5672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8920729 KL Loss: 14.3230796 DSM Loss: 20.0049698 Overall Loss:36.2201222
Validation loss decreased (0.583090 --> 0.579582).  Saving model ...
Updating learning rate to 0.00025
tensor(27.0528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 2.0095530 KL Loss: 14.5487400 DSM Loss: 19.1958594 Overall Loss:35.7541522
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(36.6477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6864, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8997810 KL Loss: 14.3944233 DSM Loss: 18.9424963 Overall Loss:35.2367006
Validation loss decreased (0.579582 --> 0.578949).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.4695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8106201 KL Loss: 14.0287028 DSM Loss: 19.5601156 Overall Loss:35.3994385
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(29.6182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8682211 KL Loss: 14.3165668 DSM Loss: 19.1885085 Overall Loss:35.3732966
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9772582054138184


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(54.9756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5777, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8885603 KL Loss: 14.3419239 DSM Loss: 22.5621633 Overall Loss:38.7926478
Validation loss decreased (inf --> 0.744300).  Saving model ...
Updating learning rate to 0.0005
tensor(27.8299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8864360 KL Loss: 14.3258187 DSM Loss: 19.3045095 Overall Loss:35.5167642
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(30.7230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8577723 KL Loss: 14.2244837 DSM Loss: 19.1948686 Overall Loss:35.2771246
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9626215100288391


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(46.1021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8848296 KL Loss: 14.2506300 DSM Loss: 23.6550219 Overall Loss:39.7904813
Validation loss decreased (inf --> 1.516267).  Saving model ...
Updating learning rate to 0.0005
tensor(34.4865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8768166 KL Loss: 14.2131697 DSM Loss: 19.9105838 Overall Loss:36.0005702
Validation loss decreased (1.516267 --> 1.497418).  Saving model ...
Updating learning rate to 0.00025
tensor(29.8145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8646363 KL Loss: 14.1799493 DSM Loss: 19.6357467 Overall Loss:35.6803323
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(28.6903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8461159 KL Loss: 14.1549648 DSM Loss: 19.4437167 Overall Loss:35.4447974
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.253710150718689


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.2540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9035216 KL Loss: 14.3721980 DSM Loss: 23.0179879 Overall Loss:39.2937074
Validation loss decreased (inf --> 0.213165).  Saving model ...
Updating learning rate to 0.0005
tensor(22.1501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.4349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1480, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9121157 KL Loss: 14.3350357 DSM Loss: 20.0103788 Overall Loss:36.2575301
Validation loss decreased (0.213165 --> 0.209757).  Saving model ...
Updating learning rate to 0.00025
tensor(25.4567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9322995 KL Loss: 14.5044616 DSM Loss: 18.9308365 Overall Loss:35.3675975
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(28.0855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8888159 KL Loss: 14.2778831 DSM Loss: 18.8984142 Overall Loss:35.0651132
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.12257467955350876


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(38.5098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8751651 KL Loss: 14.1914974 DSM Loss: 23.0280646 Overall Loss:39.0947271
Validation loss decreased (inf --> 0.637687).  Saving model ...
Updating learning rate to 0.0005
tensor(26.5917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8802524 KL Loss: 14.2134604 DSM Loss: 19.8145055 Overall Loss:35.9082180
Validation loss decreased (0.637687 --> 0.637211).  Saving model ...
Updating learning rate to 0.00025
tensor(26.2695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8912685 KL Loss: 14.3171608 DSM Loss: 19.6650145 Overall Loss:35.8734436
Validation loss decreased (0.637211 --> 0.636824).  Saving model ...
Updating learning rate to 0.000125
tensor(31.3484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9636, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8767075 KL Loss: 14.4108154 DSM Loss: 18.9433778 Overall Loss:35.2309005
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(22.6423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8285488 KL Loss: 14.2339175 DSM Loss: 19.5116318 Overall Loss:35.5740982
Validation loss decreased (0.636824 --> 0.636123).  Saving model ...
Updating learning rate to 3.125e-05
tensor(67.9541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8405869 KL Loss: 14.2586289 DSM Loss: 19.3592301 Overall Loss:35.4584459
Validation loss decreased (0.636123 --> 0.636008).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(61.3739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8696457 KL Loss: 14.2914213 DSM Loss: 18.9856426 Overall Loss:35.1467097
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(23.8473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8411673 KL Loss: 14.2027966 DSM Loss: 18.6880485 Overall Loss:34.7320124
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6513360142707825


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(65.6251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8751540 KL Loss: 14.3414213 DSM Loss: 23.2109816 Overall Loss:39.4275567
Validation loss decreased (inf --> 2.247807).  Saving model ...
Updating learning rate to 0.0005
tensor(32.2893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9048718 KL Loss: 14.2599929 DSM Loss: 19.8720330 Overall Loss:36.0368977
Validation loss decreased (2.247807 --> 2.228333).  Saving model ...
Updating learning rate to 0.00025
tensor(27.5229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8906996 KL Loss: 14.3300106 DSM Loss: 19.1465334 Overall Loss:35.3672435
Validation loss decreased (2.228333 --> 2.226357).  Saving model ...
Updating learning rate to 0.000125
tensor(31.9013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8591253 KL Loss: 14.2639207 DSM Loss: 19.3884076 Overall Loss:35.5114537
Validation loss decreased (2.226357 --> 2.223896).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.5523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9793, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8495614 KL Loss: 14.1932620 DSM Loss: 19.0746379 Overall Loss:35.1174614
Validation loss decreased (2.223896 --> 2.222959).  Saving model ...
Updating learning rate to 3.125e-05
tensor(27.7386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8522485 KL Loss: 14.2064096 DSM Loss: 19.0601241 Overall Loss:35.1187820
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(48.7237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8665171 KL Loss: 14.2921901 DSM Loss: 18.4781975 Overall Loss:34.6369047
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.1259129047393799


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(67.6970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9346, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9678677 KL Loss: 14.5073998 DSM Loss: 25.2297290 Overall Loss:41.7049964
Validation loss decreased (inf --> 0.800428).  Saving model ...
Updating learning rate to 0.0005
tensor(25.3734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8559696 KL Loss: 14.1566035 DSM Loss: 20.8702761 Overall Loss:36.8828493
Validation loss decreased (0.800428 --> 0.797782).  Saving model ...
Updating learning rate to 0.00025
tensor(29.9786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8624209 KL Loss: 14.3716053 DSM Loss: 20.3788174 Overall Loss:36.6128435
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(36.7473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8646771 KL Loss: 14.1918478 DSM Loss: 19.9648584 Overall Loss:36.0213835
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7683605551719666


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(73.5841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9630651 KL Loss: 14.3094059 DSM Loss: 23.6410696 Overall Loss:39.9135407
Validation loss decreased (inf --> 0.830882).  Saving model ...
Updating learning rate to 0.0005
tensor(27.1194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8290126 KL Loss: 14.1607117 DSM Loss: 20.3257919 Overall Loss:36.3155163
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(46.9248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8482847 KL Loss: 14.1977843 DSM Loss: 19.8637834 Overall Loss:35.9098526
Validation loss decreased (0.830882 --> 0.829266).  Saving model ...
Updating learning rate to 0.000125
tensor(41.7796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8744068 KL Loss: 14.2604337 DSM Loss: 19.4362981 Overall Loss:35.5711386
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(22.1349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6082, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8895408 KL Loss: 14.3206821 DSM Loss: 19.4739760 Overall Loss:35.6841987
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.587218701839447


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(52.5380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9539895 KL Loss: 14.4164596 DSM Loss: 22.9763206 Overall Loss:39.3467697
Validation loss decreased (inf --> 0.491129).  Saving model ...
Updating learning rate to 0.0005
tensor(29.4796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9206160 KL Loss: 14.2977696 DSM Loss: 19.8598983 Overall Loss:36.0782839
Validation loss decreased (0.491129 --> 0.491079).  Saving model ...
Updating learning rate to 0.00025
tensor(32.9886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6621, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8955066 KL Loss: 14.3773063 DSM Loss: 19.3769817 Overall Loss:35.6497946
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(29.3460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8761169 KL Loss: 14.3261838 DSM Loss: 19.0896874 Overall Loss:35.2919878
Validation loss decreased (0.491079 --> 0.490972).  Saving model ...
Updating learning rate to 6.25e-05
tensor(26.6303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8820461 KL Loss: 14.2921038 DSM Loss: 19.2160484 Overall Loss:35.3901982
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(28.9761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8464175 KL Loss: 14.1749130 DSM Loss: 19.6016241 Overall Loss:35.6229545
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7073434591293335


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(41.2100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9035033 KL Loss: 14.3771003 DSM Loss: 22.8010414 Overall Loss:39.0816450
Validation loss decreased (inf --> 0.979641).  Saving model ...
Updating learning rate to 0.0005
tensor(26.7257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8762080 KL Loss: 14.2895101 DSM Loss: 19.9910432 Overall Loss:36.1567613
Validation loss decreased (0.979641 --> 0.979476).  Saving model ...
Updating learning rate to 0.00025
tensor(58.3222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8764403 KL Loss: 14.2627630 DSM Loss: 19.4960383 Overall Loss:35.6352415
Validation loss decreased (0.979476 --> 0.978831).  Saving model ...
Updating learning rate to 0.000125
tensor(27.2530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8907208 KL Loss: 14.2799162 DSM Loss: 19.2736929 Overall Loss:35.4443297
Validation loss decreased (0.978831 --> 0.978421).  Saving model ...
Updating learning rate to 6.25e-05
tensor(71.2684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8656451 KL Loss: 14.2242537 DSM Loss: 19.0202593 Overall Loss:35.1101578
Validation loss decreased (0.978421 --> 0.978177).  Saving model ...
Updating learning rate to 3.125e-05
tensor(28.1651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.1364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8685373 KL Loss: 14.2257405 DSM Loss: 19.1947383 Overall Loss:35.2890161
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(32.0162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9137827 KL Loss: 14.4925933 DSM Loss: 18.3366382 Overall Loss:34.7430140
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8861081600189209


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.0853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1831, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9304640 KL Loss: 14.4152725 DSM Loss: 25.7071378 Overall Loss:42.0528743
Validation loss decreased (inf --> 1.032224).  Saving model ...
Updating learning rate to 0.0005
tensor(25.2720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8848740 KL Loss: 14.1993908 DSM Loss: 19.8261557 Overall Loss:35.9104203
Validation loss decreased (1.032224 --> 1.027400).  Saving model ...
Updating learning rate to 0.00025
tensor(35.7097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0562, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9279628 KL Loss: 14.2717425 DSM Loss: 18.9072440 Overall Loss:35.1069491
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(31.1392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8413207 KL Loss: 14.1304689 DSM Loss: 19.4366246 Overall Loss:35.4084141
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9334683418273926


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.9796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8915174 KL Loss: 14.2548378 DSM Loss: 21.6430663 Overall Loss:37.7894215
Validation loss decreased (inf --> 0.913531).  Saving model ...
Updating learning rate to 0.0005
tensor(43.0316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9076930 KL Loss: 14.3392880 DSM Loss: 19.4892422 Overall Loss:35.7362233
Validation loss decreased (0.913531 --> 0.910133).  Saving model ...
Updating learning rate to 0.00025
tensor(45.5659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8820001 KL Loss: 14.2816997 DSM Loss: 19.1414083 Overall Loss:35.3051082
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(28.5173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8693, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8770782 KL Loss: 14.3071649 DSM Loss: 19.0796441 Overall Loss:35.2638871
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.676482081413269


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(43.8374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8647730 KL Loss: 14.3279354 DSM Loss: 24.5944432 Overall Loss:40.7871516
Validation loss decreased (inf --> 0.551378).  Saving model ...
Updating learning rate to 0.0005
tensor(41.8487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9011736 KL Loss: 14.3486889 DSM Loss: 19.7325603 Overall Loss:35.9824226
Validation loss decreased (0.551378 --> 0.550215).  Saving model ...
Updating learning rate to 0.00025
tensor(25.5970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8502572 KL Loss: 14.0968799 DSM Loss: 19.5439733 Overall Loss:35.4911103
Validation loss decreased (0.550215 --> 0.549093).  Saving model ...
Updating learning rate to 0.000125
tensor(24.3502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2128, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8175678 KL Loss: 13.9968571 DSM Loss: 19.7547989 Overall Loss:35.5692237
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(22.1596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8567273 KL Loss: 14.2301921 DSM Loss: 19.4336917 Overall Loss:35.5206110
Validation loss decreased (0.549093 --> 0.548547).  Saving model ...
Updating learning rate to 3.125e-05
tensor(64.8307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8858220 KL Loss: 14.2921393 DSM Loss: 19.2883948 Overall Loss:35.4663561
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(26.3158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8473383 KL Loss: 14.1044845 DSM Loss: 19.0350308 Overall Loss:34.9868537
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7806692123413086


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(61.0288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0227, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8687283 KL Loss: 14.2238470 DSM Loss: 23.8048564 Overall Loss:39.8974313
Validation loss decreased (inf --> 1.093498).  Saving model ...
Updating learning rate to 0.0005
tensor(34.1656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8618206 KL Loss: 14.2037884 DSM Loss: 20.1085885 Overall Loss:36.1741977
Validation loss decreased (1.093498 --> 1.088829).  Saving model ...
Updating learning rate to 0.00025
tensor(37.4818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8625533 KL Loss: 14.2283196 DSM Loss: 19.4908524 Overall Loss:35.5817251
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(31.7848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8328359 KL Loss: 13.9812168 DSM Loss: 19.2503571 Overall Loss:35.0644094
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5495080947875977


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(53.9408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8857785 KL Loss: 14.3226510 DSM Loss: 23.0855546 Overall Loss:39.2939842
Validation loss decreased (inf --> 0.571093).  Saving model ...
Updating learning rate to 0.0005
tensor(25.2979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9534680 KL Loss: 14.3125988 DSM Loss: 19.2712210 Overall Loss:35.5372877
Validation loss decreased (0.571093 --> 0.565036).  Saving model ...
Updating learning rate to 0.00025
tensor(28.0233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8893942 KL Loss: 14.1863902 DSM Loss: 19.3544062 Overall Loss:35.4301905
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(24.4462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2388, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8975444 KL Loss: 14.2296746 DSM Loss: 18.5439174 Overall Loss:34.6711364
Validation loss decreased (0.565036 --> 0.564129).  Saving model ...
Updating learning rate to 6.25e-05
tensor(25.7105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8288099 KL Loss: 14.1242452 DSM Loss: 18.6771315 Overall Loss:34.6301867
Validation loss decreased (0.564129 --> 0.563949).  Saving model ...
Updating learning rate to 3.125e-05
tensor(24.1210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8764951 KL Loss: 14.3405998 DSM Loss: 19.0135809 Overall Loss:35.2306758
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(59.6344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8482093 KL Loss: 14.1341313 DSM Loss: 19.1682506 Overall Loss:35.1505910
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7066574692726135


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.3635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0311, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9071222 KL Loss: 14.3577343 DSM Loss: 22.3009223 Overall Loss:38.5657790
Validation loss decreased (inf --> 1.914107).  Saving model ...
Updating learning rate to 0.0005
tensor(28.2252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8840927 KL Loss: 14.2411355 DSM Loss: 19.2622031 Overall Loss:35.3874312
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(43.7434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8523326 KL Loss: 14.1745429 DSM Loss: 18.5592903 Overall Loss:34.5861658
Validation loss decreased (1.914107 --> 1.906926).  Saving model ...
Updating learning rate to 0.000125
tensor(31.2590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8740491 KL Loss: 14.2145564 DSM Loss: 18.4786006 Overall Loss:34.5672057
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(25.4729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8760870 KL Loss: 14.3036778 DSM Loss: 18.4725672 Overall Loss:34.6523321
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.2862133979797363


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(58.1989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8585366 KL Loss: 14.2498332 DSM Loss: 23.6634595 Overall Loss:39.7718291
Validation loss decreased (inf --> 1.290549).  Saving model ...
Updating learning rate to 0.0005
tensor(36.5138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8844672 KL Loss: 14.3411031 DSM Loss: 19.5601652 Overall Loss:35.7857355
Validation loss decreased (1.290549 --> 1.278415).  Saving model ...
Updating learning rate to 0.00025
tensor(37.0876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8287694 KL Loss: 14.1338929 DSM Loss: 19.3595620 Overall Loss:35.3222244
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(25.6963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8492611 KL Loss: 14.2863580 DSM Loss: 19.1104022 Overall Loss:35.2460213
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.3525853157043457


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(67.7938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9700892 KL Loss: 14.4641426 DSM Loss: 22.7119299 Overall Loss:39.1461616
Validation loss decreased (inf --> 1.381077).  Saving model ...
Updating learning rate to 0.0005
tensor(31.9858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3534, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9491377 KL Loss: 14.4177477 DSM Loss: 19.8623246 Overall Loss:36.2292100
Validation loss decreased (1.381077 --> 1.379526).  Saving model ...
Updating learning rate to 0.00025
tensor(33.7792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.0456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8378263 KL Loss: 14.1135090 DSM Loss: 19.9973538 Overall Loss:35.9486891
Validation loss decreased (1.379526 --> 1.377779).  Saving model ...
Updating learning rate to 0.000125
tensor(49.4399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9223501 KL Loss: 14.4327335 DSM Loss: 19.1352239 Overall Loss:35.4903075
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(27.7606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8255305 KL Loss: 14.1412164 DSM Loss: 19.7389942 Overall Loss:35.7057411
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.4550538063049316


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(47.1672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0471, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8996261 KL Loss: 14.2990395 DSM Loss: 22.4682295 Overall Loss:38.6668953
Validation loss decreased (inf --> 1.756774).  Saving model ...
Updating learning rate to 0.0005
tensor(47.2096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9094972 KL Loss: 14.4345197 DSM Loss: 19.3665583 Overall Loss:35.7105751
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(25.4170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8268837 KL Loss: 14.0431161 DSM Loss: 19.4189681 Overall Loss:35.2889677
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5917758941650391


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(40.8359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9000496 KL Loss: 14.3050772 DSM Loss: 21.9085883 Overall Loss:38.1137153
Validation loss decreased (inf --> 0.657947).  Saving model ...
Updating learning rate to 0.0005
tensor(28.4891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8982691 KL Loss: 14.3482609 DSM Loss: 19.4894384 Overall Loss:35.7359682
Validation loss decreased (0.657947 --> 0.649203).  Saving model ...
Updating learning rate to 0.00025
tensor(25.3333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4153, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9452236 KL Loss: 14.4071141 DSM Loss: 19.2597179 Overall Loss:35.6120553
Validation loss decreased (0.649203 --> 0.648517).  Saving model ...
Updating learning rate to 0.000125
tensor(50.8951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0793, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8871927 KL Loss: 14.2180545 DSM Loss: 19.1837381 Overall Loss:35.2889854
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(49.9650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8260916 KL Loss: 14.1729398 DSM Loss: 19.1294876 Overall Loss:35.1285188
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6732996106147766


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.7373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9989070 KL Loss: 14.3960337 DSM Loss: 22.4514106 Overall Loss:38.8463513
Validation loss decreased (inf --> 1.350967).  Saving model ...
Updating learning rate to 0.0005
tensor(28.8082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8860837 KL Loss: 14.2427273 DSM Loss: 20.0992709 Overall Loss:36.2280820
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(35.3712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8897130 KL Loss: 14.2515002 DSM Loss: 19.4629583 Overall Loss:35.6041716
Validation loss decreased (1.350967 --> 1.348838).  Saving model ...
Updating learning rate to 0.000125
tensor(28.1064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7347, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8444595 KL Loss: 14.2410139 DSM Loss: 19.1681002 Overall Loss:35.2535736
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(23.7053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9039004 KL Loss: 14.3593923 DSM Loss: 19.0742243 Overall Loss:35.3375168
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.973848283290863


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(45.4158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9468456 KL Loss: 14.3913415 DSM Loss: 21.8319479 Overall Loss:38.1701351
Validation loss decreased (inf --> 0.923458).  Saving model ...
Updating learning rate to 0.0005
tensor(39.3239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9042962 KL Loss: 14.2897898 DSM Loss: 19.9030058 Overall Loss:36.0970918
Validation loss decreased (0.923458 --> 0.923344).  Saving model ...
Updating learning rate to 0.00025
tensor(32.0892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8998021 KL Loss: 14.3237506 DSM Loss: 19.2362362 Overall Loss:35.4597887
Validation loss decreased (0.923344 --> 0.915191).  Saving model ...
Updating learning rate to 0.000125
tensor(31.4198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8362476 KL Loss: 14.2085998 DSM Loss: 18.8844239 Overall Loss:34.9292714
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(27.9709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8304094 KL Loss: 14.1867857 DSM Loss: 19.3840983 Overall Loss:35.4012935
Validation loss decreased (0.915191 --> 0.914210).  Saving model ...
Updating learning rate to 3.125e-05
tensor(32.7409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8638990 KL Loss: 14.2036803 DSM Loss: 19.0053684 Overall Loss:35.0729477
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(34.3331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8510612 KL Loss: 14.2194267 DSM Loss: 19.0233446 Overall Loss:35.0938324
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.624043345451355


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(55.1977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8696, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8044243 KL Loss: 14.1045339 DSM Loss: 23.4022994 Overall Loss:39.3112575
Validation loss decreased (inf --> 1.499705).  Saving model ...
Updating learning rate to 0.0005
tensor(50.5010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8541481 KL Loss: 14.2582752 DSM Loss: 19.1327485 Overall Loss:35.2451715
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(45.3666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8091777 KL Loss: 14.0124891 DSM Loss: 19.5962715 Overall Loss:35.4179382
Validation loss decreased (1.499705 --> 1.499578).  Saving model ...
Updating learning rate to 0.000125
tensor(26.7041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8284568 KL Loss: 14.2058273 DSM Loss: 18.8517408 Overall Loss:34.8860250
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(28.8224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8760261 KL Loss: 14.2577896 DSM Loss: 18.3197442 Overall Loss:34.4535597
Validation loss decreased (1.499578 --> 1.498681).  Saving model ...
Updating learning rate to 3.125e-05
tensor(37.3822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9453, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8193621 KL Loss: 14.0729970 DSM Loss: 18.7449931 Overall Loss:34.6373522
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(36.1312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8336934 KL Loss: 14.1357676 DSM Loss: 18.6393877 Overall Loss:34.6088488
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6446990966796875


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(44.4815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9477838 KL Loss: 14.3976759 DSM Loss: 22.8760038 Overall Loss:39.2214633
Validation loss decreased (inf --> 1.064858).  Saving model ...
Updating learning rate to 0.0005
tensor(35.6176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9132572 KL Loss: 14.3624182 DSM Loss: 19.4107530 Overall Loss:35.6864284
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(26.2182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9049218 KL Loss: 14.2404899 DSM Loss: 19.4787169 Overall Loss:35.6241286
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.755774736404419


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(48.9618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0135, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9227507 KL Loss: 14.3862424 DSM Loss: 23.6670923 Overall Loss:39.9760856
Validation loss decreased (inf --> 0.657326).  Saving model ...
Updating learning rate to 0.0005
tensor(27.0556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8484926 KL Loss: 14.1743043 DSM Loss: 20.2774494 Overall Loss:36.3002463
Validation loss decreased (0.657326 --> 0.656747).  Saving model ...
Updating learning rate to 0.00025
tensor(38.3385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8472145 KL Loss: 14.2305297 DSM Loss: 19.5204919 Overall Loss:35.5982359
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(25.5868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8628132 KL Loss: 14.2504302 DSM Loss: 19.0989605 Overall Loss:35.2122036
Validation loss decreased (0.656747 --> 0.656331).  Saving model ...
Updating learning rate to 6.25e-05
tensor(32.0943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5586, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8369267 KL Loss: 14.1263244 DSM Loss: 19.3922762 Overall Loss:35.3555273
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(29.0830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8555149 KL Loss: 14.3869007 DSM Loss: 18.4532946 Overall Loss:34.6957100
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8074892163276672


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1368
val 182
test 383
tensor(56.1628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9441002 KL Loss: 14.4600918 DSM Loss: 21.4412783 Overall Loss:37.8454703
Validation loss decreased (inf --> 1.111564).  Saving model ...
Updating learning rate to 0.0005
tensor(57.8867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0556, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8831861 KL Loss: 14.2513474 DSM Loss: 19.4438710 Overall Loss:35.5784045
Validation loss decreased (1.111564 --> 1.107807).  Saving model ...
Updating learning rate to 0.00025
tensor(32.6065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8566937 KL Loss: 14.1617965 DSM Loss: 19.3153082 Overall Loss:35.3337980
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(28.2723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9089341 KL Loss: 14.1424509 DSM Loss: 18.9902483 Overall Loss:35.0416332
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.0437366962432861
      Ticker       MSE StdDev
0   AAPL_pct  0.871585    0.0
1   ABBV_pct  0.567106    0.0
2    AEP_pct  1.148553    0.0
3   AMGN_pct  0.699153    0.0
4   AMZN_pct  1.798679    0.0
..       ...       ...    ...
66    VZ_pct  1.624043    0.0
67     V_pct  0.644699    0.0
68   WFC_pct  0.755775    0.0
69   WMT_pct  0.807489    0.0
70   XOM_pct  1.043737    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=9, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=40, root_path='data/EcmP_stock_L_2016_24_mix', scale=0.1, sequence_length=40, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(111.6094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0070571 KL Loss: 28.6303896 DSM Loss: 48.2206353 Overall Loss:78.8580815
Validation loss decreased (inf --> 0.865442).  Saving model ...
Updating learning rate to 0.0005
tensor(65.8378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8930, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9877596 KL Loss: 28.4720325 DSM Loss: 39.1204001 Overall Loss:69.5801918
Validation loss decreased (0.865442 --> 0.862231).  Saving model ...
Updating learning rate to 0.00025
tensor(76.9077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9679153 KL Loss: 28.5299419 DSM Loss: 38.2898742 Overall Loss:68.7877312
Validation loss decreased (0.862231 --> 0.861570).  Saving model ...
Updating learning rate to 0.000125
tensor(62.7892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9391487 KL Loss: 28.3360222 DSM Loss: 37.8438374 Overall Loss:68.1190084
Validation loss decreased (0.861570 --> 0.857044).  Saving model ...
Updating learning rate to 6.25e-05
tensor(56.9285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9281482 KL Loss: 28.3159130 DSM Loss: 38.0256311 Overall Loss:68.2696917
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(65.8091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9023979 KL Loss: 28.2273216 DSM Loss: 38.4055701 Overall Loss:68.5352897
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8579497337341309


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.4838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9423459 KL Loss: 28.6907057 DSM Loss: 43.3722673 Overall Loss:74.0053189
Validation loss decreased (inf --> 0.513916).  Saving model ...
Updating learning rate to 0.0005
tensor(85.3896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8957545 KL Loss: 28.4351762 DSM Loss: 38.3257737 Overall Loss:68.6567048
Validation loss decreased (0.513916 --> 0.497974).  Saving model ...
Updating learning rate to 0.00025
tensor(52.3746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9439274 KL Loss: 28.4842672 DSM Loss: 37.5350564 Overall Loss:67.9632505
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(79.4093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9355727 KL Loss: 28.4894576 DSM Loss: 37.2282922 Overall Loss:67.6533229
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5620219111442566


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(96.7343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0216563 KL Loss: 28.6739503 DSM Loss: 45.1022591 Overall Loss:75.7978657
Validation loss decreased (inf --> 0.660481).  Saving model ...
Updating learning rate to 0.0005
tensor(107.9005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9578247 KL Loss: 28.4271942 DSM Loss: 39.1910650 Overall Loss:69.5760837
Validation loss decreased (0.660481 --> 0.649078).  Saving model ...
Updating learning rate to 0.00025
tensor(102.5244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.8892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9312689 KL Loss: 28.3962479 DSM Loss: 38.5244978 Overall Loss:68.8520148
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(61.5211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.6645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9143587 KL Loss: 28.2468277 DSM Loss: 38.5136532 Overall Loss:68.6748398
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.1408861875534058


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(95.6033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3898, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9240485 KL Loss: 28.5384866 DSM Loss: 46.9849165 Overall Loss:77.4474513
Validation loss decreased (inf --> 0.639985).  Saving model ...
Updating learning rate to 0.0005
tensor(60.7802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.2188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9238918 KL Loss: 28.4299157 DSM Loss: 39.3327264 Overall Loss:69.6865336
Validation loss decreased (0.639985 --> 0.639553).  Saving model ...
Updating learning rate to 0.00025
tensor(105.3774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8334, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8992297 KL Loss: 28.4110953 DSM Loss: 39.0350092 Overall Loss:69.3453338
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(62.7772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.7112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9150496 KL Loss: 28.4667343 DSM Loss: 38.3688014 Overall Loss:68.7505850
Validation loss decreased (0.639553 --> 0.639359).  Saving model ...
Updating learning rate to 6.25e-05
tensor(99.2703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3118, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9032247 KL Loss: 28.3870206 DSM Loss: 37.6001895 Overall Loss:67.8904350
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(83.9988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.4284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9256037 KL Loss: 28.3538192 DSM Loss: 37.1682722 Overall Loss:67.4476950
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7023799419403076


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.0739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9703109 KL Loss: 28.5410205 DSM Loss: 41.4971370 Overall Loss:72.0084684
Validation loss decreased (inf --> 1.684150).  Saving model ...
Updating learning rate to 0.0005
tensor(82.8541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9202607 KL Loss: 28.3439186 DSM Loss: 37.3633522 Overall Loss:67.6275315
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(71.2313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9351062 KL Loss: 28.5803000 DSM Loss: 36.4981591 Overall Loss:67.0135652
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.77802312374115


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(98.9920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9052621 KL Loss: 28.6387161 DSM Loss: 49.2960783 Overall Loss:79.8400568
Validation loss decreased (inf --> 0.780161).  Saving model ...
Updating learning rate to 0.0005
tensor(56.9829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9361227 KL Loss: 28.5008652 DSM Loss: 38.4702011 Overall Loss:68.9071890
Validation loss decreased (0.780161 --> 0.760656).  Saving model ...
Updating learning rate to 0.00025
tensor(55.6717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.8238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9361962 KL Loss: 28.4044579 DSM Loss: 37.9654875 Overall Loss:68.3061417
Validation loss decreased (0.760656 --> 0.754236).  Saving model ...
Updating learning rate to 0.000125
tensor(58.1388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9371482 KL Loss: 28.6090041 DSM Loss: 37.0202331 Overall Loss:67.5663855
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(68.5475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9038184 KL Loss: 28.2345662 DSM Loss: 37.6635645 Overall Loss:67.8019497
Validation loss decreased (0.754236 --> 0.751832).  Saving model ...
Updating learning rate to 3.125e-05
tensor(90.6728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8906090 KL Loss: 28.0650146 DSM Loss: 37.5198018 Overall Loss:67.4754257
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(65.6849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.1794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9122680 KL Loss: 28.4753165 DSM Loss: 37.1448460 Overall Loss:67.5324305
Validation loss decreased (0.751832 --> 0.750981).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(59.8747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9190672 KL Loss: 28.4240952 DSM Loss: 36.5156062 Overall Loss:66.8587682
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(57.0705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0534, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9181538 KL Loss: 28.2368764 DSM Loss: 37.3574939 Overall Loss:67.5125242
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6882399320602417


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(153.0063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9768302 KL Loss: 28.6722680 DSM Loss: 44.2482441 Overall Loss:74.8973424
Validation loss decreased (inf --> 0.794937).  Saving model ...
Updating learning rate to 0.0005
tensor(49.4944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9875468 KL Loss: 28.5023575 DSM Loss: 39.7537912 Overall Loss:70.2436952
Validation loss decreased (0.794937 --> 0.772415).  Saving model ...
Updating learning rate to 0.00025
tensor(59.2839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.8382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9689590 KL Loss: 28.5476354 DSM Loss: 39.0076257 Overall Loss:69.5242199
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(79.1240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.5355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9480838 KL Loss: 28.2310419 DSM Loss: 38.9060586 Overall Loss:69.0851849
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5926564931869507


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(105.1822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9542452 KL Loss: 28.5915501 DSM Loss: 46.6385598 Overall Loss:77.1843551
Validation loss decreased (inf --> 1.644702).  Saving model ...
Updating learning rate to 0.0005
tensor(61.3816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9213763 KL Loss: 28.5322553 DSM Loss: 39.2658285 Overall Loss:69.7194598
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(75.4590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0572, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9467508 KL Loss: 28.5466268 DSM Loss: 38.3134328 Overall Loss:68.8068102
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9189028143882751


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(136.2236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9994532 KL Loss: 28.6174571 DSM Loss: 43.6588243 Overall Loss:74.2757342
Validation loss decreased (inf --> 1.004360).  Saving model ...
Updating learning rate to 0.0005
tensor(57.5031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0882, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9040759 KL Loss: 28.2364117 DSM Loss: 35.2278340 Overall Loss:65.3683216
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(55.4874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8727116 KL Loss: 28.0968228 DSM Loss: 34.9591963 Overall Loss:64.9287306
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8802363872528076


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(82.0943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9270774 KL Loss: 28.5696417 DSM Loss: 42.5872953 Overall Loss:73.0840143
Validation loss decreased (inf --> 0.970269).  Saving model ...
Updating learning rate to 0.0005
tensor(104.0572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9332268 KL Loss: 28.5596180 DSM Loss: 37.8117566 Overall Loss:68.3046009
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(83.9819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.7810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.2731, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9185160 KL Loss: 28.4238117 DSM Loss: 37.5949072 Overall Loss:67.9372349
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7037082314491272


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(111.9526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.2793, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9414387 KL Loss: 28.5046475 DSM Loss: 43.9349484 Overall Loss:74.3810343
Validation loss decreased (inf --> 0.704939).  Saving model ...
Updating learning rate to 0.0005
tensor(73.6362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9494329 KL Loss: 28.3527340 DSM Loss: 40.2171801 Overall Loss:70.5193469
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(79.7005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.4408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8743600 KL Loss: 28.0999448 DSM Loss: 39.7137553 Overall Loss:69.6880602
Validation loss decreased (0.704939 --> 0.704564).  Saving model ...
Updating learning rate to 0.000125
tensor(77.2655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9693, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9572999 KL Loss: 28.5581174 DSM Loss: 38.6572176 Overall Loss:69.1726349
Validation loss decreased (0.704564 --> 0.704006).  Saving model ...
Updating learning rate to 6.25e-05
tensor(59.5839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8968451 KL Loss: 28.2039419 DSM Loss: 38.6486327 Overall Loss:68.7494195
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(61.7806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9363003 KL Loss: 28.5508683 DSM Loss: 38.3012146 Overall Loss:68.7883829
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8470903038978577


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(80.9631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.2672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.1993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9289620 KL Loss: 28.3786587 DSM Loss: 51.1548079 Overall Loss:81.4624288
Validation loss decreased (inf --> 1.448315).  Saving model ...
Updating learning rate to 0.0005
tensor(86.2794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.5306, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9471668 KL Loss: 28.4361532 DSM Loss: 39.3235880 Overall Loss:69.7069078
Validation loss decreased (1.448315 --> 1.445629).  Saving model ...
Updating learning rate to 0.00025
tensor(59.0909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.5505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9581951 KL Loss: 28.5793761 DSM Loss: 38.1987363 Overall Loss:68.7363078
Validation loss decreased (1.445629 --> 1.444832).  Saving model ...
Updating learning rate to 0.000125
tensor(93.7776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.7601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9347996 KL Loss: 28.5016475 DSM Loss: 37.6389393 Overall Loss:68.0753866
Validation loss decreased (1.444832 --> 1.444191).  Saving model ...
Updating learning rate to 6.25e-05
tensor(72.1448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9571573 KL Loss: 28.6074223 DSM Loss: 38.0636946 Overall Loss:68.6282742
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(65.4329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9278150 KL Loss: 28.3262163 DSM Loss: 38.5545764 Overall Loss:68.8086075
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9123978614807129


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(124.7064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.1499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9573, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9907222 KL Loss: 28.7273701 DSM Loss: 46.7692225 Overall Loss:77.4873150
Validation loss decreased (inf --> 1.143669).  Saving model ...
Updating learning rate to 0.0005
tensor(72.7259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.6502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9772449 KL Loss: 28.5039392 DSM Loss: 40.7304072 Overall Loss:71.2115908
Validation loss decreased (1.143669 --> 1.128318).  Saving model ...
Updating learning rate to 0.00025
tensor(66.3150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9416533 KL Loss: 28.4334861 DSM Loss: 39.3583272 Overall Loss:69.7334667
Validation loss decreased (1.128318 --> 1.127207).  Saving model ...
Updating learning rate to 0.000125
tensor(81.4305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9048802 KL Loss: 28.2098972 DSM Loss: 39.4760189 Overall Loss:69.5907966
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(68.7696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9335346 KL Loss: 28.4235940 DSM Loss: 38.5088408 Overall Loss:68.8659692
Validation loss decreased (1.127207 --> 1.127145).  Saving model ...
Updating learning rate to 3.125e-05
tensor(54.7390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9220110 KL Loss: 28.2485935 DSM Loss: 38.8369451 Overall Loss:69.0075491
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(75.4627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9172217 KL Loss: 28.3720932 DSM Loss: 38.6782545 Overall Loss:68.9675692
Validation loss decreased (1.127145 --> 1.126797).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(72.2887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.0384, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9239656 KL Loss: 28.3441553 DSM Loss: 38.5905570 Overall Loss:68.8586779
Validation loss decreased (1.126797 --> 1.126764).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(73.5149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.8097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9437635 KL Loss: 28.4604993 DSM Loss: 38.4381202 Overall Loss:68.8423834
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.953125e-06
tensor(69.6272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9354564 KL Loss: 28.5504876 DSM Loss: 38.0906359 Overall Loss:68.5765799
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.665051281452179


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(105.6879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9629635 KL Loss: 28.6273576 DSM Loss: 44.7689707 Overall Loss:75.3592919
Validation loss decreased (inf --> 0.828853).  Saving model ...
Updating learning rate to 0.0005
tensor(61.2403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9357980 KL Loss: 28.3878984 DSM Loss: 38.9351978 Overall Loss:69.2588940
Validation loss decreased (0.828853 --> 0.820106).  Saving model ...
Updating learning rate to 0.00025
tensor(61.5603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9281709 KL Loss: 28.3943603 DSM Loss: 37.8175179 Overall Loss:68.1400490
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(66.3687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8885489 KL Loss: 28.3214792 DSM Loss: 38.8055074 Overall Loss:69.0155351
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9917789697647095


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(119.8923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9875513 KL Loss: 28.7188470 DSM Loss: 50.6811580 Overall Loss:81.3875566
Validation loss decreased (inf --> 0.988871).  Saving model ...
Updating learning rate to 0.0005
tensor(69.7840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0041606 KL Loss: 28.6733378 DSM Loss: 38.4311319 Overall Loss:69.1086304
Validation loss decreased (0.988871 --> 0.978381).  Saving model ...
Updating learning rate to 0.00025
tensor(64.5871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9207833 KL Loss: 28.4217271 DSM Loss: 38.2852296 Overall Loss:68.6277397
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(67.6477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.4591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9048142 KL Loss: 28.3402466 DSM Loss: 38.1312218 Overall Loss:68.3762829
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.6842586994171143


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(105.0223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9451797 KL Loss: 28.4878574 DSM Loss: 46.6524562 Overall Loss:77.0854932
Validation loss decreased (inf --> 1.026633).  Saving model ...
Updating learning rate to 0.0005
tensor(66.2899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3744, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9284594 KL Loss: 28.5130063 DSM Loss: 39.0123528 Overall Loss:69.4538185
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(64.5708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9341162 KL Loss: 28.5059545 DSM Loss: 38.3474413 Overall Loss:68.7875123
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2143510580062866


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(131.3772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9984850 KL Loss: 28.8445170 DSM Loss: 47.6692070 Overall Loss:78.5122091
Validation loss decreased (inf --> 1.303276).  Saving model ...
Updating learning rate to 0.0005
tensor(51.6905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.7178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.0742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9598953 KL Loss: 28.4132658 DSM Loss: 40.2718009 Overall Loss:70.6449619
Validation loss decreased (1.303276 --> 1.264818).  Saving model ...
Updating learning rate to 0.00025
tensor(70.6299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9076703 KL Loss: 28.2037421 DSM Loss: 39.8599469 Overall Loss:69.9713592
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(47.7070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8845621 KL Loss: 28.1059443 DSM Loss: 39.4094634 Overall Loss:69.3999699
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.218624234199524


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(84.5809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9119823 KL Loss: 28.3012710 DSM Loss: 45.9067577 Overall Loss:76.1200106
Validation loss decreased (inf --> 0.787670).  Saving model ...
Updating learning rate to 0.0005
tensor(89.2950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9477385 KL Loss: 28.4926638 DSM Loss: 39.3851856 Overall Loss:69.8255880
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(80.4978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.5366, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9559957 KL Loss: 28.4901438 DSM Loss: 37.0314697 Overall Loss:67.4776094
Validation loss decreased (0.787670 --> 0.781269).  Saving model ...
Updating learning rate to 0.000125
tensor(60.7884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.8171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8980622 KL Loss: 28.1953656 DSM Loss: 38.2800613 Overall Loss:68.3734889
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(58.0950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9417538 KL Loss: 28.5557115 DSM Loss: 36.9933186 Overall Loss:67.4907841
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6832238435745239


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(74.1990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3296, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9202633 KL Loss: 28.5993827 DSM Loss: 44.3744397 Overall Loss:74.8940854
Validation loss decreased (inf --> 0.642335).  Saving model ...
Updating learning rate to 0.0005
tensor(59.7441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.4737, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9698497 KL Loss: 28.7524951 DSM Loss: 37.9850071 Overall Loss:68.7073521
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(45.6335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5043, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9461158 KL Loss: 28.5465608 DSM Loss: 37.6826011 Overall Loss:68.1752778
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7328840494155884


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(113.3569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9264555 KL Loss: 28.6245911 DSM Loss: 42.8403533 Overall Loss:73.3913999
Validation loss decreased (inf --> 0.477882).  Saving model ...
Updating learning rate to 0.0005
tensor(47.0342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.0663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6189, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9500047 KL Loss: 28.4772136 DSM Loss: 37.6283999 Overall Loss:68.0556180
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(73.4727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9294420 KL Loss: 28.5285761 DSM Loss: 37.8401721 Overall Loss:68.2981907
Validation loss decreased (0.477882 --> 0.468521).  Saving model ...
Updating learning rate to 0.000125
tensor(47.1583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9112946 KL Loss: 28.3449180 DSM Loss: 37.7137567 Overall Loss:67.9699692
Validation loss decreased (0.468521 --> 0.467566).  Saving model ...
Updating learning rate to 6.25e-05
tensor(48.5909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.9981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8828867 KL Loss: 28.0924157 DSM Loss: 38.3547295 Overall Loss:68.3300321
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(51.7049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8610437 KL Loss: 27.9747595 DSM Loss: 37.9069963 Overall Loss:67.7427994
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6284239292144775


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(98.2517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.3976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9437988 KL Loss: 28.5963395 DSM Loss: 48.3406167 Overall Loss:78.8807551
Validation loss decreased (inf --> 1.494037).  Saving model ...
Updating learning rate to 0.0005
tensor(79.1554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9241281 KL Loss: 28.3234723 DSM Loss: 40.2603846 Overall Loss:70.5079850
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(68.7908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9213943 KL Loss: 28.4260488 DSM Loss: 39.5611109 Overall Loss:69.9085540
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.702754259109497


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(93.5207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0210099 KL Loss: 28.6339897 DSM Loss: 50.3777445 Overall Loss:81.0327440
Validation loss decreased (inf --> 1.128613).  Saving model ...
Updating learning rate to 0.0005
tensor(60.4710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9696183 KL Loss: 28.3491689 DSM Loss: 39.0232605 Overall Loss:69.3420473
Validation loss decreased (1.128613 --> 1.104971).  Saving model ...
Updating learning rate to 0.00025
tensor(90.5688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9380999 KL Loss: 28.2890628 DSM Loss: 39.5483114 Overall Loss:69.7754746
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(70.9174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9420824 KL Loss: 28.4291002 DSM Loss: 39.2070507 Overall Loss:69.5782333
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.3841789960861206


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(121.2767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6254, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9233787 KL Loss: 28.4610499 DSM Loss: 46.3547782 Overall Loss:76.7392068
Validation loss decreased (inf --> 0.576009).  Saving model ...
Updating learning rate to 0.0005
tensor(110.1387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.9758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9399632 KL Loss: 28.6101527 DSM Loss: 39.5812988 Overall Loss:70.1314141
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(48.3429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.2708, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9170649 KL Loss: 28.3233605 DSM Loss: 40.0279100 Overall Loss:70.2683358
Validation loss decreased (0.576009 --> 0.575708).  Saving model ...
Updating learning rate to 0.000125
tensor(86.7330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9611378 KL Loss: 28.6003522 DSM Loss: 39.1165325 Overall Loss:69.6780226
Validation loss decreased (0.575708 --> 0.575453).  Saving model ...
Updating learning rate to 6.25e-05
tensor(103.1219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.5146, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9484813 KL Loss: 28.4138192 DSM Loss: 38.9226135 Overall Loss:69.2849144
Validation loss decreased (0.575453 --> 0.575268).  Saving model ...
Updating learning rate to 3.125e-05
tensor(48.1918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.4804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4834, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9301853 KL Loss: 28.1798939 DSM Loss: 38.8598980 Overall Loss:68.9699770
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(90.6491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.8765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9241199 KL Loss: 28.2468495 DSM Loss: 38.9595939 Overall Loss:69.1305631
Validation loss decreased (0.575268 --> 0.575206).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(54.5055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9420921 KL Loss: 28.3197446 DSM Loss: 38.6663864 Overall Loss:68.9282229
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(49.6397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.5497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9276888 KL Loss: 28.2396564 DSM Loss: 39.1388320 Overall Loss:69.3061771
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8729626536369324


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(88.8183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9561736 KL Loss: 28.4406877 DSM Loss: 44.7217445 Overall Loss:75.1186054
Validation loss decreased (inf --> 0.643070).  Saving model ...
Updating learning rate to 0.0005
tensor(89.5478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.8116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9825621 KL Loss: 28.5697990 DSM Loss: 39.9297146 Overall Loss:70.4820763
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(50.6688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.6202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9822052 KL Loss: 28.4616166 DSM Loss: 39.6126873 Overall Loss:70.0565091
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.1221669912338257


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.7470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9333793 KL Loss: 28.5825455 DSM Loss: 44.8788928 Overall Loss:75.3948178
Validation loss decreased (inf --> 0.518087).  Saving model ...
Updating learning rate to 0.0005
tensor(92.2230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.4039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.5369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0205692 KL Loss: 28.4759517 DSM Loss: 39.2660710 Overall Loss:69.7625918
Validation loss decreased (0.518087 --> 0.512346).  Saving model ...
Updating learning rate to 0.00025
tensor(90.8324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.3074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9331428 KL Loss: 28.4797622 DSM Loss: 39.2773412 Overall Loss:69.6902462
Validation loss decreased (0.512346 --> 0.496709).  Saving model ...
Updating learning rate to 0.000125
tensor(65.1733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.3998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9388507 KL Loss: 28.3222329 DSM Loss: 38.2720836 Overall Loss:68.5331674
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(51.5900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9465866 KL Loss: 28.5508667 DSM Loss: 38.4667053 Overall Loss:68.9641585
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7605475783348083


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.1298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9546558 KL Loss: 28.4814412 DSM Loss: 47.2756671 Overall Loss:77.7117643
Validation loss decreased (inf --> 0.655737).  Saving model ...
Updating learning rate to 0.0005
tensor(52.8377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9249471 KL Loss: 28.3007059 DSM Loss: 40.1471561 Overall Loss:70.3728093
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(57.2876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9075118 KL Loss: 28.3520537 DSM Loss: 39.4369988 Overall Loss:69.6965639
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7066187858581543


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(110.5953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0202186 KL Loss: 28.7227367 DSM Loss: 45.0393287 Overall Loss:75.7822842
Validation loss decreased (inf --> 0.666260).  Saving model ...
Updating learning rate to 0.0005
tensor(64.8028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.3354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9915678 KL Loss: 28.4484511 DSM Loss: 40.0221277 Overall Loss:70.4621463
Validation loss decreased (0.666260 --> 0.663192).  Saving model ...
Updating learning rate to 0.00025
tensor(65.0341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.7766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9332657 KL Loss: 28.3252390 DSM Loss: 39.8777747 Overall Loss:70.1362794
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(55.5346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9140530 KL Loss: 28.1792620 DSM Loss: 39.2702551 Overall Loss:69.3635697
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.514109194278717


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(108.7977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9855418 KL Loss: 28.6871632 DSM Loss: 45.7167494 Overall Loss:76.3894544
Validation loss decreased (inf --> 1.295935).  Saving model ...
Updating learning rate to 0.0005
tensor(83.8608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9184162 KL Loss: 28.3987229 DSM Loss: 38.9865703 Overall Loss:69.3037093
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(67.7661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0738, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9188391 KL Loss: 28.3711106 DSM Loss: 38.7119120 Overall Loss:69.0018618
Validation loss decreased (1.295935 --> 1.291350).  Saving model ...
Updating learning rate to 0.000125
tensor(67.9297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.5912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9131233 KL Loss: 28.3385078 DSM Loss: 38.8502238 Overall Loss:69.1018550
Validation loss decreased (1.291350 --> 1.285573).  Saving model ...
Updating learning rate to 6.25e-05
tensor(95.4450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2327, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9264689 KL Loss: 28.4222924 DSM Loss: 37.8040939 Overall Loss:68.1528550
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(71.1527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0202, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9467182 KL Loss: 28.3643936 DSM Loss: 38.6364599 Overall Loss:68.9475720
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.759040117263794


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(118.7239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.5883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.5468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9286723 KL Loss: 28.4862215 DSM Loss: 46.8996801 Overall Loss:77.3145740
Validation loss decreased (inf --> 1.190728).  Saving model ...
Updating learning rate to 0.0005
tensor(57.0394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.8859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9563007 KL Loss: 28.6195124 DSM Loss: 40.5242210 Overall Loss:71.1000343
Validation loss decreased (1.190728 --> 1.184231).  Saving model ...
Updating learning rate to 0.00025
tensor(124.3252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.6447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9353231 KL Loss: 28.3404128 DSM Loss: 39.7649094 Overall Loss:70.0406454
Validation loss decreased (1.184231 --> 1.176412).  Saving model ...
Updating learning rate to 0.000125
tensor(76.2232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8858234 KL Loss: 28.2690705 DSM Loss: 39.6028971 Overall Loss:69.7577913
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(73.1847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.6492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8949750 KL Loss: 28.2608195 DSM Loss: 39.3028171 Overall Loss:69.4586112
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.0006905794143677


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(142.8589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9622201 KL Loss: 28.5444983 DSM Loss: 43.6778154 Overall Loss:74.1845335
Validation loss decreased (inf --> 0.805621).  Saving model ...
Updating learning rate to 0.0005
tensor(57.4288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0005431 KL Loss: 28.5920561 DSM Loss: 37.9229048 Overall Loss:68.5155040
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(111.4205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9134021 KL Loss: 28.3396939 DSM Loss: 39.1720490 Overall Loss:69.4251448
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7170147895812988


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(106.0157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5189, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9734671 KL Loss: 28.6617667 DSM Loss: 45.2300215 Overall Loss:75.8652551
Validation loss decreased (inf --> 1.368523).  Saving model ...
Updating learning rate to 0.0005
tensor(78.0772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9428054 KL Loss: 28.4282005 DSM Loss: 38.3217276 Overall Loss:68.6927334
Validation loss decreased (1.368523 --> 1.358797).  Saving model ...
Updating learning rate to 0.00025
tensor(74.8907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.8368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.5232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9237325 KL Loss: 28.3852065 DSM Loss: 38.0308627 Overall Loss:68.3398014
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(76.2538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9254062 KL Loss: 28.2537131 DSM Loss: 38.0935802 Overall Loss:68.2726995
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.0011959075927734


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(110.7457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1814, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9443243 KL Loss: 28.4835220 DSM Loss: 42.5920018 Overall Loss:73.0198478
Validation loss decreased (inf --> 0.343152).  Saving model ...
Updating learning rate to 0.0005
tensor(79.4171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9172268 KL Loss: 28.2648608 DSM Loss: 36.0564196 Overall Loss:66.2385072
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(69.0852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9288219 KL Loss: 28.3698750 DSM Loss: 35.0693606 Overall Loss:65.3680574
Validation loss decreased (0.343152 --> 0.334839).  Saving model ...
Updating learning rate to 0.000125
tensor(52.9580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.0772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8861101 KL Loss: 28.2826338 DSM Loss: 34.5148086 Overall Loss:64.6835527
Validation loss decreased (0.334839 --> 0.334663).  Saving model ...
Updating learning rate to 6.25e-05
tensor(58.1229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9085595 KL Loss: 28.3598724 DSM Loss: 34.9501575 Overall Loss:65.2185893
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(76.8968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.1120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9063472 KL Loss: 28.1836735 DSM Loss: 34.6452780 Overall Loss:64.7352988
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.164452075958252


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(95.9018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0359, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9640833 KL Loss: 28.6074140 DSM Loss: 45.0724096 Overall Loss:75.6439071
Validation loss decreased (inf --> 0.954619).  Saving model ...
Updating learning rate to 0.0005
tensor(52.0118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.1253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9456707 KL Loss: 28.4413736 DSM Loss: 40.0004862 Overall Loss:70.3875308
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(56.9639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.9858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.2183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9542044 KL Loss: 28.5922252 DSM Loss: 39.0226091 Overall Loss:69.5690387
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.3778361082077026


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(88.8968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.0359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9718716 KL Loss: 28.5834170 DSM Loss: 45.5733950 Overall Loss:76.1286833
Validation loss decreased (inf --> 0.751520).  Saving model ...
Updating learning rate to 0.0005
tensor(64.4863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9550070 KL Loss: 28.3490513 DSM Loss: 39.9295622 Overall Loss:70.2336202
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(51.6453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.4901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9019029 KL Loss: 28.2195368 DSM Loss: 39.5261119 Overall Loss:69.6475517
Validation loss decreased (0.751520 --> 0.751289).  Saving model ...
Updating learning rate to 0.000125
tensor(57.4131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.0063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9429685 KL Loss: 28.3746809 DSM Loss: 38.7359926 Overall Loss:69.0536422
Validation loss decreased (0.751289 --> 0.751190).  Saving model ...
Updating learning rate to 6.25e-05
tensor(50.9358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.7190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9397360 KL Loss: 28.4447108 DSM Loss: 38.2076349 Overall Loss:68.5920819
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(46.2319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9250515 KL Loss: 28.3766485 DSM Loss: 38.6131816 Overall Loss:68.9148813
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7307490110397339


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(84.6871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9555573 KL Loss: 28.6281938 DSM Loss: 47.9137545 Overall Loss:78.4975053
Validation loss decreased (inf --> 0.927023).  Saving model ...
Updating learning rate to 0.0005
tensor(52.2940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.8047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9535552 KL Loss: 28.3364647 DSM Loss: 38.7411469 Overall Loss:69.0311668
Validation loss decreased (0.927023 --> 0.803695).  Saving model ...
Updating learning rate to 0.00025
tensor(58.4982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.6946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.3932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9147646 KL Loss: 28.3310274 DSM Loss: 38.2286936 Overall Loss:68.4744856
Validation loss decreased (0.803695 --> 0.789810).  Saving model ...
Updating learning rate to 0.000125
tensor(51.2654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9529727 KL Loss: 28.3230491 DSM Loss: 37.1766920 Overall Loss:67.4527139
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(69.7642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8948385 KL Loss: 28.1178653 DSM Loss: 37.8818388 Overall Loss:67.8945421
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6597316861152649


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(95.3008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0607, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9312329 KL Loss: 28.3132830 DSM Loss: 45.1707072 Overall Loss:75.4152232
Validation loss decreased (inf --> 0.754778).  Saving model ...
Updating learning rate to 0.0005
tensor(58.7739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9746743 KL Loss: 28.5498669 DSM Loss: 40.0659566 Overall Loss:70.5904976
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(56.7834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.5478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9366792 KL Loss: 28.2939251 DSM Loss: 38.8430214 Overall Loss:69.0736251
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6322861909866333


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(117.9434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.3593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.6164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0097280 KL Loss: 28.9643617 DSM Loss: 53.3842989 Overall Loss:84.3583889
Validation loss decreased (inf --> 1.279580).  Saving model ...
Updating learning rate to 0.0005
tensor(58.8106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.1732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.8558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9175402 KL Loss: 28.3932557 DSM Loss: 40.9088391 Overall Loss:71.2196349
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(48.7031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.6518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9194742 KL Loss: 28.3643572 DSM Loss: 39.6512405 Overall Loss:69.9350724
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8279023766517639


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(93.0471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.0892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9930076 KL Loss: 28.6791626 DSM Loss: 50.1068154 Overall Loss:80.7789856
Validation loss decreased (inf --> 1.433451).  Saving model ...
Updating learning rate to 0.0005
tensor(78.0517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9385275 KL Loss: 28.3867949 DSM Loss: 40.3867111 Overall Loss:70.7120335
Validation loss decreased (1.433451 --> 1.429045).  Saving model ...
Updating learning rate to 0.00025
tensor(81.6426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.5599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9545362 KL Loss: 28.4167474 DSM Loss: 39.3652851 Overall Loss:69.7365686
Validation loss decreased (1.429045 --> 1.428548).  Saving model ...
Updating learning rate to 0.000125
tensor(89.9656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.3332, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9332917 KL Loss: 28.4078424 DSM Loss: 39.5016505 Overall Loss:69.8427845
Validation loss decreased (1.428548 --> 1.426676).  Saving model ...
Updating learning rate to 6.25e-05
tensor(80.6324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9151841 KL Loss: 28.2600057 DSM Loss: 38.7370761 Overall Loss:68.9122659
Validation loss decreased (1.426676 --> 1.424768).  Saving model ...
Updating learning rate to 3.125e-05
tensor(79.0310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3016, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9017397 KL Loss: 28.2419520 DSM Loss: 38.5285799 Overall Loss:68.6722717
Validation loss decreased (1.424768 --> 1.423915).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(51.7501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9000679 KL Loss: 28.2531060 DSM Loss: 37.9763219 Overall Loss:68.1294957
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(78.3131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.2100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5178, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8996301 KL Loss: 28.4237997 DSM Loss: 38.4341723 Overall Loss:68.7576016
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5889112949371338


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(142.9290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.2220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0220342 KL Loss: 28.9924830 DSM Loss: 49.2439273 Overall Loss:80.2584441
Validation loss decreased (inf --> 0.625759).  Saving model ...
Updating learning rate to 0.0005
tensor(50.4519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.1440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.9027, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9618106 KL Loss: 28.5490172 DSM Loss: 39.4344825 Overall Loss:69.9453108
Validation loss decreased (0.625759 --> 0.619494).  Saving model ...
Updating learning rate to 0.00025
tensor(53.7543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.0741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9002975 KL Loss: 28.2114385 DSM Loss: 39.6321609 Overall Loss:69.7438970
Validation loss decreased (0.619494 --> 0.614242).  Saving model ...
Updating learning rate to 0.000125
tensor(55.9698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.5105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9228683 KL Loss: 28.4540197 DSM Loss: 39.6235706 Overall Loss:70.0004587
Validation loss decreased (0.614242 --> 0.613174).  Saving model ...
Updating learning rate to 6.25e-05
tensor(87.2403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9364217 KL Loss: 28.4347390 DSM Loss: 39.7822219 Overall Loss:70.1533830
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(53.6471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9042227 KL Loss: 28.2979735 DSM Loss: 38.9645969 Overall Loss:69.1667934
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.4932388961315155


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(84.8906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9565535 KL Loss: 28.5865891 DSM Loss: 45.6231145 Overall Loss:76.1662573
Validation loss decreased (inf --> 0.964175).  Saving model ...
Updating learning rate to 0.0005
tensor(56.2718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9164360 KL Loss: 28.2675810 DSM Loss: 39.8658736 Overall Loss:70.0498904
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(54.2508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9379660 KL Loss: 28.4772242 DSM Loss: 39.1954320 Overall Loss:69.6106218
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9495407342910767


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(101.1211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0171789 KL Loss: 28.6036069 DSM Loss: 43.7163339 Overall Loss:74.3371197
Validation loss decreased (inf --> 0.741691).  Saving model ...
Updating learning rate to 0.0005
tensor(74.3648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9634660 KL Loss: 28.5214244 DSM Loss: 39.7693760 Overall Loss:70.2542664
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(59.6651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9438318 KL Loss: 28.4905570 DSM Loss: 38.9348858 Overall Loss:69.3692745
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.428296446800232


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(111.9630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9617062 KL Loss: 28.5900771 DSM Loss: 46.0677641 Overall Loss:76.6195475
Validation loss decreased (inf --> 0.796205).  Saving model ...
Updating learning rate to 0.0005
tensor(69.3924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9655871 KL Loss: 28.5161385 DSM Loss: 40.2059002 Overall Loss:70.6876260
Validation loss decreased (0.796205 --> 0.792967).  Saving model ...
Updating learning rate to 0.00025
tensor(63.5005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7350, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9177289 KL Loss: 28.3699579 DSM Loss: 40.0669236 Overall Loss:70.3546105
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(83.8932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9410273 KL Loss: 28.5046826 DSM Loss: 39.2624324 Overall Loss:69.7081418
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6331091523170471


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(117.1718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0032354 KL Loss: 28.7647026 DSM Loss: 51.2825230 Overall Loss:82.0504611
Validation loss decreased (inf --> 1.534685).  Saving model ...
Updating learning rate to 0.0005
tensor(57.2692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9551575 KL Loss: 28.5646651 DSM Loss: 40.1638750 Overall Loss:70.6836974
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(88.8360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9282235 KL Loss: 28.4473216 DSM Loss: 39.3567235 Overall Loss:69.7322684
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8163596391677856


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(132.4457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.8332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8224, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9328461 KL Loss: 28.5369613 DSM Loss: 46.9121270 Overall Loss:77.3819345
Validation loss decreased (inf --> 1.112455).  Saving model ...
Updating learning rate to 0.0005
tensor(61.5664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0035563 KL Loss: 28.8071171 DSM Loss: 37.8566716 Overall Loss:68.6673447
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(84.0957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.3145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9220612 KL Loss: 28.2341234 DSM Loss: 38.4370731 Overall Loss:68.5932577
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2240222692489624


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(125.5899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9736316 KL Loss: 28.7513165 DSM Loss: 48.3433739 Overall Loss:79.0683221
Validation loss decreased (inf --> 1.337870).  Saving model ...
Updating learning rate to 0.0005
tensor(66.3387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9069656 KL Loss: 28.2609078 DSM Loss: 40.7571248 Overall Loss:70.9249985
Validation loss decreased (1.337870 --> 1.335304).  Saving model ...
Updating learning rate to 0.00025
tensor(82.6573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7293, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9637423 KL Loss: 28.3630811 DSM Loss: 39.7116476 Overall Loss:70.0384713
Validation loss decreased (1.335304 --> 1.333887).  Saving model ...
Updating learning rate to 0.000125
tensor(73.5942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9054378 KL Loss: 28.1595897 DSM Loss: 38.7709706 Overall Loss:68.8359979
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(70.4936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2779, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9033883 KL Loss: 28.2374385 DSM Loss: 39.3512860 Overall Loss:69.4921128
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.5038090944290161


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(131.7882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9406030 KL Loss: 28.5373198 DSM Loss: 47.5439978 Overall Loss:78.0219207
Validation loss decreased (inf --> 0.585390).  Saving model ...
Updating learning rate to 0.0005
tensor(62.0333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9536245 KL Loss: 28.5872471 DSM Loss: 39.8551823 Overall Loss:70.3960543
Validation loss decreased (0.585390 --> 0.582805).  Saving model ...
Updating learning rate to 0.00025
tensor(60.8540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9316600 KL Loss: 28.4934122 DSM Loss: 39.1926502 Overall Loss:69.6177226
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(87.1823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9673523 KL Loss: 28.6369734 DSM Loss: 38.7738155 Overall Loss:69.3781412
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9776557087898254


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(109.8010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9889387 KL Loss: 28.6989555 DSM Loss: 44.2520408 Overall Loss:74.9399349
Validation loss decreased (inf --> 0.752561).  Saving model ...
Updating learning rate to 0.0005
tensor(66.2672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9698692 KL Loss: 28.4705678 DSM Loss: 38.2217254 Overall Loss:68.6621624
Validation loss decreased (0.752561 --> 0.749826).  Saving model ...
Updating learning rate to 0.00025
tensor(92.2567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9478576 KL Loss: 28.3968000 DSM Loss: 38.0615574 Overall Loss:68.4062151
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(58.5139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.2401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9212183 KL Loss: 28.4509797 DSM Loss: 37.7196705 Overall Loss:68.0918686
Validation loss decreased (0.749826 --> 0.749305).  Saving model ...
Updating learning rate to 6.25e-05
tensor(80.6239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9596980 KL Loss: 28.4328881 DSM Loss: 38.0254833 Overall Loss:68.4180694
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(52.9659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9243059 KL Loss: 28.3401293 DSM Loss: 37.4076259 Overall Loss:67.6720613
Validation loss decreased (0.749305 --> 0.749246).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(58.8303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8419, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9324336 KL Loss: 28.5427308 DSM Loss: 37.0962408 Overall Loss:67.5714052
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(58.1077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7033, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9193219 KL Loss: 28.2886532 DSM Loss: 37.4181224 Overall Loss:67.6260975
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.959581196308136


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(123.9554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0311, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9765218 KL Loss: 28.7804196 DSM Loss: 43.8621791 Overall Loss:74.6191205
Validation loss decreased (inf --> 1.589395).  Saving model ...
Updating learning rate to 0.0005
tensor(60.8530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9709565 KL Loss: 28.3755418 DSM Loss: 39.7264723 Overall Loss:70.0729707
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(54.0902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.4294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9673246 KL Loss: 28.5855076 DSM Loss: 38.5321649 Overall Loss:69.0849972
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2131938934326172


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(124.3651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.6586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.3827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0138799 KL Loss: 28.9037118 DSM Loss: 48.7435069 Overall Loss:79.6610985
Validation loss decreased (inf --> 0.209045).  Saving model ...
Updating learning rate to 0.0005
tensor(50.9228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9731025 KL Loss: 28.6873388 DSM Loss: 40.9312828 Overall Loss:71.5917240
Validation loss decreased (0.209045 --> 0.208454).  Saving model ...
Updating learning rate to 0.00025
tensor(66.6125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9623392 KL Loss: 28.5421038 DSM Loss: 39.8391419 Overall Loss:70.3435849
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(73.7236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9491324 KL Loss: 28.5589540 DSM Loss: 39.8096198 Overall Loss:70.3177056
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.11655112355947495


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(94.8369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.7612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.2059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9699034 KL Loss: 28.7228134 DSM Loss: 46.4664715 Overall Loss:77.1591873
Validation loss decreased (inf --> 0.654235).  Saving model ...
Updating learning rate to 0.0005
tensor(51.4272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9869660 KL Loss: 28.7866121 DSM Loss: 39.9763104 Overall Loss:70.7498882
Validation loss decreased (0.654235 --> 0.653153).  Saving model ...
Updating learning rate to 0.00025
tensor(49.5972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(158.3430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9754036 KL Loss: 28.6295157 DSM Loss: 39.2542939 Overall Loss:69.8592134
Validation loss decreased (0.653153 --> 0.652472).  Saving model ...
Updating learning rate to 0.000125
tensor(53.6818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9586001 KL Loss: 28.6422127 DSM Loss: 38.1790852 Overall Loss:68.7798985
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(54.1401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(124.2155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.3320, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9543585 KL Loss: 28.3755393 DSM Loss: 38.7499623 Overall Loss:69.0798602
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6512210965156555


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(134.4828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9186084 KL Loss: 28.3791341 DSM Loss: 46.7598019 Overall Loss:77.0575445
Validation loss decreased (inf --> 2.300087).  Saving model ...
Updating learning rate to 0.0005
tensor(72.5236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9735539 KL Loss: 28.4292173 DSM Loss: 39.5003825 Overall Loss:69.9031536
Validation loss decreased (2.300087 --> 2.297487).  Saving model ...
Updating learning rate to 0.00025
tensor(88.2738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.9916, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9500291 KL Loss: 28.4576803 DSM Loss: 38.1696499 Overall Loss:68.5773591
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(60.2466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8984742 KL Loss: 28.1475147 DSM Loss: 38.2568939 Overall Loss:68.3028823
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.1009368896484375


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(90.2056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9232381 KL Loss: 28.5343561 DSM Loss: 46.0214538 Overall Loss:76.4790483
Validation loss decreased (inf --> 0.842867).  Saving model ...
Updating learning rate to 0.0005
tensor(50.1662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.2390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9485066 KL Loss: 28.3846995 DSM Loss: 39.8389163 Overall Loss:70.1721223
Validation loss decreased (0.842867 --> 0.836324).  Saving model ...
Updating learning rate to 0.00025
tensor(132.9823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9336830 KL Loss: 28.4462212 DSM Loss: 39.6157496 Overall Loss:69.9956536
Validation loss decreased (0.836324 --> 0.834690).  Saving model ...
Updating learning rate to 0.000125
tensor(90.2362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.9548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(134.7309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8636449 KL Loss: 28.1285705 DSM Loss: 39.7961876 Overall Loss:69.7884028
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(57.6368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.3229, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9030746 KL Loss: 28.2645845 DSM Loss: 39.5882285 Overall Loss:69.7558877
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7510706186294556


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(92.0316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9121611 KL Loss: 28.6234428 DSM Loss: 55.0292127 Overall Loss:85.5648165
Validation loss decreased (inf --> 0.876402).  Saving model ...
Updating learning rate to 0.0005
tensor(60.2449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9654000 KL Loss: 28.6709580 DSM Loss: 40.5755091 Overall Loss:71.2118670
Validation loss decreased (0.876402 --> 0.863211).  Saving model ...
Updating learning rate to 0.00025
tensor(58.8059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0867, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9530269 KL Loss: 28.5983198 DSM Loss: 39.3481985 Overall Loss:69.8995453
Validation loss decreased (0.863211 --> 0.861225).  Saving model ...
Updating learning rate to 0.000125
tensor(89.4272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.7079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9648967 KL Loss: 28.7462436 DSM Loss: 38.8790360 Overall Loss:69.5901766
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(54.7019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.3477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9526166 KL Loss: 28.5512880 DSM Loss: 39.6397897 Overall Loss:70.1436942
Validation loss decreased (0.861225 --> 0.860861).  Saving model ...
Updating learning rate to 3.125e-05
tensor(78.7121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9135570 KL Loss: 28.2949734 DSM Loss: 39.5388031 Overall Loss:69.7473331
Validation loss decreased (0.860861 --> 0.860546).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(59.9992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.7985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9368737 KL Loss: 28.5044439 DSM Loss: 39.1898750 Overall Loss:69.6311924
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(52.2874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9128489 KL Loss: 28.3663987 DSM Loss: 38.8224379 Overall Loss:69.1016857
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5787935256958008


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(86.5302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.5569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9408794 KL Loss: 28.6576830 DSM Loss: 48.0525011 Overall Loss:78.6510637
Validation loss decreased (inf --> 0.497308).  Saving model ...
Updating learning rate to 0.0005
tensor(54.2468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.7192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9291295 KL Loss: 28.3946075 DSM Loss: 40.2628773 Overall Loss:70.5866141
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(51.8745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9023193 KL Loss: 28.3802189 DSM Loss: 39.4867650 Overall Loss:69.7693033
Validation loss decreased (0.497308 --> 0.495654).  Saving model ...
Updating learning rate to 0.000125
tensor(112.4078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9650272 KL Loss: 28.6407880 DSM Loss: 37.8189115 Overall Loss:68.4247268
Validation loss decreased (0.495654 --> 0.495065).  Saving model ...
Updating learning rate to 6.25e-05
tensor(71.8058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9373483 KL Loss: 28.5152743 DSM Loss: 39.0315688 Overall Loss:69.4841913
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(46.1846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8334, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9494692 KL Loss: 28.3236264 DSM Loss: 38.9025886 Overall Loss:69.1756841
Validation loss decreased (0.495065 --> 0.494846).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(90.7151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8952899 KL Loss: 28.1972195 DSM Loss: 39.5840806 Overall Loss:69.6765900
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(76.6654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7996, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8975040 KL Loss: 28.1356481 DSM Loss: 39.4872778 Overall Loss:69.5204299
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.686533510684967


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(97.0310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8735, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9418055 KL Loss: 28.5870829 DSM Loss: 47.2901711 Overall Loss:77.8190596
Validation loss decreased (inf --> 1.001795).  Saving model ...
Updating learning rate to 0.0005
tensor(56.3011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9736330 KL Loss: 28.5544108 DSM Loss: 39.2801011 Overall Loss:69.8081447
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(56.0673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9853661 KL Loss: 28.6957208 DSM Loss: 38.4921517 Overall Loss:69.1732385
Validation loss decreased (1.001795 --> 1.001109).  Saving model ...
Updating learning rate to 0.000125
tensor(73.7980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(135.9351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9453092 KL Loss: 28.4906248 DSM Loss: 38.7386625 Overall Loss:69.1745968
Validation loss decreased (1.001109 --> 0.999589).  Saving model ...
Updating learning rate to 6.25e-05
tensor(84.7505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2720, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9867563 KL Loss: 28.6400411 DSM Loss: 38.0588406 Overall Loss:68.6856382
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(59.7161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9465197 KL Loss: 28.6131840 DSM Loss: 38.1249149 Overall Loss:68.6846189
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.883460521697998


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(96.2254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.0927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9790370 KL Loss: 28.6973090 DSM Loss: 46.0534859 Overall Loss:76.7298316
Validation loss decreased (inf --> 1.043022).  Saving model ...
Updating learning rate to 0.0005
tensor(58.7248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2675, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9380182 KL Loss: 28.2020976 DSM Loss: 40.6606681 Overall Loss:70.8007839
Validation loss decreased (1.043022 --> 1.034555).  Saving model ...
Updating learning rate to 0.00025
tensor(49.6038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8967896 KL Loss: 28.1195908 DSM Loss: 39.0323920 Overall Loss:69.0487723
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(90.2130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9614936 KL Loss: 28.2862223 DSM Loss: 38.5267868 Overall Loss:68.7745026
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9065211415290833


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(100.6772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.3009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0121, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9765303 KL Loss: 28.6446891 DSM Loss: 42.9372598 Overall Loss:73.5584794
Validation loss decreased (inf --> 0.911511).  Saving model ...
Updating learning rate to 0.0005
tensor(57.5799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.5986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9515134 KL Loss: 28.4765187 DSM Loss: 39.2619275 Overall Loss:69.6899597
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(72.5283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9322722 KL Loss: 28.3743407 DSM Loss: 38.6748149 Overall Loss:68.9814277
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.5715434551239014


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(89.2870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.5081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9996483 KL Loss: 28.7365084 DSM Loss: 49.7679651 Overall Loss:80.5041212
Validation loss decreased (inf --> 0.550305).  Saving model ...
Updating learning rate to 0.0005
tensor(49.8408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(136.8520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9509020 KL Loss: 28.4278015 DSM Loss: 42.0494106 Overall Loss:72.4281140
Validation loss decreased (0.550305 --> 0.550109).  Saving model ...
Updating learning rate to 0.00025
tensor(54.9972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.2405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.5296, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9165716 KL Loss: 28.0825427 DSM Loss: 40.8300676 Overall Loss:70.8291819
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(95.5795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.9313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9346097 KL Loss: 28.3389949 DSM Loss: 39.2495022 Overall Loss:69.5231069
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7728188037872314


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(107.7067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.4909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9730705 KL Loss: 28.5028318 DSM Loss: 45.6309744 Overall Loss:76.1068767
Validation loss decreased (inf --> 1.089570).  Saving model ...
Updating learning rate to 0.0005
tensor(60.2721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9669583 KL Loss: 28.2518338 DSM Loss: 39.5666823 Overall Loss:69.7854743
Validation loss decreased (1.089570 --> 1.083398).  Saving model ...
Updating learning rate to 0.00025
tensor(59.2505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9549255 KL Loss: 28.2939264 DSM Loss: 39.1016436 Overall Loss:69.3504951
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(80.0882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9497180 KL Loss: 28.2725485 DSM Loss: 39.0229734 Overall Loss:69.2452391
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.556675910949707


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(94.3481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.1630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(143.9340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9461895 KL Loss: 28.7337151 DSM Loss: 47.8720702 Overall Loss:78.5519742
Validation loss decreased (inf --> 0.583129).  Saving model ...
Updating learning rate to 0.0005
tensor(75.0509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.7379, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9465405 KL Loss: 28.4248786 DSM Loss: 39.5022217 Overall Loss:69.8736410
Validation loss decreased (0.583129 --> 0.581117).  Saving model ...
Updating learning rate to 0.00025
tensor(59.8493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(129.7257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9395910 KL Loss: 28.5936054 DSM Loss: 38.4248365 Overall Loss:68.9580327
Validation loss decreased (0.581117 --> 0.578112).  Saving model ...
Updating learning rate to 0.000125
tensor(52.4634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9442943 KL Loss: 28.2925071 DSM Loss: 39.4657273 Overall Loss:69.7025288
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(61.9157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6007, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9416230 KL Loss: 28.4585019 DSM Loss: 38.0403537 Overall Loss:68.4404785
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6950045228004456


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(127.0014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.0685, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9107100 KL Loss: 28.4989268 DSM Loss: 43.4415152 Overall Loss:73.8511520
Validation loss decreased (inf --> 1.964826).  Saving model ...
Updating learning rate to 0.0005
tensor(65.5709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7875, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9213839 KL Loss: 28.4227684 DSM Loss: 37.5375615 Overall Loss:67.8817139
Validation loss decreased (1.964826 --> 1.949881).  Saving model ...
Updating learning rate to 0.00025
tensor(80.3369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9369725 KL Loss: 28.5224915 DSM Loss: 36.8635989 Overall Loss:67.3230633
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(61.7298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9394829 KL Loss: 28.4246740 DSM Loss: 36.6803027 Overall Loss:67.0444593
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.264585018157959


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(134.1586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9340148 KL Loss: 28.5248374 DSM Loss: 43.9968210 Overall Loss:74.4556732
Validation loss decreased (inf --> 1.327514).  Saving model ...
Updating learning rate to 0.0005
tensor(64.0940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1845, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9381599 KL Loss: 28.3230522 DSM Loss: 38.7260016 Overall Loss:68.9872133
Validation loss decreased (1.327514 --> 1.315992).  Saving model ...
Updating learning rate to 0.00025
tensor(61.6358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9072582 KL Loss: 28.2575397 DSM Loss: 38.9996210 Overall Loss:69.1644192
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(68.7322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.5362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9131165 KL Loss: 28.2939200 DSM Loss: 38.4452055 Overall Loss:68.6522426
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.3420137166976929


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(88.2274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.9376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9839135 KL Loss: 28.5904349 DSM Loss: 47.5657855 Overall Loss:78.1401336
Validation loss decreased (inf --> 1.398205).  Saving model ...
Updating learning rate to 0.0005
tensor(80.3937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.8936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9386295 KL Loss: 28.3038686 DSM Loss: 40.5567936 Overall Loss:70.7992915
Validation loss decreased (1.398205 --> 1.394365).  Saving model ...
Updating learning rate to 0.00025
tensor(90.0935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7121, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9665305 KL Loss: 28.6230447 DSM Loss: 39.5892442 Overall Loss:70.1788200
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(54.9784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9231480 KL Loss: 28.2529066 DSM Loss: 39.8111201 Overall Loss:69.9871747
Validation loss decreased (1.394365 --> 1.393753).  Saving model ...
Updating learning rate to 6.25e-05
tensor(60.6164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7843, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8870956 KL Loss: 28.2979049 DSM Loss: 39.2011002 Overall Loss:69.3861007
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(50.2878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.8116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9334008 KL Loss: 28.3599164 DSM Loss: 39.4650709 Overall Loss:69.7583881
Validation loss decreased (1.393753 --> 1.393520).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(48.7806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9292248 KL Loss: 28.4897204 DSM Loss: 39.3960569 Overall Loss:69.8150018
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(70.2536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9227916 KL Loss: 28.3254350 DSM Loss: 39.2968109 Overall Loss:69.5450372
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.469372034072876


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(88.3509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.9970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9674702 KL Loss: 28.6547328 DSM Loss: 45.8296601 Overall Loss:76.4518628
Validation loss decreased (inf --> 1.880840).  Saving model ...
Updating learning rate to 0.0005
tensor(62.7009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.3449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0013931 KL Loss: 28.7228926 DSM Loss: 38.5472001 Overall Loss:69.2714860
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(68.7690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6621, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9483320 KL Loss: 28.5368947 DSM Loss: 38.7196438 Overall Loss:69.2048706
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5664058327674866


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(91.3347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.7342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.1078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9531990 KL Loss: 28.4750895 DSM Loss: 48.2473889 Overall Loss:78.6756772
Validation loss decreased (inf --> 0.664676).  Saving model ...
Updating learning rate to 0.0005
tensor(57.6305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(117.7545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9646, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9495867 KL Loss: 28.2739551 DSM Loss: 40.6980795 Overall Loss:70.9216212
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(58.4026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.9506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9328518 KL Loss: 28.3618977 DSM Loss: 39.1925516 Overall Loss:69.4873011
Validation loss decreased (0.664676 --> 0.658959).  Saving model ...
Updating learning rate to 0.000125
tensor(55.9995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9190538 KL Loss: 28.3672265 DSM Loss: 39.0140594 Overall Loss:69.3003393
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(83.2920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.4134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9683987 KL Loss: 28.4371413 DSM Loss: 38.1584795 Overall Loss:68.5640196
Validation loss decreased (0.658959 --> 0.658687).  Saving model ...
Updating learning rate to 3.125e-05
tensor(52.5527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9554029 KL Loss: 28.5322756 DSM Loss: 38.5403840 Overall Loss:69.0280625
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(53.8011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.0650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9184433 KL Loss: 28.2823056 DSM Loss: 39.2639796 Overall Loss:69.4647283
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6631456017494202


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(100.8969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.8807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9654262 KL Loss: 28.5711316 DSM Loss: 47.9088440 Overall Loss:78.4454021
Validation loss decreased (inf --> 1.431427).  Saving model ...
Updating learning rate to 0.0005
tensor(61.5129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.7363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2471, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9587712 KL Loss: 28.4594711 DSM Loss: 40.5142468 Overall Loss:70.9324885
Validation loss decreased (1.431427 --> 1.411581).  Saving model ...
Updating learning rate to 0.00025
tensor(74.3216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.3647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9515068 KL Loss: 28.5661733 DSM Loss: 39.4876717 Overall Loss:70.0053520
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(59.7707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9514498 KL Loss: 28.4689869 DSM Loss: 38.8482425 Overall Loss:69.2686789
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.974490225315094


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(116.7526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.3069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.6122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9160058 KL Loss: 28.5794556 DSM Loss: 49.2965457 Overall Loss:79.7920068
Validation loss decreased (inf --> 0.898540).  Saving model ...
Updating learning rate to 0.0005
tensor(68.6102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9134275 KL Loss: 28.3460336 DSM Loss: 39.7723029 Overall Loss:70.0317646
Validation loss decreased (0.898540 --> 0.891864).  Saving model ...
Updating learning rate to 0.00025
tensor(76.0145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0004, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9529375 KL Loss: 28.6176131 DSM Loss: 39.5937478 Overall Loss:70.1642983
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(63.1205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9203639 KL Loss: 28.3241834 DSM Loss: 38.5589012 Overall Loss:68.8034486
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.6196885108947754


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(123.8872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9325520 KL Loss: 28.5506491 DSM Loss: 44.2781866 Overall Loss:74.7613877
Validation loss decreased (inf --> 1.549549).  Saving model ...
Updating learning rate to 0.0005
tensor(49.2411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.3444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1358, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8960475 KL Loss: 28.1880484 DSM Loss: 38.8358510 Overall Loss:68.9199470
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(49.6664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9223234 KL Loss: 28.3890280 DSM Loss: 38.5531061 Overall Loss:68.8644573
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6254205703735352


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(125.2357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.1013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9778185 KL Loss: 28.7230314 DSM Loss: 45.3597084 Overall Loss:76.0605583
Validation loss decreased (inf --> 1.069291).  Saving model ...
Updating learning rate to 0.0005
tensor(70.8838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.6594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9288033 KL Loss: 28.3171605 DSM Loss: 40.2982138 Overall Loss:70.5441774
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(80.5835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.8412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9567962 KL Loss: 28.3654931 DSM Loss: 39.1234165 Overall Loss:69.4457058
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.733004629611969


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(113.5300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9903057 KL Loss: 28.7507677 DSM Loss: 49.3052948 Overall Loss:80.0463679
Validation loss decreased (inf --> 0.713234).  Saving model ...
Updating learning rate to 0.0005
tensor(69.6436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9335068 KL Loss: 28.3652340 DSM Loss: 39.2841480 Overall Loss:69.5828884
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(79.7625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.3831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9281107 KL Loss: 28.4695653 DSM Loss: 38.8248497 Overall Loss:69.2225257
Validation loss decreased (0.713234 --> 0.712175).  Saving model ...
Updating learning rate to 0.000125
tensor(55.9281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9134714 KL Loss: 28.3151605 DSM Loss: 38.9827975 Overall Loss:69.2114294
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(76.9113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.0307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9370355 KL Loss: 28.4799101 DSM Loss: 38.3046967 Overall Loss:68.7216420
Validation loss decreased (0.712175 --> 0.712072).  Saving model ...
Updating learning rate to 3.125e-05
tensor(73.2081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9269915 KL Loss: 28.5165147 DSM Loss: 38.0462426 Overall Loss:68.4897488
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(66.4328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9381626 KL Loss: 28.5207432 DSM Loss: 38.1544250 Overall Loss:68.6133312
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7878099083900452


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1328
val 162
test 363
tensor(102.7657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9131292 KL Loss: 28.4966027 DSM Loss: 46.1427992 Overall Loss:76.5525308
Validation loss decreased (inf --> 1.171415).  Saving model ...
Updating learning rate to 0.0005
tensor(59.9958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9113524 KL Loss: 28.2892232 DSM Loss: 40.0390052 Overall Loss:70.2395806
Validation loss decreased (1.171415 --> 1.143697).  Saving model ...
Updating learning rate to 0.00025
tensor(80.6672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9324160 KL Loss: 28.5188505 DSM Loss: 38.7687815 Overall Loss:69.2200478
Validation loss decreased (1.143697 --> 1.124091).  Saving model ...
Updating learning rate to 0.000125
tensor(84.0888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.3563, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9830310 KL Loss: 28.5909610 DSM Loss: 37.8744963 Overall Loss:68.4484878
Validation loss decreased (1.124091 --> 1.119032).  Saving model ...
Updating learning rate to 6.25e-05
tensor(63.0622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9608748 KL Loss: 28.3989802 DSM Loss: 38.1256823 Overall Loss:68.4855369
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(69.6421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.4710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9457141 KL Loss: 28.3415284 DSM Loss: 37.9714335 Overall Loss:68.2586758
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.000548243522644
      Ticker       MSE StdDev
0   AAPL_pct   0.85795    0.0
1   ABBV_pct  0.562022    0.0
2    AEP_pct  1.140886    0.0
3   AMGN_pct   0.70238    0.0
4   AMZN_pct  1.778023    0.0
..       ...       ...    ...
66    VZ_pct  1.619689    0.0
67     V_pct  0.625421    0.0
68   WFC_pct  0.733005    0.0
69   WMT_pct   0.78781    0.0
70   XOM_pct  1.000548    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=9, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=60, root_path='data/EcmP_stock_L_2016_24_mix', scale=0.1, sequence_length=60, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL_pct.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(181.6753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.2238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9752637 KL Loss: 42.7558975 DSM Loss: 68.1051589 Overall Loss:112.8363200
Validation loss decreased (inf --> 0.808688).  Saving model ...
Updating learning rate to 0.0005
tensor(96.1295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.7959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0434756 KL Loss: 43.0183050 DSM Loss: 58.5307718 Overall Loss:103.5925521
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(89.2423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.4886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9775771 KL Loss: 42.4605505 DSM Loss: 58.7038176 Overall Loss:103.1419455
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8624600768089294


Running on file ABBV_pct.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(164.0229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.7290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9663330 KL Loss: 42.6934777 DSM Loss: 65.8702500 Overall Loss:110.5300605
Validation loss decreased (inf --> 0.438803).  Saving model ...
Updating learning rate to 0.0005
tensor(95.8825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9729614 KL Loss: 42.6256119 DSM Loss: 57.4015576 Overall Loss:102.0001311
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(94.3363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.8509, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9360533 KL Loss: 42.5047583 DSM Loss: 57.4007488 Overall Loss:101.8415606
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5619478225708008


Running on file AEP_pct.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(167.7353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.1752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9931278 KL Loss: 42.7026492 DSM Loss: 69.6063739 Overall Loss:114.3021511
Validation loss decreased (inf --> 0.626893).  Saving model ...
Updating learning rate to 0.0005
tensor(78.2992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0285240 KL Loss: 42.9574871 DSM Loss: 59.7056592 Overall Loss:104.6916708
Validation loss decreased (0.626893 --> 0.616775).  Saving model ...
Updating learning rate to 0.00025
tensor(82.5234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.5095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9382164 KL Loss: 42.3453398 DSM Loss: 58.9361645 Overall Loss:103.2197207
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(129.4599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(124.3063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9581936 KL Loss: 42.4674605 DSM Loss: 58.3234120 Overall Loss:102.7490659
Validation loss decreased (0.616775 --> 0.616567).  Saving model ...
Updating learning rate to 6.25e-05
tensor(75.2021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.3938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9696695 KL Loss: 42.6016607 DSM Loss: 57.0160447 Overall Loss:101.5873751
Validation loss decreased (0.616567 --> 0.616479).  Saving model ...
Updating learning rate to 3.125e-05
tensor(122.0592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9314981 KL Loss: 42.1563481 DSM Loss: 59.0143394 Overall Loss:103.1021852
Validation loss decreased (0.616479 --> 0.616323).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(107.6720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2005, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9418220 KL Loss: 42.2886236 DSM Loss: 58.7722386 Overall Loss:103.0026843
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(104.3154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9530, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9477038 KL Loss: 42.2625768 DSM Loss: 58.4496472 Overall Loss:102.6599281
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.1309186220169067


Running on file AMGN_pct.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(145.5274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.8779, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9140695 KL Loss: 42.4444539 DSM Loss: 68.8910836 Overall Loss:113.2496072
Validation loss decreased (inf --> 0.683684).  Saving model ...
Updating learning rate to 0.0005
tensor(104.6761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.8303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9814533 KL Loss: 42.7183439 DSM Loss: 57.5064259 Overall Loss:102.2062231
Validation loss decreased (0.683684 --> 0.676731).  Saving model ...
Updating learning rate to 0.00025
tensor(78.3756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.9570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9740546 KL Loss: 42.6663949 DSM Loss: 57.2728200 Overall Loss:101.9132693
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(93.0063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(125.0033, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9196253 KL Loss: 42.3350490 DSM Loss: 57.2511468 Overall Loss:101.5058207
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7086097598075867


Running on file AMZN_pct.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(174.0470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.7512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9704597 KL Loss: 42.8822748 DSM Loss: 60.6370000 Overall Loss:105.4897346
Validation loss decreased (inf --> 1.594737).  Saving model ...
Updating learning rate to 0.0005
tensor(100.8837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.7923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9431857 KL Loss: 42.6226924 DSM Loss: 54.7878922 Overall Loss:99.3537703
Validation loss decreased (1.594737 --> 1.594342).  Saving model ...
Updating learning rate to 0.00025
tensor(87.8919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.5246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9210619 KL Loss: 42.4811002 DSM Loss: 54.4854422 Overall Loss:98.8876047
Validation loss decreased (1.594342 --> 1.585025).  Saving model ...
Updating learning rate to 0.000125
tensor(84.9842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.0947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9514353 KL Loss: 42.4688076 DSM Loss: 54.0138554 Overall Loss:98.4340981
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(98.9596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.5162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9366201 KL Loss: 42.4691295 DSM Loss: 53.9538631 Overall Loss:98.3596128
Validation loss decreased (1.585025 --> 1.583167).  Saving model ...
Updating learning rate to 3.125e-05
tensor(114.9504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.2785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9434710 KL Loss: 42.4285966 DSM Loss: 54.1835553 Overall Loss:98.5556231
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(99.3248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.5278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9224983 KL Loss: 42.4392943 DSM Loss: 54.6375806 Overall Loss:98.9993732
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.748052716255188


Running on file BAC_pct.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(128.5820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(125.8977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9534592 KL Loss: 42.7583766 DSM Loss: 75.2945421 Overall Loss:120.0063779
Validation loss decreased (inf --> 0.709640).  Saving model ...
Updating learning rate to 0.0005
tensor(103.8415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.6285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9588471 KL Loss: 42.5675269 DSM Loss: 58.7280208 Overall Loss:103.2543938
Validation loss decreased (0.709640 --> 0.709416).  Saving model ...
Updating learning rate to 0.00025
tensor(86.4158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.5693, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9673313 KL Loss: 42.6958922 DSM Loss: 56.3240745 Overall Loss:100.9872982
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(110.3326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9783486 KL Loss: 42.8612411 DSM Loss: 56.3399992 Overall Loss:101.1795890
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6796472072601318


Running on file BA_pct.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(154.0830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(160.7532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0043966 KL Loss: 43.2490775 DSM Loss: 69.4696852 Overall Loss:114.7231598
Validation loss decreased (inf --> 0.756980).  Saving model ...
Updating learning rate to 0.0005
tensor(94.2404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.0462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9595937 KL Loss: 42.6499102 DSM Loss: 59.9551453 Overall Loss:104.5646492
Validation loss decreased (0.756980 --> 0.753732).  Saving model ...
Updating learning rate to 0.00025
tensor(100.2021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.6312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9526855 KL Loss: 42.5231607 DSM Loss: 58.9350256 Overall Loss:103.4108719
Validation loss decreased (0.753732 --> 0.751276).  Saving model ...
Updating learning rate to 0.000125
tensor(148.8340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9367195 KL Loss: 42.1960634 DSM Loss: 58.5659499 Overall Loss:102.6987329
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(136.0374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.3915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9710157 KL Loss: 42.4378464 DSM Loss: 58.4122293 Overall Loss:102.8210912
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5834225416183472


Running on file BCH_pct.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(151.1534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.2209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9380614 KL Loss: 42.5657799 DSM Loss: 75.6013011 Overall Loss:120.1051430
Validation loss decreased (inf --> 1.767984).  Saving model ...
Updating learning rate to 0.0005
tensor(121.2612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(121.7657, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9611520 KL Loss: 42.6417596 DSM Loss: 61.0606564 Overall Loss:105.6635684
Validation loss decreased (1.767984 --> 1.765147).  Saving model ...
Updating learning rate to 0.00025
tensor(108.9235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.1218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9816043 KL Loss: 42.7910556 DSM Loss: 58.4377681 Overall Loss:103.2104280
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(81.3541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.2873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9387608 KL Loss: 42.4210365 DSM Loss: 58.7281828 Overall Loss:103.0879803
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8900941610336304


Running on file BHP_pct.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(152.2363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.1436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9172490 KL Loss: 42.6028715 DSM Loss: 62.5291540 Overall Loss:107.0492743
Validation loss decreased (inf --> 0.949223).  Saving model ...
Updating learning rate to 0.0005
tensor(90.4877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.7061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9023837 KL Loss: 42.2743552 DSM Loss: 50.6268273 Overall Loss:94.8035661
Validation loss decreased (0.949223 --> 0.947782).  Saving model ...
Updating learning rate to 0.00025
tensor(81.6236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.3750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8858082 KL Loss: 42.0186865 DSM Loss: 51.0090476 Overall Loss:94.9135423
Validation loss decreased (0.947782 --> 0.946315).  Saving model ...
Updating learning rate to 0.000125
tensor(89.1331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9057666 KL Loss: 42.3677491 DSM Loss: 49.7551912 Overall Loss:94.0287071
Validation loss decreased (0.946315 --> 0.944433).  Saving model ...
Updating learning rate to 6.25e-05
tensor(118.5579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.3004, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9037718 KL Loss: 42.2935365 DSM Loss: 49.3142660 Overall Loss:93.5115745
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(81.6653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.9567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9091849 KL Loss: 42.3257318 DSM Loss: 49.7626478 Overall Loss:93.9975647
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8823864459991455


Running on file BP_pct.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(154.2492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.4208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9704590 KL Loss: 42.9672874 DSM Loss: 65.0613648 Overall Loss:109.9991119
Validation loss decreased (inf --> 0.936019).  Saving model ...
Updating learning rate to 0.0005
tensor(120.8228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9516664 KL Loss: 42.7046273 DSM Loss: 57.1383614 Overall Loss:101.7946555
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(126.0182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.8743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9717896 KL Loss: 42.7375071 DSM Loss: 56.7678519 Overall Loss:101.4771481
Validation loss decreased (0.936019 --> 0.933414).  Saving model ...
Updating learning rate to 0.000125
tensor(83.7750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3874, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9594729 KL Loss: 42.7340025 DSM Loss: 55.7359926 Overall Loss:100.4294676
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(85.8315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.7624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9506153 KL Loss: 42.5806879 DSM Loss: 56.0786978 Overall Loss:100.6100014
Validation loss decreased (0.933414 --> 0.932749).  Saving model ...
Updating learning rate to 3.125e-05
tensor(132.8323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.6671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9394533 KL Loss: 42.3694125 DSM Loss: 55.6831241 Overall Loss:99.9919905
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(154.6075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(178.7631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9529966 KL Loss: 42.4436892 DSM Loss: 56.7769778 Overall Loss:101.1736642
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6923208236694336


Running on file BRK-A_pct.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(147.4599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(128.4521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0002323 KL Loss: 42.7954680 DSM Loss: 71.2383301 Overall Loss:116.0340304
Validation loss decreased (inf --> 0.664433).  Saving model ...
Updating learning rate to 0.0005
tensor(131.4377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.0214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0200028 KL Loss: 43.0327967 DSM Loss: 60.5852422 Overall Loss:105.6380416
Validation loss decreased (0.664433 --> 0.663771).  Saving model ...
Updating learning rate to 0.00025
tensor(90.4350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.3566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0246563 KL Loss: 42.7665505 DSM Loss: 59.3805523 Overall Loss:104.1717593
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(128.2156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9942692 KL Loss: 42.6099672 DSM Loss: 58.9497667 Overall Loss:103.5540029
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8455313444137573


Running on file BSAC_pct.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(172.4494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.0050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9707645 KL Loss: 42.8098002 DSM Loss: 68.6342803 Overall Loss:113.4148449
Validation loss decreased (inf --> 1.615561).  Saving model ...
Updating learning rate to 0.0005
tensor(82.3077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(162.2744, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9930677 KL Loss: 42.6499553 DSM Loss: 59.2756593 Overall Loss:103.9186826
Validation loss decreased (1.615561 --> 1.615381).  Saving model ...
Updating learning rate to 0.00025
tensor(94.6025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.8784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9860097 KL Loss: 42.9760797 DSM Loss: 57.8917706 Overall Loss:102.8538601
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(81.4547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.8170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 2.0038086 KL Loss: 42.7774149 DSM Loss: 58.2092439 Overall Loss:102.9904679
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8969001173973083


Running on file BUD_pct.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(147.7027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(134.7208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0542466 KL Loss: 42.8524783 DSM Loss: 80.4321015 Overall Loss:125.3388268
Validation loss decreased (inf --> 1.106450).  Saving model ...
Updating learning rate to 0.0005
tensor(91.8631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.1346, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0195289 KL Loss: 42.6362174 DSM Loss: 59.8077017 Overall Loss:104.4634481
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(79.5731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(125.8850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9871775 KL Loss: 42.7580976 DSM Loss: 59.7044023 Overall Loss:104.4496765
Validation loss decreased (1.106450 --> 1.105746).  Saving model ...
Updating learning rate to 0.000125
tensor(105.0259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.2351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9649801 KL Loss: 42.5891376 DSM Loss: 59.1351891 Overall Loss:103.6893072
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(115.5912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.2026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9837735 KL Loss: 42.5766151 DSM Loss: 58.9027526 Overall Loss:103.4631416
Validation loss decreased (1.105746 --> 1.105529).  Saving model ...
Updating learning rate to 3.125e-05
tensor(114.2686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.2677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9411134 KL Loss: 42.3589929 DSM Loss: 60.0020068 Overall Loss:104.3021136
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(96.7327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(145.0492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9621363 KL Loss: 42.6289093 DSM Loss: 59.4270845 Overall Loss:104.0181300
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6594193577766418


Running on file CAT_pct.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(154.3164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.9109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9654166 KL Loss: 42.9371849 DSM Loss: 71.6774861 Overall Loss:116.5800879
Validation loss decreased (inf --> 0.804433).  Saving model ...
Updating learning rate to 0.0005
tensor(98.0516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.1672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9751194 KL Loss: 42.7967720 DSM Loss: 59.0524374 Overall Loss:103.8243290
Validation loss decreased (0.804433 --> 0.802338).  Saving model ...
Updating learning rate to 0.00025
tensor(97.9035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.2619, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9511008 KL Loss: 42.4880998 DSM Loss: 58.9077208 Overall Loss:103.3469223
Validation loss decreased (0.802338 --> 0.802058).  Saving model ...
Updating learning rate to 0.000125
tensor(80.3246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(117.3146, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9512509 KL Loss: 42.6605531 DSM Loss: 57.7741887 Overall Loss:102.3859927
Validation loss decreased (0.802058 --> 0.801709).  Saving model ...
Updating learning rate to 6.25e-05
tensor(123.4029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.5029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9265666 KL Loss: 42.4031371 DSM Loss: 56.7249406 Overall Loss:101.0546447
Validation loss decreased (0.801709 --> 0.800991).  Saving model ...
Updating learning rate to 3.125e-05
tensor(94.6906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(130.9165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9490910 KL Loss: 42.5991462 DSM Loss: 57.4688638 Overall Loss:102.0171012
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(119.4200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.9231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9433803 KL Loss: 42.4642056 DSM Loss: 56.7763927 Overall Loss:101.1839777
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.9733882546424866


Running on file CHTR_pct.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(179.8618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(124.9508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9602108 KL Loss: 42.6444523 DSM Loss: 68.6789588 Overall Loss:113.2836209
Validation loss decreased (inf --> 0.904294).  Saving model ...
Updating learning rate to 0.0005
tensor(103.3385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.3487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9577752 KL Loss: 42.6977111 DSM Loss: 57.0120314 Overall Loss:101.6675182
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(92.9478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.2584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9615533 KL Loss: 42.4593876 DSM Loss: 57.0321671 Overall Loss:101.4531080
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.681583285331726


Running on file CMCSA_pct.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(195.3330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9753148 KL Loss: 42.8555593 DSM Loss: 68.6246765 Overall Loss:113.4555506
Validation loss decreased (inf --> 0.988551).  Saving model ...
Updating learning rate to 0.0005
tensor(83.9683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.8120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0085449 KL Loss: 42.8016980 DSM Loss: 59.9119499 Overall Loss:104.7221930
Validation loss decreased (0.988551 --> 0.977231).  Saving model ...
Updating learning rate to 0.00025
tensor(89.3477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.5349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9650376 KL Loss: 42.6553309 DSM Loss: 58.5879869 Overall Loss:103.2083559
Validation loss decreased (0.977231 --> 0.974344).  Saving model ...
Updating learning rate to 0.000125
tensor(89.0955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.5053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9310016 KL Loss: 42.3012153 DSM Loss: 59.8314635 Overall Loss:104.0636803
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(113.7275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.9221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9317618 KL Loss: 42.5164742 DSM Loss: 58.8533663 Overall Loss:103.3016026
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.1879554986953735


Running on file CODI_pct.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(189.1683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.3258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9755608 KL Loss: 42.8113471 DSM Loss: 69.7868188 Overall Loss:114.5737265
Validation loss decreased (inf --> 1.182185).  Saving model ...
Updating learning rate to 0.0005
tensor(71.2085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.6080, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0034466 KL Loss: 42.7545350 DSM Loss: 59.5962833 Overall Loss:104.3542649
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(115.3554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.6524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9612971 KL Loss: 42.5255557 DSM Loss: 60.8667597 Overall Loss:105.3536127
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.205039620399475


Running on file CSCO_pct.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(138.0378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.7485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9222847 KL Loss: 42.8225570 DSM Loss: 72.3861603 Overall Loss:117.1310016
Validation loss decreased (inf --> 0.758134).  Saving model ...
Updating learning rate to 0.0005
tensor(72.0977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.1647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9621627 KL Loss: 42.8017852 DSM Loss: 58.4968582 Overall Loss:103.2608068
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(91.8243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(126.3706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9547368 KL Loss: 42.5931841 DSM Loss: 57.4327826 Overall Loss:101.9807035
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6841235160827637


Running on file CVX_pct.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(112.3620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.0730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9811803 KL Loss: 42.9285720 DSM Loss: 75.2231336 Overall Loss:120.1328862
Validation loss decreased (inf --> 0.579037).  Saving model ...
Updating learning rate to 0.0005
tensor(109.4006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(173.7958, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9062613 KL Loss: 42.3596341 DSM Loss: 59.6149272 Overall Loss:103.8808230
Validation loss decreased (0.579037 --> 0.578586).  Saving model ...
Updating learning rate to 0.00025
tensor(78.1109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(190.4283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9277369 KL Loss: 42.5435256 DSM Loss: 59.1247482 Overall Loss:103.5960101
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(80.2351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.6078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9277328 KL Loss: 42.5104918 DSM Loss: 58.2959107 Overall Loss:102.7341351
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7033906579017639


Running on file C_pct.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : C_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(181.0806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.1015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9672665 KL Loss: 42.6591636 DSM Loss: 73.2541333 Overall Loss:117.8805630
Validation loss decreased (inf --> 0.444660).  Saving model ...
Updating learning rate to 0.0005
tensor(153.0616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.1970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9616007 KL Loss: 42.6705830 DSM Loss: 57.9913827 Overall Loss:102.6235663
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(71.6016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.8689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9687841 KL Loss: 42.4256077 DSM Loss: 57.4265708 Overall Loss:101.8209620
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6038466691970825


Running on file DHR_pct.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(162.0040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(136.6314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0020313 KL Loss: 42.9421067 DSM Loss: 75.8350430 Overall Loss:120.7791816
Validation loss decreased (inf --> 1.482746).  Saving model ...
Updating learning rate to 0.0005
tensor(91.8143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.2323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9457548 KL Loss: 42.3474556 DSM Loss: 61.1675681 Overall Loss:105.4607788
Validation loss decreased (1.482746 --> 1.481567).  Saving model ...
Updating learning rate to 0.00025
tensor(125.6396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.9166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9657849 KL Loss: 42.6965502 DSM Loss: 59.3631702 Overall Loss:104.0255051
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(154.1567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.0012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9885551 KL Loss: 42.6291512 DSM Loss: 59.0853691 Overall Loss:103.7030752
Validation loss decreased (1.481567 --> 1.478677).  Saving model ...
Updating learning rate to 6.25e-05
tensor(115.0376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.2189, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9684206 KL Loss: 42.7225094 DSM Loss: 59.0227168 Overall Loss:103.7136470
Validation loss decreased (1.478677 --> 1.477636).  Saving model ...
Updating learning rate to 3.125e-05
tensor(118.5965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.6210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9556037 KL Loss: 42.5836106 DSM Loss: 59.2272181 Overall Loss:103.7664322
Validation loss decreased (1.477636 --> 1.474867).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(104.7362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.4697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9382168 KL Loss: 42.4643432 DSM Loss: 59.2404531 Overall Loss:103.6430132
Validation loss decreased (1.474867 --> 1.472174).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(106.6779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.7291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9449780 KL Loss: 42.5013589 DSM Loss: 59.4055265 Overall Loss:103.8518632
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(108.6566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.7813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 80 | MSE Loss: 1.9737032 KL Loss: 42.5150081 DSM Loss: 58.6054413 Overall Loss:103.0941527
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.6618318557739258


Running on file DIS_pct.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(129.2546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.6210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9650858 KL Loss: 42.7523961 DSM Loss: 77.3883168 Overall Loss:122.1057982
Validation loss decreased (inf --> 1.103050).  Saving model ...
Updating learning rate to 0.0005
tensor(110.1850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(125.9048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9944673 KL Loss: 42.8621162 DSM Loss: 59.7968544 Overall Loss:104.6534376
Validation loss decreased (1.103050 --> 1.086243).  Saving model ...
Updating learning rate to 0.00025
tensor(124.4839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.9566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9609005 KL Loss: 42.3954601 DSM Loss: 59.4714200 Overall Loss:103.8277808
Validation loss decreased (1.086243 --> 1.077006).  Saving model ...
Updating learning rate to 0.000125
tensor(88.7087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.1933, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9447594 KL Loss: 42.2913767 DSM Loss: 58.2023952 Overall Loss:102.4385312
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(130.1448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.6838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9313952 KL Loss: 42.3555151 DSM Loss: 59.3626232 Overall Loss:103.6495332
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.3878297805786133


Running on file DUK_pct.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(121.6009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.7950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9432032 KL Loss: 42.9720518 DSM Loss: 70.6572484 Overall Loss:115.5725040
Validation loss decreased (inf --> 0.578555).  Saving model ...
Updating learning rate to 0.0005
tensor(102.9665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.2873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9710788 KL Loss: 42.9067455 DSM Loss: 59.7139974 Overall Loss:104.5918220
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(112.2966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.1120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9396058 KL Loss: 42.6355040 DSM Loss: 60.8504695 Overall Loss:105.4255790
Validation loss decreased (0.578555 --> 0.578417).  Saving model ...
Updating learning rate to 0.000125
tensor(142.2417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.3931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9596443 KL Loss: 42.4450900 DSM Loss: 59.0957943 Overall Loss:103.5005287
Validation loss decreased (0.578417 --> 0.577821).  Saving model ...
Updating learning rate to 6.25e-05
tensor(74.2154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(132.4492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9399182 KL Loss: 42.4156091 DSM Loss: 60.1623682 Overall Loss:104.5178959
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(72.9133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.7211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9901193 KL Loss: 42.6180905 DSM Loss: 57.5649930 Overall Loss:102.1732028
Validation loss decreased (0.577821 --> 0.577684).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(117.6158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.5469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9534975 KL Loss: 42.3226845 DSM Loss: 57.7914098 Overall Loss:102.0675926
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(79.5837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.0655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9352597 KL Loss: 42.2701256 DSM Loss: 59.6856016 Overall Loss:103.8909867
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8733218312263489


Running on file D_pct.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : D_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(169.4455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.0757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9943236 KL Loss: 43.0374031 DSM Loss: 74.8572839 Overall Loss:119.8890101
Validation loss decreased (inf --> 0.655052).  Saving model ...
Updating learning rate to 0.0005
tensor(80.0610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9502465 KL Loss: 42.4675425 DSM Loss: 60.4899355 Overall Loss:104.9077244
Validation loss decreased (0.655052 --> 0.651345).  Saving model ...
Updating learning rate to 0.00025
tensor(74.7608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.2372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9542879 KL Loss: 42.6023295 DSM Loss: 60.3653004 Overall Loss:104.9219175
Validation loss decreased (0.651345 --> 0.651306).  Saving model ...
Updating learning rate to 0.000125
tensor(70.4902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.9054, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9585769 KL Loss: 42.4210199 DSM Loss: 60.1518415 Overall Loss:104.5314384
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(76.9271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2293, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9928203 KL Loss: 42.5469125 DSM Loss: 58.7637142 Overall Loss:103.3034472
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.1214780807495117


Running on file EXC_pct.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(170.6449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.5761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8810707 KL Loss: 42.4242839 DSM Loss: 69.1865848 Overall Loss:113.4919399
Validation loss decreased (inf --> 0.480884).  Saving model ...
Updating learning rate to 0.0005
tensor(158.7188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(167.5580, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0124041 KL Loss: 43.2517081 DSM Loss: 59.0995511 Overall Loss:104.3636635
Validation loss decreased (0.480884 --> 0.476944).  Saving model ...
Updating learning rate to 0.00025
tensor(81.4621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.6517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9705474 KL Loss: 42.5386979 DSM Loss: 57.9291014 Overall Loss:102.4383467
Validation loss decreased (0.476944 --> 0.468466).  Saving model ...
Updating learning rate to 0.000125
tensor(159.0202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9619268 KL Loss: 42.6399996 DSM Loss: 59.6134711 Overall Loss:104.2153971
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(120.3182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.1351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9265895 KL Loss: 42.2494358 DSM Loss: 59.1227306 Overall Loss:103.2987565
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7569584250450134


Running on file GD_pct.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(185.1063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.6603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9738471 KL Loss: 42.9315361 DSM Loss: 72.0330458 Overall Loss:116.9384295
Validation loss decreased (inf --> 0.616554).  Saving model ...
Updating learning rate to 0.0005
tensor(92.4728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.8623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9864360 KL Loss: 42.8222676 DSM Loss: 59.3341054 Overall Loss:104.1428096
Validation loss decreased (0.616554 --> 0.605377).  Saving model ...
Updating learning rate to 0.00025
tensor(112.7825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(121.3002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9846006 KL Loss: 42.7142801 DSM Loss: 59.2474390 Overall Loss:103.9463194
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(91.9229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 2.0041646 KL Loss: 42.9472725 DSM Loss: 57.8650301 Overall Loss:102.8164669
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6836533546447754


Running on file GE_pct.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(136.4120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.7667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9488218 KL Loss: 42.8267299 DSM Loss: 77.8835874 Overall Loss:122.6591394
Validation loss decreased (inf --> 0.632993).  Saving model ...
Updating learning rate to 0.0005
tensor(102.1237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.1666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9506429 KL Loss: 42.6914314 DSM Loss: 62.6298467 Overall Loss:107.2719216
Validation loss decreased (0.632993 --> 0.631951).  Saving model ...
Updating learning rate to 0.00025
tensor(82.5941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(122.9126, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9710723 KL Loss: 42.6603982 DSM Loss: 61.0130548 Overall Loss:105.6445257
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(100.2914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.2131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9685361 KL Loss: 42.5328905 DSM Loss: 59.5134920 Overall Loss:104.0149181
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5087933540344238


Running on file GOOG_pct.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(162.4831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.2970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9750702 KL Loss: 42.8493706 DSM Loss: 75.5927668 Overall Loss:120.4172082
Validation loss decreased (inf --> 1.226252).  Saving model ...
Updating learning rate to 0.0005
tensor(132.5237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.8933, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9594053 KL Loss: 42.7484969 DSM Loss: 59.5802808 Overall Loss:104.2881838
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(88.8823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.1670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9581386 KL Loss: 42.5624793 DSM Loss: 58.6097634 Overall Loss:103.1303810
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.735153317451477


Running on file HD_pct.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(151.0702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(161.0810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9120534 KL Loss: 42.6868032 DSM Loss: 76.3233114 Overall Loss:120.9221678
Validation loss decreased (inf --> 1.119701).  Saving model ...
Updating learning rate to 0.0005
tensor(79.0920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9871478 KL Loss: 42.6781020 DSM Loss: 59.3580115 Overall Loss:104.0232618
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(91.9646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.6808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0338378 KL Loss: 43.0730929 DSM Loss: 57.5050290 Overall Loss:102.6119598
Validation loss decreased (1.119701 --> 1.117899).  Saving model ...
Updating learning rate to 0.000125
tensor(83.1095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.5266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9546364 KL Loss: 42.3880758 DSM Loss: 58.8214943 Overall Loss:103.1642063
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(78.9494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.5599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9623168 KL Loss: 42.5661747 DSM Loss: 59.1932266 Overall Loss:103.7217183
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.0091317892074585


Running on file HON_pct.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(144.0677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.1751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0024776 KL Loss: 42.9447052 DSM Loss: 68.9027421 Overall Loss:113.8499250
Validation loss decreased (inf --> 0.826304).  Saving model ...
Updating learning rate to 0.0005
tensor(71.4795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.1824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0275811 KL Loss: 42.8835941 DSM Loss: 59.7214152 Overall Loss:104.6325906
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(85.8570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.9615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9192496 KL Loss: 42.3628109 DSM Loss: 60.5632439 Overall Loss:104.8453047
Validation loss decreased (0.826304 --> 0.822474).  Saving model ...
Updating learning rate to 0.000125
tensor(82.8826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.3781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9459981 KL Loss: 42.3469003 DSM Loss: 59.2003034 Overall Loss:103.4932017
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(88.3618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.0422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9632410 KL Loss: 42.2757238 DSM Loss: 59.0358242 Overall Loss:103.2747894
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.713391125202179


Running on file HSBC_pct.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(137.0464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.1507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9630298 KL Loss: 42.6361843 DSM Loss: 80.8804825 Overall Loss:125.4796961
Validation loss decreased (inf --> 1.272025).  Saving model ...
Updating learning rate to 0.0005
tensor(105.9515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9677075 KL Loss: 42.6547753 DSM Loss: 58.3942364 Overall Loss:103.0167195
Validation loss decreased (1.272025 --> 1.247782).  Saving model ...
Updating learning rate to 0.00025
tensor(107.1216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.5639, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9442668 KL Loss: 42.4538199 DSM Loss: 58.3915345 Overall Loss:102.7896218
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(109.6635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.7608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9677878 KL Loss: 42.6447520 DSM Loss: 57.8319329 Overall Loss:102.4444724
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.9829177856445312


Running on file IEP_pct.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(184.1273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.2319, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0221217 KL Loss: 42.7716365 DSM Loss: 66.8024747 Overall Loss:111.5962332
Validation loss decreased (inf --> 0.350063).  Saving model ...
Updating learning rate to 0.0005
tensor(95.0850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.3373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9322111 KL Loss: 42.4172470 DSM Loss: 53.6007115 Overall Loss:97.9501702
Validation loss decreased (0.350063 --> 0.347846).  Saving model ...
Updating learning rate to 0.00025
tensor(78.5614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(135.4833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9399912 KL Loss: 42.4555398 DSM Loss: 52.6247461 Overall Loss:97.0202773
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(126.1089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9486665 KL Loss: 42.6378146 DSM Loss: 51.3252959 Overall Loss:95.9117772
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:3.2695701122283936


Running on file INTC_pct.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(177.4024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(121.1470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9810584 KL Loss: 42.8669590 DSM Loss: 93.3242102 Overall Loss:138.1722281
Validation loss decreased (inf --> 0.919925).  Saving model ...
Updating learning rate to 0.0005
tensor(114.1295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8447, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9323297 KL Loss: 42.5174667 DSM Loss: 60.6222263 Overall Loss:105.0720223
Validation loss decreased (0.919925 --> 0.917818).  Saving model ...
Updating learning rate to 0.00025
tensor(83.3158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(139.8531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9496868 KL Loss: 42.5254546 DSM Loss: 59.2722224 Overall Loss:103.7473634
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(92.2033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.9573, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9636242 KL Loss: 42.6203014 DSM Loss: 59.4045126 Overall Loss:103.9884377
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.3785490989685059


Running on file JNJ_pct.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(155.1464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.4577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9532050 KL Loss: 42.5275901 DSM Loss: 73.6031366 Overall Loss:118.0839314
Validation loss decreased (inf --> 0.727016).  Saving model ...
Updating learning rate to 0.0005
tensor(84.1106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.3136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0048643 KL Loss: 42.7923257 DSM Loss: 60.1315390 Overall Loss:104.9287288
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(106.5306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0110449 KL Loss: 42.6627861 DSM Loss: 58.0015846 Overall Loss:102.6754156
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7322534322738647


Running on file JPM_pct.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(152.9751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.0245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9674865 KL Loss: 42.7713612 DSM Loss: 70.4977935 Overall Loss:115.2366415
Validation loss decreased (inf --> 0.816176).  Saving model ...
Updating learning rate to 0.0005
tensor(86.4655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.6831, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9283342 KL Loss: 42.2824826 DSM Loss: 58.8531947 Overall Loss:103.0640112
Validation loss decreased (0.816176 --> 0.769490).  Saving model ...
Updating learning rate to 0.00025
tensor(104.1544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(137.2706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0117006 KL Loss: 42.8359305 DSM Loss: 57.1200716 Overall Loss:101.9677028
Validation loss decreased (0.769490 --> 0.763941).  Saving model ...
Updating learning rate to 0.000125
tensor(101.2601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.1641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9282109 KL Loss: 42.2035214 DSM Loss: 57.5293154 Overall Loss:101.6610477
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(71.7516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.9651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9801242 KL Loss: 42.4929771 DSM Loss: 55.7447419 Overall Loss:100.2178432
Validation loss decreased (0.763941 --> 0.759543).  Saving model ...
Updating learning rate to 3.125e-05
tensor(125.5739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9649976 KL Loss: 42.3654042 DSM Loss: 56.5755179 Overall Loss:100.9059200
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(68.2916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.1393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9362809 KL Loss: 42.2683794 DSM Loss: 56.9774217 Overall Loss:101.1820823
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6585404276847839


Running on file KO_pct.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(145.2115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(140.6734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9731574 KL Loss: 42.8632045 DSM Loss: 72.9689635 Overall Loss:117.8053260
Validation loss decreased (inf --> 0.740541).  Saving model ...
Updating learning rate to 0.0005
tensor(111.7303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.8650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9640570 KL Loss: 42.5622291 DSM Loss: 60.5943085 Overall Loss:105.1205944
Validation loss decreased (0.740541 --> 0.735035).  Saving model ...
Updating learning rate to 0.00025
tensor(71.0591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.3679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9635203 KL Loss: 42.4033332 DSM Loss: 59.2829065 Overall Loss:103.6497600
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(164.7365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.3197, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9843752 KL Loss: 42.4516687 DSM Loss: 58.7278358 Overall Loss:103.1638796
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6172287464141846


Running on file LMT_pct.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(152.3951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.2274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9664324 KL Loss: 43.0408188 DSM Loss: 71.9110554 Overall Loss:116.9183065
Validation loss decreased (inf --> 1.275813).  Saving model ...
Updating learning rate to 0.0005
tensor(110.5174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(148.3026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9843270 KL Loss: 42.7747319 DSM Loss: 61.1367350 Overall Loss:105.8957944
Validation loss decreased (1.275813 --> 1.266345).  Saving model ...
Updating learning rate to 0.00025
tensor(139.8116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.6110, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9416574 KL Loss: 42.5306944 DSM Loss: 61.1823424 Overall Loss:105.6546944
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(142.4683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.6850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9236328 KL Loss: 42.4393754 DSM Loss: 60.4897844 Overall Loss:104.8527925
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8149001598358154


Running on file MA_pct.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(159.6409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.4232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9582234 KL Loss: 42.5276424 DSM Loss: 74.5530316 Overall Loss:119.0388980
Validation loss decreased (inf --> 1.443280).  Saving model ...
Updating learning rate to 0.0005
tensor(136.2206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6523, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9789381 KL Loss: 42.5185831 DSM Loss: 60.1206172 Overall Loss:104.6181386
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(78.2747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.1751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9246682 KL Loss: 42.3199474 DSM Loss: 59.4198324 Overall Loss:103.6644480
Validation loss decreased (1.443280 --> 1.443197).  Saving model ...
Updating learning rate to 0.000125
tensor(88.8377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(151.5177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9289770 KL Loss: 42.1676550 DSM Loss: 57.9450349 Overall Loss:102.0416666
Validation loss decreased (1.443197 --> 1.442150).  Saving model ...
Updating learning rate to 6.25e-05
tensor(139.2423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(126.9156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9270060 KL Loss: 42.0945934 DSM Loss: 59.2069863 Overall Loss:103.2285857
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(81.0433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9140525 KL Loss: 42.1956923 DSM Loss: 58.7516422 Overall Loss:102.8613871
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5814700126647949


Running on file MCD_pct.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(177.1444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(129.4915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0274601 KL Loss: 43.2986819 DSM Loss: 72.3546999 Overall Loss:117.6808428
Validation loss decreased (inf --> 0.567209).  Saving model ...
Updating learning rate to 0.0005
tensor(174.0661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9967792 KL Loss: 42.9714656 DSM Loss: 60.7174057 Overall Loss:105.6856508
Validation loss decreased (0.567209 --> 0.565396).  Saving model ...
Updating learning rate to 0.00025
tensor(76.8686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9418460 KL Loss: 42.4156399 DSM Loss: 60.0550031 Overall Loss:104.4124886
Validation loss decreased (0.565396 --> 0.565265).  Saving model ...
Updating learning rate to 0.000125
tensor(156.3621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9329557 KL Loss: 42.5023837 DSM Loss: 59.6574293 Overall Loss:104.0927687
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(98.3448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9423104 KL Loss: 42.4068953 DSM Loss: 59.4502495 Overall Loss:103.7994555
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.48930853605270386


Running on file MDT_pct.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(136.9466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.9736, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9363403 KL Loss: 42.7876789 DSM Loss: 77.2728112 Overall Loss:121.9968307
Validation loss decreased (inf --> 0.982110).  Saving model ...
Updating learning rate to 0.0005
tensor(131.9783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.3292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9289767 KL Loss: 42.4558117 DSM Loss: 60.2799245 Overall Loss:104.6647132
Validation loss decreased (0.982110 --> 0.955969).  Saving model ...
Updating learning rate to 0.00025
tensor(69.9626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.8096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9474911 KL Loss: 42.5366538 DSM Loss: 59.3315015 Overall Loss:103.8156466
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(97.0830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.4429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9458136 KL Loss: 42.3890574 DSM Loss: 58.5372544 Overall Loss:102.8721252
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.9597952961921692


Running on file MMM_pct.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(170.5166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(141.4590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9078591 KL Loss: 42.8047967 DSM Loss: 87.0481361 Overall Loss:131.7607923
Validation loss decreased (inf --> 0.731134).  Saving model ...
Updating learning rate to 0.0005
tensor(120.0868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.4654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9589894 KL Loss: 42.9364017 DSM Loss: 61.5321606 Overall Loss:106.4275521
Validation loss decreased (0.731134 --> 0.712283).  Saving model ...
Updating learning rate to 0.00025
tensor(91.7362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.8596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9459041 KL Loss: 42.7969565 DSM Loss: 60.7467956 Overall Loss:105.4896568
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(93.2017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(136.8114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9279326 KL Loss: 42.5402367 DSM Loss: 60.4902574 Overall Loss:104.9584265
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.4444633722305298


Running on file MO_pct.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(172.5654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.3224, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9438286 KL Loss: 42.9111629 DSM Loss: 74.3096227 Overall Loss:119.1646136
Validation loss decreased (inf --> 0.756851).  Saving model ...
Updating learning rate to 0.0005
tensor(90.8884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.8511, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9459494 KL Loss: 42.6308867 DSM Loss: 62.1824830 Overall Loss:106.7593188
Validation loss decreased (0.756851 --> 0.754539).  Saving model ...
Updating learning rate to 0.00025
tensor(84.7173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.9902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9989079 KL Loss: 43.2122839 DSM Loss: 60.9497626 Overall Loss:106.1609547
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(93.1363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.5353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9631324 KL Loss: 42.5289483 DSM Loss: 61.0822280 Overall Loss:105.5743083
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6003774404525757


Running on file MRK_pct.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(146.7487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(131.0087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9900179 KL Loss: 42.7426649 DSM Loss: 81.3850926 Overall Loss:126.1177752
Validation loss decreased (inf --> 1.636606).  Saving model ...
Updating learning rate to 0.0005
tensor(110.0797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.4444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9949281 KL Loss: 42.7864830 DSM Loss: 60.3139297 Overall Loss:105.0953406
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(87.6818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(117.0561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9831101 KL Loss: 42.6088804 DSM Loss: 59.7323796 Overall Loss:104.3243707
Validation loss decreased (1.636606 --> 1.636544).  Saving model ...
Updating learning rate to 0.000125
tensor(111.9028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.1773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9550886 KL Loss: 42.6403922 DSM Loss: 60.4488880 Overall Loss:105.0443686
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(95.9606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.9427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9412775 KL Loss: 42.5730022 DSM Loss: 60.1796269 Overall Loss:104.6939067
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8122347593307495


Running on file MSFT_pct.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(129.8282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9693764 KL Loss: 42.9873454 DSM Loss: 68.9502516 Overall Loss:113.9069732
Validation loss decreased (inf --> 1.032955).  Saving model ...
Updating learning rate to 0.0005
tensor(88.2954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9543476 KL Loss: 42.5495088 DSM Loss: 58.9255801 Overall Loss:103.4294365
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(177.7114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.7072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9349211 KL Loss: 42.6123730 DSM Loss: 58.6670086 Overall Loss:103.2143023
Validation loss decreased (1.032955 --> 1.030228).  Saving model ...
Updating learning rate to 0.000125
tensor(93.2203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(142.0207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9537435 KL Loss: 42.6745318 DSM Loss: 58.1419770 Overall Loss:102.7702518
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(107.0378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.9223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9504591 KL Loss: 42.4590309 DSM Loss: 57.5076790 Overall Loss:101.9171693
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.2235515117645264


Running on file NEE_pct.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(204.8138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(148.7827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9607036 KL Loss: 42.9589968 DSM Loss: 75.4732775 Overall Loss:120.3929783
Validation loss decreased (inf --> 1.371579).  Saving model ...
Updating learning rate to 0.0005
tensor(115.1248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.8021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9644521 KL Loss: 42.4822710 DSM Loss: 61.4818650 Overall Loss:105.9285875
Validation loss decreased (1.371579 --> 1.369668).  Saving model ...
Updating learning rate to 0.00025
tensor(127.4071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(210.5572, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9417924 KL Loss: 42.3642177 DSM Loss: 59.9038580 Overall Loss:104.2098685
Validation loss decreased (1.369668 --> 1.369668).  Saving model ...
Updating learning rate to 0.000125
tensor(89.3177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(144.9091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9441097 KL Loss: 42.3928947 DSM Loss: 59.9650136 Overall Loss:104.3020184
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(66.2697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(116.5351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9525746 KL Loss: 42.5272731 DSM Loss: 60.1222644 Overall Loss:104.6021121
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.4652656316757202


Running on file NGG_pct.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(158.7831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.4277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0363218 KL Loss: 43.2675286 DSM Loss: 68.5855625 Overall Loss:113.8894133
Validation loss decreased (inf --> 0.523386).  Saving model ...
Updating learning rate to 0.0005
tensor(145.9618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.3660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9853402 KL Loss: 42.6609773 DSM Loss: 62.3447414 Overall Loss:106.9910582
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(115.9817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9743064 KL Loss: 42.9222207 DSM Loss: 60.6561112 Overall Loss:105.5526383
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.9903882145881653


Running on file NVS_pct.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(156.6875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(139.8351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9280118 KL Loss: 42.7341925 DSM Loss: 74.6851910 Overall Loss:119.3473955
Validation loss decreased (inf --> 0.754155).  Saving model ...
Updating learning rate to 0.0005
tensor(90.4874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.0081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9384415 KL Loss: 42.5769645 DSM Loss: 58.5797515 Overall Loss:103.0951570
Validation loss decreased (0.754155 --> 0.743893).  Saving model ...
Updating learning rate to 0.00025
tensor(108.7457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.0484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9437229 KL Loss: 42.7171254 DSM Loss: 57.6714455 Overall Loss:102.3322942
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(113.8661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(130.6489, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9446708 KL Loss: 42.5731747 DSM Loss: 57.5377088 Overall Loss:102.0555544
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.9542689919471741


Running on file ORCL_pct.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(172.6769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.1416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8990584 KL Loss: 42.7268821 DSM Loss: 75.2488934 Overall Loss:119.8748337
Validation loss decreased (inf --> 1.708185).  Saving model ...
Updating learning rate to 0.0005
tensor(110.4197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.5738, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9597280 KL Loss: 42.8322440 DSM Loss: 58.6400660 Overall Loss:103.4320379
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(159.4854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(136.7798, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9597884 KL Loss: 42.7747028 DSM Loss: 57.7069172 Overall Loss:102.4414085
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.2139792442321777


Running on file PCG_pct.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(148.4480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.2268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9879611 KL Loss: 43.2948363 DSM Loss: 67.2801433 Overall Loss:112.5629407
Validation loss decreased (inf --> 0.201081).  Saving model ...
Updating learning rate to 0.0005
tensor(122.0723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(134.7763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0301557 KL Loss: 43.3505859 DSM Loss: 61.3830464 Overall Loss:106.7637887
Validation loss decreased (0.201081 --> 0.199931).  Saving model ...
Updating learning rate to 0.00025
tensor(166.5167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(131.8575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9711620 KL Loss: 42.7977646 DSM Loss: 62.1352213 Overall Loss:106.9041479
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(119.7345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(117.5617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9737522 KL Loss: 43.0988369 DSM Loss: 62.1932913 Overall Loss:107.2658804
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.11466534435749054


Running on file PEP_pct.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(127.6560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(155.8006, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9019645 KL Loss: 42.0850387 DSM Loss: 72.3099960 Overall Loss:116.2969989
Validation loss decreased (inf --> 0.614454).  Saving model ...
Updating learning rate to 0.0005
tensor(117.8298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.8539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9739792 KL Loss: 42.7358424 DSM Loss: 61.3185348 Overall Loss:106.0283567
Validation loss decreased (0.614454 --> 0.606879).  Saving model ...
Updating learning rate to 0.00025
tensor(96.6402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.1253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9825396 KL Loss: 42.5625161 DSM Loss: 59.9004053 Overall Loss:104.4454612
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(157.7239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8560, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9480930 KL Loss: 42.3405558 DSM Loss: 60.8573629 Overall Loss:105.1460115
Validation loss decreased (0.606879 --> 0.606681).  Saving model ...
Updating learning rate to 6.25e-05
tensor(75.6556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9420336 KL Loss: 42.5324711 DSM Loss: 60.7053171 Overall Loss:105.1798214
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(108.8995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.6674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9589984 KL Loss: 42.4400079 DSM Loss: 57.9411599 Overall Loss:102.3401661
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6486235857009888


Running on file PFE_pct.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(170.5779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.0024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9767237 KL Loss: 43.0142250 DSM Loss: 70.3774226 Overall Loss:115.3683708
Validation loss decreased (inf --> 2.512966).  Saving model ...
Updating learning rate to 0.0005
tensor(98.1379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.8152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9831423 KL Loss: 42.7924177 DSM Loss: 58.5273058 Overall Loss:103.3028656
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(103.6407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.1636, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9560669 KL Loss: 42.5854557 DSM Loss: 58.8220337 Overall Loss:103.3635564
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.0983198881149292


Running on file PG_pct.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(151.6449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.2989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9275964 KL Loss: 42.7908842 DSM Loss: 69.2916779 Overall Loss:114.0101580
Validation loss decreased (inf --> 0.794767).  Saving model ...
Updating learning rate to 0.0005
tensor(79.9219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.4448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9552607 KL Loss: 42.8521786 DSM Loss: 60.0077009 Overall Loss:104.8151402
Validation loss decreased (0.794767 --> 0.793256).  Saving model ...
Updating learning rate to 0.00025
tensor(154.4571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9601379 KL Loss: 42.7472063 DSM Loss: 60.5258356 Overall Loss:105.2331800
Validation loss decreased (0.793256 --> 0.792569).  Saving model ...
Updating learning rate to 0.000125
tensor(112.8854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.3618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9307966 KL Loss: 42.4961359 DSM Loss: 59.4838486 Overall Loss:103.9107818
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(70.9794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.8239, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9566166 KL Loss: 42.6822949 DSM Loss: 58.4438154 Overall Loss:103.0827272
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7310184240341187


Running on file PM_pct.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(115.7595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.5222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0275532 KL Loss: 43.0189342 DSM Loss: 72.9835649 Overall Loss:118.0300524
Validation loss decreased (inf --> 0.793668).  Saving model ...
Updating learning rate to 0.0005
tensor(120.0279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9763869 KL Loss: 42.8848305 DSM Loss: 62.1246140 Overall Loss:106.9858314
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(109.3902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.2199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0359293 KL Loss: 43.2272162 DSM Loss: 60.0998578 Overall Loss:105.3630028
Validation loss decreased (0.793668 --> 0.792919).  Saving model ...
Updating learning rate to 0.000125
tensor(125.0867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(128.5627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 2.0014578 KL Loss: 43.0808815 DSM Loss: 59.9853597 Overall Loss:105.0676994
Validation loss decreased (0.792919 --> 0.792912).  Saving model ...
Updating learning rate to 6.25e-05
tensor(116.7162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.5473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9947771 KL Loss: 42.7418820 DSM Loss: 59.9068635 Overall Loss:104.6435227
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(106.6264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.1206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9569990 KL Loss: 42.7577933 DSM Loss: 59.9130466 Overall Loss:104.6278393
Validation loss decreased (0.792912 --> 0.792721).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(131.6240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.9083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9902763 KL Loss: 42.9346401 DSM Loss: 60.0500669 Overall Loss:104.9749833
Validation loss decreased (0.792721 --> 0.792676).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(140.6502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.6484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9851243 KL Loss: 42.8350961 DSM Loss: 59.8279690 Overall Loss:104.6481892
Validation loss decreased (0.792676 --> 0.792637).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(115.6577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.4649, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 80 | MSE Loss: 1.9779829 KL Loss: 42.7916390 DSM Loss: 59.8622243 Overall Loss:104.6318462
Validation loss decreased (0.792637 --> 0.792617).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(132.7480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.8177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 80 | MSE Loss: 1.9718760 KL Loss: 42.6878141 DSM Loss: 60.6664531 Overall Loss:105.3261434
EarlyStopping counter: 1 out of 2
Updating learning rate to 9.765625e-07
tensor(92.0961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.7342, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 80 | MSE Loss: 1.9380707 KL Loss: 42.2791058 DSM Loss: 61.2826698 Overall Loss:105.4998460
Validation loss decreased (0.792617 --> 0.792571).  Saving model ...
Updating learning rate to 4.8828125e-07
tensor(136.8607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(125.0552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 80 | MSE Loss: 1.9508099 KL Loss: 42.5289116 DSM Loss: 60.6404272 Overall Loss:105.1201483
EarlyStopping counter: 1 out of 2
Updating learning rate to 2.44140625e-07
tensor(129.2847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(129.5191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 80 | MSE Loss: 1.9811560 KL Loss: 42.6464880 DSM Loss: 59.9736731 Overall Loss:104.6013173
Validation loss decreased (0.792571 --> 0.792543).  Saving model ...
Updating learning rate to 1.220703125e-07
tensor(107.3162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(138.5263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 80 | MSE Loss: 1.9616055 KL Loss: 42.4496047 DSM Loss: 60.3148595 Overall Loss:104.7260696
Validation loss decreased (0.792543 --> 0.792532).  Saving model ...
Updating learning rate to 6.103515625e-08
tensor(92.6940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.0641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 80 | MSE Loss: 1.9587980 KL Loss: 42.5452016 DSM Loss: 60.4219708 Overall Loss:104.9259709
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.0517578125e-08
tensor(130.6047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.5684, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 80 | MSE Loss: 1.9670401 KL Loss: 42.8043373 DSM Loss: 59.7786623 Overall Loss:104.5500401
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5646634101867676


Running on file PPL_pct.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(186.6087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0294676 KL Loss: 43.0702155 DSM Loss: 70.6243138 Overall Loss:115.7239970
Validation loss decreased (inf --> 0.465366).  Saving model ...
Updating learning rate to 0.0005
tensor(86.9993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.6739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9796684 KL Loss: 42.5354709 DSM Loss: 61.9391281 Overall Loss:106.4542668
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(164.9386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.8933, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0010893 KL Loss: 42.7815053 DSM Loss: 60.1949346 Overall Loss:104.9775290
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.682317316532135


Running on file REX_pct.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(148.2460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(132.8192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9808082 KL Loss: 43.1384228 DSM Loss: 70.7015011 Overall Loss:115.8207319
Validation loss decreased (inf --> 1.047696).  Saving model ...
Updating learning rate to 0.0005
tensor(87.8853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.3112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9885066 KL Loss: 42.9525377 DSM Loss: 60.4850666 Overall Loss:105.4261108
Validation loss decreased (1.047696 --> 1.033333).  Saving model ...
Updating learning rate to 0.00025
tensor(114.1638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9143340 KL Loss: 42.2898190 DSM Loss: 60.1001394 Overall Loss:104.3042931
Validation loss decreased (1.033333 --> 1.032959).  Saving model ...
Updating learning rate to 0.000125
tensor(188.6636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.7475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9495257 KL Loss: 42.6892509 DSM Loss: 58.1474833 Overall Loss:102.7862598
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(168.2455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.4367, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9720382 KL Loss: 42.8383770 DSM Loss: 57.6166259 Overall Loss:102.4270413
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.8896885514259338


Running on file SLB_pct.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(196.7940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(117.3303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9692784 KL Loss: 42.9077166 DSM Loss: 89.6416930 Overall Loss:134.5186877
Validation loss decreased (inf --> 0.971101).  Saving model ...
Updating learning rate to 0.0005
tensor(108.5178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.6199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9934195 KL Loss: 42.7219629 DSM Loss: 60.6377849 Overall Loss:105.3531670
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(99.0628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.3841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9411556 KL Loss: 42.3936765 DSM Loss: 59.9334549 Overall Loss:104.2682863
Validation loss decreased (0.971101 --> 0.965200).  Saving model ...
Updating learning rate to 0.000125
tensor(116.9670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.4432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9517412 KL Loss: 42.2103852 DSM Loss: 60.0066011 Overall Loss:104.1687275
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(102.6133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.0616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9869706 KL Loss: 42.5939474 DSM Loss: 57.6196053 Overall Loss:102.2005234
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.9001458287239075


Running on file SNY_pct.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(142.1311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.5228, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9587236 KL Loss: 42.9088223 DSM Loss: 70.9095144 Overall Loss:115.7770604
Validation loss decreased (inf --> 0.861658).  Saving model ...
Updating learning rate to 0.0005
tensor(116.5751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.1140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9761111 KL Loss: 42.7763590 DSM Loss: 57.2133060 Overall Loss:101.9657763
Validation loss decreased (0.861658 --> 0.859407).  Saving model ...
Updating learning rate to 0.00025
tensor(94.8850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.6439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9250392 KL Loss: 42.4669385 DSM Loss: 57.4314148 Overall Loss:101.8233925
Validation loss decreased (0.859407 --> 0.856855).  Saving model ...
Updating learning rate to 0.000125
tensor(101.8314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(102.6076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9492699 KL Loss: 42.5570592 DSM Loss: 56.9500114 Overall Loss:101.4563407
Validation loss decreased (0.856855 --> 0.856426).  Saving model ...
Updating learning rate to 6.25e-05
tensor(111.7915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.7783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9572548 KL Loss: 42.6510210 DSM Loss: 56.6938076 Overall Loss:101.3020834
Validation loss decreased (0.856426 --> 0.856340).  Saving model ...
Updating learning rate to 3.125e-05
tensor(103.6791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.6062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9418371 KL Loss: 42.4738376 DSM Loss: 56.5133891 Overall Loss:100.9290642
Validation loss decreased (0.856340 --> 0.856223).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(96.2134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.0176, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9478007 KL Loss: 42.7251918 DSM Loss: 55.8360856 Overall Loss:100.5090773
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(141.7141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.3804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9435167 KL Loss: 42.3399970 DSM Loss: 56.4659096 Overall Loss:100.7494234
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.4634872674942017


Running on file SO_pct.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(179.5221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(130.3090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9464220 KL Loss: 42.6838515 DSM Loss: 85.4450862 Overall Loss:130.0753600
Validation loss decreased (inf --> 0.521199).  Saving model ...
Updating learning rate to 0.0005
tensor(127.4172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9700904 KL Loss: 42.7997793 DSM Loss: 61.2683970 Overall Loss:106.0382670
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(74.7012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.9147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0417912 KL Loss: 42.6744078 DSM Loss: 58.1303457 Overall Loss:102.8465455
Validation loss decreased (0.521199 --> 0.520818).  Saving model ...
Updating learning rate to 0.000125
tensor(69.3464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.5981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9948849 KL Loss: 42.5660565 DSM Loss: 60.6076800 Overall Loss:105.1686216
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(71.6873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9398666 KL Loss: 42.1965735 DSM Loss: 61.0656240 Overall Loss:105.2020639
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7746526002883911


Running on file SPLP_pct.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(169.9456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0197716 KL Loss: 42.8447759 DSM Loss: 71.2617259 Overall Loss:116.1262735
Validation loss decreased (inf --> 1.141920).  Saving model ...
Updating learning rate to 0.0005
tensor(80.3970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.6713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9747613 KL Loss: 42.3081638 DSM Loss: 60.9838404 Overall Loss:105.2667660
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(81.7609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9828850 KL Loss: 42.3408039 DSM Loss: 59.6433588 Overall Loss:103.9670476
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5836004018783569


Running on file SRE_pct.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(141.9929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.7455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9327779 KL Loss: 42.9119652 DSM Loss: 80.0096346 Overall Loss:124.8543779
Validation loss decreased (inf --> 0.574043).  Saving model ...
Updating learning rate to 0.0005
tensor(78.5903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(186.0240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9698617 KL Loss: 43.0622190 DSM Loss: 60.1366929 Overall Loss:105.1687736
Validation loss decreased (0.574043 --> 0.563186).  Saving model ...
Updating learning rate to 0.00025
tensor(109.2490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9994413 KL Loss: 42.8088256 DSM Loss: 59.2170294 Overall Loss:104.0252962
Validation loss decreased (0.563186 --> 0.561984).  Saving model ...
Updating learning rate to 0.000125
tensor(104.5413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9749701 KL Loss: 42.4556414 DSM Loss: 58.4219011 Overall Loss:102.8525126
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(75.8685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.9103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9469671 KL Loss: 42.3451188 DSM Loss: 59.4498935 Overall Loss:103.7419796
Validation loss decreased (0.561984 --> 0.561563).  Saving model ...
Updating learning rate to 3.125e-05
tensor(94.0120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.1180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9291845 KL Loss: 42.3634884 DSM Loss: 58.6663537 Overall Loss:102.9590267
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(113.2955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9322866 KL Loss: 42.1415221 DSM Loss: 59.0239233 Overall Loss:103.0977323
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6916695237159729


Running on file TM_pct.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(139.3443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.2994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9981474 KL Loss: 42.9232207 DSM Loss: 66.8129058 Overall Loss:111.7342739
Validation loss decreased (inf --> 1.842786).  Saving model ...
Updating learning rate to 0.0005
tensor(109.9975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.1030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9234037 KL Loss: 42.2568565 DSM Loss: 55.4795217 Overall Loss:99.6597822
Validation loss decreased (1.842786 --> 1.839945).  Saving model ...
Updating learning rate to 0.00025
tensor(92.2325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.8155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9472403 KL Loss: 42.4870279 DSM Loss: 54.3515018 Overall Loss:98.7857704
Validation loss decreased (1.839945 --> 1.838432).  Saving model ...
Updating learning rate to 0.000125
tensor(98.8171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(125.3089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9622358 KL Loss: 42.3912040 DSM Loss: 54.2699997 Overall Loss:98.6234392
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(84.9372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.1963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9411977 KL Loss: 42.2673324 DSM Loss: 54.8738384 Overall Loss:99.0823685
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.2526954412460327


Running on file TSM_pct.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(171.3803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.5308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0152749 KL Loss: 42.5796860 DSM Loss: 69.4100528 Overall Loss:114.0050134
Validation loss decreased (inf --> 1.352025).  Saving model ...
Updating learning rate to 0.0005
tensor(97.3476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.3670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9445319 KL Loss: 42.4038245 DSM Loss: 60.0995236 Overall Loss:104.4478799
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(109.7604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.5573, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9625363 KL Loss: 42.4534857 DSM Loss: 59.2200078 Overall Loss:103.6360296
Validation loss decreased (1.352025 --> 1.346885).  Saving model ...
Updating learning rate to 0.000125
tensor(90.2787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9777630 KL Loss: 42.6694621 DSM Loss: 57.4867184 Overall Loss:102.1339435
Validation loss decreased (1.346885 --> 1.344345).  Saving model ...
Updating learning rate to 6.25e-05
tensor(117.3074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.6993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9728481 KL Loss: 42.3938186 DSM Loss: 57.2423617 Overall Loss:101.6090284
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(103.2423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.3788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9635814 KL Loss: 42.6162456 DSM Loss: 58.0454804 Overall Loss:102.6253077
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.3397674560546875


Running on file T_pct.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : T_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(157.9687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.6422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0119201 KL Loss: 43.0538698 DSM Loss: 81.2944230 Overall Loss:126.3602132
Validation loss decreased (inf --> 1.453663).  Saving model ...
Updating learning rate to 0.0005
tensor(136.1128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(101.4970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0095250 KL Loss: 42.8049401 DSM Loss: 61.6235891 Overall Loss:106.4380548
Validation loss decreased (1.453663 --> 1.449676).  Saving model ...
Updating learning rate to 0.00025
tensor(108.9372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(145.3735, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9685507 KL Loss: 42.6474634 DSM Loss: 61.8506426 Overall Loss:106.4666571
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(89.5462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.1196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9426380 KL Loss: 42.4531690 DSM Loss: 60.3009439 Overall Loss:104.6967506
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.4478514194488525


Running on file UL_pct.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(188.8752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.1751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9630724 KL Loss: 42.7764172 DSM Loss: 70.5464736 Overall Loss:115.2859635
Validation loss decreased (inf --> 2.108375).  Saving model ...
Updating learning rate to 0.0005
tensor(103.3062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.4877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9737112 KL Loss: 42.8827431 DSM Loss: 57.9923097 Overall Loss:102.8487647
Validation loss decreased (2.108375 --> 2.103555).  Saving model ...
Updating learning rate to 0.00025
tensor(115.8119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.8369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9531314 KL Loss: 42.5345789 DSM Loss: 59.6555439 Overall Loss:104.1432539
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(108.7215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.5783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9785763 KL Loss: 42.8514205 DSM Loss: 58.2244064 Overall Loss:103.0544024
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.5575219988822937


Running on file UNH_pct.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(165.3382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(140.4764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9561836 KL Loss: 42.8185238 DSM Loss: 71.7100400 Overall Loss:116.4847477
Validation loss decreased (inf --> 0.640979).  Saving model ...
Updating learning rate to 0.0005
tensor(121.3084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9623032 KL Loss: 42.6677912 DSM Loss: 61.4235597 Overall Loss:106.0536545
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(78.3726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(149.4131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9654083 KL Loss: 42.7271210 DSM Loss: 59.0453057 Overall Loss:103.7378351
Validation loss decreased (0.640979 --> 0.639788).  Saving model ...
Updating learning rate to 0.000125
tensor(81.6642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(138.5088, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9757154 KL Loss: 42.6021255 DSM Loss: 59.4493380 Overall Loss:104.0271793
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(81.8408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(144.1477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9890843 KL Loss: 42.5620372 DSM Loss: 59.7417471 Overall Loss:104.2928688
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6571095585823059


Running on file UPS_pct.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(185.1697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.5014, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9795458 KL Loss: 42.8804777 DSM Loss: 74.7704018 Overall Loss:119.6304250
Validation loss decreased (inf --> 1.479605).  Saving model ...
Updating learning rate to 0.0005
tensor(114.2438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9746821 KL Loss: 42.6790139 DSM Loss: 62.2224509 Overall Loss:106.8761469
Validation loss decreased (1.479605 --> 1.478344).  Saving model ...
Updating learning rate to 0.00025
tensor(104.5841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.5434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9503023 KL Loss: 42.5410117 DSM Loss: 61.3334831 Overall Loss:105.8247965
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(86.1426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(120.1844, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9956066 KL Loss: 42.9463253 DSM Loss: 59.1349095 Overall Loss:104.0768411
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.9753300547599792


Running on file VZ_pct.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(152.9348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.6487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9624776 KL Loss: 42.8619698 DSM Loss: 67.8256041 Overall Loss:112.6500516
Validation loss decreased (inf --> 0.820436).  Saving model ...
Updating learning rate to 0.0005
tensor(107.4496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.8914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9568666 KL Loss: 42.6317183 DSM Loss: 59.2815331 Overall Loss:103.8701177
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(116.0956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.6506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9518250 KL Loss: 42.7338899 DSM Loss: 59.4544452 Overall Loss:104.1401607
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.5680683851242065


Running on file V_pct.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : V_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(139.6887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.8644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9507857 KL Loss: 42.7699065 DSM Loss: 78.3163291 Overall Loss:123.0370207
Validation loss decreased (inf --> 1.560460).  Saving model ...
Updating learning rate to 0.0005
tensor(116.3790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(104.9908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9555364 KL Loss: 42.5204063 DSM Loss: 58.6907008 Overall Loss:103.1666438
Validation loss decreased (1.560460 --> 1.556696).  Saving model ...
Updating learning rate to 0.00025
tensor(92.6003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.5993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9409057 KL Loss: 42.5074830 DSM Loss: 59.2933558 Overall Loss:103.7417443
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(131.7967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(113.9234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 2.0009175 KL Loss: 42.8367228 DSM Loss: 57.4722703 Overall Loss:102.3099110
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.6198083758354187


Running on file WFC_pct.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(172.8962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9633728 KL Loss: 42.8349072 DSM Loss: 67.5873282 Overall Loss:112.3856084
Validation loss decreased (inf --> 1.043199).  Saving model ...
Updating learning rate to 0.0005
tensor(86.8679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.8823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0187184 KL Loss: 42.8977752 DSM Loss: 60.5582606 Overall Loss:105.4747545
Validation loss decreased (1.043199 --> 1.039922).  Saving model ...
Updating learning rate to 0.00025
tensor(93.2055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(169.4900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9520924 KL Loss: 42.8647320 DSM Loss: 59.1132418 Overall Loss:103.9300662
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(126.0453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.1459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9540137 KL Loss: 42.6057499 DSM Loss: 58.9837601 Overall Loss:103.5435236
Validation loss decreased (1.039922 --> 1.039724).  Saving model ...
Updating learning rate to 6.25e-05
tensor(128.3585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.4180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9690770 KL Loss: 42.8664340 DSM Loss: 57.5052309 Overall Loss:102.3407414
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(104.6263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.1564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9620154 KL Loss: 42.5384596 DSM Loss: 59.0432319 Overall Loss:103.5437072
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7253432273864746


Running on file WMT_pct.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(191.2376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.1466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0324678 KL Loss: 42.9546093 DSM Loss: 68.3610740 Overall Loss:113.3481506
Validation loss decreased (inf --> 0.673345).  Saving model ...
Updating learning rate to 0.0005
tensor(110.6606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.6645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0029310 KL Loss: 42.8478179 DSM Loss: 58.5375419 Overall Loss:103.3882908
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(108.2189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.5866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0242944 KL Loss: 42.9667981 DSM Loss: 57.7631252 Overall Loss:102.7542176
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.7527071237564087


Running on file XOM_pct.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1288
val 142
test 343
tensor(137.1224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.4217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9301914 KL Loss: 42.6636237 DSM Loss: 68.9418560 Overall Loss:113.5356709
Validation loss decreased (inf --> 1.054857).  Saving model ...
Updating learning rate to 0.0005
tensor(113.0861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.2894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0079753 KL Loss: 43.0694297 DSM Loss: 59.2229719 Overall Loss:104.3003765
Validation loss decreased (1.054857 --> 1.048158).  Saving model ...
Updating learning rate to 0.00025
tensor(115.8623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.1469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9836040 KL Loss: 42.7133739 DSM Loss: 59.1502848 Overall Loss:103.8472635
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(97.4253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.5042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 2.0042734 KL Loss: 42.8259932 DSM Loss: 59.0379333 Overall Loss:103.8681998
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM_pct.csv_tpEcmP_stock_L_2016_24_mix_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.977069079875946
      Ticker       MSE StdDev
0   AAPL_pct   0.86246    0.0
1   ABBV_pct  0.561948    0.0
2    AEP_pct  1.130919    0.0
3   AMGN_pct   0.70861    0.0
4   AMZN_pct  1.748053    0.0
..       ...       ...    ...
66    VZ_pct  1.568068    0.0
67     V_pct  0.619808    0.0
68   WFC_pct  0.725343    0.0
69   WMT_pct  0.752707    0.0
70   XOM_pct  0.977069    0.0

[71 rows x 3 columns]
