Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=40, root_path='data/EcmP_stock_L_2016_24_dva_spec', scale=0.1, sequence_length=40, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(100.9390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9550971 KL Loss: 27.9846344 DSM Loss: 45.5606636 Overall Loss:75.5003951
Validation loss decreased (inf --> 11.210291).  Saving model ...
Updating learning rate to 0.0005
tensor(53.5880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9822005 KL Loss: 27.8081372 DSM Loss: 36.9520957 Overall Loss:66.7424334
Validation loss decreased (11.210291 --> 9.170724).  Saving model ...
Updating learning rate to 0.00025
tensor(53.6907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9479264 KL Loss: 27.5551854 DSM Loss: 36.2097397 Overall Loss:65.7128513
Validation loss decreased (9.170724 --> 8.988802).  Saving model ...
Updating learning rate to 0.000125
tensor(71.6276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9415904 KL Loss: 27.5127236 DSM Loss: 36.4080698 Overall Loss:65.8623835
Validation loss decreased (8.988802 --> 8.243825).  Saving model ...
Updating learning rate to 6.25e-05
tensor(66.5502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0928978 KL Loss: 28.0009444 DSM Loss: 34.8059214 Overall Loss:64.8997637
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(82.5586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.3064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9545108 KL Loss: 27.8410052 DSM Loss: 35.7514393 Overall Loss:65.5469554
Validation loss decreased (8.243825 --> 8.094823).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(66.4652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.0588472 KL Loss: 27.7993244 DSM Loss: 34.9429444 Overall Loss:64.8011163
Validation loss decreased (8.094823 --> 8.004089).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(77.9722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.0787023 KL Loss: 27.9896310 DSM Loss: 34.8774295 Overall Loss:64.9457630
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(55.3296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1494, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 2.0613463 KL Loss: 28.2178744 DSM Loss: 35.2582571 Overall Loss:65.5374776
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.474237442016602


Running on file ABBV.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(104.1442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9721500 KL Loss: 28.4156871 DSM Loss: 45.6448511 Overall Loss:76.0326886
Validation loss decreased (inf --> 10.074069).  Saving model ...
Updating learning rate to 0.0005
tensor(71.6941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9190026 KL Loss: 28.1211569 DSM Loss: 35.5383281 Overall Loss:65.5784877
Validation loss decreased (10.074069 --> 9.613750).  Saving model ...
Updating learning rate to 0.00025
tensor(65.7497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9154108 KL Loss: 28.0441191 DSM Loss: 33.8200862 Overall Loss:63.7796159
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(75.6931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.2554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9296378 KL Loss: 28.3229579 DSM Loss: 33.8956345 Overall Loss:64.1482304
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:17.354047775268555


Running on file AEP.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(107.9940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9822, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0007627 KL Loss: 28.5424517 DSM Loss: 44.2353567 Overall Loss:74.7785711
Validation loss decreased (inf --> 2.176885).  Saving model ...
Updating learning rate to 0.0005
tensor(70.0257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9496578 KL Loss: 28.2323399 DSM Loss: 37.3618421 Overall Loss:67.5438396
Validation loss decreased (2.176885 --> 1.763840).  Saving model ...
Updating learning rate to 0.00025
tensor(69.1737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9208142 KL Loss: 28.1615859 DSM Loss: 36.5884218 Overall Loss:66.6708216
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(69.0003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8902372 KL Loss: 28.0403865 DSM Loss: 35.2903942 Overall Loss:65.2210178
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.6422176361083984


Running on file AMGN.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(105.1948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8973961 KL Loss: 28.1595779 DSM Loss: 53.9394971 Overall Loss:83.9964712
Validation loss decreased (inf --> 1.116414).  Saving model ...
Updating learning rate to 0.0005
tensor(57.1571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.1188464 KL Loss: 28.9617455 DSM Loss: 37.1854905 Overall Loss:68.2660824
Validation loss decreased (1.116414 --> 0.829814).  Saving model ...
Updating learning rate to 0.00025
tensor(65.2113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 2.2787358 KL Loss: 29.2996456 DSM Loss: 36.5269522 Overall Loss:68.1053336
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(63.4084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.2153688 KL Loss: 29.1351993 DSM Loss: 35.1283939 Overall Loss:66.4789615
Validation loss decreased (0.829814 --> 0.814430).  Saving model ...
Updating learning rate to 6.25e-05
tensor(69.7003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.3634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.1169846 KL Loss: 28.8316732 DSM Loss: 35.8489237 Overall Loss:66.7975815
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(61.5215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.2393430 KL Loss: 29.2518861 DSM Loss: 34.4414859 Overall Loss:65.9327152
Validation loss decreased (0.814430 --> 0.717991).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(75.2909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3388, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.2062440 KL Loss: 28.9943545 DSM Loss: 35.0050127 Overall Loss:66.2056107
Validation loss decreased (0.717991 --> 0.635826).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(67.9485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.2932743 KL Loss: 29.2555231 DSM Loss: 34.3965257 Overall Loss:65.9453228
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(74.3515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 2.1828061 KL Loss: 28.9818343 DSM Loss: 34.7075548 Overall Loss:65.8721949
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.129077672958374


Running on file AMZN.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(112.9965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9429098 KL Loss: 28.0416249 DSM Loss: 45.0932328 Overall Loss:75.0777674
Validation loss decreased (inf --> 2.135737).  Saving model ...
Updating learning rate to 0.0005
tensor(59.0941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9341713 KL Loss: 27.8757821 DSM Loss: 36.4563782 Overall Loss:66.2663313
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(90.4174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.4533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9081902 KL Loss: 27.6206106 DSM Loss: 35.2801376 Overall Loss:64.8089388
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.3326314687728882


Running on file BA.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(101.6714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9457699 KL Loss: 28.1681329 DSM Loss: 45.8954128 Overall Loss:76.0093152
Validation loss decreased (inf --> 0.184932).  Saving model ...
Updating learning rate to 0.0005
tensor(63.6856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9148771 KL Loss: 28.0573345 DSM Loss: 38.5477297 Overall Loss:68.5199411
Validation loss decreased (0.184932 --> 0.124571).  Saving model ...
Updating learning rate to 0.00025
tensor(65.7240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0573, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9287111 KL Loss: 27.9061717 DSM Loss: 37.1634496 Overall Loss:66.9983322
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(71.7630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8681704 KL Loss: 27.7991592 DSM Loss: 36.6072717 Overall Loss:66.2746014
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.27520692348480225


Running on file BAC.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(100.1590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.8498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.7689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9721298 KL Loss: 28.2804992 DSM Loss: 41.6663496 Overall Loss:71.9189783
Validation loss decreased (inf --> 7.110752).  Saving model ...
Updating learning rate to 0.0005
tensor(70.9120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.2187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9336093 KL Loss: 28.0374426 DSM Loss: 34.6545853 Overall Loss:64.6256372
Validation loss decreased (7.110752 --> 6.325104).  Saving model ...
Updating learning rate to 0.00025
tensor(67.0890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.6227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9163008 KL Loss: 28.0447754 DSM Loss: 34.2530778 Overall Loss:64.2141542
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(72.0713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8957603 KL Loss: 27.9317088 DSM Loss: 32.9119105 Overall Loss:62.7393799
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7946996092796326


Running on file BCH.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(109.5576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9193, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9616481 KL Loss: 28.3318398 DSM Loss: 45.1904657 Overall Loss:75.4839538
Validation loss decreased (inf --> 0.916410).  Saving model ...
Updating learning rate to 0.0005
tensor(63.9363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1500, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0200226 KL Loss: 28.4201420 DSM Loss: 39.2232700 Overall Loss:69.6634345
Validation loss decreased (0.916410 --> 0.772314).  Saving model ...
Updating learning rate to 0.00025
tensor(73.6622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9345104 KL Loss: 28.3465166 DSM Loss: 37.5381948 Overall Loss:67.8192215
Validation loss decreased (0.772314 --> 0.748684).  Saving model ...
Updating learning rate to 0.000125
tensor(66.0630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.3422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9354329 KL Loss: 28.2664464 DSM Loss: 37.0949304 Overall Loss:67.2968097
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(72.6141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9047909 KL Loss: 28.2883645 DSM Loss: 36.6018342 Overall Loss:66.7949897
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.26449087262153625


Running on file BHP.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(86.1374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9215312 KL Loss: 28.3493586 DSM Loss: 42.1012215 Overall Loss:72.3721112
Validation loss decreased (inf --> 2.093519).  Saving model ...
Updating learning rate to 0.0005
tensor(77.2282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9066973 KL Loss: 28.3644710 DSM Loss: 35.2656781 Overall Loss:65.5368463
Validation loss decreased (2.093519 --> 1.807178).  Saving model ...
Updating learning rate to 0.00025
tensor(55.6980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9202569 KL Loss: 28.1348706 DSM Loss: 32.7584654 Overall Loss:62.8135933
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(76.4286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4530, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8899073 KL Loss: 27.8893784 DSM Loss: 33.4066136 Overall Loss:63.1858993
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.1080565452575684


Running on file BP.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(89.9700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9007057 KL Loss: 28.3185543 DSM Loss: 44.2156134 Overall Loss:74.4348733
Validation loss decreased (inf --> 0.208360).  Saving model ...
Updating learning rate to 0.0005
tensor(71.6219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1344, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8950459 KL Loss: 28.1734289 DSM Loss: 38.8481304 Overall Loss:68.9166055
Validation loss decreased (0.208360 --> 0.174281).  Saving model ...
Updating learning rate to 0.00025
tensor(72.2751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9123221 KL Loss: 28.3276936 DSM Loss: 37.8665996 Overall Loss:68.1066150
Validation loss decreased (0.174281 --> 0.148353).  Saving model ...
Updating learning rate to 0.000125
tensor(65.5512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9092624 KL Loss: 28.1979494 DSM Loss: 37.4399964 Overall Loss:67.5472082
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(83.1475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.0594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9399894 KL Loss: 28.4819643 DSM Loss: 37.3224107 Overall Loss:67.7443646
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.358887195587158


Running on file BRK-A.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(72.2629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9110528 KL Loss: 28.4422112 DSM Loss: 39.2128920 Overall Loss:69.5661556
Validation loss decreased (inf --> 11.327313).  Saving model ...
Updating learning rate to 0.0005
tensor(52.1922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.8989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.6317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8822192 KL Loss: 28.1376386 DSM Loss: 33.5632205 Overall Loss:63.5830784
Validation loss decreased (11.327313 --> 9.999482).  Saving model ...
Updating learning rate to 0.00025
tensor(75.2094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0891, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8539768 KL Loss: 28.0135378 DSM Loss: 32.0642485 Overall Loss:61.9317631
Validation loss decreased (9.999482 --> 9.205451).  Saving model ...
Updating learning rate to 0.000125
tensor(74.3322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5375, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8951084 KL Loss: 28.0308120 DSM Loss: 32.2570338 Overall Loss:62.1829545
Validation loss decreased (9.205451 --> 9.011343).  Saving model ...
Updating learning rate to 6.25e-05
tensor(84.4946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8932636 KL Loss: 27.9125355 DSM Loss: 31.7089181 Overall Loss:61.5147169
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(62.1651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.4038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8325710 KL Loss: 27.4622165 DSM Loss: 32.0099353 Overall Loss:61.3047227
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:11.702130317687988


Running on file BSAC.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(111.5038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0015418 KL Loss: 28.5182306 DSM Loss: 44.6291378 Overall Loss:75.1489101
Validation loss decreased (inf --> 0.580844).  Saving model ...
Updating learning rate to 0.0005
tensor(65.2899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4896, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9710485 KL Loss: 28.2798163 DSM Loss: 37.3747296 Overall Loss:67.6255943
Validation loss decreased (0.580844 --> 0.365279).  Saving model ...
Updating learning rate to 0.00025
tensor(73.6896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5595, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9657654 KL Loss: 28.2833095 DSM Loss: 36.6329104 Overall Loss:66.8819853
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(62.2935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9048539 KL Loss: 28.0624466 DSM Loss: 35.9619677 Overall Loss:65.9292683
Validation loss decreased (0.365279 --> 0.309835).  Saving model ...
Updating learning rate to 6.25e-05
tensor(63.8913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9024696 KL Loss: 28.0292051 DSM Loss: 35.2047587 Overall Loss:65.1364336
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(71.4418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8871769 KL Loss: 28.0101644 DSM Loss: 36.1582792 Overall Loss:66.0556206
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5502076148986816


Running on file BUD.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(117.1072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9646969 KL Loss: 28.0649974 DSM Loss: 46.2355921 Overall Loss:76.2652864
Validation loss decreased (inf --> 1.938035).  Saving model ...
Updating learning rate to 0.0005
tensor(65.9912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1587, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0228429 KL Loss: 28.5282612 DSM Loss: 40.1075881 Overall Loss:70.6586920
Validation loss decreased (1.938035 --> 1.816402).  Saving model ...
Updating learning rate to 0.00025
tensor(69.8334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9981686 KL Loss: 28.4314446 DSM Loss: 39.2651844 Overall Loss:69.6947976
Validation loss decreased (1.816402 --> 1.810114).  Saving model ...
Updating learning rate to 0.000125
tensor(60.8275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.0204971 KL Loss: 28.7143062 DSM Loss: 38.6097183 Overall Loss:69.3445218
Validation loss decreased (1.810114 --> 1.722620).  Saving model ...
Updating learning rate to 6.25e-05
tensor(51.7603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0056, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0042796 KL Loss: 28.8198358 DSM Loss: 38.7056139 Overall Loss:69.5297292
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(90.8176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.0222766 KL Loss: 28.8332448 DSM Loss: 38.3064324 Overall Loss:69.1619537
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.094111680984497


Running on file C.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(108.7989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.8293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1898, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9233037 KL Loss: 28.3922247 DSM Loss: 45.4425604 Overall Loss:75.7580888
Validation loss decreased (inf --> 0.734523).  Saving model ...
Updating learning rate to 0.0005
tensor(64.2675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7239, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9424605 KL Loss: 28.2882617 DSM Loss: 35.8115224 Overall Loss:66.0422447
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(58.6934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9138390 KL Loss: 28.1949764 DSM Loss: 34.8713224 Overall Loss:64.9801379
Validation loss decreased (0.734523 --> 0.699006).  Saving model ...
Updating learning rate to 0.000125
tensor(63.9560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9153179 KL Loss: 28.3602153 DSM Loss: 34.2868075 Overall Loss:64.5623405
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(58.9677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9325388 KL Loss: 28.4729057 DSM Loss: 33.8435310 Overall Loss:64.2489758
Validation loss decreased (0.699006 --> 0.647302).  Saving model ...
Updating learning rate to 3.125e-05
tensor(75.1180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3335, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9512941 KL Loss: 28.6035777 DSM Loss: 33.7653149 Overall Loss:64.3201868
Validation loss decreased (0.647302 --> 0.634539).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(70.0720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9558257 KL Loss: 28.4185526 DSM Loss: 33.5569705 Overall Loss:63.9313488
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(65.8931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4860, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9472961 KL Loss: 28.4718757 DSM Loss: 33.7944498 Overall Loss:64.2136215
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7057148218154907


Running on file CAT.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(100.1538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9264021 KL Loss: 28.1965616 DSM Loss: 42.9108600 Overall Loss:73.0338237
Validation loss decreased (inf --> 3.896035).  Saving model ...
Updating learning rate to 0.0005
tensor(93.9167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8843026 KL Loss: 27.7024376 DSM Loss: 35.8171012 Overall Loss:65.4038414
Validation loss decreased (3.896035 --> 3.712533).  Saving model ...
Updating learning rate to 0.00025
tensor(52.3635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9181075 KL Loss: 27.6085744 DSM Loss: 34.8616669 Overall Loss:64.3883485
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(50.9638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9617097 KL Loss: 27.8513438 DSM Loss: 34.0786087 Overall Loss:63.8916622
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.441230773925781


Running on file CHTR.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(76.3137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8820212 KL Loss: 28.0330198 DSM Loss: 41.7129514 Overall Loss:71.6279924
Validation loss decreased (inf --> 2.613462).  Saving model ...
Updating learning rate to 0.0005
tensor(79.1971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8925543 KL Loss: 27.8774264 DSM Loss: 34.8380325 Overall Loss:64.6080130
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(66.7939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8808780 KL Loss: 27.7216461 DSM Loss: 33.8627969 Overall Loss:63.4653209
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.1215057522058487


Running on file CMCSA.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(105.7283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9642752 KL Loss: 28.1818178 DSM Loss: 45.6977649 Overall Loss:75.8438579
Validation loss decreased (inf --> 3.567014).  Saving model ...
Updating learning rate to 0.0005
tensor(66.5918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.1722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9222584 KL Loss: 27.9959983 DSM Loss: 34.8939479 Overall Loss:64.8122046
Validation loss decreased (3.567014 --> 2.751803).  Saving model ...
Updating learning rate to 0.00025
tensor(48.7995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5581, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9238588 KL Loss: 27.9954548 DSM Loss: 32.9586162 Overall Loss:62.8779301
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(67.1142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9200557 KL Loss: 27.9256878 DSM Loss: 33.1287669 Overall Loss:62.9745105
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.43887758255004883


Running on file CODI.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(99.2816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9011407 KL Loss: 28.5361202 DSM Loss: 49.5446429 Overall Loss:79.9819039
Validation loss decreased (inf --> 11.683818).  Saving model ...
Updating learning rate to 0.0005
tensor(57.4164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.6684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8847517 KL Loss: 27.8053490 DSM Loss: 36.3042758 Overall Loss:65.9943764
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(47.6397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6082, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8901709 KL Loss: 27.8166617 DSM Loss: 35.1546556 Overall Loss:64.8614880
Validation loss decreased (11.683818 --> 11.357623).  Saving model ...
Updating learning rate to 0.000125
tensor(49.5024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.2377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8536920 KL Loss: 27.5082643 DSM Loss: 35.4274423 Overall Loss:64.7893987
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(65.7653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8257620 KL Loss: 27.3145050 DSM Loss: 34.6179941 Overall Loss:63.7582608
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.255469799041748


Running on file CSCO.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(106.0482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2769, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9341344 KL Loss: 28.4126498 DSM Loss: 44.4057268 Overall Loss:74.7525109
Validation loss decreased (inf --> 4.386344).  Saving model ...
Updating learning rate to 0.0005
tensor(69.3715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9662089 KL Loss: 28.3465027 DSM Loss: 34.7316667 Overall Loss:65.0443783
Validation loss decreased (4.386344 --> 4.066824).  Saving model ...
Updating learning rate to 0.00025
tensor(61.4501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.9569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8999726 KL Loss: 28.1612656 DSM Loss: 34.0594708 Overall Loss:64.1207090
Validation loss decreased (4.066824 --> 3.929708).  Saving model ...
Updating learning rate to 0.000125
tensor(74.7215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8867584 KL Loss: 28.0373290 DSM Loss: 33.3297801 Overall Loss:63.2538675
Validation loss decreased (3.929708 --> 3.791595).  Saving model ...
Updating learning rate to 6.25e-05
tensor(72.3546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0762, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8654871 KL Loss: 27.9733151 DSM Loss: 33.3786243 Overall Loss:63.2174263
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(58.1981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8947933 KL Loss: 28.0469914 DSM Loss: 33.5158643 Overall Loss:63.4576491
Validation loss decreased (3.791595 --> 3.753053).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(58.6225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8974358 KL Loss: 28.0961371 DSM Loss: 33.0336217 Overall Loss:63.0271946
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(42.8751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9028400 KL Loss: 28.0895741 DSM Loss: 33.0866512 Overall Loss:63.0790655
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.8963361978530884


Running on file CVX.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(107.4227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9772637 KL Loss: 28.3088105 DSM Loss: 40.3314779 Overall Loss:70.6175520
Validation loss decreased (inf --> 11.411823).  Saving model ...
Updating learning rate to 0.0005
tensor(55.4225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9033777 KL Loss: 28.2408157 DSM Loss: 34.2824786 Overall Loss:64.4266721
Validation loss decreased (11.411823 --> 10.751865).  Saving model ...
Updating learning rate to 0.00025
tensor(56.1272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9021900 KL Loss: 28.2430048 DSM Loss: 33.9706215 Overall Loss:64.1158164
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(52.2013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7708, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8719832 KL Loss: 28.1081575 DSM Loss: 33.2006630 Overall Loss:63.1808038
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:36.57469940185547


Running on file D.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(101.5460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0125185 KL Loss: 28.4077457 DSM Loss: 41.1639567 Overall Loss:71.5842210
Validation loss decreased (inf --> 2.573733).  Saving model ...
Updating learning rate to 0.0005
tensor(65.1678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9579, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0039037 KL Loss: 28.3327371 DSM Loss: 37.5679936 Overall Loss:67.9046344
Validation loss decreased (2.573733 --> 2.334326).  Saving model ...
Updating learning rate to 0.00025
tensor(72.2026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9405936 KL Loss: 28.1736103 DSM Loss: 36.2877484 Overall Loss:66.4019524
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(75.6493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9192074 KL Loss: 28.1504696 DSM Loss: 35.0763728 Overall Loss:65.1460500
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.2734885215759277


Running on file DHR.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(104.6327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6311, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9088037 KL Loss: 28.1342633 DSM Loss: 40.7904074 Overall Loss:70.8334745
Validation loss decreased (inf --> 9.584317).  Saving model ...
Updating learning rate to 0.0005
tensor(64.7598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.7029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9137224 KL Loss: 28.2850019 DSM Loss: 35.7954312 Overall Loss:65.9941558
Validation loss decreased (9.584317 --> 8.326332).  Saving model ...
Updating learning rate to 0.00025
tensor(61.5646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9281881 KL Loss: 28.0710770 DSM Loss: 34.7727195 Overall Loss:64.7719846
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(65.6264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9641099 KL Loss: 28.2659156 DSM Loss: 34.0735827 Overall Loss:64.3036079
Validation loss decreased (8.326332 --> 8.286505).  Saving model ...
Updating learning rate to 6.25e-05
tensor(90.5289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0733554 KL Loss: 28.6323282 DSM Loss: 34.1983832 Overall Loss:64.9040662
Validation loss decreased (8.286505 --> 7.952777).  Saving model ...
Updating learning rate to 3.125e-05
tensor(45.6557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1980, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.1083313 KL Loss: 28.3770827 DSM Loss: 33.8182828 Overall Loss:64.3036968
Validation loss decreased (7.952777 --> 7.892831).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(56.3035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.2180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.0629961 KL Loss: 28.4631540 DSM Loss: 33.9686904 Overall Loss:64.4948405
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(51.4317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8252, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.0884127 KL Loss: 28.4271879 DSM Loss: 33.7745177 Overall Loss:64.2901181
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.285855293273926


Running on file DIS.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(128.6092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9387372 KL Loss: 28.3898832 DSM Loss: 44.1234812 Overall Loss:74.4521013
Validation loss decreased (inf --> 1.996569).  Saving model ...
Updating learning rate to 0.0005
tensor(74.3430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.6016, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9480353 KL Loss: 28.2201901 DSM Loss: 38.1377214 Overall Loss:68.3059468
Validation loss decreased (1.996569 --> 1.812432).  Saving model ...
Updating learning rate to 0.00025
tensor(78.0547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9120126 KL Loss: 28.1364233 DSM Loss: 37.3222769 Overall Loss:67.3707128
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(94.2237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.8183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9420817 KL Loss: 28.2189081 DSM Loss: 35.8649350 Overall Loss:66.0259247
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.9552472233772278


Running on file DUK.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(91.2935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9733571 KL Loss: 28.3759832 DSM Loss: 44.7445532 Overall Loss:75.0938937
Validation loss decreased (inf --> 7.038052).  Saving model ...
Updating learning rate to 0.0005
tensor(58.6045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9820858 KL Loss: 28.2340598 DSM Loss: 35.3270963 Overall Loss:65.5432417
Validation loss decreased (7.038052 --> 6.969661).  Saving model ...
Updating learning rate to 0.00025
tensor(62.3360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9409349 KL Loss: 28.4443123 DSM Loss: 33.7366803 Overall Loss:64.1219276
Validation loss decreased (6.969661 --> 6.357527).  Saving model ...
Updating learning rate to 0.000125
tensor(56.8810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9196572 KL Loss: 28.1812740 DSM Loss: 33.8607469 Overall Loss:63.9616785
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(49.7454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9443491 KL Loss: 28.3573442 DSM Loss: 33.0454386 Overall Loss:63.3471320
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.58603048324585


Running on file EXC.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(92.3022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8420507 KL Loss: 28.0133309 DSM Loss: 46.4275704 Overall Loss:76.2829522
Validation loss decreased (inf --> 10.554051).  Saving model ...
Updating learning rate to 0.0005
tensor(59.8068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8697599 KL Loss: 27.9165284 DSM Loss: 35.3300093 Overall Loss:65.1162976
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(67.1938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2045, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8633114 KL Loss: 27.8516948 DSM Loss: 34.3171445 Overall Loss:64.0321509
Validation loss decreased (10.554051 --> 10.256445).  Saving model ...
Updating learning rate to 0.000125
tensor(60.0647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.9080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8793849 KL Loss: 28.0117259 DSM Loss: 33.7647031 Overall Loss:63.6558140
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(56.7352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8790958 KL Loss: 28.0481304 DSM Loss: 33.3480074 Overall Loss:63.2752337
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:13.645120620727539


Running on file GD.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(99.1223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9385996 KL Loss: 28.1605695 DSM Loss: 44.8362072 Overall Loss:74.9353757
Validation loss decreased (inf --> 5.956407).  Saving model ...
Updating learning rate to 0.0005
tensor(52.3854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3556, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9309514 KL Loss: 28.2461572 DSM Loss: 34.5616439 Overall Loss:64.7387521
Validation loss decreased (5.956407 --> 4.712744).  Saving model ...
Updating learning rate to 0.00025
tensor(61.7403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9498449 KL Loss: 28.3478611 DSM Loss: 33.6256914 Overall Loss:63.9233975
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(65.8565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9330386 KL Loss: 28.2858394 DSM Loss: 32.7780201 Overall Loss:62.9968981
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:9.173714637756348


Running on file GE.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(115.1922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.0541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.3722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9789018 KL Loss: 28.3968607 DSM Loss: 44.4394477 Overall Loss:74.8152106
Validation loss decreased (inf --> 0.237689).  Saving model ...
Updating learning rate to 0.0005
tensor(73.5434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9421227 KL Loss: 27.8863710 DSM Loss: 38.5127259 Overall Loss:68.3412197
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(64.8427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9753341 KL Loss: 28.1837347 DSM Loss: 38.5962699 Overall Loss:68.7553386
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.35010969638824463


Running on file GOOG.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(131.1325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5179, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9114781 KL Loss: 28.1156419 DSM Loss: 43.6693023 Overall Loss:73.6964224
Validation loss decreased (inf --> 11.079501).  Saving model ...
Updating learning rate to 0.0005
tensor(43.6336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.4100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9330239 KL Loss: 27.8702455 DSM Loss: 33.8067239 Overall Loss:63.6099931
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(100.3977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8903061 KL Loss: 27.5654720 DSM Loss: 33.2973973 Overall Loss:62.7531755
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.046327114105225


Running on file HD.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(98.1105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9629320 KL Loss: 28.0996427 DSM Loss: 43.3876125 Overall Loss:73.4501871
Validation loss decreased (inf --> 8.489113).  Saving model ...
Updating learning rate to 0.0005
tensor(56.7263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9357344 KL Loss: 27.8535677 DSM Loss: 35.9866259 Overall Loss:65.7759280
Validation loss decreased (8.489113 --> 8.242165).  Saving model ...
Updating learning rate to 0.00025
tensor(67.6766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8907088 KL Loss: 27.6755632 DSM Loss: 35.3483950 Overall Loss:64.9146673
Validation loss decreased (8.242165 --> 7.470150).  Saving model ...
Updating learning rate to 0.000125
tensor(61.2759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8837354 KL Loss: 27.5601491 DSM Loss: 34.9287331 Overall Loss:64.3726179
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(64.5531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.4860, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8989791 KL Loss: 27.6370955 DSM Loss: 34.4825413 Overall Loss:64.0186157
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.9460959434509277


Running on file HON.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(86.6405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9534640 KL Loss: 28.5266421 DSM Loss: 39.9318343 Overall Loss:70.4119403
Validation loss decreased (inf --> 3.392651).  Saving model ...
Updating learning rate to 0.0005
tensor(63.5584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.3905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9200877 KL Loss: 28.1442853 DSM Loss: 35.5586825 Overall Loss:65.6230552
Validation loss decreased (3.392651 --> 3.189424).  Saving model ...
Updating learning rate to 0.00025
tensor(82.0183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9274065 KL Loss: 27.9333885 DSM Loss: 34.4749102 Overall Loss:64.3357053
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(94.2407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2846, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9076702 KL Loss: 27.7894025 DSM Loss: 34.1051532 Overall Loss:63.8022255
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.634183645248413


Running on file HSBC.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(125.7645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.3638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9350125 KL Loss: 28.3543017 DSM Loss: 49.0228828 Overall Loss:79.3121968
Validation loss decreased (inf --> 0.307909).  Saving model ...
Updating learning rate to 0.0005
tensor(75.0037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9378, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9443371 KL Loss: 28.2658152 DSM Loss: 39.2886690 Overall Loss:69.4988213
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(54.6815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1962, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9281622 KL Loss: 28.1072552 DSM Loss: 37.6284549 Overall Loss:67.6638723
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.0776453018188477


Running on file IEP.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(81.6355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9762552 KL Loss: 28.3885907 DSM Loss: 53.1687845 Overall Loss:83.5336302
Validation loss decreased (inf --> 2.483760).  Saving model ...
Updating learning rate to 0.0005
tensor(77.3573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0105771 KL Loss: 28.4449637 DSM Loss: 38.5102182 Overall Loss:68.9657592
Validation loss decreased (2.483760 --> 1.836714).  Saving model ...
Updating learning rate to 0.00025
tensor(60.5640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9545892 KL Loss: 28.1597982 DSM Loss: 36.9942730 Overall Loss:67.1086606
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(65.6660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.4878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9137498 KL Loss: 28.1752084 DSM Loss: 35.9098654 Overall Loss:65.9988236
Validation loss decreased (1.836714 --> 1.792890).  Saving model ...
Updating learning rate to 6.25e-05
tensor(74.9843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7035, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9586819 KL Loss: 28.3061582 DSM Loss: 36.4535408 Overall Loss:66.7183813
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(69.1112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.8788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9276213 KL Loss: 28.3337305 DSM Loss: 35.7814548 Overall Loss:66.0428063
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.30171275138855


Running on file INTC.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(98.3606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0017843 KL Loss: 28.2700663 DSM Loss: 40.9635558 Overall Loss:71.2354062
Validation loss decreased (inf --> 0.652759).  Saving model ...
Updating learning rate to 0.0005
tensor(69.9806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9467247 KL Loss: 28.1393915 DSM Loss: 35.7108840 Overall Loss:65.7970006
Validation loss decreased (0.652759 --> 0.600547).  Saving model ...
Updating learning rate to 0.00025
tensor(58.4934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8947536 KL Loss: 27.7656142 DSM Loss: 35.5686050 Overall Loss:65.2289729
Validation loss decreased (0.600547 --> 0.368977).  Saving model ...
Updating learning rate to 0.000125
tensor(70.2107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5319, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9173311 KL Loss: 28.1370242 DSM Loss: 34.8059122 Overall Loss:64.8602676
Validation loss decreased (0.368977 --> 0.338853).  Saving model ...
Updating learning rate to 6.25e-05
tensor(57.6633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8964500 KL Loss: 27.9625273 DSM Loss: 34.4788415 Overall Loss:64.3378183
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(47.9748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8842004 KL Loss: 27.9626504 DSM Loss: 34.9973815 Overall Loss:64.8442321
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.2828963994979858


Running on file JNJ.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(79.4688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8656590 KL Loss: 28.1262551 DSM Loss: 45.3837843 Overall Loss:75.3756980
Validation loss decreased (inf --> 4.492000).  Saving model ...
Updating learning rate to 0.0005
tensor(56.6435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8798436 KL Loss: 27.9562964 DSM Loss: 33.8290208 Overall Loss:63.6651607
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(81.1852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.8963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8802477 KL Loss: 28.2701930 DSM Loss: 31.9724433 Overall Loss:62.1228835
Validation loss decreased (4.492000 --> 4.295889).  Saving model ...
Updating learning rate to 0.000125
tensor(55.6750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1741, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8741361 KL Loss: 27.8765274 DSM Loss: 31.0276398 Overall Loss:60.7783034
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(61.8944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8707955 KL Loss: 27.7838392 DSM Loss: 31.7542426 Overall Loss:61.4088772
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.721938610076904


Running on file JPM.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(79.7597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.8115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8928229 KL Loss: 28.2385186 DSM Loss: 40.5349956 Overall Loss:70.6663374
Validation loss decreased (inf --> 5.157708).  Saving model ...
Updating learning rate to 0.0005
tensor(60.4366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9075628 KL Loss: 28.2385456 DSM Loss: 35.1565440 Overall Loss:65.3026529
Validation loss decreased (5.157708 --> 4.435912).  Saving model ...
Updating learning rate to 0.00025
tensor(61.5267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.2669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9139567 KL Loss: 28.2538123 DSM Loss: 34.7137456 Overall Loss:64.8815148
Validation loss decreased (4.435912 --> 4.179179).  Saving model ...
Updating learning rate to 0.000125
tensor(75.4438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8987894 KL Loss: 28.0853456 DSM Loss: 33.4909633 Overall Loss:63.4750983
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(65.8320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9264539 KL Loss: 28.2646926 DSM Loss: 32.5395160 Overall Loss:62.7306630
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.398529291152954


Running on file KO.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(136.0940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0389302 KL Loss: 28.5267845 DSM Loss: 47.5356093 Overall Loss:78.1013238
Validation loss decreased (inf --> 6.462651).  Saving model ...
Updating learning rate to 0.0005
tensor(67.4770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9953477 KL Loss: 28.3374264 DSM Loss: 37.2200959 Overall Loss:67.5528700
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(59.1816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9212730 KL Loss: 28.2219592 DSM Loss: 36.0940704 Overall Loss:66.2373023
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:10.310328483581543


Running on file LMT.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(84.0625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9047767 KL Loss: 28.1703401 DSM Loss: 40.0864650 Overall Loss:70.1615817
Validation loss decreased (inf --> 2.277387).  Saving model ...
Updating learning rate to 0.0005
tensor(65.1198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7051, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9061547 KL Loss: 28.2437235 DSM Loss: 35.8667983 Overall Loss:66.0166760
Validation loss decreased (2.277387 --> 2.219094).  Saving model ...
Updating learning rate to 0.00025
tensor(54.7632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8950207 KL Loss: 28.2241089 DSM Loss: 34.8870180 Overall Loss:65.0061474
Validation loss decreased (2.219094 --> 1.903682).  Saving model ...
Updating learning rate to 0.000125
tensor(69.5672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8514753 KL Loss: 27.9063692 DSM Loss: 34.0954544 Overall Loss:63.8532989
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(65.3541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5580, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8653524 KL Loss: 27.8108725 DSM Loss: 33.4556873 Overall Loss:63.1319120
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:6.849630355834961


Running on file MA.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(103.6412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.3629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9018034 KL Loss: 28.0130079 DSM Loss: 52.5546842 Overall Loss:82.4694955
Validation loss decreased (inf --> 2.638564).  Saving model ...
Updating learning rate to 0.0005
tensor(57.9778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9423763 KL Loss: 28.1992550 DSM Loss: 38.1735539 Overall Loss:68.3151854
Validation loss decreased (2.638564 --> 2.421741).  Saving model ...
Updating learning rate to 0.00025
tensor(64.0273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9286867 KL Loss: 28.0394503 DSM Loss: 36.2776105 Overall Loss:66.2457476
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(80.8265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9341758 KL Loss: 28.1151495 DSM Loss: 35.8368464 Overall Loss:65.8861715
Validation loss decreased (2.421741 --> 1.997134).  Saving model ...
Updating learning rate to 6.25e-05
tensor(66.3855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.5518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5710, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8738185 KL Loss: 27.9123057 DSM Loss: 35.5643444 Overall Loss:65.3504684
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(54.3700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.8671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9088893 KL Loss: 28.2222954 DSM Loss: 35.5941485 Overall Loss:65.7253335
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.4834492206573486


Running on file MCD.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(99.2572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8993387 KL Loss: 28.2400031 DSM Loss: 41.6663348 Overall Loss:71.8056771
Validation loss decreased (inf --> 4.242110).  Saving model ...
Updating learning rate to 0.0005
tensor(65.7076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8766000 KL Loss: 28.0051527 DSM Loss: 36.9998592 Overall Loss:66.8816121
Validation loss decreased (4.242110 --> 3.411537).  Saving model ...
Updating learning rate to 0.00025
tensor(68.6966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8368232 KL Loss: 27.6000817 DSM Loss: 35.7980288 Overall Loss:65.2349334
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(63.2722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8679587 KL Loss: 27.6411344 DSM Loss: 35.3806647 Overall Loss:64.8897578
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:6.539911270141602


Running on file MDT.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(118.6756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9899298 KL Loss: 28.6502411 DSM Loss: 45.2912616 Overall Loss:75.9314325
Validation loss decreased (inf --> 2.720063).  Saving model ...
Updating learning rate to 0.0005
tensor(58.7284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.6685, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9955344 KL Loss: 28.4272111 DSM Loss: 36.4167075 Overall Loss:66.8394528
Validation loss decreased (2.720063 --> 2.441933).  Saving model ...
Updating learning rate to 0.00025
tensor(64.9125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.7045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 2.0226778 KL Loss: 28.3967169 DSM Loss: 34.8709261 Overall Loss:65.2903209
Validation loss decreased (2.441933 --> 2.387135).  Saving model ...
Updating learning rate to 0.000125
tensor(68.7240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4056, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.0236769 KL Loss: 28.4058231 DSM Loss: 34.6986988 Overall Loss:65.1281986
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(69.8956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0319495 KL Loss: 28.4659828 DSM Loss: 34.4447113 Overall Loss:64.9426437
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.0969165563583374


Running on file MMM.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(81.6862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9245316 KL Loss: 28.5063749 DSM Loss: 42.7878380 Overall Loss:73.2187445
Validation loss decreased (inf --> 0.410239).  Saving model ...
Updating learning rate to 0.0005
tensor(52.4123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9231117 KL Loss: 28.4093774 DSM Loss: 34.5330322 Overall Loss:64.8655214
Validation loss decreased (0.410239 --> 0.400678).  Saving model ...
Updating learning rate to 0.00025
tensor(82.4073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9078254 KL Loss: 28.2236609 DSM Loss: 33.7792460 Overall Loss:63.9107321
Validation loss decreased (0.400678 --> 0.397688).  Saving model ...
Updating learning rate to 0.000125
tensor(78.1240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9055534 KL Loss: 28.2015227 DSM Loss: 33.1962802 Overall Loss:63.3033561
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(57.3259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9109316 KL Loss: 28.0727173 DSM Loss: 33.3841857 Overall Loss:63.3678349
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.318448066711426


Running on file MO.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(109.5642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9555952 KL Loss: 28.3943646 DSM Loss: 51.4234709 Overall Loss:81.7734307
Validation loss decreased (inf --> 0.923839).  Saving model ...
Updating learning rate to 0.0005
tensor(95.5467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9783326 KL Loss: 28.5558210 DSM Loss: 42.6398007 Overall Loss:73.1739542
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(59.1845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.7238, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9895930 KL Loss: 28.5549355 DSM Loss: 41.3932945 Overall Loss:71.9378231
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6585046648979187


Running on file MRK.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(86.3659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.3268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9419802 KL Loss: 28.1782645 DSM Loss: 43.2823135 Overall Loss:73.4025582
Validation loss decreased (inf --> 1.645277).  Saving model ...
Updating learning rate to 0.0005
tensor(59.1670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9491457 KL Loss: 28.2454888 DSM Loss: 35.9708506 Overall Loss:66.1654846
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(69.9066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9605085 KL Loss: 28.2769700 DSM Loss: 35.5833513 Overall Loss:65.8208296
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:13.390494346618652


Running on file MSFT.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(102.9531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.9312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9446232 KL Loss: 28.2615501 DSM Loss: 48.6504838 Overall Loss:78.8566571
Validation loss decreased (inf --> 7.996961).  Saving model ...
Updating learning rate to 0.0005
tensor(67.0842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5435, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9031285 KL Loss: 27.8364038 DSM Loss: 37.1694007 Overall Loss:66.9089327
Validation loss decreased (7.996961 --> 7.392908).  Saving model ...
Updating learning rate to 0.00025
tensor(73.5849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9015702 KL Loss: 27.9398114 DSM Loss: 36.7043984 Overall Loss:66.5457802
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(73.9315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9221189 KL Loss: 27.9888986 DSM Loss: 36.5285358 Overall Loss:66.4395530
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:6.200392246246338


Running on file NEE.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(114.4856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9536977 KL Loss: 27.9448888 DSM Loss: 46.1512405 Overall Loss:76.0498268
Validation loss decreased (inf --> 3.882393).  Saving model ...
Updating learning rate to 0.0005
tensor(72.1902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9123195 KL Loss: 27.7622264 DSM Loss: 38.0990494 Overall Loss:67.7735955
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(73.5463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9355701 KL Loss: 27.7672122 DSM Loss: 36.6587480 Overall Loss:66.3615303
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.8790829181671143


Running on file NGG.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(105.7418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8913239 KL Loss: 28.3426308 DSM Loss: 48.3124429 Overall Loss:78.5463976
Validation loss decreased (inf --> 10.501131).  Saving model ...
Updating learning rate to 0.0005
tensor(62.3451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8928257 KL Loss: 28.3411833 DSM Loss: 39.2698102 Overall Loss:69.5038192
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(53.1748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.1179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4226, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9140500 KL Loss: 28.2540332 DSM Loss: 37.2278001 Overall Loss:67.3958829
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.311972618103027


Running on file NVS.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(95.2069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9366, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9411318 KL Loss: 28.1420474 DSM Loss: 45.3394691 Overall Loss:75.4226481
Validation loss decreased (inf --> 1.349002).  Saving model ...
Updating learning rate to 0.0005
tensor(71.2553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8906987 KL Loss: 27.9034144 DSM Loss: 37.6253486 Overall Loss:67.4194618
Validation loss decreased (1.349002 --> 1.130792).  Saving model ...
Updating learning rate to 0.00025
tensor(66.3045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9130401 KL Loss: 28.1170040 DSM Loss: 36.3022002 Overall Loss:66.3322443
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(60.1177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3343, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9057493 KL Loss: 28.2598054 DSM Loss: 35.7332725 Overall Loss:65.8988274
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.6874613761901855


Running on file ORCL.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(94.8356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8450915 KL Loss: 27.9284696 DSM Loss: 49.6399790 Overall Loss:79.4135402
Validation loss decreased (inf --> 11.483526).  Saving model ...
Updating learning rate to 0.0005
tensor(57.0389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.3495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8943327 KL Loss: 27.8058204 DSM Loss: 33.5012881 Overall Loss:63.2014410
Validation loss decreased (11.483526 --> 11.310298).  Saving model ...
Updating learning rate to 0.00025
tensor(46.9615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3082, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9161283 KL Loss: 27.8938530 DSM Loss: 31.2005046 Overall Loss:61.0104861
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(74.8943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.1629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8943276 KL Loss: 27.4134027 DSM Loss: 30.6533111 Overall Loss:59.9610414
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:18.399789810180664


Running on file PCG.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(104.6395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9256841 KL Loss: 28.2116050 DSM Loss: 45.2069933 Overall Loss:75.3442827
Validation loss decreased (inf --> 0.825451).  Saving model ...
Updating learning rate to 0.0005
tensor(74.9918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9500298 KL Loss: 28.4263257 DSM Loss: 39.8414514 Overall Loss:70.2178067
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(64.6588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9239230 KL Loss: 28.2380427 DSM Loss: 39.0421642 Overall Loss:69.2041301
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5622364282608032


Running on file PEP.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(119.9142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3916, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8855967 KL Loss: 28.2385977 DSM Loss: 48.7170778 Overall Loss:78.8412725
Validation loss decreased (inf --> 8.089866).  Saving model ...
Updating learning rate to 0.0005
tensor(77.2181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8904311 KL Loss: 28.1163023 DSM Loss: 34.9155076 Overall Loss:64.9222411
Validation loss decreased (8.089866 --> 7.662185).  Saving model ...
Updating learning rate to 0.00025
tensor(75.7986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8860488 KL Loss: 28.1082112 DSM Loss: 34.5384674 Overall Loss:64.5327276
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(59.2284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1388, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8835098 KL Loss: 27.8642210 DSM Loss: 34.2992664 Overall Loss:64.0469972
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:13.901674270629883


Running on file PFE.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(105.1646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9110489 KL Loss: 28.3131927 DSM Loss: 42.1382778 Overall Loss:72.3625196
Validation loss decreased (inf --> 16.347280).  Saving model ...
Updating learning rate to 0.0005
tensor(71.5961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8849193 KL Loss: 28.0366265 DSM Loss: 33.8632892 Overall Loss:63.7848350
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(66.9469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8880572 KL Loss: 27.9513609 DSM Loss: 32.5438906 Overall Loss:62.3833087
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.822392463684082


Running on file PG.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(100.0344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9535190 KL Loss: 28.2961254 DSM Loss: 43.9933626 Overall Loss:74.2430069
Validation loss decreased (inf --> 5.245434).  Saving model ...
Updating learning rate to 0.0005
tensor(75.5658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.0772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9960268 KL Loss: 28.5281447 DSM Loss: 38.0651154 Overall Loss:68.5892869
Validation loss decreased (5.245434 --> 4.939099).  Saving model ...
Updating learning rate to 0.00025
tensor(63.6948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.1065, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9251566 KL Loss: 27.9514976 DSM Loss: 37.0734023 Overall Loss:66.9500563
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(68.2319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7299, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8979825 KL Loss: 27.8144000 DSM Loss: 36.1897765 Overall Loss:65.9021590
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.656928539276123


Running on file PM.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(97.6637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1832, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9462282 KL Loss: 28.4111117 DSM Loss: 45.2860973 Overall Loss:75.6434368
Validation loss decreased (inf --> 6.934903).  Saving model ...
Updating learning rate to 0.0005
tensor(71.4268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.2910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9494044 KL Loss: 28.4213367 DSM Loss: 38.8210452 Overall Loss:69.1917865
Validation loss decreased (6.934903 --> 6.114598).  Saving model ...
Updating learning rate to 0.00025
tensor(61.4117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9867679 KL Loss: 28.4656363 DSM Loss: 37.8304560 Overall Loss:68.2828601
Validation loss decreased (6.114598 --> 5.862842).  Saving model ...
Updating learning rate to 0.000125
tensor(77.5748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.9840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9425602 KL Loss: 28.3356051 DSM Loss: 37.0634494 Overall Loss:67.3416150
Validation loss decreased (5.862842 --> 5.767748).  Saving model ...
Updating learning rate to 6.25e-05
tensor(47.7726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3129, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9443605 KL Loss: 28.3287143 DSM Loss: 36.1946709 Overall Loss:66.4677457
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(78.6930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9096615 KL Loss: 27.9841276 DSM Loss: 36.2618630 Overall Loss:66.1556525
Validation loss decreased (5.767748 --> 5.668766).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(66.6160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.5391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9211985 KL Loss: 28.0019808 DSM Loss: 35.8603444 Overall Loss:65.7835238
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(78.4017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.0014067 KL Loss: 28.3910951 DSM Loss: 36.3745538 Overall Loss:66.7670557
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.00711441040039


Running on file PPL.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(115.8899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.8163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9755748 KL Loss: 28.6000171 DSM Loss: 47.8069862 Overall Loss:78.3825779
Validation loss decreased (inf --> 0.745050).  Saving model ...
Updating learning rate to 0.0005
tensor(73.4396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.6777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.7873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9241350 KL Loss: 28.3971689 DSM Loss: 42.7538999 Overall Loss:73.0752039
Validation loss decreased (0.745050 --> 0.729361).  Saving model ...
Updating learning rate to 0.00025
tensor(71.2584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.2162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9575666 KL Loss: 28.3854602 DSM Loss: 40.4496906 Overall Loss:70.7927173
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(79.4318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.5992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9460825 KL Loss: 28.4608778 DSM Loss: 40.1508815 Overall Loss:70.5578417
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8843594789505005


Running on file REX.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(89.8775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9610825 KL Loss: 28.5699573 DSM Loss: 41.5685945 Overall Loss:72.0996342
Validation loss decreased (inf --> 1.628664).  Saving model ...
Updating learning rate to 0.0005
tensor(57.6058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9493941 KL Loss: 28.3391233 DSM Loss: 35.0241882 Overall Loss:65.3127049
Validation loss decreased (1.628664 --> 1.494957).  Saving model ...
Updating learning rate to 0.00025
tensor(63.6293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8964357 KL Loss: 28.1488517 DSM Loss: 33.6256198 Overall Loss:63.6709070
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(65.0582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9118660 KL Loss: 28.1709133 DSM Loss: 33.0900284 Overall Loss:63.1728077
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.950485944747925


Running on file SLB.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(111.4129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8110, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9842118 KL Loss: 28.3672607 DSM Loss: 52.5159050 Overall Loss:82.8673768
Validation loss decreased (inf --> 0.239644).  Saving model ...
Updating learning rate to 0.0005
tensor(68.9965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9253363 KL Loss: 27.9949895 DSM Loss: 40.9938182 Overall Loss:70.9141439
Validation loss decreased (0.239644 --> 0.237900).  Saving model ...
Updating learning rate to 0.00025
tensor(74.3109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3370, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9016624 KL Loss: 27.8598895 DSM Loss: 39.9903712 Overall Loss:69.7519229
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(70.9901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3094, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9163152 KL Loss: 27.7853405 DSM Loss: 39.2330119 Overall Loss:68.9346678
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.4215126633644104


Running on file SNY.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(94.5714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8955280 KL Loss: 28.0453167 DSM Loss: 41.8612885 Overall Loss:71.8021333
Validation loss decreased (inf --> 3.571908).  Saving model ...
Updating learning rate to 0.0005
tensor(65.2715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9043, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9204834 KL Loss: 28.1147832 DSM Loss: 36.0966601 Overall Loss:66.1319270
Validation loss decreased (3.571908 --> 3.260479).  Saving model ...
Updating learning rate to 0.00025
tensor(64.9564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8826020 KL Loss: 27.9070396 DSM Loss: 35.6062916 Overall Loss:65.3959331
Validation loss decreased (3.260479 --> 2.884644).  Saving model ...
Updating learning rate to 0.000125
tensor(87.0781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8879815 KL Loss: 27.7696526 DSM Loss: 35.4476618 Overall Loss:65.1052962
Validation loss decreased (2.884644 --> 2.632110).  Saving model ...
Updating learning rate to 6.25e-05
tensor(68.3637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8964948 KL Loss: 27.8038547 DSM Loss: 35.4388313 Overall Loss:65.1391809
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(75.4705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8938285 KL Loss: 27.8648970 DSM Loss: 34.9474303 Overall Loss:64.7061559
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.858701467514038


Running on file SO.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(101.7630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1058, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9193216 KL Loss: 28.1865249 DSM Loss: 43.7424835 Overall Loss:73.8483298
Validation loss decreased (inf --> 6.296271).  Saving model ...
Updating learning rate to 0.0005
tensor(64.8114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.1788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9038238 KL Loss: 28.0340657 DSM Loss: 38.6628807 Overall Loss:68.6007706
Validation loss decreased (6.296271 --> 5.242636).  Saving model ...
Updating learning rate to 0.00025
tensor(68.6151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8839936 KL Loss: 27.8225527 DSM Loss: 36.9833448 Overall Loss:66.6898909
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(68.4981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2127, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9012690 KL Loss: 27.8668821 DSM Loss: 36.6508389 Overall Loss:66.4189896
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:9.399989128112793


Running on file SPLP.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(91.2457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.8852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0264489 KL Loss: 28.6214649 DSM Loss: 43.9196797 Overall Loss:74.5675933
Validation loss decreased (inf --> 18.474378).  Saving model ...
Updating learning rate to 0.0005
tensor(46.7438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9975765 KL Loss: 28.3316405 DSM Loss: 36.6154573 Overall Loss:66.9446740
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(99.5273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9533662 KL Loss: 28.1757766 DSM Loss: 35.8709042 Overall Loss:66.0000471
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:31.216659545898438


Running on file SRE.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(86.9083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9509078 KL Loss: 28.3798685 DSM Loss: 50.0170281 Overall Loss:80.3478041
Validation loss decreased (inf --> 2.829723).  Saving model ...
Updating learning rate to 0.0005
tensor(67.8870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4299, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9373673 KL Loss: 28.2900375 DSM Loss: 36.6704557 Overall Loss:66.8978607
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(64.0419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.2363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9576297 KL Loss: 28.1587810 DSM Loss: 35.6804513 Overall Loss:65.7968620
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:6.827364444732666


Running on file T.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(107.8146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.0975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0086424 KL Loss: 28.5841644 DSM Loss: 44.9599634 Overall Loss:75.5527700
Validation loss decreased (inf --> 0.481138).  Saving model ...
Updating learning rate to 0.0005
tensor(77.4990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.5697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.5538, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9585718 KL Loss: 28.2214150 DSM Loss: 37.8247581 Overall Loss:68.0047450
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(64.0617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5339, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9371877 KL Loss: 28.1446396 DSM Loss: 37.3387951 Overall Loss:67.4206221
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.4469835758209229


Running on file TM.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(95.2099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9614034 KL Loss: 28.5313910 DSM Loss: 41.0563430 Overall Loss:71.5491375
Validation loss decreased (inf --> 10.568981).  Saving model ...
Updating learning rate to 0.0005
tensor(48.1977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.0653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9269123 KL Loss: 28.1014917 DSM Loss: 34.3023786 Overall Loss:64.3307827
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(76.0359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.8626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8825024 KL Loss: 27.8684407 DSM Loss: 33.7182864 Overall Loss:63.4692295
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.913517713546753


Running on file TSM.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(101.2277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0755099 KL Loss: 28.3834025 DSM Loss: 45.0157341 Overall Loss:75.4746463
Validation loss decreased (inf --> 5.528697).  Saving model ...
Updating learning rate to 0.0005
tensor(56.3350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.0842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.1161678 KL Loss: 28.3111304 DSM Loss: 37.4394548 Overall Loss:67.8667531
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(68.3601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.3511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0480, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 2.2514708 KL Loss: 28.6046403 DSM Loss: 35.9714814 Overall Loss:66.8275923
Validation loss decreased (5.528697 --> 3.478216).  Saving model ...
Updating learning rate to 0.000125
tensor(99.4709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 2.2433133 KL Loss: 28.8193222 DSM Loss: 35.6779974 Overall Loss:66.7406329
Validation loss decreased (3.478216 --> 2.848606).  Saving model ...
Updating learning rate to 6.25e-05
tensor(55.7330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0954601 KL Loss: 28.0508368 DSM Loss: 35.5769936 Overall Loss:65.7232906
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(58.5057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.2501195 KL Loss: 28.4921485 DSM Loss: 34.5648993 Overall Loss:65.3071668
Validation loss decreased (2.848606 --> 2.581028).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(39.1060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.1871705 KL Loss: 28.4680405 DSM Loss: 34.8897380 Overall Loss:65.5449489
Validation loss decreased (2.581028 --> 2.553702).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(65.9306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.2786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.2161338 KL Loss: 28.2431188 DSM Loss: 34.9587985 Overall Loss:65.4180509
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.90625e-06
tensor(47.4771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.1931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 2.2757846 KL Loss: 28.4687665 DSM Loss: 34.0236388 Overall Loss:64.7681897
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5846127867698669


Running on file UL.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(93.5587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9053630 KL Loss: 28.1584862 DSM Loss: 43.3625244 Overall Loss:73.4263734
Validation loss decreased (inf --> 0.192552).  Saving model ...
Updating learning rate to 0.0005
tensor(64.8644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9313108 KL Loss: 28.0857540 DSM Loss: 34.9119058 Overall Loss:64.9289707
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(75.0745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3463, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9213180 KL Loss: 27.9506903 DSM Loss: 34.2445337 Overall Loss:64.1165418
Validation loss decreased (0.192552 --> 0.182261).  Saving model ...
Updating learning rate to 0.000125
tensor(71.8165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9124120 KL Loss: 28.0631519 DSM Loss: 34.5734199 Overall Loss:64.5489842
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(52.3692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8759857 KL Loss: 27.8823188 DSM Loss: 34.1264119 Overall Loss:63.8847167
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.23523108661174774


Running on file UNH.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(96.3411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9214654 KL Loss: 28.3531863 DSM Loss: 42.8606196 Overall Loss:73.1352713
Validation loss decreased (inf --> 7.425196).  Saving model ...
Updating learning rate to 0.0005
tensor(63.6800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.6268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9175552 KL Loss: 27.8733692 DSM Loss: 34.7523774 Overall Loss:64.5433018
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(73.6038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8607067 KL Loss: 27.3861713 DSM Loss: 33.4875125 Overall Loss:62.7343907
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:10.94965934753418


Running on file UPS.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(84.9172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.0765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8934235 KL Loss: 27.9083795 DSM Loss: 44.8584760 Overall Loss:74.6602786
Validation loss decreased (inf --> 8.497748).  Saving model ...
Updating learning rate to 0.0005
tensor(64.1528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(123.5058, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8880791 KL Loss: 27.4149257 DSM Loss: 35.9430130 Overall Loss:65.2460181
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(76.7755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8920916 KL Loss: 27.6664199 DSM Loss: 34.1363245 Overall Loss:63.6948356
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.130521297454834


Running on file V.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(103.0693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9665625 KL Loss: 28.2341041 DSM Loss: 42.6228327 Overall Loss:72.8234996
Validation loss decreased (inf --> 1.739430).  Saving model ...
Updating learning rate to 0.0005
tensor(68.6876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9656095 KL Loss: 28.3529749 DSM Loss: 36.6540921 Overall Loss:66.9726765
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(79.7834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9288447 KL Loss: 28.3883330 DSM Loss: 35.4153376 Overall Loss:65.7325153
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.138993740081787


Running on file VZ.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(112.1012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9355659 KL Loss: 28.3504564 DSM Loss: 43.7474337 Overall Loss:74.0334561
Validation loss decreased (inf --> 0.539770).  Saving model ...
Updating learning rate to 0.0005
tensor(61.7468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9235991 KL Loss: 28.4159255 DSM Loss: 37.5235601 Overall Loss:67.8630849
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(61.2246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9791003 KL Loss: 28.5254658 DSM Loss: 36.8848061 Overall Loss:67.3893720
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.4524682760238647


Running on file WFC.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(126.1576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.6442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.9495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9735990 KL Loss: 28.4486171 DSM Loss: 50.7479917 Overall Loss:81.1702074
Validation loss decreased (inf --> 0.991251).  Saving model ...
Updating learning rate to 0.0005
tensor(74.6599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4418, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9751462 KL Loss: 28.3369895 DSM Loss: 41.6747804 Overall Loss:71.9869164
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(56.1167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9837944 KL Loss: 28.3904596 DSM Loss: 40.8909172 Overall Loss:71.2651713
Validation loss decreased (0.991251 --> 0.828657).  Saving model ...
Updating learning rate to 0.000125
tensor(64.4904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9800283 KL Loss: 28.5013170 DSM Loss: 40.0557756 Overall Loss:70.5371207
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(89.0768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.3697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0194945 KL Loss: 28.4485705 DSM Loss: 39.8923528 Overall Loss:70.3604177
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.11472617089748383


Running on file WMT.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(102.0969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.5031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9442095 KL Loss: 28.1443137 DSM Loss: 51.8505440 Overall Loss:81.9390678
Validation loss decreased (inf --> 3.057135).  Saving model ...
Updating learning rate to 0.0005
tensor(76.9659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9520989 KL Loss: 28.1448939 DSM Loss: 38.1792080 Overall Loss:68.2762008
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(75.3222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.9824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9319891 KL Loss: 28.0711604 DSM Loss: 36.4581755 Overall Loss:66.4613247
Validation loss decreased (3.057135 --> 2.974542).  Saving model ...
Updating learning rate to 0.000125
tensor(62.3581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9078398 KL Loss: 27.9749952 DSM Loss: 35.8787655 Overall Loss:65.7616006
Validation loss decreased (2.974542 --> 2.762866).  Saving model ...
Updating learning rate to 6.25e-05
tensor(63.9963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8943697 KL Loss: 27.8844356 DSM Loss: 35.6444003 Overall Loss:65.4232056
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(71.6886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8853314 KL Loss: 27.8054301 DSM Loss: 35.6477909 Overall Loss:65.3385526
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.648329019546509


Running on file XOM.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(111.8910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7142, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9166180 KL Loss: 28.3639893 DSM Loss: 51.3926495 Overall Loss:81.6732563
Validation loss decreased (inf --> 2.000161).  Saving model ...
Updating learning rate to 0.0005
tensor(82.3224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.7126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9601977 KL Loss: 28.3890005 DSM Loss: 42.6842040 Overall Loss:73.0334023
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(66.1719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9379087 KL Loss: 28.2643110 DSM Loss: 40.7298038 Overall Loss:70.9320237
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:24.419267654418945
   Ticker        MSE StdDev
0    AAPL   8.474237    0.0
1    ABBV  17.354048    0.0
2     AEP   2.642218    0.0
3    AMGN   3.129078    0.0
4    AMZN   0.332631    0.0
..    ...        ...    ...
66      V   2.138994    0.0
67     VZ   1.452468    0.0
68    WFC   0.114726    0.0
69    WMT   3.648329    0.0
70    XOM  24.419268    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=2, prediction_length=60, root_path='data/EcmP_stock_L_2016_24_dva_spec', scale=0.1, sequence_length=60, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(177.5685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.2469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9629345 KL Loss: 41.5433814 DSM Loss: 66.5534822 Overall Loss:110.0597979
Validation loss decreased (inf --> 8.039964).  Saving model ...
Updating learning rate to 0.0005
tensor(131.7908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.0676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9862130 KL Loss: 41.8756129 DSM Loss: 54.2496759 Overall Loss:98.1115017
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(108.8578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.2107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9379134 KL Loss: 41.6756119 DSM Loss: 52.5948587 Overall Loss:96.2083832
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:8.429141998291016


Running on file ABBV.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(174.6646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9403783 KL Loss: 42.0839221 DSM Loss: 70.9780782 Overall Loss:115.0023787
Validation loss decreased (inf --> 7.814186).  Saving model ...
Updating learning rate to 0.0005
tensor(110.9407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(118.5587, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9958822 KL Loss: 42.2406540 DSM Loss: 51.4048969 Overall Loss:95.6414328
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(97.4509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.1678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9265443 KL Loss: 41.9876850 DSM Loss: 48.7692922 Overall Loss:92.6835217
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:16.625324249267578


Running on file AEP.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(148.9886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.6868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9507998 KL Loss: 42.0975141 DSM Loss: 67.2114997 Overall Loss:111.2598140
Validation loss decreased (inf --> 2.314584).  Saving model ...
Updating learning rate to 0.0005
tensor(110.7859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.7269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0003031 KL Loss: 42.4591697 DSM Loss: 55.6747839 Overall Loss:100.1342568
Validation loss decreased (2.314584 --> 2.251459).  Saving model ...
Updating learning rate to 0.00025
tensor(94.0800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.8710, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9095829 KL Loss: 41.6351711 DSM Loss: 53.1291538 Overall Loss:96.6739074
Validation loss decreased (2.251459 --> 1.929193).  Saving model ...
Updating learning rate to 0.000125
tensor(97.9516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.9963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9029168 KL Loss: 41.3927859 DSM Loss: 52.8939175 Overall Loss:96.1896201
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(90.6514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.7396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9308468 KL Loss: 41.9852217 DSM Loss: 52.9563218 Overall Loss:96.8723906
Validation loss decreased (1.929193 --> 1.927444).  Saving model ...
Updating learning rate to 3.125e-05
tensor(83.1340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.4150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.9209599 KL Loss: 41.8450674 DSM Loss: 51.8154526 Overall Loss:95.5814795
Validation loss decreased (1.927444 --> 1.921435).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(93.5659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.1564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.9162450 KL Loss: 41.6348964 DSM Loss: 52.7074294 Overall Loss:96.2585706
EarlyStopping counter: 1 out of 2
Updating learning rate to 7.8125e-06
tensor(83.3327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.6941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 80 | MSE Loss: 1.9054207 KL Loss: 41.4966860 DSM Loss: 51.9513946 Overall Loss:95.3535008
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:3.3142518997192383


Running on file AMGN.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(162.3772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(114.1154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8979781 KL Loss: 42.2905815 DSM Loss: 63.2239302 Overall Loss:107.4124901
Validation loss decreased (inf --> 1.249015).  Saving model ...
Updating learning rate to 0.0005
tensor(84.0891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.2308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9232005 KL Loss: 42.4227233 DSM Loss: 54.9199356 Overall Loss:99.2658594
Validation loss decreased (1.249015 --> 0.960215).  Saving model ...
Updating learning rate to 0.00025
tensor(97.6424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(119.1444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9276308 KL Loss: 42.2494280 DSM Loss: 53.3368374 Overall Loss:97.5138963
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(85.4749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.0227, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9126168 KL Loss: 42.0986093 DSM Loss: 51.0947320 Overall Loss:95.1059583
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:4.1771063804626465


Running on file AMZN.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(126.4192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9732023 KL Loss: 42.2082359 DSM Loss: 61.8845917 Overall Loss:106.0660289
Validation loss decreased (inf --> 3.257600).  Saving model ...
Updating learning rate to 0.0005
tensor(124.5474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.0730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9790570 KL Loss: 42.2784810 DSM Loss: 51.9821745 Overall Loss:96.2397120
Validation loss decreased (3.257600 --> 3.251836).  Saving model ...
Updating learning rate to 0.00025
tensor(97.7063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.8796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9481684 KL Loss: 42.0210315 DSM Loss: 50.7290140 Overall Loss:94.6982140
Validation loss decreased (3.251836 --> 3.241721).  Saving model ...
Updating learning rate to 0.000125
tensor(114.7876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.9654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9283669 KL Loss: 41.5466672 DSM Loss: 51.1378706 Overall Loss:94.6129046
Validation loss decreased (3.241721 --> 2.511937).  Saving model ...
Updating learning rate to 6.25e-05
tensor(77.0310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 2.0607662 KL Loss: 42.1867903 DSM Loss: 50.4868482 Overall Loss:94.7344046
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.125e-05
tensor(87.5134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.7373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 2.1641922 KL Loss: 42.6238448 DSM Loss: 49.9561870 Overall Loss:94.7442237
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.3922540545463562


Running on file BA.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(161.0920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(130.3151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0056448 KL Loss: 42.7066560 DSM Loss: 66.5288073 Overall Loss:111.2411080
Validation loss decreased (inf --> 0.157265).  Saving model ...
Updating learning rate to 0.0005
tensor(114.9837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.1566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9703060 KL Loss: 42.4278103 DSM Loss: 56.0865644 Overall Loss:100.4846811
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(106.6616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.4044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9438457 KL Loss: 42.0347722 DSM Loss: 55.2590234 Overall Loss:99.2376418
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.4060920476913452


Running on file BAC.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(154.8295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2094, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8889911 KL Loss: 42.1184013 DSM Loss: 53.6385572 Overall Loss:97.6459498
Validation loss decreased (inf --> 7.872007).  Saving model ...
Updating learning rate to 0.0005
tensor(70.2653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(98.9354, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.8993173 KL Loss: 42.5203296 DSM Loss: 44.7295202 Overall Loss:89.1491669
Validation loss decreased (7.872007 --> 7.689269).  Saving model ...
Updating learning rate to 0.00025
tensor(107.4908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8777317 KL Loss: 42.0399669 DSM Loss: 43.8913349 Overall Loss:87.8090334
Validation loss decreased (7.689269 --> 7.648150).  Saving model ...
Updating learning rate to 0.000125
tensor(64.7223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.4644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.8929390 KL Loss: 42.1474607 DSM Loss: 43.7671556 Overall Loss:87.8075553
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(114.0516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.8943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.8498699 KL Loss: 41.3977875 DSM Loss: 44.1552639 Overall Loss:87.4029214
Validation loss decreased (7.648150 --> 7.555416).  Saving model ...
Updating learning rate to 3.125e-05
tensor(75.3024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 80 | MSE Loss: 1.8452140 KL Loss: 41.4146124 DSM Loss: 43.6168395 Overall Loss:86.8766665
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.5625e-05
tensor(154.1039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.1885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 80 | MSE Loss: 1.8685290 KL Loss: 41.7692410 DSM Loss: 43.0236724 Overall Loss:86.6614426
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.0632611513137817


Running on file BCH.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(162.1091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9373309 KL Loss: 42.5887850 DSM Loss: 66.6667645 Overall Loss:111.1928808
Validation loss decreased (inf --> 1.140941).  Saving model ...
Updating learning rate to 0.0005
tensor(111.5169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.0038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9059924 KL Loss: 42.0855261 DSM Loss: 57.4591786 Overall Loss:101.4506965
Validation loss decreased (1.140941 --> 1.092476).  Saving model ...
Updating learning rate to 0.00025
tensor(101.4950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.0748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8986985 KL Loss: 42.0398467 DSM Loss: 55.9766498 Overall Loss:99.9151947
Validation loss decreased (1.092476 --> 0.623607).  Saving model ...
Updating learning rate to 0.000125
tensor(95.0854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.7654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9114531 KL Loss: 42.0957751 DSM Loss: 54.7650926 Overall Loss:98.7723209
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(89.4492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.3575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9153169 KL Loss: 42.2084494 DSM Loss: 54.3661343 Overall Loss:98.4899001
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.24161885678768158


Running on file BHP.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(173.1356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.5280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8743629 KL Loss: 42.1693739 DSM Loss: 58.8339723 Overall Loss:102.8777094
Validation loss decreased (inf --> 1.837475).  Saving model ...
Updating learning rate to 0.0005
tensor(108.3334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(111.4295, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9006319 KL Loss: 42.2110970 DSM Loss: 47.9904892 Overall Loss:92.1022183
Validation loss decreased (1.837475 --> 1.783493).  Saving model ...
Updating learning rate to 0.00025
tensor(90.9882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.5288, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9182885 KL Loss: 42.2435668 DSM Loss: 46.6294120 Overall Loss:90.7912673
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(74.0132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.0902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9181020 KL Loss: 42.0628713 DSM Loss: 46.8552188 Overall Loss:90.8361922
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:3.4640209674835205


Running on file BP.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(152.8839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.5202, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9897452 KL Loss: 42.8116287 DSM Loss: 67.7525714 Overall Loss:112.5539452
Validation loss decreased (inf --> 0.162914).  Saving model ...
Updating learning rate to 0.0005
tensor(112.5764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.9544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9492361 KL Loss: 42.5148015 DSM Loss: 57.1430717 Overall Loss:101.6071093
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(88.1739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.4037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9208333 KL Loss: 42.2029184 DSM Loss: 57.5275471 Overall Loss:101.6512981
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:2.772388458251953


Running on file BRK-A.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(145.2684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0177190 KL Loss: 42.4360574 DSM Loss: 53.3139405 Overall Loss:97.7677168
Validation loss decreased (inf --> 8.226456).  Saving model ...
Updating learning rate to 0.0005
tensor(77.7748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.8412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9652240 KL Loss: 42.2635253 DSM Loss: 45.4554379 Overall Loss:89.6841877
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(68.8229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.6439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9140570 KL Loss: 41.7557677 DSM Loss: 44.4352386 Overall Loss:88.1050632
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:11.667277336120605


Running on file BSAC.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(162.2980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(112.9083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0259629 KL Loss: 42.5930894 DSM Loss: 72.1515970 Overall Loss:116.7706494
Validation loss decreased (inf --> 0.457585).  Saving model ...
Updating learning rate to 0.0005
tensor(103.9626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.4164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9732191 KL Loss: 42.5293738 DSM Loss: 55.3307398 Overall Loss:99.8333325
Validation loss decreased (0.457585 --> 0.259128).  Saving model ...
Updating learning rate to 0.00025
tensor(90.1109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(107.1460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9665939 KL Loss: 42.4485516 DSM Loss: 53.6432597 Overall Loss:98.0584055
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(106.3083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.2478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9490945 KL Loss: 42.4315898 DSM Loss: 53.0276678 Overall Loss:97.4083522
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.44817736744880676


Running on file BUD.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(180.0289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(129.8840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9725423 KL Loss: 42.6210208 DSM Loss: 74.8101108 Overall Loss:119.4036738
Validation loss decreased (inf --> 1.401431).  Saving model ...
Updating learning rate to 0.0005
tensor(128.3991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.9637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 2.0471448 KL Loss: 42.9080293 DSM Loss: 60.8480696 Overall Loss:105.8032435
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(124.0515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(148.1439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 2.0632125 KL Loss: 43.1239836 DSM Loss: 59.1275177 Overall Loss:104.3147135
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:1.7335357666015625


Running on file C.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(139.8539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.0726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 2.0032514 KL Loss: 42.4233830 DSM Loss: 61.7305217 Overall Loss:106.1571563
Validation loss decreased (inf --> 0.724872).  Saving model ...
Updating learning rate to 0.0005
tensor(82.7027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(103.3028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9701165 KL Loss: 42.4619509 DSM Loss: 49.6815345 Overall Loss:94.1136021
Validation loss decreased (0.724872 --> 0.658392).  Saving model ...
Updating learning rate to 0.00025
tensor(96.1228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.1852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8998492 KL Loss: 42.0129478 DSM Loss: 48.8023998 Overall Loss:92.7151969
Validation loss decreased (0.658392 --> 0.517755).  Saving model ...
Updating learning rate to 0.000125
tensor(74.6922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.9936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9282485 KL Loss: 42.3084550 DSM Loss: 48.0824765 Overall Loss:92.3191802
EarlyStopping counter: 1 out of 2
Updating learning rate to 6.25e-05
tensor(78.7140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.7432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 80 | MSE Loss: 1.9102878 KL Loss: 42.1080218 DSM Loss: 48.0582069 Overall Loss:92.0765162
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.863268256187439


Running on file CAT.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(117.7819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(129.0110, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.8848011 KL Loss: 41.9180465 DSM Loss: 76.8468319 Overall Loss:120.6496792
Validation loss decreased (inf --> 3.823237).  Saving model ...
Updating learning rate to 0.0005
tensor(103.8363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.8768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9145630 KL Loss: 42.0469344 DSM Loss: 49.7507573 Overall Loss:93.7122545
Validation loss decreased (3.823237 --> 3.418873).  Saving model ...
Updating learning rate to 0.00025
tensor(75.7816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.2046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.9193813 KL Loss: 42.4202354 DSM Loss: 47.8636466 Overall Loss:92.2032637
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.000125
tensor(67.7146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.6117, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 80 | MSE Loss: 1.9257792 KL Loss: 42.2503220 DSM Loss: 47.3756608 Overall Loss:91.5517613
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:7.297122955322266


Running on file CHTR.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(141.6229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.0253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 80 | MSE Loss: 1.9026212 KL Loss: 42.4597050 DSM Loss: 63.8339873 Overall Loss:108.1963136
Validation loss decreased (inf --> 3.031286).  Saving model ...
Updating learning rate to 0.0005
tensor(91.2556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.2149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 80 | MSE Loss: 1.9382802 KL Loss: 42.2496064 DSM Loss: 50.9374190 Overall Loss:95.1253061
EarlyStopping counter: 1 out of 2
Updating learning rate to 0.00025
tensor(86.2293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.3063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 80 | MSE Loss: 1.8966373 KL Loss: 41.9444910 DSM Loss: 48.3080821 Overall Loss:92.1492102
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
test 343
mse:0.12143243104219437


Running on file CMCSA.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl60>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1289
val 142
test 343
tensor(149.7524, device='cuda:0', grad_fn=<AddBackward0>)
