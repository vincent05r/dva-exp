Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=5, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=3, prediction_length=10, root_path='data/EcmP_stock_L_2016_24_dva_spec', scale=1, sequence_length=10, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.0405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8416913 KL Loss: 7.1803972 DSM Loss: 11.9854353 Overall Loss:21.0075238
Validation loss decreased (inf --> 8.477768).  Saving model ...
Updating learning rate to 0.0005
tensor(19.2348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8498647 KL Loss: 7.1963465 DSM Loss: 10.0967251 Overall Loss:19.1429361
Validation loss decreased (8.477768 --> 8.382969).  Saving model ...
Updating learning rate to 0.00025
tensor(21.3028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8033, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7656959 KL Loss: 7.1171457 DSM Loss: 9.6920846 Overall Loss:18.5749262
Validation loss decreased (8.382969 --> 7.634730).  Saving model ...
Updating learning rate to 0.000125
tensor(18.0212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7511265 KL Loss: 7.1192218 DSM Loss: 9.4060677 Overall Loss:18.2764160
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(12.6155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7713663 KL Loss: 7.1946632 DSM Loss: 9.3225850 Overall Loss:18.2886145
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(18.7913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7871043 KL Loss: 7.1638154 DSM Loss: 9.2301308 Overall Loss:18.1810504
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.262612342834473
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.1796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8403035 KL Loss: 7.2364071 DSM Loss: 13.6032053 Overall Loss:22.6799158
Validation loss decreased (inf --> 7.570389).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4856, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8476410 KL Loss: 7.0963453 DSM Loss: 10.4059051 Overall Loss:19.3498915
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.0357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7637594 KL Loss: 7.0864516 DSM Loss: 9.8870841 Overall Loss:18.7372951
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.5406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7885835 KL Loss: 7.1682503 DSM Loss: 9.6967699 Overall Loss:18.6536037
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.25607681274414
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.6967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8236341 KL Loss: 7.2259088 DSM Loss: 12.9417801 Overall Loss:21.9913231
Validation loss decreased (inf --> 8.355178).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7672462 KL Loss: 7.1372150 DSM Loss: 9.8665569 Overall Loss:18.7710180
Validation loss decreased (8.355178 --> 7.933199).  Saving model ...
Updating learning rate to 0.00025
tensor(22.3902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8023701 KL Loss: 7.1747694 DSM Loss: 9.7963493 Overall Loss:18.7734888
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.4571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8223932 KL Loss: 7.2346885 DSM Loss: 9.5467059 Overall Loss:18.6037877
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(25.4575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8376459 KL Loss: 7.2289635 DSM Loss: 9.2355326 Overall Loss:18.3021419
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.662073135375977
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8394271 KL Loss: 7.1995754 DSM Loss: 11.9192574 Overall Loss:20.9582600
Validation loss decreased (inf --> 8.186891).  Saving model ...
Updating learning rate to 0.0005
tensor(17.1859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8145695 KL Loss: 7.1155472 DSM Loss: 9.7786120 Overall Loss:18.7087288
Validation loss decreased (8.186891 --> 7.924987).  Saving model ...
Updating learning rate to 0.00025
tensor(21.9755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8028144 KL Loss: 7.1292275 DSM Loss: 9.7919813 Overall Loss:18.7240231
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(11.3344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7534063 KL Loss: 7.1644014 DSM Loss: 9.4545924 Overall Loss:18.3724001
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(12.6045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7293, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7512234 KL Loss: 7.1173538 DSM Loss: 9.2901059 Overall Loss:18.1586831
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.638177871704102
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.7246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8232204 KL Loss: 7.1948403 DSM Loss: 12.0032043 Overall Loss:21.0212651
Validation loss decreased (inf --> 7.537382).  Saving model ...
Updating learning rate to 0.0005
tensor(18.4268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8248935 KL Loss: 7.1625492 DSM Loss: 10.0667124 Overall Loss:19.0541552
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(23.5538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0744, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8622894 KL Loss: 7.1573547 DSM Loss: 9.7695283 Overall Loss:18.7891724
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(23.7917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1820, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7822471 KL Loss: 7.1810465 DSM Loss: 9.6760010 Overall Loss:18.6392946
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.228939056396484


Running on file ABBV.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.8684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8863825 KL Loss: 7.2626614 DSM Loss: 13.7788469 Overall Loss:22.9278905
Validation loss decreased (inf --> 9.871839).  Saving model ...
Updating learning rate to 0.0005
tensor(20.0446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7723530 KL Loss: 7.1385856 DSM Loss: 10.1325226 Overall Loss:19.0434614
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.6746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7906213 KL Loss: 7.1676715 DSM Loss: 9.6693656 Overall Loss:18.6276584
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.2450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7253535 KL Loss: 7.1219588 DSM Loss: 9.4134982 Overall Loss:18.2608106
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:17.105979919433594
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.0416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8186231 KL Loss: 7.2455225 DSM Loss: 12.3332293 Overall Loss:21.3973750
Validation loss decreased (inf --> 10.320326).  Saving model ...
Updating learning rate to 0.0005
tensor(24.2287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6374, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8165136 KL Loss: 7.1580228 DSM Loss: 10.0381690 Overall Loss:19.0127053
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.4575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7829360 KL Loss: 7.1430854 DSM Loss: 9.7212396 Overall Loss:18.6472610
Validation loss decreased (10.320326 --> 10.217635).  Saving model ...
Updating learning rate to 0.000125
tensor(15.7878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6000, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7756661 KL Loss: 7.1679812 DSM Loss: 9.3146206 Overall Loss:18.2582680
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.9395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7632076 KL Loss: 7.1311890 DSM Loss: 9.3611739 Overall Loss:18.2555705
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(24.0270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7155754 KL Loss: 7.1437508 DSM Loss: 9.3436176 Overall Loss:18.2029438
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:17.687255859375
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.1703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3480, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8046314 KL Loss: 7.1985204 DSM Loss: 11.4471552 Overall Loss:20.4503071
Validation loss decreased (inf --> 10.091388).  Saving model ...
Updating learning rate to 0.0005
tensor(21.7042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.3933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3367, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8171105 KL Loss: 7.1578736 DSM Loss: 9.9250749 Overall Loss:18.9000589
Validation loss decreased (10.091388 --> 9.307989).  Saving model ...
Updating learning rate to 0.00025
tensor(15.4458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8001358 KL Loss: 7.1522708 DSM Loss: 9.4812846 Overall Loss:18.4336912
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(14.5554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7549417 KL Loss: 7.1468978 DSM Loss: 9.4113902 Overall Loss:18.3132297
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.9649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7770633 KL Loss: 7.1438309 DSM Loss: 9.3389054 Overall Loss:18.2597995
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:16.395015716552734
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.4342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8064506 KL Loss: 7.1238918 DSM Loss: 11.4075277 Overall Loss:20.3378700
Validation loss decreased (inf --> 9.986124).  Saving model ...
Updating learning rate to 0.0005
tensor(24.4981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7798681 KL Loss: 7.1083388 DSM Loss: 9.8897384 Overall Loss:18.7779453
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.1838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8112766 KL Loss: 7.1969374 DSM Loss: 9.6935795 Overall Loss:18.7017935
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.0696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8227060 KL Loss: 7.2189236 DSM Loss: 9.2120372 Overall Loss:18.2536667
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:17.275318145751953
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.5422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7111, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8822228 KL Loss: 7.2213106 DSM Loss: 12.6198864 Overall Loss:21.7234199
Validation loss decreased (inf --> 9.085997).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8299484 KL Loss: 7.1995465 DSM Loss: 10.4358375 Overall Loss:19.4653323
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(13.7857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7737712 KL Loss: 7.1451940 DSM Loss: 9.6104040 Overall Loss:18.5293692
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.3706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7908968 KL Loss: 7.1591488 DSM Loss: 9.3905468 Overall Loss:18.3405924
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:16.31490135192871


Running on file AEP.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(32.7148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6054, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8170614 KL Loss: 7.1467471 DSM Loss: 11.7315989 Overall Loss:20.6954076
Validation loss decreased (inf --> 3.603902).  Saving model ...
Updating learning rate to 0.0005
tensor(20.1729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8464711 KL Loss: 7.2665117 DSM Loss: 9.9298843 Overall Loss:19.0428669
Validation loss decreased (3.603902 --> 2.883752).  Saving model ...
Updating learning rate to 0.00025
tensor(17.6710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8245657 KL Loss: 7.2184682 DSM Loss: 9.6745625 Overall Loss:18.7175965
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(21.6183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7874396 KL Loss: 7.1809318 DSM Loss: 9.4103953 Overall Loss:18.3787667
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.0401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7753358 KL Loss: 7.1971885 DSM Loss: 9.2901366 Overall Loss:18.2626608
Validation loss decreased (2.883752 --> 2.782138).  Saving model ...
Updating learning rate to 3.125e-05
tensor(17.5148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7542918 KL Loss: 7.1547230 DSM Loss: 9.3572667 Overall Loss:18.2662814
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(17.0007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7720775 KL Loss: 7.1311842 DSM Loss: 9.3000556 Overall Loss:18.2033173
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(19.1485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7956781 KL Loss: 7.2115365 DSM Loss: 9.3327861 Overall Loss:18.3400006
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.484708309173584
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.6396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8635527 KL Loss: 7.2559748 DSM Loss: 11.2822045 Overall Loss:20.4017321
Validation loss decreased (inf --> 2.793990).  Saving model ...
Updating learning rate to 0.0005
tensor(17.8532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8319944 KL Loss: 7.1531864 DSM Loss: 10.1184813 Overall Loss:19.1036621
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.7702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7873792 KL Loss: 7.1620111 DSM Loss: 9.6281193 Overall Loss:18.5775097
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(12.5633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7865890 KL Loss: 7.1872362 DSM Loss: 9.4834952 Overall Loss:18.4573205
Validation loss decreased (2.793990 --> 2.736567).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.5668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7839558 KL Loss: 7.1582877 DSM Loss: 9.3838210 Overall Loss:18.3260644
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(18.5147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7918100 KL Loss: 7.2433906 DSM Loss: 9.2865232 Overall Loss:18.3217237
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.6540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8011250 KL Loss: 7.2023889 DSM Loss: 9.1472444 Overall Loss:18.1507583
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.4319827556610107
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.3427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8375324 KL Loss: 7.1927637 DSM Loss: 11.6226573 Overall Loss:20.6529534
Validation loss decreased (inf --> 2.834312).  Saving model ...
Updating learning rate to 0.0005
tensor(23.9747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8352821 KL Loss: 7.2371608 DSM Loss: 9.9518522 Overall Loss:19.0242951
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.4300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8421646 KL Loss: 7.1432547 DSM Loss: 9.7600879 Overall Loss:18.7455073
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.7682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8058748 KL Loss: 7.1683539 DSM Loss: 9.4160547 Overall Loss:18.3902836
Validation loss decreased (2.834312 --> 2.651629).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.8722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8061926 KL Loss: 7.1982386 DSM Loss: 9.4703648 Overall Loss:18.4747960
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(18.6925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7917890 KL Loss: 7.2043495 DSM Loss: 9.2282609 Overall Loss:18.2243993
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(14.1224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7480548 KL Loss: 7.1164293 DSM Loss: 9.0891221 Overall Loss:17.9536062
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.3575289249420166
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8152100 KL Loss: 7.1892873 DSM Loss: 11.5229426 Overall Loss:20.5274401
Validation loss decreased (inf --> 2.871238).  Saving model ...
Updating learning rate to 0.0005
tensor(25.5845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5334, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8272803 KL Loss: 7.2156288 DSM Loss: 9.9485323 Overall Loss:18.9914413
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.5625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8007519 KL Loss: 7.0949980 DSM Loss: 9.5761335 Overall Loss:18.4718835
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.8364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8071999 KL Loss: 7.1870619 DSM Loss: 9.2556357 Overall Loss:18.2498973
Validation loss decreased (2.871238 --> 2.729429).  Saving model ...
Updating learning rate to 6.25e-05
tensor(21.5672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7735, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7060807 KL Loss: 7.0553947 DSM Loss: 9.2102134 Overall Loss:17.9716887
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(20.9613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7290368 KL Loss: 7.1256730 DSM Loss: 9.3987263 Overall Loss:18.2534360
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(15.3671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7796454 KL Loss: 7.1410807 DSM Loss: 9.2026210 Overall Loss:18.1233472
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.4196765422821045
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(32.2732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8290921 KL Loss: 7.1644956 DSM Loss: 11.4094228 Overall Loss:20.4030105
Validation loss decreased (inf --> 2.726606).  Saving model ...
Updating learning rate to 0.0005
tensor(22.2099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8030750 KL Loss: 7.1681004 DSM Loss: 10.2464660 Overall Loss:19.2176414
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.9129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8034062 KL Loss: 7.1703186 DSM Loss: 9.5564533 Overall Loss:18.5301781
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.2382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7650562 KL Loss: 7.1496844 DSM Loss: 9.2992133 Overall Loss:18.2139539
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.4062423706054688


Running on file AMGN.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9477, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8762436 KL Loss: 7.2432633 DSM Loss: 12.3521767 Overall Loss:21.4716836
Validation loss decreased (inf --> 1.563639).  Saving model ...
Updating learning rate to 0.0005
tensor(20.7450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8919, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8104816 KL Loss: 7.1099129 DSM Loss: 10.2374040 Overall Loss:19.1577985
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(14.1333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7692517 KL Loss: 7.1225728 DSM Loss: 9.7361231 Overall Loss:18.6279474
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.7254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7956448 KL Loss: 7.1710535 DSM Loss: 9.4160425 Overall Loss:18.3827408
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.8656840324401855
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.8311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8244180 KL Loss: 7.2213137 DSM Loss: 13.0437546 Overall Loss:22.0894864
Validation loss decreased (inf --> 2.130691).  Saving model ...
Updating learning rate to 0.0005
tensor(27.2178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8573666 KL Loss: 7.2212597 DSM Loss: 10.1869963 Overall Loss:19.2656224
Validation loss decreased (2.130691 --> 1.854541).  Saving model ...
Updating learning rate to 0.00025
tensor(17.8537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8803458 KL Loss: 7.2747562 DSM Loss: 9.6682440 Overall Loss:18.8233459
Validation loss decreased (1.854541 --> 1.716321).  Saving model ...
Updating learning rate to 0.000125
tensor(21.1553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8078291 KL Loss: 7.1775101 DSM Loss: 9.4352789 Overall Loss:18.4206180
Validation loss decreased (1.716321 --> 1.680755).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.0879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7574847 KL Loss: 7.1220961 DSM Loss: 9.4435901 Overall Loss:18.3231710
Validation loss decreased (1.680755 --> 1.579439).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.2948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7825230 KL Loss: 7.1907247 DSM Loss: 9.3289837 Overall Loss:18.3022315
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(19.6205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7771913 KL Loss: 7.1423492 DSM Loss: 9.4092727 Overall Loss:18.3288131
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(17.3187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7562272 KL Loss: 7.1112397 DSM Loss: 9.4107258 Overall Loss:18.2781927
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.8593902587890625
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.3149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8597495 KL Loss: 7.2490506 DSM Loss: 12.0335264 Overall Loss:21.1423264
Validation loss decreased (inf --> 1.656289).  Saving model ...
Updating learning rate to 0.0005
tensor(15.6057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3058, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8187905 KL Loss: 7.1442216 DSM Loss: 10.2336282 Overall Loss:19.1966402
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(22.2671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8033137 KL Loss: 7.1898618 DSM Loss: 9.7806830 Overall Loss:18.7738585
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.4798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8418, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7777579 KL Loss: 7.1208571 DSM Loss: 9.5468649 Overall Loss:18.4454800
Validation loss decreased (1.656289 --> 1.608754).  Saving model ...
Updating learning rate to 6.25e-05
tensor(13.4494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8034342 KL Loss: 7.1927954 DSM Loss: 9.5187684 Overall Loss:18.5149979
Validation loss decreased (1.608754 --> 1.584020).  Saving model ...
Updating learning rate to 3.125e-05
tensor(21.4851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7625508 KL Loss: 7.1791197 DSM Loss: 9.2713228 Overall Loss:18.2129933
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(16.4642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7598127 KL Loss: 7.1228379 DSM Loss: 9.3484867 Overall Loss:18.2311371
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(19.6214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7643613 KL Loss: 7.1798334 DSM Loss: 9.3835658 Overall Loss:18.3277606
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.892617702484131
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.9323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8468586 KL Loss: 7.2409857 DSM Loss: 11.2394414 Overall Loss:20.3272858
Validation loss decreased (inf --> 1.685060).  Saving model ...
Updating learning rate to 0.0005
tensor(15.2424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8257097 KL Loss: 7.1963682 DSM Loss: 10.0192759 Overall Loss:19.0413541
Validation loss decreased (1.685060 --> 1.377047).  Saving model ...
Updating learning rate to 0.00025
tensor(18.6037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8019168 KL Loss: 7.1567391 DSM Loss: 9.5890774 Overall Loss:18.5477333
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.5746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5361, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7579946 KL Loss: 7.1328790 DSM Loss: 9.4663298 Overall Loss:18.3572034
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(17.7988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1562, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7589331 KL Loss: 7.1691082 DSM Loss: 9.3768843 Overall Loss:18.3049255
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.51855993270874
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.3475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7785239 KL Loss: 7.1690497 DSM Loss: 11.4452988 Overall Loss:20.3928724
Validation loss decreased (inf --> 1.406745).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7628, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8453262 KL Loss: 7.1451601 DSM Loss: 10.0228760 Overall Loss:19.0133621
Validation loss decreased (1.406745 --> 1.391237).  Saving model ...
Updating learning rate to 0.00025
tensor(20.3286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8163431 KL Loss: 7.1917339 DSM Loss: 9.6716876 Overall Loss:18.6797646
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(21.8466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8435628 KL Loss: 7.2305943 DSM Loss: 9.3901759 Overall Loss:18.4643331
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.6527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7836203 KL Loss: 7.1520718 DSM Loss: 9.3106124 Overall Loss:18.2463045
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.541816234588623


Running on file AMZN.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.5943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8332283 KL Loss: 7.2335644 DSM Loss: 11.6560514 Overall Loss:20.7228439
Validation loss decreased (inf --> 2.938809).  Saving model ...
Updating learning rate to 0.0005
tensor(21.0888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8083091 KL Loss: 7.1830764 DSM Loss: 10.2358108 Overall Loss:19.2271961
Validation loss decreased (2.938809 --> 1.864758).  Saving model ...
Updating learning rate to 0.00025
tensor(16.1328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7718962 KL Loss: 7.0769521 DSM Loss: 9.8404634 Overall Loss:18.6893117
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.3257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.6715874 KL Loss: 6.9930046 DSM Loss: 9.4910732 Overall Loss:18.1556653
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.4916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7469989 KL Loss: 7.1251132 DSM Loss: 9.4332023 Overall Loss:18.3053144
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.3672727942466736
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9684, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8227345 KL Loss: 7.2132474 DSM Loss: 11.2861826 Overall Loss:20.3221645
Validation loss decreased (inf --> 2.435876).  Saving model ...
Updating learning rate to 0.0005
tensor(22.2593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8043629 KL Loss: 7.1739398 DSM Loss: 9.9871456 Overall Loss:18.9654481
Validation loss decreased (2.435876 --> 2.268374).  Saving model ...
Updating learning rate to 0.00025
tensor(21.3629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8344366 KL Loss: 7.1761396 DSM Loss: 9.8788226 Overall Loss:18.8893988
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.2459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7608563 KL Loss: 7.0934002 DSM Loss: 9.4278214 Overall Loss:18.2820780
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.4296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7074465 KL Loss: 7.0822685 DSM Loss: 9.5938589 Overall Loss:18.3835738
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.4601009488105774
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.8063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8079970 KL Loss: 7.1443734 DSM Loss: 11.7753443 Overall Loss:20.7277148
Validation loss decreased (inf --> 3.306687).  Saving model ...
Updating learning rate to 0.0005
tensor(18.9733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7860614 KL Loss: 7.1075370 DSM Loss: 10.3806212 Overall Loss:19.2742196
Validation loss decreased (3.306687 --> 2.765851).  Saving model ...
Updating learning rate to 0.00025
tensor(18.0657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7796778 KL Loss: 7.1534764 DSM Loss: 9.7235744 Overall Loss:18.6567286
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(24.6586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7990497 KL Loss: 7.2144308 DSM Loss: 9.4600709 Overall Loss:18.4735515
Validation loss decreased (2.765851 --> 2.707532).  Saving model ...
Updating learning rate to 6.25e-05
tensor(20.4047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7127902 KL Loss: 7.0732384 DSM Loss: 9.5395348 Overall Loss:18.3255634
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(22.5995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7589513 KL Loss: 7.1703661 DSM Loss: 9.3563997 Overall Loss:18.2857171
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(14.0354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7788614 KL Loss: 7.1768212 DSM Loss: 9.4250124 Overall Loss:18.3806949
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5686590075492859
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.4068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8633666 KL Loss: 7.2843427 DSM Loss: 11.4967021 Overall Loss:20.6444116
Validation loss decreased (inf --> 2.783252).  Saving model ...
Updating learning rate to 0.0005
tensor(17.1664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7800257 KL Loss: 7.0605229 DSM Loss: 10.0482965 Overall Loss:18.8888450
Validation loss decreased (2.783252 --> 2.682323).  Saving model ...
Updating learning rate to 0.00025
tensor(14.2543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7888815 KL Loss: 7.1642540 DSM Loss: 9.6974835 Overall Loss:18.6506189
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.4891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9675, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7807245 KL Loss: 7.1561527 DSM Loss: 9.3887501 Overall Loss:18.3256271
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.8129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7635412 KL Loss: 7.1185303 DSM Loss: 9.3891819 Overall Loss:18.2712533
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5847895741462708
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.7888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0293, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8143370 KL Loss: 7.1971948 DSM Loss: 12.2309216 Overall Loss:21.2424533
Validation loss decreased (inf --> 2.273124).  Saving model ...
Updating learning rate to 0.0005
tensor(18.5653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8012441 KL Loss: 7.2050468 DSM Loss: 9.9592902 Overall Loss:18.9655810
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.0560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7936599 KL Loss: 7.1860330 DSM Loss: 9.6385803 Overall Loss:18.6182733
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.3182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8343, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7756940 KL Loss: 7.1489403 DSM Loss: 9.5610318 Overall Loss:18.4856661
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.39065462350845337


Running on file BA.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.8378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9161107 KL Loss: 7.2393466 DSM Loss: 11.8578236 Overall Loss:21.0132809
Validation loss decreased (inf --> 0.228559).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8550465 KL Loss: 7.1625607 DSM Loss: 10.4030082 Overall Loss:19.4206155
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.3067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8225939 KL Loss: 7.2134825 DSM Loss: 9.7252406 Overall Loss:18.7613169
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.9337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5058, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8073545 KL Loss: 7.2172055 DSM Loss: 9.5490185 Overall Loss:18.5735784
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.393669456243515
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.5509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8341586 KL Loss: 7.1846864 DSM Loss: 12.6635098 Overall Loss:21.6823548
Validation loss decreased (inf --> 0.129534).  Saving model ...
Updating learning rate to 0.0005
tensor(20.2969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8055079 KL Loss: 7.1608406 DSM Loss: 10.1180617 Overall Loss:19.0844103
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(13.7595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8444551 KL Loss: 7.2234362 DSM Loss: 9.8307082 Overall Loss:18.8985995
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.6371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7758973 KL Loss: 7.1428215 DSM Loss: 9.4972032 Overall Loss:18.4159219
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.27012279629707336
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.5823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8442439 KL Loss: 7.2003107 DSM Loss: 11.6659088 Overall Loss:20.7104633
Validation loss decreased (inf --> 0.165778).  Saving model ...
Updating learning rate to 0.0005
tensor(18.3598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8713397 KL Loss: 7.1943976 DSM Loss: 10.2596765 Overall Loss:19.3254138
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.8571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2098, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7799631 KL Loss: 7.1724198 DSM Loss: 9.7887928 Overall Loss:18.7411756
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.2593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9905, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8142908 KL Loss: 7.1772163 DSM Loss: 9.5237966 Overall Loss:18.5153036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.32649317383766174
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.1982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8622997 KL Loss: 7.2081174 DSM Loss: 12.0558115 Overall Loss:21.1262286
Validation loss decreased (inf --> 0.154149).  Saving model ...
Updating learning rate to 0.0005
tensor(16.2320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7755251 KL Loss: 7.1410890 DSM Loss: 10.0262285 Overall Loss:18.9428426
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.4977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7705806 KL Loss: 7.1346118 DSM Loss: 9.7095127 Overall Loss:18.6147050
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.2699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7647793 KL Loss: 7.2049551 DSM Loss: 9.5233629 Overall Loss:18.4930972
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.312516987323761
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.8140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8418670 KL Loss: 7.1674995 DSM Loss: 12.2772999 Overall Loss:21.2866663
Validation loss decreased (inf --> 0.218331).  Saving model ...
Updating learning rate to 0.0005
tensor(18.1783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8467540 KL Loss: 7.2476138 DSM Loss: 10.2523166 Overall Loss:19.3466846
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.2917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3559, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8250777 KL Loss: 7.1585578 DSM Loss: 9.7861227 Overall Loss:18.7697581
Validation loss decreased (0.218331 --> 0.213319).  Saving model ...
Updating learning rate to 0.000125
tensor(20.0201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7316693 KL Loss: 7.0869057 DSM Loss: 9.6317375 Overall Loss:18.4503125
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.7123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7733556 KL Loss: 7.1876534 DSM Loss: 9.3932963 Overall Loss:18.3543051
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(18.2782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7452710 KL Loss: 7.1370073 DSM Loss: 9.5336820 Overall Loss:18.4159602
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.39352497458457947


Running on file BAC.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(32.9042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8740342 KL Loss: 7.1981117 DSM Loss: 11.7998675 Overall Loss:20.8720132
Validation loss decreased (inf --> 7.067468).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8336147 KL Loss: 7.1940329 DSM Loss: 9.8949473 Overall Loss:18.9225948
Validation loss decreased (7.067468 --> 6.349495).  Saving model ...
Updating learning rate to 0.00025
tensor(20.6341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7759870 KL Loss: 7.1269651 DSM Loss: 9.5621717 Overall Loss:18.4651239
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(14.5882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7519938 KL Loss: 7.1232089 DSM Loss: 9.4461623 Overall Loss:18.3213649
Validation loss decreased (6.349495 --> 5.924436).  Saving model ...
Updating learning rate to 6.25e-05
tensor(14.4054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7866576 KL Loss: 7.1470046 DSM Loss: 9.3529629 Overall Loss:18.2866251
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(18.5238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7602697 KL Loss: 7.1213512 DSM Loss: 9.2125151 Overall Loss:18.0941361
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(25.9273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5996, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7545262 KL Loss: 7.1725792 DSM Loss: 9.2048528 Overall Loss:18.1319582
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8447479605674744
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(38.3024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9344, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8758579 KL Loss: 7.2522391 DSM Loss: 11.5897717 Overall Loss:20.7178686
Validation loss decreased (inf --> 7.312330).  Saving model ...
Updating learning rate to 0.0005
tensor(17.4855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8706528 KL Loss: 7.2443875 DSM Loss: 9.6393647 Overall Loss:18.7544049
Validation loss decreased (7.312330 --> 6.494490).  Saving model ...
Updating learning rate to 0.00025
tensor(23.2567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8140835 KL Loss: 7.2029964 DSM Loss: 9.4996255 Overall Loss:18.5167054
Validation loss decreased (6.494490 --> 6.290416).  Saving model ...
Updating learning rate to 0.000125
tensor(13.4960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7834879 KL Loss: 7.1242781 DSM Loss: 9.3282838 Overall Loss:18.2360499
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(21.5379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8203189 KL Loss: 7.1978527 DSM Loss: 9.4103017 Overall Loss:18.4284733
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.1117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8012723 KL Loss: 7.1951886 DSM Loss: 9.1167290 Overall Loss:18.1131900
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9783074855804443
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.7625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8635654 KL Loss: 7.2148229 DSM Loss: 11.5720292 Overall Loss:20.6504176
Validation loss decreased (inf --> 7.439334).  Saving model ...
Updating learning rate to 0.0005
tensor(17.4244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7966933 KL Loss: 7.1881528 DSM Loss: 10.2390916 Overall Loss:19.2239377
Validation loss decreased (7.439334 --> 6.236425).  Saving model ...
Updating learning rate to 0.00025
tensor(24.5946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7897689 KL Loss: 7.1152527 DSM Loss: 9.8096152 Overall Loss:18.7146368
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(11.9134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0974, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7615817 KL Loss: 7.1793027 DSM Loss: 9.0970014 Overall Loss:18.0378857
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.3983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7564779 KL Loss: 7.1009441 DSM Loss: 9.5295917 Overall Loss:18.3870136
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.946009635925293
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.3984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8326284 KL Loss: 7.2295759 DSM Loss: 11.0327995 Overall Loss:20.0950038
Validation loss decreased (inf --> 7.743657).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8208184 KL Loss: 7.1992103 DSM Loss: 10.2077481 Overall Loss:19.2277769
Validation loss decreased (7.743657 --> 3.909972).  Saving model ...
Updating learning rate to 0.00025
tensor(20.6602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8277004 KL Loss: 7.1893143 DSM Loss: 9.5370459 Overall Loss:18.5540606
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(13.4405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9054, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7651894 KL Loss: 7.1374182 DSM Loss: 9.3280095 Overall Loss:18.2306172
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.1614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.0044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7701422 KL Loss: 7.1733647 DSM Loss: 9.3319329 Overall Loss:18.2754398
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.3478662371635437
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(32.2368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2242, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8229113 KL Loss: 7.2069522 DSM Loss: 12.1068095 Overall Loss:21.1366729
Validation loss decreased (inf --> 6.188166).  Saving model ...
Updating learning rate to 0.0005
tensor(19.7070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8243536 KL Loss: 7.1599220 DSM Loss: 10.4865489 Overall Loss:19.4708245
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.3942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8733901 KL Loss: 7.2737822 DSM Loss: 9.4026137 Overall Loss:18.5497859
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.5658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7630617 KL Loss: 7.1061220 DSM Loss: 9.4654439 Overall Loss:18.3346275
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9258416295051575


Running on file BCH.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.6862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8456190 KL Loss: 7.2770631 DSM Loss: 11.4552951 Overall Loss:20.5779770
Validation loss decreased (inf --> 0.500136).  Saving model ...
Updating learning rate to 0.0005
tensor(23.8631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8383308 KL Loss: 7.1998958 DSM Loss: 9.9900425 Overall Loss:19.0282691
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.0519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7864, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8331825 KL Loss: 7.2394994 DSM Loss: 9.6432137 Overall Loss:18.7158955
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.7283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7551018 KL Loss: 7.1610025 DSM Loss: 9.5575184 Overall Loss:18.4736227
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.17063842713832855
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.8647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8762187 KL Loss: 7.2097770 DSM Loss: 11.7045299 Overall Loss:20.7905257
Validation loss decreased (inf --> 0.786251).  Saving model ...
Updating learning rate to 0.0005
tensor(17.4363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8273903 KL Loss: 7.1853296 DSM Loss: 9.9828700 Overall Loss:18.9955898
Validation loss decreased (0.786251 --> 0.730170).  Saving model ...
Updating learning rate to 0.00025
tensor(21.0658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7464956 KL Loss: 7.1436522 DSM Loss: 9.6669698 Overall Loss:18.5571176
Validation loss decreased (0.730170 --> 0.723258).  Saving model ...
Updating learning rate to 0.000125
tensor(18.0749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7682725 KL Loss: 7.1305685 DSM Loss: 9.5249808 Overall Loss:18.4238217
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.8337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7756507 KL Loss: 7.1925763 DSM Loss: 9.5653501 Overall Loss:18.5335771
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.5259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7920228 KL Loss: 7.1439043 DSM Loss: 9.3893132 Overall Loss:18.3252403
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.2703573405742645
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.3033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6344, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8747481 KL Loss: 7.2361664 DSM Loss: 11.6577115 Overall Loss:20.7686260
Validation loss decreased (inf --> 0.853056).  Saving model ...
Updating learning rate to 0.0005
tensor(18.7845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3735, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7378562 KL Loss: 7.1048091 DSM Loss: 10.2051442 Overall Loss:19.0478096
Validation loss decreased (0.853056 --> 0.662738).  Saving model ...
Updating learning rate to 0.00025
tensor(20.4564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8192549 KL Loss: 7.1896389 DSM Loss: 9.6948964 Overall Loss:18.7037901
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(14.6286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7657202 KL Loss: 7.1535866 DSM Loss: 9.5353193 Overall Loss:18.4546260
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.2184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7456352 KL Loss: 7.1482562 DSM Loss: 9.5164520 Overall Loss:18.4103435
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.257336288690567
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.8346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8800383 KL Loss: 7.2090182 DSM Loss: 11.7166075 Overall Loss:20.8056640
Validation loss decreased (inf --> 0.344697).  Saving model ...
Updating learning rate to 0.0005
tensor(16.9587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7537658 KL Loss: 7.1329558 DSM Loss: 10.1644877 Overall Loss:19.0512092
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.5512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8035181 KL Loss: 7.1745739 DSM Loss: 9.6483515 Overall Loss:18.6264436
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.8552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7862460 KL Loss: 7.1964686 DSM Loss: 9.5037454 Overall Loss:18.4864601
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.312154084444046
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.2705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8786075 KL Loss: 7.2445177 DSM Loss: 12.8802770 Overall Loss:22.0034022
Validation loss decreased (inf --> 0.397296).  Saving model ...
Updating learning rate to 0.0005
tensor(20.7194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1354, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8091150 KL Loss: 7.2002916 DSM Loss: 10.4638405 Overall Loss:19.4732472
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.7902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7529245 KL Loss: 7.0619306 DSM Loss: 9.8340436 Overall Loss:18.6488988
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.5440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8243373 KL Loss: 7.2151210 DSM Loss: 9.5008330 Overall Loss:18.5402913
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.21193473041057587


Running on file BHP.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.0254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8830548 KL Loss: 7.2829671 DSM Loss: 12.8281248 Overall Loss:21.9941468
Validation loss decreased (inf --> 2.115248).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7892538 KL Loss: 7.1908350 DSM Loss: 9.7821598 Overall Loss:18.7622486
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(22.3587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7905885 KL Loss: 7.1338855 DSM Loss: 9.4192471 Overall Loss:18.3437210
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.3933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7511333 KL Loss: 7.1435501 DSM Loss: 9.2080707 Overall Loss:18.1027539
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.339751720428467
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(34.4887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5018, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8610926 KL Loss: 7.2793118 DSM Loss: 12.5089565 Overall Loss:21.6493611
Validation loss decreased (inf --> 2.244996).  Saving model ...
Updating learning rate to 0.0005
tensor(20.1401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8308197 KL Loss: 7.2233136 DSM Loss: 9.9722524 Overall Loss:19.0263857
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(23.9790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7810419 KL Loss: 7.1682906 DSM Loss: 9.4345237 Overall Loss:18.3838562
Validation loss decreased (2.244996 --> 1.884244).  Saving model ...
Updating learning rate to 0.000125
tensor(19.8297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7814115 KL Loss: 7.1221301 DSM Loss: 9.5906458 Overall Loss:18.4941873
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.8916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7911275 KL Loss: 7.1435790 DSM Loss: 9.1623592 Overall Loss:18.0970658
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.7445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5579, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7609049 KL Loss: 7.1763302 DSM Loss: 9.2117505 Overall Loss:18.1489857
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.080209255218506
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.5797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8757033 KL Loss: 7.2383295 DSM Loss: 11.3830672 Overall Loss:20.4971002
Validation loss decreased (inf --> 2.038358).  Saving model ...
Updating learning rate to 0.0005
tensor(12.4442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7635073 KL Loss: 7.1393726 DSM Loss: 9.8230837 Overall Loss:18.7259636
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.4431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1216, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7736777 KL Loss: 7.1529405 DSM Loss: 9.4728761 Overall Loss:18.3994943
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(12.8419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8060650 KL Loss: 7.2518512 DSM Loss: 9.3035639 Overall Loss:18.3614801
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.2833094596862793
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.8408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7721855 KL Loss: 7.2624482 DSM Loss: 12.5496577 Overall Loss:21.5842913
Validation loss decreased (inf --> 2.057998).  Saving model ...
Updating learning rate to 0.0005
tensor(16.1243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8848, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8245466 KL Loss: 7.2043382 DSM Loss: 9.8078816 Overall Loss:18.8367663
Validation loss decreased (2.057998 --> 1.987208).  Saving model ...
Updating learning rate to 0.00025
tensor(18.0612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8137305 KL Loss: 7.2032001 DSM Loss: 9.4117747 Overall Loss:18.4287053
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.0986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8098555 KL Loss: 7.2485097 DSM Loss: 9.3726578 Overall Loss:18.4310231
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.3389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8643691 KL Loss: 7.2466015 DSM Loss: 9.1028736 Overall Loss:18.2138444
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.2091517448425293
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.3184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8194090 KL Loss: 7.1939209 DSM Loss: 11.5795023 Overall Loss:20.5928322
Validation loss decreased (inf --> 2.386818).  Saving model ...
Updating learning rate to 0.0005
tensor(16.8475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7959061 KL Loss: 7.1194390 DSM Loss: 10.0560467 Overall Loss:18.9713916
Validation loss decreased (2.386818 --> 2.255846).  Saving model ...
Updating learning rate to 0.00025
tensor(16.0657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7884896 KL Loss: 7.1494189 DSM Loss: 9.4592399 Overall Loss:18.3971485
Validation loss decreased (2.255846 --> 2.191406).  Saving model ...
Updating learning rate to 0.000125
tensor(14.7283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7561547 KL Loss: 7.1624759 DSM Loss: 9.2090056 Overall Loss:18.1276362
Validation loss decreased (2.191406 --> 2.189361).  Saving model ...
Updating learning rate to 6.25e-05
tensor(13.9511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7896201 KL Loss: 7.1929748 DSM Loss: 9.1190796 Overall Loss:18.1016745
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(17.1333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7800939 KL Loss: 7.1845552 DSM Loss: 9.4150877 Overall Loss:18.3797369
Validation loss decreased (2.189361 --> 2.148231).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(19.1748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8205, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7585508 KL Loss: 7.1669854 DSM Loss: 9.1151891 Overall Loss:18.0407253
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(21.4948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7273625 KL Loss: 7.0871403 DSM Loss: 9.1824362 Overall Loss:17.9969390
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(16.6844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7138462 KL Loss: 7.0797896 DSM Loss: 9.2321134 Overall Loss:18.0257492
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.4243969917297363


Running on file BP.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.6940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8980702 KL Loss: 7.2462033 DSM Loss: 11.2297570 Overall Loss:20.3740306
Validation loss decreased (inf --> 0.251550).  Saving model ...
Updating learning rate to 0.0005
tensor(19.5995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8318191 KL Loss: 7.1928554 DSM Loss: 10.1954707 Overall Loss:19.2201452
Validation loss decreased (0.251550 --> 0.203462).  Saving model ...
Updating learning rate to 0.00025
tensor(20.5934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8239416 KL Loss: 7.0927331 DSM Loss: 9.8705792 Overall Loss:18.7872539
Validation loss decreased (0.203462 --> 0.159472).  Saving model ...
Updating learning rate to 0.000125
tensor(20.0558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7517151 KL Loss: 7.0712288 DSM Loss: 9.5322205 Overall Loss:18.3551644
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.3834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7348370 KL Loss: 7.0579708 DSM Loss: 9.4984244 Overall Loss:18.2912320
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.6912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7671444 KL Loss: 7.1506607 DSM Loss: 9.4322313 Overall Loss:18.3500364
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.1014838218688965
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.2570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8211333 KL Loss: 7.2399929 DSM Loss: 12.1994089 Overall Loss:21.2605350
Validation loss decreased (inf --> 0.173282).  Saving model ...
Updating learning rate to 0.0005
tensor(17.5289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6982, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8742297 KL Loss: 7.2338915 DSM Loss: 10.4079732 Overall Loss:19.5160945
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.1862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8198878 KL Loss: 7.2395178 DSM Loss: 10.0027733 Overall Loss:19.0621789
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.1210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7769598 KL Loss: 7.1911989 DSM Loss: 9.6133698 Overall Loss:18.5815286
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.1428442001342773
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.7649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8321515 KL Loss: 7.2285652 DSM Loss: 11.7827853 Overall Loss:20.8435019
Validation loss decreased (inf --> 0.203303).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8317834 KL Loss: 7.1617332 DSM Loss: 10.2842512 Overall Loss:19.2777679
Validation loss decreased (0.203303 --> 0.168345).  Saving model ...
Updating learning rate to 0.00025
tensor(19.3591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8425833 KL Loss: 7.1828487 DSM Loss: 9.7395174 Overall Loss:18.7649493
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(22.4468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7600006 KL Loss: 7.1727721 DSM Loss: 9.5943777 Overall Loss:18.5271504
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.2447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7782312 KL Loss: 7.2069706 DSM Loss: 9.6793600 Overall Loss:18.6645618
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.4919259548187256
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.4695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8407188 KL Loss: 7.1771743 DSM Loss: 11.1545057 Overall Loss:20.1723989
Validation loss decreased (inf --> 0.213772).  Saving model ...
Updating learning rate to 0.0005
tensor(19.8354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8390555 KL Loss: 7.2202917 DSM Loss: 10.2747667 Overall Loss:19.3341141
Validation loss decreased (0.213772 --> 0.181972).  Saving model ...
Updating learning rate to 0.00025
tensor(19.5523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7798006 KL Loss: 7.1787717 DSM Loss: 9.7737468 Overall Loss:18.7323190
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.9689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7973621 KL Loss: 7.1919453 DSM Loss: 9.5063149 Overall Loss:18.4956222
Validation loss decreased (0.181972 --> 0.181056).  Saving model ...
Updating learning rate to 6.25e-05
tensor(21.7394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7890891 KL Loss: 7.1689385 DSM Loss: 9.5846948 Overall Loss:18.5427224
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(15.3871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7690301 KL Loss: 7.1377010 DSM Loss: 9.3544529 Overall Loss:18.2611839
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(18.2004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5415, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8019533 KL Loss: 7.2701646 DSM Loss: 9.4632247 Overall Loss:18.5353425
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.4280552864074707
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.4125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8672970 KL Loss: 7.2404238 DSM Loss: 12.2324184 Overall Loss:21.3401392
Validation loss decreased (inf --> 0.174194).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8551039 KL Loss: 7.1605916 DSM Loss: 10.1798607 Overall Loss:19.1955562
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.4467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8644971 KL Loss: 7.1452870 DSM Loss: 9.7448000 Overall Loss:18.7545840
Validation loss decreased (0.174194 --> 0.172011).  Saving model ...
Updating learning rate to 0.000125
tensor(16.9729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7227335 KL Loss: 7.1027514 DSM Loss: 9.6964787 Overall Loss:18.5219635
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.7255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7593942 KL Loss: 7.1361661 DSM Loss: 9.4475156 Overall Loss:18.3430759
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.4428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7874556 KL Loss: 7.1680048 DSM Loss: 9.5756403 Overall Loss:18.5311009
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.438695192337036


Running on file BRK-A.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.9618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8533025 KL Loss: 7.1858998 DSM Loss: 11.6578834 Overall Loss:20.6970857
Validation loss decreased (inf --> 9.593109).  Saving model ...
Updating learning rate to 0.0005
tensor(21.2342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8141828 KL Loss: 7.1768101 DSM Loss: 9.5620384 Overall Loss:18.5530314
Validation loss decreased (9.593109 --> 9.060917).  Saving model ...
Updating learning rate to 0.00025
tensor(20.2491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4562, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8384713 KL Loss: 7.1202488 DSM Loss: 9.4052015 Overall Loss:18.3639215
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.6970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7698853 KL Loss: 7.1277838 DSM Loss: 9.0487887 Overall Loss:17.9464579
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(13.6865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7875243 KL Loss: 7.1255363 DSM Loss: 9.0477084 Overall Loss:17.9607690
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:11.809981346130371
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.4101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8393504 KL Loss: 7.2439819 DSM Loss: 11.3799171 Overall Loss:20.4632495
Validation loss decreased (inf --> 10.498985).  Saving model ...
Updating learning rate to 0.0005
tensor(21.5504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5980, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8157015 KL Loss: 7.1783621 DSM Loss: 9.7600217 Overall Loss:18.7540852
Validation loss decreased (10.498985 --> 10.038667).  Saving model ...
Updating learning rate to 0.00025
tensor(25.9987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8484611 KL Loss: 7.1843258 DSM Loss: 9.4938501 Overall Loss:18.5266368
Validation loss decreased (10.038667 --> 9.949660).  Saving model ...
Updating learning rate to 0.000125
tensor(16.0106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7830102 KL Loss: 7.1477526 DSM Loss: 9.2296443 Overall Loss:18.1604070
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(18.1525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7045740 KL Loss: 7.1007794 DSM Loss: 9.4574373 Overall Loss:18.2627907
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(16.4772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7810982 KL Loss: 7.2268817 DSM Loss: 9.0981387 Overall Loss:18.1061187
Validation loss decreased (9.949660 --> 9.619573).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(21.7776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7450429 KL Loss: 7.0757170 DSM Loss: 9.1195712 Overall Loss:17.9403311
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(19.5200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7597188 KL Loss: 7.1939033 DSM Loss: 9.0498638 Overall Loss:18.0034860
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(19.9268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7538777 KL Loss: 7.1653387 DSM Loss: 9.0695536 Overall Loss:17.9887699
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.455194473266602
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(18.6357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8047000 KL Loss: 7.2074112 DSM Loss: 11.8636741 Overall Loss:20.8757854
Validation loss decreased (inf --> 10.060274).  Saving model ...
Updating learning rate to 0.0005
tensor(15.4113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7536445 KL Loss: 7.1639047 DSM Loss: 9.7106766 Overall Loss:18.6282258
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(25.1959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9828, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8611331 KL Loss: 7.2707772 DSM Loss: 9.6148609 Overall Loss:18.7467712
Validation loss decreased (10.060274 --> 8.812955).  Saving model ...
Updating learning rate to 0.000125
tensor(16.7643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8268283 KL Loss: 7.2404627 DSM Loss: 8.9928515 Overall Loss:18.0601425
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(22.9213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7682269 KL Loss: 7.1398972 DSM Loss: 9.2613735 Overall Loss:18.1694975
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(15.4051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7780539 KL Loss: 7.1663853 DSM Loss: 9.0425392 Overall Loss:17.9869784
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:11.529876708984375
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.5966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8841267 KL Loss: 7.2335593 DSM Loss: 11.3264764 Overall Loss:20.4441624
Validation loss decreased (inf --> 9.399376).  Saving model ...
Updating learning rate to 0.0005
tensor(20.5576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8394784 KL Loss: 7.2171869 DSM Loss: 9.7473308 Overall Loss:18.8039961
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.1162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8026524 KL Loss: 7.1913977 DSM Loss: 9.3824869 Overall Loss:18.3765372
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.5124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7514626 KL Loss: 7.1350353 DSM Loss: 9.2694236 Overall Loss:18.1559213
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.19997787475586
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.9192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8604666 KL Loss: 7.2457399 DSM Loss: 12.7952073 Overall Loss:21.9014137
Validation loss decreased (inf --> 9.821035).  Saving model ...
Updating learning rate to 0.0005
tensor(21.5760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7790781 KL Loss: 7.1676898 DSM Loss: 10.2276289 Overall Loss:19.1743967
Validation loss decreased (9.821035 --> 9.602647).  Saving model ...
Updating learning rate to 0.00025
tensor(16.9048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7838089 KL Loss: 7.1767731 DSM Loss: 9.3080104 Overall Loss:18.2685924
Validation loss decreased (9.602647 --> 9.376696).  Saving model ...
Updating learning rate to 0.000125
tensor(18.4393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8444442 KL Loss: 7.2340185 DSM Loss: 9.2888511 Overall Loss:18.3673138
Validation loss decreased (9.376696 --> 9.095100).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.3676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8073500 KL Loss: 7.1794430 DSM Loss: 9.1406321 Overall Loss:18.1274252
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(20.4971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7766382 KL Loss: 7.2090036 DSM Loss: 9.1339636 Overall Loss:18.1196053
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(11.7054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3129, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8083888 KL Loss: 7.2117774 DSM Loss: 9.0614671 Overall Loss:18.0816332
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:11.862271308898926


Running on file BSAC.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.2341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8283356 KL Loss: 7.1740258 DSM Loss: 12.3169194 Overall Loss:21.3192808
Validation loss decreased (inf --> 0.143909).  Saving model ...
Updating learning rate to 0.0005
tensor(22.4367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7903828 KL Loss: 7.1698983 DSM Loss: 10.1742562 Overall Loss:19.1345372
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.1453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7596543 KL Loss: 7.1558343 DSM Loss: 9.7515713 Overall Loss:18.6670600
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.7413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6474, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7721197 KL Loss: 7.0984288 DSM Loss: 9.4309587 Overall Loss:18.3015073
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.36172929406166077
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.8293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8115943 KL Loss: 7.2080391 DSM Loss: 11.3573835 Overall Loss:20.3770169
Validation loss decreased (inf --> 0.220275).  Saving model ...
Updating learning rate to 0.0005
tensor(21.0990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8533117 KL Loss: 7.2117023 DSM Loss: 10.0784530 Overall Loss:19.1434670
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.3606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7744793 KL Loss: 7.1425115 DSM Loss: 9.5559738 Overall Loss:18.4729647
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.1515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7832779 KL Loss: 7.1471751 DSM Loss: 9.5457342 Overall Loss:18.4761870
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.4611058533191681
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.6196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7919695 KL Loss: 7.1996676 DSM Loss: 11.8789394 Overall Loss:20.8705765
Validation loss decreased (inf --> 0.119248).  Saving model ...
Updating learning rate to 0.0005
tensor(23.6587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8254555 KL Loss: 7.1653641 DSM Loss: 10.2895286 Overall Loss:19.2803482
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.1783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7939839 KL Loss: 7.1410702 DSM Loss: 9.9191168 Overall Loss:18.8541708
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.8441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7810444 KL Loss: 7.1924874 DSM Loss: 9.5219459 Overall Loss:18.4954776
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.26460254192352295
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.4958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5285, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8326476 KL Loss: 7.2568269 DSM Loss: 11.2970103 Overall Loss:20.3864849
Validation loss decreased (inf --> 0.416984).  Saving model ...
Updating learning rate to 0.0005
tensor(16.8654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8308308 KL Loss: 7.2041415 DSM Loss: 10.2369510 Overall Loss:19.2719232
Validation loss decreased (0.416984 --> 0.245957).  Saving model ...
Updating learning rate to 0.00025
tensor(18.2533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8426809 KL Loss: 7.1734693 DSM Loss: 9.7522675 Overall Loss:18.7684175
Validation loss decreased (0.245957 --> 0.184884).  Saving model ...
Updating learning rate to 0.000125
tensor(18.3297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7545821 KL Loss: 7.1317103 DSM Loss: 9.4641234 Overall Loss:18.3504157
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.2225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7806700 KL Loss: 7.2090755 DSM Loss: 9.4305677 Overall Loss:18.4203133
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(19.0173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7547649 KL Loss: 7.1297719 DSM Loss: 9.3396481 Overall Loss:18.2241849
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.4158964157104492
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.5302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7331, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8703513 KL Loss: 7.2089475 DSM Loss: 12.2290756 Overall Loss:21.3083743
Validation loss decreased (inf --> 0.496831).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1354, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8538500 KL Loss: 7.1925867 DSM Loss: 10.2303406 Overall Loss:19.2767773
Validation loss decreased (0.496831 --> 0.262411).  Saving model ...
Updating learning rate to 0.00025
tensor(21.0406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8257845 KL Loss: 7.2301983 DSM Loss: 9.5636073 Overall Loss:18.6195901
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.7921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7677844 KL Loss: 7.1399335 DSM Loss: 9.4362162 Overall Loss:18.3439339
Validation loss decreased (0.262411 --> 0.245459).  Saving model ...
Updating learning rate to 6.25e-05
tensor(21.4638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8049590 KL Loss: 7.1892962 DSM Loss: 9.3606646 Overall Loss:18.3549197
Validation loss decreased (0.245459 --> 0.229143).  Saving model ...
Updating learning rate to 3.125e-05
tensor(17.6230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7999458 KL Loss: 7.2614256 DSM Loss: 9.4175528 Overall Loss:18.4789243
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(17.2638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7618901 KL Loss: 7.1473244 DSM Loss: 9.3237219 Overall Loss:18.2329363
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(18.2689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7587, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8065734 KL Loss: 7.2534775 DSM Loss: 9.3767580 Overall Loss:18.4368087
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.48027142882347107


Running on file BUD.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.9088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9113881 KL Loss: 7.2398037 DSM Loss: 12.0583648 Overall Loss:21.2095565
Validation loss decreased (inf --> 1.457438).  Saving model ...
Updating learning rate to 0.0005
tensor(15.6745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9891, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8149650 KL Loss: 7.1680858 DSM Loss: 10.0756996 Overall Loss:19.0587504
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.5204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7816311 KL Loss: 7.1630995 DSM Loss: 9.9019871 Overall Loss:18.8467176
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(22.5618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8235413 KL Loss: 7.1784825 DSM Loss: 9.7424998 Overall Loss:18.7445235
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.7512542009353638
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.9005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9014364 KL Loss: 7.2438518 DSM Loss: 12.3912430 Overall Loss:21.5365312
Validation loss decreased (inf --> 1.961513).  Saving model ...
Updating learning rate to 0.0005
tensor(15.5349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8639635 KL Loss: 7.2446338 DSM Loss: 10.2752658 Overall Loss:19.3838630
Validation loss decreased (1.961513 --> 1.609308).  Saving model ...
Updating learning rate to 0.00025
tensor(20.2030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8856, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8091357 KL Loss: 7.1959140 DSM Loss: 9.8416103 Overall Loss:18.8466601
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(24.6925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1366, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8123455 KL Loss: 7.2147278 DSM Loss: 9.4511785 Overall Loss:18.4782518
Validation loss decreased (1.609308 --> 1.570827).  Saving model ...
Updating learning rate to 6.25e-05
tensor(25.0087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7018, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7514886 KL Loss: 7.1363010 DSM Loss: 9.6020898 Overall Loss:18.4898794
Validation loss decreased (1.570827 --> 1.529969).  Saving model ...
Updating learning rate to 3.125e-05
tensor(15.7379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7353996 KL Loss: 7.1359546 DSM Loss: 9.5779170 Overall Loss:18.4492712
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(21.5210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8737, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7668953 KL Loss: 7.2221189 DSM Loss: 9.4409789 Overall Loss:18.4299931
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(23.7050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7730599 KL Loss: 7.1576325 DSM Loss: 9.4505925 Overall Loss:18.3812849
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.8458949327468872
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(34.4724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9011417 KL Loss: 7.2844327 DSM Loss: 12.6320741 Overall Loss:21.8176484
Validation loss decreased (inf --> 1.954007).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8668097 KL Loss: 7.2325170 DSM Loss: 10.0768808 Overall Loss:19.1762076
Validation loss decreased (1.954007 --> 1.394764).  Saving model ...
Updating learning rate to 0.00025
tensor(25.0577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5987, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8021320 KL Loss: 7.1462331 DSM Loss: 9.8063281 Overall Loss:18.7546931
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(21.4894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7776629 KL Loss: 7.1651248 DSM Loss: 9.7159530 Overall Loss:18.6587407
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.8243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8027329 KL Loss: 7.2068671 DSM Loss: 9.4749870 Overall Loss:18.4845870
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.6914366483688354
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.4299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6055, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8902819 KL Loss: 7.2402624 DSM Loss: 11.9910264 Overall Loss:21.1215708
Validation loss decreased (inf --> 1.687834).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7582985 KL Loss: 7.1140536 DSM Loss: 10.0044341 Overall Loss:18.8767861
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.6119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7706313 KL Loss: 7.1847733 DSM Loss: 9.7508735 Overall Loss:18.7062780
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.6454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7864861 KL Loss: 7.1686602 DSM Loss: 9.7011133 Overall Loss:18.6562595
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.0197572708129883
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.4921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8226002 KL Loss: 7.2049301 DSM Loss: 11.7349004 Overall Loss:20.7624306
Validation loss decreased (inf --> 1.747527).  Saving model ...
Updating learning rate to 0.0005
tensor(24.1839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8453737 KL Loss: 7.1953234 DSM Loss: 9.9578111 Overall Loss:18.9985081
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.2142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9952, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7795748 KL Loss: 7.1507781 DSM Loss: 10.0189655 Overall Loss:18.9493183
Validation loss decreased (1.747527 --> 1.658906).  Saving model ...
Updating learning rate to 0.000125
tensor(18.8158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7753168 KL Loss: 7.1704070 DSM Loss: 9.6864764 Overall Loss:18.6322002
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.4337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8033296 KL Loss: 7.1657536 DSM Loss: 9.5454970 Overall Loss:18.5145801
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(14.9262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4777, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7577325 KL Loss: 7.1314370 DSM Loss: 9.6057987 Overall Loss:18.4949681
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.9714792966842651


Running on file C.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(21.2390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7864, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7557958 KL Loss: 7.1458823 DSM Loss: 13.0963496 Overall Loss:21.9980277
Validation loss decreased (inf --> 0.557685).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8239168 KL Loss: 7.2122181 DSM Loss: 10.1098258 Overall Loss:19.1459606
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.9810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8088626 KL Loss: 7.1343852 DSM Loss: 9.8527302 Overall Loss:18.7959779
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(22.8288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7829890 KL Loss: 7.1010918 DSM Loss: 9.6688606 Overall Loss:18.5529414
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6168933510780334
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8416838 KL Loss: 7.2649423 DSM Loss: 11.5793286 Overall Loss:20.6859548
Validation loss decreased (inf --> 0.853815).  Saving model ...
Updating learning rate to 0.0005
tensor(21.9160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8124920 KL Loss: 7.1737722 DSM Loss: 10.2897328 Overall Loss:19.2759970
Validation loss decreased (0.853815 --> 0.813573).  Saving model ...
Updating learning rate to 0.00025
tensor(14.6233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8330260 KL Loss: 7.2133633 DSM Loss: 9.7279888 Overall Loss:18.7743781
Validation loss decreased (0.813573 --> 0.735821).  Saving model ...
Updating learning rate to 0.000125
tensor(16.2509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7683065 KL Loss: 7.1346623 DSM Loss: 9.6797616 Overall Loss:18.5827304
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(18.1783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7273342 KL Loss: 7.1129079 DSM Loss: 9.3316500 Overall Loss:18.1718922
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(14.4352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7493453 KL Loss: 7.1404093 DSM Loss: 9.4330778 Overall Loss:18.3228324
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6032983064651489
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.1112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8392538 KL Loss: 7.1472836 DSM Loss: 11.6759195 Overall Loss:20.6624570
Validation loss decreased (inf --> 0.628351).  Saving model ...
Updating learning rate to 0.0005
tensor(17.5461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8384063 KL Loss: 7.2192429 DSM Loss: 10.2213380 Overall Loss:19.2789872
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.3628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3410, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7827336 KL Loss: 7.1596195 DSM Loss: 9.8023631 Overall Loss:18.7447161
Validation loss decreased (0.628351 --> 0.576387).  Saving model ...
Updating learning rate to 0.000125
tensor(19.2931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8009325 KL Loss: 7.1971617 DSM Loss: 9.4373758 Overall Loss:18.4354701
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(21.3640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7924265 KL Loss: 7.1231727 DSM Loss: 9.4252628 Overall Loss:18.3408621
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(21.1464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7216395 KL Loss: 7.1285992 DSM Loss: 9.3248882 Overall Loss:18.1751269
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8086265325546265
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.2713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8837141 KL Loss: 7.2332790 DSM Loss: 11.3860446 Overall Loss:20.5030377
Validation loss decreased (inf --> 0.628468).  Saving model ...
Updating learning rate to 0.0005
tensor(14.3719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8209545 KL Loss: 7.1649053 DSM Loss: 9.9882282 Overall Loss:18.9740882
Validation loss decreased (0.628468 --> 0.551147).  Saving model ...
Updating learning rate to 0.00025
tensor(19.5702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8311, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7652317 KL Loss: 7.1335599 DSM Loss: 9.8255875 Overall Loss:18.7243791
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(14.8753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7557, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7851486 KL Loss: 7.1821354 DSM Loss: 9.4395432 Overall Loss:18.4068272
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(22.9348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7501070 KL Loss: 7.1845622 DSM Loss: 9.5183231 Overall Loss:18.4529923
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.7486067414283752
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.9048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8163047 KL Loss: 7.2384588 DSM Loss: 11.7651104 Overall Loss:20.8198741
Validation loss decreased (inf --> 0.666938).  Saving model ...
Updating learning rate to 0.0005
tensor(17.1091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8456085 KL Loss: 7.1698960 DSM Loss: 10.2976727 Overall Loss:19.3131772
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.6656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7778339 KL Loss: 7.1768674 DSM Loss: 9.5965117 Overall Loss:18.5512131
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.5564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8203506 KL Loss: 7.1842350 DSM Loss: 9.7308816 Overall Loss:18.7354671
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.671078622341156


Running on file CAT.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.3556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8640031 KL Loss: 7.2241943 DSM Loss: 11.4580283 Overall Loss:20.5462255
Validation loss decreased (inf --> 3.557067).  Saving model ...
Updating learning rate to 0.0005
tensor(25.3341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8619, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8387174 KL Loss: 7.1715760 DSM Loss: 9.9449222 Overall Loss:18.9552156
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(22.6357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8173879 KL Loss: 7.2092857 DSM Loss: 9.5849770 Overall Loss:18.6116505
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.2737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7731585 KL Loss: 7.1378588 DSM Loss: 9.5673906 Overall Loss:18.4784078
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.077950954437256
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8665883 KL Loss: 7.1941715 DSM Loss: 11.3864270 Overall Loss:20.4471868
Validation loss decreased (inf --> 3.178289).  Saving model ...
Updating learning rate to 0.0005
tensor(23.3953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8575941 KL Loss: 7.1686992 DSM Loss: 10.3099694 Overall Loss:19.3362626
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.6769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7961611 KL Loss: 7.1603865 DSM Loss: 9.5801907 Overall Loss:18.5367383
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.2184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7527797 KL Loss: 7.1147770 DSM Loss: 9.5922805 Overall Loss:18.4598373
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.602862358093262
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.5936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8571984 KL Loss: 7.2834341 DSM Loss: 11.3827745 Overall Loss:20.5234070
Validation loss decreased (inf --> 4.689249).  Saving model ...
Updating learning rate to 0.0005
tensor(15.5991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8537990 KL Loss: 7.2343724 DSM Loss: 9.6684362 Overall Loss:18.7566078
Validation loss decreased (4.689249 --> 4.322589).  Saving model ...
Updating learning rate to 0.00025
tensor(20.6671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7905443 KL Loss: 7.1168100 DSM Loss: 9.7534538 Overall Loss:18.6608082
Validation loss decreased (4.322589 --> 4.071038).  Saving model ...
Updating learning rate to 0.000125
tensor(25.6048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7410342 KL Loss: 7.1212238 DSM Loss: 9.5761549 Overall Loss:18.4384128
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.4762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7600208 KL Loss: 7.0885331 DSM Loss: 9.3571988 Overall Loss:18.2057526
Validation loss decreased (4.071038 --> 3.990212).  Saving model ...
Updating learning rate to 3.125e-05
tensor(26.7089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9471, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7894344 KL Loss: 7.1568324 DSM Loss: 9.2321760 Overall Loss:18.1784428
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(15.8996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7932182 KL Loss: 7.1926401 DSM Loss: 9.2911531 Overall Loss:18.2770115
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(16.2739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7398185 KL Loss: 7.1116680 DSM Loss: 9.2797030 Overall Loss:18.1311895
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.699053764343262
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.7299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8489243 KL Loss: 7.2657016 DSM Loss: 12.9605402 Overall Loss:22.0751660
Validation loss decreased (inf --> 3.783203).  Saving model ...
Updating learning rate to 0.0005
tensor(21.4828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7896581 KL Loss: 7.1776993 DSM Loss: 9.8729229 Overall Loss:18.8402803
Validation loss decreased (3.783203 --> 3.701740).  Saving model ...
Updating learning rate to 0.00025
tensor(25.1889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8299222 KL Loss: 7.1676428 DSM Loss: 9.4134916 Overall Loss:18.4110566
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(22.0980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.2950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7564118 KL Loss: 7.1274307 DSM Loss: 9.5135509 Overall Loss:18.3973934
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(13.8299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7121596 KL Loss: 7.1100507 DSM Loss: 9.4625716 Overall Loss:18.2847819
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.084661960601807
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(34.6674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8648712 KL Loss: 7.2390838 DSM Loss: 13.0339943 Overall Loss:22.1379493
Validation loss decreased (inf --> 3.052934).  Saving model ...
Updating learning rate to 0.0005
tensor(16.0612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8518672 KL Loss: 7.1623406 DSM Loss: 10.0766638 Overall Loss:19.0908715
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.2985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8066122 KL Loss: 7.1407692 DSM Loss: 9.5028202 Overall Loss:18.4502014
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.1169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7073785 KL Loss: 7.0183244 DSM Loss: 9.5594228 Overall Loss:18.2851256
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.514178276062012


Running on file CHTR.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.6941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8555570 KL Loss: 7.1805554 DSM Loss: 11.7192704 Overall Loss:20.7553828
Validation loss decreased (inf --> 2.772071).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7118, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8682119 KL Loss: 7.2420255 DSM Loss: 9.9105797 Overall Loss:19.0208170
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(22.8478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8255137 KL Loss: 7.2015162 DSM Loss: 9.5569067 Overall Loss:18.5839365
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.4105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8191738 KL Loss: 7.1655720 DSM Loss: 9.2800441 Overall Loss:18.2647901
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1466810554265976
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.5566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7565937 KL Loss: 7.1150407 DSM Loss: 10.9938083 Overall Loss:19.8654427
Validation loss decreased (inf --> 3.240281).  Saving model ...
Updating learning rate to 0.0005
tensor(25.7699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7970779 KL Loss: 7.1740466 DSM Loss: 9.8977479 Overall Loss:18.8688723
Validation loss decreased (3.240281 --> 3.237415).  Saving model ...
Updating learning rate to 0.00025
tensor(14.3489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8073394 KL Loss: 7.0959592 DSM Loss: 9.5574432 Overall Loss:18.4607420
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.1668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8048668 KL Loss: 7.1661533 DSM Loss: 9.3765862 Overall Loss:18.3476065
Validation loss decreased (3.237415 --> 3.073732).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.8107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7186594 KL Loss: 7.0651790 DSM Loss: 9.3526286 Overall Loss:18.1364669
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(16.9021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7297246 KL Loss: 7.1967529 DSM Loss: 9.1866826 Overall Loss:18.1131602
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.0380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7693350 KL Loss: 7.2011114 DSM Loss: 9.0179508 Overall Loss:17.9883971
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.117167629301548
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.5122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8175264 KL Loss: 7.2133439 DSM Loss: 11.5045644 Overall Loss:20.5354347
Validation loss decreased (inf --> 2.717072).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7852417 KL Loss: 7.1288121 DSM Loss: 9.9354677 Overall Loss:18.8495216
Validation loss decreased (2.717072 --> 2.695999).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7960631 KL Loss: 7.1876190 DSM Loss: 9.5753015 Overall Loss:18.5589836
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.4839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7501577 KL Loss: 7.1231966 DSM Loss: 9.2568260 Overall Loss:18.1301801
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(23.4381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3560, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7707337 KL Loss: 7.1684947 DSM Loss: 9.3324353 Overall Loss:18.2716637
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.09428327530622482
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.5494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7640821 KL Loss: 7.2068001 DSM Loss: 11.3568649 Overall Loss:20.3277472
Validation loss decreased (inf --> 2.231535).  Saving model ...
Updating learning rate to 0.0005
tensor(21.0031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8248235 KL Loss: 7.1419897 DSM Loss: 10.0074782 Overall Loss:18.9742913
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.6434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6035, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7903526 KL Loss: 7.2118458 DSM Loss: 9.5357862 Overall Loss:18.5379848
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.9319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7895190 KL Loss: 7.1925924 DSM Loss: 9.4306881 Overall Loss:18.4127995
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.26936784386634827
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.8326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1306, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8293113 KL Loss: 7.2129109 DSM Loss: 12.2866135 Overall Loss:21.3288358
Validation loss decreased (inf --> 3.198414).  Saving model ...
Updating learning rate to 0.0005
tensor(17.3484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8568603 KL Loss: 7.2153770 DSM Loss: 10.1120808 Overall Loss:19.1843181
Validation loss decreased (3.198414 --> 2.731653).  Saving model ...
Updating learning rate to 0.00025
tensor(24.0808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7878027 KL Loss: 7.1289685 DSM Loss: 9.8418907 Overall Loss:18.7586619
Validation loss decreased (2.731653 --> 2.717494).  Saving model ...
Updating learning rate to 0.000125
tensor(17.5011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8005057 KL Loss: 7.1623577 DSM Loss: 9.3310407 Overall Loss:18.2939041
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.9168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7704788 KL Loss: 7.0842306 DSM Loss: 9.3083976 Overall Loss:18.1631070
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(21.7301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5070, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7730410 KL Loss: 7.1799910 DSM Loss: 9.1724273 Overall Loss:18.1254593
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.12261805683374405


Running on file CMCSA.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.0629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.3151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9367, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9238595 KL Loss: 7.2304634 DSM Loss: 12.0422229 Overall Loss:21.1965459
Validation loss decreased (inf --> 3.400804).  Saving model ...
Updating learning rate to 0.0005
tensor(17.5995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8190880 KL Loss: 7.1606388 DSM Loss: 9.8209600 Overall Loss:18.8006866
Validation loss decreased (3.400804 --> 2.927683).  Saving model ...
Updating learning rate to 0.00025
tensor(16.0921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8338, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8087000 KL Loss: 7.1871931 DSM Loss: 9.5267818 Overall Loss:18.5226750
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.5705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7040, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7963041 KL Loss: 7.1862646 DSM Loss: 9.2748778 Overall Loss:18.2574464
Validation loss decreased (2.927683 --> 2.854838).  Saving model ...
Updating learning rate to 6.25e-05
tensor(20.0962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7439804 KL Loss: 7.1168992 DSM Loss: 9.0322354 Overall Loss:17.8931150
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(12.3557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7321637 KL Loss: 7.1501576 DSM Loss: 9.1565077 Overall Loss:18.0388290
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.9405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3869, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7614845 KL Loss: 7.2184991 DSM Loss: 8.9246752 Overall Loss:17.9046587
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.43235814571380615
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5581, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8394762 KL Loss: 7.1861156 DSM Loss: 11.4251170 Overall Loss:20.4507088
Validation loss decreased (inf --> 2.441111).  Saving model ...
Updating learning rate to 0.0005
tensor(18.9903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8245853 KL Loss: 7.1544185 DSM Loss: 9.9056318 Overall Loss:18.8846355
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.4201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8069390 KL Loss: 7.1623809 DSM Loss: 9.6592783 Overall Loss:18.6285982
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.5739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7772305 KL Loss: 7.1488633 DSM Loss: 9.3645713 Overall Loss:18.2906651
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.37119415402412415
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.6416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8318356 KL Loss: 7.2073835 DSM Loss: 11.1308641 Overall Loss:20.1700832
Validation loss decreased (inf --> 2.868144).  Saving model ...
Updating learning rate to 0.0005
tensor(16.2044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8475279 KL Loss: 7.1585586 DSM Loss: 9.8595530 Overall Loss:18.8656397
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.4201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7726142 KL Loss: 7.1223715 DSM Loss: 9.2722784 Overall Loss:18.1672640
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.5504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7482204 KL Loss: 7.0892245 DSM Loss: 9.2953727 Overall Loss:18.1328176
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.4457205533981323
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.5647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8573316 KL Loss: 7.2089219 DSM Loss: 12.7292976 Overall Loss:21.7955510
Validation loss decreased (inf --> 3.055749).  Saving model ...
Updating learning rate to 0.0005
tensor(20.7875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7936560 KL Loss: 7.1666514 DSM Loss: 10.0889881 Overall Loss:19.0492954
Validation loss decreased (3.055749 --> 2.214566).  Saving model ...
Updating learning rate to 0.00025
tensor(17.1371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8183673 KL Loss: 7.1816834 DSM Loss: 9.2992670 Overall Loss:18.2993178
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.1561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7345398 KL Loss: 7.0789853 DSM Loss: 9.4243975 Overall Loss:18.2379227
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(22.3146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7947479 KL Loss: 7.2111459 DSM Loss: 9.2357582 Overall Loss:18.2416520
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.3932832181453705
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.4660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8063047 KL Loss: 7.1946745 DSM Loss: 11.5249373 Overall Loss:20.5259164
Validation loss decreased (inf --> 3.291233).  Saving model ...
Updating learning rate to 0.0005
tensor(16.1276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8428276 KL Loss: 7.1778845 DSM Loss: 10.0802575 Overall Loss:19.1009697
Validation loss decreased (3.291233 --> 2.591849).  Saving model ...
Updating learning rate to 0.00025
tensor(19.9962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8297120 KL Loss: 7.1451176 DSM Loss: 9.3180629 Overall Loss:18.2928926
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(12.8930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7944814 KL Loss: 7.1799782 DSM Loss: 9.1697440 Overall Loss:18.1442035
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.8653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7866503 KL Loss: 7.1388254 DSM Loss: 8.9950663 Overall Loss:17.9205421
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.39890798926353455


Running on file CODI.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.2838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8341029 KL Loss: 7.2409649 DSM Loss: 11.3272958 Overall Loss:20.4023635
Validation loss decreased (inf --> 11.149146).  Saving model ...
Updating learning rate to 0.0005
tensor(18.0586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8331431 KL Loss: 7.2074589 DSM Loss: 9.8203681 Overall Loss:18.8609700
Validation loss decreased (11.149146 --> 10.543314).  Saving model ...
Updating learning rate to 0.00025
tensor(21.2804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7989559 KL Loss: 7.1860694 DSM Loss: 9.5127273 Overall Loss:18.4977527
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.3993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3869, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7403876 KL Loss: 7.1508237 DSM Loss: 9.4910366 Overall Loss:18.3822478
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(25.2936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7557261 KL Loss: 7.1162563 DSM Loss: 9.4130451 Overall Loss:18.2850275
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.2552647590637207
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.3223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7176, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8393619 KL Loss: 7.1988091 DSM Loss: 11.8940795 Overall Loss:20.9322505
Validation loss decreased (inf --> 10.826464).  Saving model ...
Updating learning rate to 0.0005
tensor(22.5134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8224739 KL Loss: 7.1993165 DSM Loss: 10.4533970 Overall Loss:19.4751874
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(12.7802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8103224 KL Loss: 7.1598520 DSM Loss: 9.7029595 Overall Loss:18.6731338
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.5921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7608960 KL Loss: 7.1671869 DSM Loss: 9.3232952 Overall Loss:18.2513781
Validation loss decreased (10.826464 --> 10.270770).  Saving model ...
Updating learning rate to 6.25e-05
tensor(14.2270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.0179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8185551 KL Loss: 7.1338058 DSM Loss: 9.1468914 Overall Loss:18.0992523
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(17.7367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7942, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7547678 KL Loss: 7.0903219 DSM Loss: 9.2581373 Overall Loss:18.1032269
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(15.9959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9884, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7506194 KL Loss: 7.0538092 DSM Loss: 8.9571784 Overall Loss:17.7616071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.1108789443969727
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(38.9772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2480, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8392873 KL Loss: 7.1788308 DSM Loss: 12.2970379 Overall Loss:21.3151559
Validation loss decreased (inf --> 10.772498).  Saving model ...
Updating learning rate to 0.0005
tensor(17.7072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3233, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8795525 KL Loss: 7.2338918 DSM Loss: 10.1936159 Overall Loss:19.3070602
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.9008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7967291 KL Loss: 7.1775649 DSM Loss: 9.6379009 Overall Loss:18.6121949
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.0508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8130925 KL Loss: 7.1958509 DSM Loss: 9.2329121 Overall Loss:18.2418555
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.315965414047241
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.9627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8133884 KL Loss: 7.1655652 DSM Loss: 11.3019237 Overall Loss:20.2808774
Validation loss decreased (inf --> 10.659876).  Saving model ...
Updating learning rate to 0.0005
tensor(19.6601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8145720 KL Loss: 7.1748726 DSM Loss: 9.8664037 Overall Loss:18.8558481
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(25.0287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8133415 KL Loss: 7.1765614 DSM Loss: 9.7076593 Overall Loss:18.6975623
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.2736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7710898 KL Loss: 7.1453622 DSM Loss: 9.3826295 Overall Loss:18.2990815
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.268881320953369
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.2056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8076976 KL Loss: 7.1936845 DSM Loss: 12.8355967 Overall Loss:21.8369787
Validation loss decreased (inf --> 10.742211).  Saving model ...
Updating learning rate to 0.0005
tensor(18.1873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8479440 KL Loss: 7.1528810 DSM Loss: 10.3036104 Overall Loss:19.3044353
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.5063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8330959 KL Loss: 7.1692527 DSM Loss: 9.6838948 Overall Loss:18.6862435
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(11.6802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7697777 KL Loss: 7.0790823 DSM Loss: 9.5620834 Overall Loss:18.4109434
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.3821558952331543


Running on file CSCO.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.3559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8314794 KL Loss: 7.1991335 DSM Loss: 10.9837746 Overall Loss:20.0143875
Validation loss decreased (inf --> 4.376809).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9511, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8372732 KL Loss: 7.2139353 DSM Loss: 9.9192610 Overall Loss:18.9704693
Validation loss decreased (4.376809 --> 3.122448).  Saving model ...
Updating learning rate to 0.00025
tensor(19.4179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8024753 KL Loss: 7.1119270 DSM Loss: 9.7331619 Overall Loss:18.6475643
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.4582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7448718 KL Loss: 7.1424737 DSM Loss: 9.2564278 Overall Loss:18.1437733
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(17.6862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7682828 KL Loss: 7.1758628 DSM Loss: 9.2022115 Overall Loss:18.1463571
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.522628664970398
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(21.4789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8352456 KL Loss: 7.1928070 DSM Loss: 11.6255516 Overall Loss:20.6536042
Validation loss decreased (inf --> 3.406332).  Saving model ...
Updating learning rate to 0.0005
tensor(16.8164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8318148 KL Loss: 7.1674900 DSM Loss: 10.0065722 Overall Loss:19.0058771
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.8127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6621, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7816214 KL Loss: 7.1623085 DSM Loss: 9.5603102 Overall Loss:18.5042400
Validation loss decreased (3.406332 --> 3.350493).  Saving model ...
Updating learning rate to 0.000125
tensor(20.4373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8013536 KL Loss: 7.0816900 DSM Loss: 9.3837307 Overall Loss:18.2667742
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.5084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7301315 KL Loss: 7.1188118 DSM Loss: 9.3311481 Overall Loss:18.1800914
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(21.7601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7237746 KL Loss: 7.1300720 DSM Loss: 9.2766122 Overall Loss:18.1304589
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.6923688650131226
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.3603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8395451 KL Loss: 7.1874179 DSM Loss: 11.5701950 Overall Loss:20.5971581
Validation loss decreased (inf --> 3.565834).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8014509 KL Loss: 7.1908217 DSM Loss: 9.8674815 Overall Loss:18.8597542
Validation loss decreased (3.565834 --> 2.960882).  Saving model ...
Updating learning rate to 0.00025
tensor(22.1170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8277686 KL Loss: 7.1993783 DSM Loss: 9.5625880 Overall Loss:18.5897349
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.8685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7991836 KL Loss: 7.1901055 DSM Loss: 9.4295801 Overall Loss:18.4188691
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.7011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7691493 KL Loss: 7.1501861 DSM Loss: 9.3300708 Overall Loss:18.2494062
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.4351598024368286
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.2286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4863, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8769662 KL Loss: 7.2205931 DSM Loss: 13.7838551 Overall Loss:22.8814144
Validation loss decreased (inf --> 3.205856).  Saving model ...
Updating learning rate to 0.0005
tensor(22.8909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2649, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8002142 KL Loss: 7.1219671 DSM Loss: 10.1860022 Overall Loss:19.1081836
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.4753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7773794 KL Loss: 7.1244253 DSM Loss: 9.6975360 Overall Loss:18.5993406
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.5040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7491277 KL Loss: 7.1427084 DSM Loss: 9.4594361 Overall Loss:18.3512722
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.5936248302459717
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3233, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8214002 KL Loss: 7.1744397 DSM Loss: 12.3972172 Overall Loss:21.3930571
Validation loss decreased (inf --> 3.423327).  Saving model ...
Updating learning rate to 0.0005
tensor(17.8135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8103492 KL Loss: 7.2050499 DSM Loss: 10.2035886 Overall Loss:19.2189877
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.0828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7557744 KL Loss: 7.1587852 DSM Loss: 9.5891098 Overall Loss:18.5036695
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.5767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7062513 KL Loss: 7.0845587 DSM Loss: 9.2812195 Overall Loss:18.0720295
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.74397611618042


Running on file CVX.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.5321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8168524 KL Loss: 7.2580538 DSM Loss: 12.1763455 Overall Loss:21.2512518
Validation loss decreased (inf --> 11.694669).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8889057 KL Loss: 7.2562911 DSM Loss: 9.8021797 Overall Loss:18.9473764
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.1336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7809643 KL Loss: 7.1556007 DSM Loss: 9.3297574 Overall Loss:18.2663226
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.1458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2125, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7691222 KL Loss: 7.1506007 DSM Loss: 9.2019920 Overall Loss:18.1217149
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:35.51109313964844
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.6904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8447889 KL Loss: 7.2325367 DSM Loss: 11.0667232 Overall Loss:20.1440486
Validation loss decreased (inf --> 13.595444).  Saving model ...
Updating learning rate to 0.0005
tensor(16.5444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8545943 KL Loss: 7.1768742 DSM Loss: 9.8980894 Overall Loss:18.9295579
Validation loss decreased (13.595444 --> 12.951751).  Saving model ...
Updating learning rate to 0.00025
tensor(19.9763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7969533 KL Loss: 7.1322499 DSM Loss: 9.5376241 Overall Loss:18.4668273
Validation loss decreased (12.951751 --> 12.040469).  Saving model ...
Updating learning rate to 0.000125
tensor(16.6040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8453, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7435684 KL Loss: 7.1385059 DSM Loss: 9.1456842 Overall Loss:18.0277584
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(18.6155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7560976 KL Loss: 7.1134455 DSM Loss: 9.1397476 Overall Loss:18.0092908
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(16.3585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7747457 KL Loss: 7.1882872 DSM Loss: 9.1177828 Overall Loss:18.0808157
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:35.97547912597656
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.7137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8155782 KL Loss: 7.2125040 DSM Loss: 11.2435200 Overall Loss:20.2716023
Validation loss decreased (inf --> 13.559167).  Saving model ...
Updating learning rate to 0.0005
tensor(17.8743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2525, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8097079 KL Loss: 7.2041780 DSM Loss: 9.8960939 Overall Loss:18.9099797
Validation loss decreased (13.559167 --> 12.302133).  Saving model ...
Updating learning rate to 0.00025
tensor(19.1502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8425234 KL Loss: 7.2043304 DSM Loss: 9.2961921 Overall Loss:18.3430459
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.0680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3834, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7928673 KL Loss: 7.1419959 DSM Loss: 9.2740172 Overall Loss:18.2088804
Validation loss decreased (12.302133 --> 12.257649).  Saving model ...
Updating learning rate to 6.25e-05
tensor(12.9071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7416626 KL Loss: 7.0687403 DSM Loss: 8.9815270 Overall Loss:17.7919297
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(19.9012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7297784 KL Loss: 7.1298958 DSM Loss: 9.1711145 Overall Loss:18.0307889
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(16.8709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4732, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7900090 KL Loss: 7.1914308 DSM Loss: 9.0851386 Overall Loss:18.0665785
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:36.66173553466797
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(21.7722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8592750 KL Loss: 7.2042859 DSM Loss: 11.4717680 Overall Loss:20.5353290
Validation loss decreased (inf --> 12.423900).  Saving model ...
Updating learning rate to 0.0005
tensor(16.5993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7831906 KL Loss: 7.1371611 DSM Loss: 9.7248430 Overall Loss:18.6451947
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.5009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7711461 KL Loss: 7.1652123 DSM Loss: 9.4450811 Overall Loss:18.3814395
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.6539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3094, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7767639 KL Loss: 7.1650141 DSM Loss: 9.2819307 Overall Loss:18.2237087
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:36.945716857910156
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.4436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4471, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8774999 KL Loss: 7.2546393 DSM Loss: 11.0880117 Overall Loss:20.2201510
Validation loss decreased (inf --> 12.498964).  Saving model ...
Updating learning rate to 0.0005
tensor(15.0797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7787593 KL Loss: 7.1465270 DSM Loss: 10.2458909 Overall Loss:19.1711771
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.8106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7968839 KL Loss: 7.1822294 DSM Loss: 9.6337744 Overall Loss:18.6128878
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.3272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7621767 KL Loss: 7.1497288 DSM Loss: 9.1631713 Overall Loss:18.0750767
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:37.08614730834961


Running on file D.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8359652 KL Loss: 7.1727162 DSM Loss: 12.1590008 Overall Loss:21.1676823
Validation loss decreased (inf --> 3.418165).  Saving model ...
Updating learning rate to 0.0005
tensor(16.2924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8688811 KL Loss: 7.1456198 DSM Loss: 10.1390039 Overall Loss:19.1535049
Validation loss decreased (3.418165 --> 3.369323).  Saving model ...
Updating learning rate to 0.00025
tensor(19.3771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0358, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8917820 KL Loss: 7.2300416 DSM Loss: 9.6847227 Overall Loss:18.8065463
Validation loss decreased (3.369323 --> 3.148490).  Saving model ...
Updating learning rate to 0.000125
tensor(16.2690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7530, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7957997 KL Loss: 7.1323997 DSM Loss: 9.3789731 Overall Loss:18.3071724
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.9675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7890407 KL Loss: 7.2049742 DSM Loss: 9.4324754 Overall Loss:18.4264904
Validation loss decreased (3.148490 --> 3.064534).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.4572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7628963 KL Loss: 7.1184935 DSM Loss: 9.3864604 Overall Loss:18.2678501
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(16.2657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7542376 KL Loss: 7.1992688 DSM Loss: 9.3550276 Overall Loss:18.3085340
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(17.6455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8090184 KL Loss: 7.2216588 DSM Loss: 9.2936283 Overall Loss:18.3243054
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.167492628097534
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.1996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8699423 KL Loss: 7.1854730 DSM Loss: 13.0194876 Overall Loss:22.0749027
Validation loss decreased (inf --> 2.766115).  Saving model ...
Updating learning rate to 0.0005
tensor(20.2500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8823696 KL Loss: 7.1805884 DSM Loss: 10.3122173 Overall Loss:19.3751755
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.9636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7938058 KL Loss: 7.1800688 DSM Loss: 9.8490920 Overall Loss:18.8229665
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.4304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2830, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8286893 KL Loss: 7.1646976 DSM Loss: 9.4629843 Overall Loss:18.4563711
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.0100247859954834
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.3420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7870404 KL Loss: 7.1655353 DSM Loss: 11.8161882 Overall Loss:20.7687639
Validation loss decreased (inf --> 3.188246).  Saving model ...
Updating learning rate to 0.0005
tensor(12.8720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0583, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8015419 KL Loss: 7.1722784 DSM Loss: 10.1275013 Overall Loss:19.1013213
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.9648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7597019 KL Loss: 7.0811472 DSM Loss: 9.5121958 Overall Loss:18.3530450
Validation loss decreased (3.188246 --> 3.154467).  Saving model ...
Updating learning rate to 0.000125
tensor(19.7527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7821549 KL Loss: 7.1730591 DSM Loss: 9.2914828 Overall Loss:18.2466969
Validation loss decreased (3.154467 --> 3.112493).  Saving model ...
Updating learning rate to 6.25e-05
tensor(19.2185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7840363 KL Loss: 7.1505636 DSM Loss: 9.3264771 Overall Loss:18.2610771
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(19.5512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7592730 KL Loss: 7.1322698 DSM Loss: 9.3175824 Overall Loss:18.2091251
Validation loss decreased (3.112493 --> 3.011768).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(14.7369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7542335 KL Loss: 7.1316084 DSM Loss: 9.2722378 Overall Loss:18.1580795
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(16.0761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7389952 KL Loss: 7.1867505 DSM Loss: 9.1864508 Overall Loss:18.1121966
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(17.1244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1926, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7462923 KL Loss: 7.2350564 DSM Loss: 9.1003065 Overall Loss:18.0816552
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.033318042755127
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.9935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8172250 KL Loss: 7.1965995 DSM Loss: 11.3793370 Overall Loss:20.3931614
Validation loss decreased (inf --> 2.782996).  Saving model ...
Updating learning rate to 0.0005
tensor(16.7899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8384746 KL Loss: 7.2059606 DSM Loss: 10.3966166 Overall Loss:19.4410518
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(25.8852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7983053 KL Loss: 7.1918146 DSM Loss: 9.5767500 Overall Loss:18.5668699
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.4438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7775425 KL Loss: 7.1528732 DSM Loss: 9.2973768 Overall Loss:18.2277925
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.2880589962005615
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.1599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3216, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9142828 KL Loss: 7.2394945 DSM Loss: 11.8557237 Overall Loss:21.0095009
Validation loss decreased (inf --> 3.180375).  Saving model ...
Updating learning rate to 0.0005
tensor(20.2296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8379373 KL Loss: 7.1768259 DSM Loss: 9.8035763 Overall Loss:18.8183395
Validation loss decreased (3.180375 --> 3.094349).  Saving model ...
Updating learning rate to 0.00025
tensor(19.9749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8454244 KL Loss: 7.2194312 DSM Loss: 9.6165508 Overall Loss:18.6814065
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.4017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5972, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7965076 KL Loss: 7.1493349 DSM Loss: 9.3666375 Overall Loss:18.3124799
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.1146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7877641 KL Loss: 7.1956233 DSM Loss: 9.3690592 Overall Loss:18.3524466
Validation loss decreased (3.094349 --> 3.061361).  Saving model ...
Updating learning rate to 3.125e-05
tensor(12.3650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9731, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7486141 KL Loss: 7.1546359 DSM Loss: 9.2224553 Overall Loss:18.1257051
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(16.7957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7420689 KL Loss: 7.1802690 DSM Loss: 9.2657340 Overall Loss:18.1880720
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(20.7593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7579, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7425974 KL Loss: 7.1555887 DSM Loss: 9.2809792 Overall Loss:18.1791652
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.177769899368286


Running on file DHR.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.4664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8398304 KL Loss: 7.1880844 DSM Loss: 11.7846774 Overall Loss:20.8125922
Validation loss decreased (inf --> 8.762190).  Saving model ...
Updating learning rate to 0.0005
tensor(14.2741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7769559 KL Loss: 7.1181357 DSM Loss: 9.8529355 Overall Loss:18.7480271
Validation loss decreased (8.762190 --> 8.642293).  Saving model ...
Updating learning rate to 0.00025
tensor(12.9970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4624, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7258623 KL Loss: 7.1183423 DSM Loss: 9.8783741 Overall Loss:18.7225788
Validation loss decreased (8.642293 --> 8.636378).  Saving model ...
Updating learning rate to 0.000125
tensor(17.6911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8433293 KL Loss: 7.2172318 DSM Loss: 9.5173542 Overall Loss:18.5779153
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.3163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7747616 KL Loss: 7.1283832 DSM Loss: 9.2073056 Overall Loss:18.1104501
Validation loss decreased (8.636378 --> 8.184730).  Saving model ...
Updating learning rate to 3.125e-05
tensor(15.5663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7358522 KL Loss: 7.1157717 DSM Loss: 9.2319882 Overall Loss:18.0836122
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(15.8916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7554481 KL Loss: 7.1624507 DSM Loss: 9.2563738 Overall Loss:18.1742728
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(20.7108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8153052 KL Loss: 7.1524555 DSM Loss: 9.1543645 Overall Loss:18.1221251
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.640294551849365
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.4599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5051, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8821752 KL Loss: 7.2583334 DSM Loss: 11.0905984 Overall Loss:20.2311069
Validation loss decreased (inf --> 8.554277).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8669210 KL Loss: 7.1551497 DSM Loss: 10.0888345 Overall Loss:19.1109051
Validation loss decreased (8.554277 --> 8.138950).  Saving model ...
Updating learning rate to 0.00025
tensor(15.6800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7959705 KL Loss: 7.1849330 DSM Loss: 9.6231167 Overall Loss:18.6040203
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.8047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7701209 KL Loss: 7.1244074 DSM Loss: 9.5093793 Overall Loss:18.4039075
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.4020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8108317 KL Loss: 7.2129042 DSM Loss: 9.3457534 Overall Loss:18.3694893
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.680251121520996
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.9236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8580518 KL Loss: 7.2528460 DSM Loss: 12.2040245 Overall Loss:21.3149224
Validation loss decreased (inf --> 9.398247).  Saving model ...
Updating learning rate to 0.0005
tensor(14.7823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8304023 KL Loss: 7.1914045 DSM Loss: 9.6610116 Overall Loss:18.6828185
Validation loss decreased (9.398247 --> 7.201941).  Saving model ...
Updating learning rate to 0.00025
tensor(23.6141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8228891 KL Loss: 7.1530387 DSM Loss: 9.5681353 Overall Loss:18.5440630
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.2154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8086697 KL Loss: 7.2066751 DSM Loss: 9.4300514 Overall Loss:18.4453961
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(27.7454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7933577 KL Loss: 7.2072620 DSM Loss: 9.1357175 Overall Loss:18.1363373
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.886337995529175
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.2631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8659603 KL Loss: 7.2495750 DSM Loss: 11.2653905 Overall Loss:20.3809258
Validation loss decreased (inf --> 7.620285).  Saving model ...
Updating learning rate to 0.0005
tensor(22.0699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7860209 KL Loss: 7.1184026 DSM Loss: 9.9162618 Overall Loss:18.8206854
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.0953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8093705 KL Loss: 7.1349127 DSM Loss: 9.4452853 Overall Loss:18.3895686
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.5350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5018, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7605038 KL Loss: 7.0996990 DSM Loss: 9.4480828 Overall Loss:18.3082856
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.193975448608398
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.2504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9108849 KL Loss: 7.2376168 DSM Loss: 12.1403685 Overall Loss:21.2888702
Validation loss decreased (inf --> 7.109022).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5077, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8577754 KL Loss: 7.1946070 DSM Loss: 9.6090324 Overall Loss:18.6614149
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.7080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5594, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7790708 KL Loss: 7.1217512 DSM Loss: 9.5700390 Overall Loss:18.4708609
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.9536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7572724 KL Loss: 7.0660222 DSM Loss: 9.4727690 Overall Loss:18.2960635
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.827608346939087


Running on file DIS.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.1742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5358, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8323429 KL Loss: 7.2808762 DSM Loss: 11.6910836 Overall Loss:20.8043027
Validation loss decreased (inf --> 2.237644).  Saving model ...
Updating learning rate to 0.0005
tensor(15.9381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8503742 KL Loss: 7.1992480 DSM Loss: 10.1136049 Overall Loss:19.1632270
Validation loss decreased (2.237644 --> 1.787450).  Saving model ...
Updating learning rate to 0.00025
tensor(19.6614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7631869 KL Loss: 7.1389295 DSM Loss: 9.6210008 Overall Loss:18.5231171
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(13.4631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0736, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7828912 KL Loss: 7.1684477 DSM Loss: 9.6508420 Overall Loss:18.6021810
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(17.7791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9417, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7919925 KL Loss: 7.1180519 DSM Loss: 9.4822790 Overall Loss:18.3923233
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.984355628490448
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.8093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8384206 KL Loss: 7.1746995 DSM Loss: 12.3816772 Overall Loss:21.3947971
Validation loss decreased (inf --> 1.665888).  Saving model ...
Updating learning rate to 0.0005
tensor(21.8694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8198826 KL Loss: 7.1460645 DSM Loss: 10.0477434 Overall Loss:19.0136906
Validation loss decreased (1.665888 --> 1.276242).  Saving model ...
Updating learning rate to 0.00025
tensor(18.3483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7536426 KL Loss: 7.1041241 DSM Loss: 9.7832160 Overall Loss:18.6409825
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(23.5897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2279, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8242158 KL Loss: 7.1671642 DSM Loss: 9.3588581 Overall Loss:18.3502380
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(11.3053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1656, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7248393 KL Loss: 7.1120393 DSM Loss: 9.5332800 Overall Loss:18.3701586
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.3709229528903961
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.7478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.0432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8741125 KL Loss: 7.2432454 DSM Loss: 11.6704388 Overall Loss:20.7877966
Validation loss decreased (inf --> 1.651751).  Saving model ...
Updating learning rate to 0.0005
tensor(24.3239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8654031 KL Loss: 7.2089143 DSM Loss: 10.0328016 Overall Loss:19.1071189
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.7650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8278365 KL Loss: 7.1360334 DSM Loss: 9.8225258 Overall Loss:18.7863957
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.5496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8156540 KL Loss: 7.1409055 DSM Loss: 9.4241666 Overall Loss:18.3807261
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.129733681678772
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(37.1725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8314096 KL Loss: 7.2415119 DSM Loss: 15.5013723 Overall Loss:24.5742938
Validation loss decreased (inf --> 1.963270).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7784249 KL Loss: 7.1530157 DSM Loss: 10.0482345 Overall Loss:18.9796750
Validation loss decreased (1.963270 --> 1.619113).  Saving model ...
Updating learning rate to 0.00025
tensor(14.6268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7602882 KL Loss: 7.1014284 DSM Loss: 9.9889661 Overall Loss:18.8506828
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.5492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1831, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7520310 KL Loss: 7.0809702 DSM Loss: 9.7222856 Overall Loss:18.5552868
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.1335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7947729 KL Loss: 7.1896613 DSM Loss: 9.5512977 Overall Loss:18.5357318
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5088270902633667
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(35.4799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8827251 KL Loss: 7.2447281 DSM Loss: 12.1149765 Overall Loss:21.2424297
Validation loss decreased (inf --> 1.744072).  Saving model ...
Updating learning rate to 0.0005
tensor(14.7481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8333172 KL Loss: 7.1461695 DSM Loss: 10.5016357 Overall Loss:19.4811225
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.1267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8217397 KL Loss: 7.1593291 DSM Loss: 9.7228506 Overall Loss:18.7039195
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.5408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7789114 KL Loss: 7.1479643 DSM Loss: 9.7250251 Overall Loss:18.6519007
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0373913049697876


Running on file DUK.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.6966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8675777 KL Loss: 7.1859372 DSM Loss: 11.3938990 Overall Loss:20.4474140
Validation loss decreased (inf --> 6.769197).  Saving model ...
Updating learning rate to 0.0005
tensor(21.2204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5410, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7694833 KL Loss: 7.1334120 DSM Loss: 9.7044932 Overall Loss:18.6073884
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.1918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7990594 KL Loss: 7.1694402 DSM Loss: 9.2555407 Overall Loss:18.2240403
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.3700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8121, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7460055 KL Loss: 7.1015299 DSM Loss: 9.2233197 Overall Loss:18.0708551
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.6203460693359375
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.0100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8086668 KL Loss: 7.2297084 DSM Loss: 11.4689196 Overall Loss:20.5072947
Validation loss decreased (inf --> 7.191226).  Saving model ...
Updating learning rate to 0.0005
tensor(15.8710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3857, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7948024 KL Loss: 7.1860919 DSM Loss: 9.7603500 Overall Loss:18.7412442
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(22.1681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8079117 KL Loss: 7.1996359 DSM Loss: 9.2580447 Overall Loss:18.2655923
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(22.2860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7875063 KL Loss: 7.1685531 DSM Loss: 9.1725897 Overall Loss:18.1286489
Validation loss decreased (7.191226 --> 6.925433).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.1968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7202060 KL Loss: 7.0932542 DSM Loss: 9.2248095 Overall Loss:18.0382698
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(21.0408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7706639 KL Loss: 7.1437913 DSM Loss: 9.1586295 Overall Loss:18.0730848
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.5765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7337993 KL Loss: 7.1496796 DSM Loss: 9.0795291 Overall Loss:17.9630080
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.782405376434326
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.0625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8435533 KL Loss: 7.2448879 DSM Loss: 11.3300122 Overall Loss:20.4184533
Validation loss decreased (inf --> 6.577897).  Saving model ...
Updating learning rate to 0.0005
tensor(18.4672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8075669 KL Loss: 7.1320082 DSM Loss: 9.7454478 Overall Loss:18.6850228
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.0813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7606418 KL Loss: 7.1121574 DSM Loss: 9.4867246 Overall Loss:18.3595239
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(22.7496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7709734 KL Loss: 7.1732129 DSM Loss: 9.2366201 Overall Loss:18.1808063
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.489824295043945
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.6330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7910843 KL Loss: 7.1916433 DSM Loss: 10.9072394 Overall Loss:19.8899669
Validation loss decreased (inf --> 6.890835).  Saving model ...
Updating learning rate to 0.0005
tensor(18.7273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8148360 KL Loss: 7.2324053 DSM Loss: 9.6403660 Overall Loss:18.6876073
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.0218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0741, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7865596 KL Loss: 7.1368342 DSM Loss: 9.5668206 Overall Loss:18.4902144
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.5400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7522, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7925599 KL Loss: 7.1369410 DSM Loss: 9.1187442 Overall Loss:18.0482450
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.752787113189697
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.1739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8474105 KL Loss: 7.1774254 DSM Loss: 11.7032145 Overall Loss:20.7280504
Validation loss decreased (inf --> 7.052813).  Saving model ...
Updating learning rate to 0.0005
tensor(15.2140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9117, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7932668 KL Loss: 7.1336213 DSM Loss: 9.4676971 Overall Loss:18.3945852
Validation loss decreased (7.052813 --> 6.976574).  Saving model ...
Updating learning rate to 0.00025
tensor(17.9237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7889140 KL Loss: 7.1255895 DSM Loss: 9.5014883 Overall Loss:18.4159918
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.7203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7726028 KL Loss: 7.1873089 DSM Loss: 9.2960869 Overall Loss:18.2559986
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.1924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7247618 KL Loss: 7.1473988 DSM Loss: 9.1579183 Overall Loss:18.0300788
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.810145854949951


Running on file EXC.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.1024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8098967 KL Loss: 7.2214094 DSM Loss: 11.6674649 Overall Loss:20.6987711
Validation loss decreased (inf --> 10.958726).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8581313 KL Loss: 7.2762170 DSM Loss: 9.7666464 Overall Loss:18.9009946
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.5236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8338676 KL Loss: 7.1718918 DSM Loss: 9.3169870 Overall Loss:18.3227464
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.3086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7931157 KL Loss: 7.2141793 DSM Loss: 9.0936315 Overall Loss:18.1009265
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:13.948555946350098
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.9767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6930, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9058397 KL Loss: 7.1768543 DSM Loss: 11.2539846 Overall Loss:20.3366784
Validation loss decreased (inf --> 11.411591).  Saving model ...
Updating learning rate to 0.0005
tensor(21.1651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8379159 KL Loss: 7.1820395 DSM Loss: 9.6524247 Overall Loss:18.6723800
Validation loss decreased (11.411591 --> 10.751125).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8027664 KL Loss: 7.1322583 DSM Loss: 9.5815513 Overall Loss:18.5165759
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.8990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7773358 KL Loss: 7.1359585 DSM Loss: 9.0858142 Overall Loss:17.9991085
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.2276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3111, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7423991 KL Loss: 7.1419400 DSM Loss: 9.0103895 Overall Loss:17.8947285
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:13.65078353881836
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.5677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8457273 KL Loss: 7.2201378 DSM Loss: 14.9060788 Overall Loss:23.9719440
Validation loss decreased (inf --> 13.186079).  Saving model ...
Updating learning rate to 0.0005
tensor(19.2048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8320978 KL Loss: 7.2024297 DSM Loss: 9.9707492 Overall Loss:19.0052766
Validation loss decreased (13.186079 --> 12.952061).  Saving model ...
Updating learning rate to 0.00025
tensor(14.6316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8240343 KL Loss: 7.2340045 DSM Loss: 9.3585055 Overall Loss:18.4165442
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.4178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8039999 KL Loss: 7.1681615 DSM Loss: 9.2383930 Overall Loss:18.2105543
Validation loss decreased (12.952061 --> 12.277690).  Saving model ...
Updating learning rate to 6.25e-05
tensor(19.4473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6844, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7953952 KL Loss: 7.2271633 DSM Loss: 9.0952209 Overall Loss:18.1177794
Validation loss decreased (12.277690 --> 12.087125).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.9117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7951881 KL Loss: 7.1902763 DSM Loss: 9.0678247 Overall Loss:18.0532891
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(15.8205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7897455 KL Loss: 7.2290178 DSM Loss: 9.0587026 Overall Loss:18.0774660
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(16.1749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7760460 KL Loss: 7.1442917 DSM Loss: 9.1183728 Overall Loss:18.0387106
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:15.283178329467773
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.5054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8194064 KL Loss: 7.1937793 DSM Loss: 11.3455551 Overall Loss:20.3587408
Validation loss decreased (inf --> 13.107069).  Saving model ...
Updating learning rate to 0.0005
tensor(20.6944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8247740 KL Loss: 7.2019520 DSM Loss: 9.8117161 Overall Loss:18.8384421
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.3539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7659894 KL Loss: 7.0975326 DSM Loss: 9.2607658 Overall Loss:18.1242879
Validation loss decreased (13.107069 --> 11.437719).  Saving model ...
Updating learning rate to 0.000125
tensor(25.3491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7833519 KL Loss: 7.1771199 DSM Loss: 9.1805738 Overall Loss:18.1410455
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.2233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7158043 KL Loss: 7.0480851 DSM Loss: 9.0606290 Overall Loss:17.8245183
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(15.4838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4043, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7819106 KL Loss: 7.2059538 DSM Loss: 9.1218534 Overall Loss:18.1097179
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:14.52028751373291
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.7213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7886214 KL Loss: 7.2054437 DSM Loss: 10.4645256 Overall Loss:19.4585908
Validation loss decreased (inf --> 12.551193).  Saving model ...
Updating learning rate to 0.0005
tensor(20.3017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8147309 KL Loss: 7.1225799 DSM Loss: 9.7882844 Overall Loss:18.7255952
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(22.5146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8333731 KL Loss: 7.2031199 DSM Loss: 9.4174642 Overall Loss:18.4539572
Validation loss decreased (12.551193 --> 12.367573).  Saving model ...
Updating learning rate to 0.000125
tensor(16.9576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8237003 KL Loss: 7.1930986 DSM Loss: 9.1376783 Overall Loss:18.1544773
Validation loss decreased (12.367573 --> 11.636743).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.9579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7613530 KL Loss: 7.1876329 DSM Loss: 8.9522989 Overall Loss:17.9012847
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(17.8047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7403622 KL Loss: 7.1285810 DSM Loss: 8.9651014 Overall Loss:17.8340446
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(18.7533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7823332 KL Loss: 7.1338749 DSM Loss: 9.0560219 Overall Loss:17.9722300
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:14.75307846069336


Running on file GD.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.7336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8281438 KL Loss: 7.2472711 DSM Loss: 11.1109137 Overall Loss:20.1863286
Validation loss decreased (inf --> 5.215471).  Saving model ...
Updating learning rate to 0.0005
tensor(24.8938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8492441 KL Loss: 7.2362274 DSM Loss: 9.8497416 Overall Loss:18.9352131
Validation loss decreased (5.215471 --> 5.065985).  Saving model ...
Updating learning rate to 0.00025
tensor(20.5504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1602, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7779061 KL Loss: 7.1540620 DSM Loss: 9.5719696 Overall Loss:18.5039377
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(13.2265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7426668 KL Loss: 7.1350322 DSM Loss: 9.3798905 Overall Loss:18.2575895
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.4120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8083749 KL Loss: 7.2176417 DSM Loss: 9.3068031 Overall Loss:18.3328197
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.383435249328613
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.3625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8230521 KL Loss: 7.1992523 DSM Loss: 11.6228641 Overall Loss:20.6451685
Validation loss decreased (inf --> 6.104313).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8493779 KL Loss: 7.1791611 DSM Loss: 9.8769553 Overall Loss:18.9054943
Validation loss decreased (6.104313 --> 4.754706).  Saving model ...
Updating learning rate to 0.00025
tensor(16.2290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8067497 KL Loss: 7.1720804 DSM Loss: 9.6874810 Overall Loss:18.6663110
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.5243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7051, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8233536 KL Loss: 7.1932833 DSM Loss: 9.3890572 Overall Loss:18.4056942
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.8500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8086035 KL Loss: 7.2146585 DSM Loss: 9.2742943 Overall Loss:18.2975562
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.109968185424805
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.9022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2930, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8673759 KL Loss: 7.2007277 DSM Loss: 11.0231363 Overall Loss:20.0912397
Validation loss decreased (inf --> 5.342875).  Saving model ...
Updating learning rate to 0.0005
tensor(21.4196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7878515 KL Loss: 7.1680549 DSM Loss: 9.7777161 Overall Loss:18.7336226
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.6257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7972062 KL Loss: 7.1723698 DSM Loss: 9.3641464 Overall Loss:18.3337224
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.4387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7728746 KL Loss: 7.1488755 DSM Loss: 9.4557230 Overall Loss:18.3774730
Validation loss decreased (5.342875 --> 5.242893).  Saving model ...
Updating learning rate to 6.25e-05
tensor(24.3961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8015231 KL Loss: 7.1629287 DSM Loss: 9.2849411 Overall Loss:18.2493928
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(16.4800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7693452 KL Loss: 7.1790646 DSM Loss: 9.2611570 Overall Loss:18.2095669
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(13.5873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7712865 KL Loss: 7.1737600 DSM Loss: 9.1579272 Overall Loss:18.1029737
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.772027969360352
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.4185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8384315 KL Loss: 7.1737504 DSM Loss: 11.1583151 Overall Loss:20.1704972
Validation loss decreased (inf --> 5.110928).  Saving model ...
Updating learning rate to 0.0005
tensor(19.1233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7779422 KL Loss: 7.1345730 DSM Loss: 9.8944164 Overall Loss:18.8069315
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.6851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9720, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7478448 KL Loss: 7.0652924 DSM Loss: 9.5396980 Overall Loss:18.3528352
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.3040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1419, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7845512 KL Loss: 7.1886330 DSM Loss: 9.2430997 Overall Loss:18.2162839
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.577799797058105
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.1310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0127, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8752563 KL Loss: 7.1840769 DSM Loss: 11.7385311 Overall Loss:20.7978644
Validation loss decreased (inf --> 4.817223).  Saving model ...
Updating learning rate to 0.0005
tensor(15.2669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8093531 KL Loss: 7.1703228 DSM Loss: 9.9741368 Overall Loss:18.9538127
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.8913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7681919 KL Loss: 7.1345724 DSM Loss: 9.5772286 Overall Loss:18.4799929
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.2772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8662, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8068183 KL Loss: 7.1972194 DSM Loss: 9.2568169 Overall Loss:18.2608548
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.184202194213867


Running on file GE.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.5518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8271960 KL Loss: 7.1486678 DSM Loss: 13.3294598 Overall Loss:22.3053237
Validation loss decreased (inf --> 0.150767).  Saving model ...
Updating learning rate to 0.0005
tensor(15.4646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8006474 KL Loss: 7.1386669 DSM Loss: 10.5375241 Overall Loss:19.4768384
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.7957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7399733 KL Loss: 7.0863130 DSM Loss: 9.9686918 Overall Loss:18.7949781
Validation loss decreased (0.150767 --> 0.143265).  Saving model ...
Updating learning rate to 0.000125
tensor(20.4431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7855188 KL Loss: 7.1877011 DSM Loss: 9.6977354 Overall Loss:18.6709553
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.3825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7526463 KL Loss: 7.0891763 DSM Loss: 9.5462585 Overall Loss:18.3880811
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(21.6991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7485411 KL Loss: 7.1590318 DSM Loss: 9.6600874 Overall Loss:18.5676603
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.27009788155555725
Use GPU: cuda:0
>>>>>>>start training : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.8157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7666664 KL Loss: 7.1937478 DSM Loss: 12.3592223 Overall Loss:21.3196365
Validation loss decreased (inf --> 0.077215).  Saving model ...
Updating learning rate to 0.0005
tensor(15.3676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4189, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7713865 KL Loss: 7.1269330 DSM Loss: 10.1765829 Overall Loss:19.0749024
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.2961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8405815 KL Loss: 7.1648052 DSM Loss: 9.8443128 Overall Loss:18.8496993
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.4623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8318543 KL Loss: 7.2130501 DSM Loss: 9.7568206 Overall Loss:18.8017251
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.16992317140102386
Use GPU: cuda:0
>>>>>>>start training : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.3794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8123689 KL Loss: 7.2207415 DSM Loss: 11.3677150 Overall Loss:20.4008254
Validation loss decreased (inf --> 0.454410).  Saving model ...
Updating learning rate to 0.0005
tensor(14.5524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8178326 KL Loss: 7.1372949 DSM Loss: 10.3734155 Overall Loss:19.3285429
Validation loss decreased (0.454410 --> 0.254162).  Saving model ...
Updating learning rate to 0.00025
tensor(17.9054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8153117 KL Loss: 7.1835885 DSM Loss: 9.8825863 Overall Loss:18.8814866
Validation loss decreased (0.254162 --> 0.187643).  Saving model ...
Updating learning rate to 0.000125
tensor(22.8522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7807245 KL Loss: 7.1719567 DSM Loss: 9.6565185 Overall Loss:18.6091997
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(18.9163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1663, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7709717 KL Loss: 7.1812613 DSM Loss: 9.6162547 Overall Loss:18.5684877
Validation loss decreased (0.187643 --> 0.166713).  Saving model ...
Updating learning rate to 3.125e-05
tensor(15.1627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9933, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7962348 KL Loss: 7.1906814 DSM Loss: 9.4492572 Overall Loss:18.4361733
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(17.8771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7647440 KL Loss: 7.1648146 DSM Loss: 9.5577348 Overall Loss:18.4872934
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(21.9979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7685544 KL Loss: 7.1590588 DSM Loss: 9.3982315 Overall Loss:18.3258446
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.30634748935699463
Use GPU: cuda:0
>>>>>>>start training : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8579026 KL Loss: 7.1357232 DSM Loss: 12.2553607 Overall Loss:21.2489864
Validation loss decreased (inf --> 0.246074).  Saving model ...
Updating learning rate to 0.0005
tensor(24.2083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8151962 KL Loss: 7.2147767 DSM Loss: 9.9827940 Overall Loss:19.0127669
Validation loss decreased (0.246074 --> 0.130742).  Saving model ...
Updating learning rate to 0.00025
tensor(19.1229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7439654 KL Loss: 7.0705647 DSM Loss: 9.9198125 Overall Loss:18.7343426
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.6296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8302815 KL Loss: 7.1681612 DSM Loss: 9.6051509 Overall Loss:18.6035935
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.5854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0736, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7951259 KL Loss: 7.1756365 DSM Loss: 9.4785919 Overall Loss:18.4493544
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.29608291387557983
Use GPU: cuda:0
>>>>>>>start training : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.8236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8319, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8194172 KL Loss: 7.2040091 DSM Loss: 11.7122541 Overall Loss:20.7356804
Validation loss decreased (inf --> 0.324352).  Saving model ...
Updating learning rate to 0.0005
tensor(17.2885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7754304 KL Loss: 7.1278673 DSM Loss: 10.3124960 Overall Loss:19.2157937
Validation loss decreased (0.324352 --> 0.154305).  Saving model ...
Updating learning rate to 0.00025
tensor(24.3755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7931772 KL Loss: 7.1461154 DSM Loss: 9.7196314 Overall Loss:18.6589239
Validation loss decreased (0.154305 --> 0.115935).  Saving model ...
Updating learning rate to 0.000125
tensor(23.1649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7666706 KL Loss: 7.1073814 DSM Loss: 9.6685131 Overall Loss:18.5425652
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(18.6693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.6758655 KL Loss: 7.0765185 DSM Loss: 9.6234111 Overall Loss:18.3757951
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(14.4122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9320, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7065477 KL Loss: 7.0793855 DSM Loss: 9.4781632 Overall Loss:18.2640964
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.28122398257255554


Running on file GOOG.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.1952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8425113 KL Loss: 7.2228918 DSM Loss: 11.1955983 Overall Loss:20.2610014
Validation loss decreased (inf --> 12.127745).  Saving model ...
Updating learning rate to 0.0005
tensor(20.2398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8157804 KL Loss: 7.1306580 DSM Loss: 9.7706030 Overall Loss:18.7170414
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(31.8632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8147958 KL Loss: 7.1954578 DSM Loss: 9.3823633 Overall Loss:18.3926169
Validation loss decreased (12.127745 --> 11.650086).  Saving model ...
Updating learning rate to 0.000125
tensor(18.0881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7976555 KL Loss: 7.1574049 DSM Loss: 9.0788477 Overall Loss:18.0339081
Validation loss decreased (11.650086 --> 11.416394).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.7339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7818274 KL Loss: 7.1429899 DSM Loss: 9.3126435 Overall Loss:18.2374608
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(22.9681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6051, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7937276 KL Loss: 7.1549882 DSM Loss: 9.0517883 Overall Loss:18.0005042
Validation loss decreased (11.416394 --> 11.282667).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(23.5909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4384, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7459129 KL Loss: 7.0845986 DSM Loss: 9.1056123 Overall Loss:17.9361237
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(19.7828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7590243 KL Loss: 7.0986644 DSM Loss: 8.9572542 Overall Loss:17.8149428
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(21.0071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7289554 KL Loss: 7.0966061 DSM Loss: 9.1538159 Overall Loss:17.9793774
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.611032485961914
Use GPU: cuda:0
>>>>>>>start training : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.8401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8759601 KL Loss: 7.1970167 DSM Loss: 12.2219374 Overall Loss:21.2949142
Validation loss decreased (inf --> 12.261917).  Saving model ...
Updating learning rate to 0.0005
tensor(17.8932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8412336 KL Loss: 7.2001720 DSM Loss: 9.9198611 Overall Loss:18.9612667
Validation loss decreased (12.261917 --> 11.338765).  Saving model ...
Updating learning rate to 0.00025
tensor(16.9307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7861740 KL Loss: 7.1526520 DSM Loss: 9.5563319 Overall Loss:18.4951579
Validation loss decreased (11.338765 --> 11.091845).  Saving model ...
Updating learning rate to 0.000125
tensor(11.9280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5619, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7992611 KL Loss: 7.1334372 DSM Loss: 9.2607908 Overall Loss:18.1934892
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(25.5675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8169951 KL Loss: 7.1457304 DSM Loss: 9.0653721 Overall Loss:18.0280975
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(24.4164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7348183 KL Loss: 7.1419909 DSM Loss: 8.9982563 Overall Loss:17.8750654
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.473597526550293
Use GPU: cuda:0
>>>>>>>start training : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(20.7355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0415, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8881324 KL Loss: 7.2991128 DSM Loss: 12.7832828 Overall Loss:21.9705281
Validation loss decreased (inf --> 11.015276).  Saving model ...
Updating learning rate to 0.0005
tensor(12.7184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4264, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8078056 KL Loss: 7.1256292 DSM Loss: 10.1628882 Overall Loss:19.0963230
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(30.3965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8177003 KL Loss: 7.1818324 DSM Loss: 9.5531661 Overall Loss:18.5526987
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.7124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7636232 KL Loss: 7.1015088 DSM Loss: 9.5247245 Overall Loss:18.3898564
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.317987442016602
Use GPU: cuda:0
>>>>>>>start training : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.1662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8140857 KL Loss: 7.1915764 DSM Loss: 12.4270833 Overall Loss:21.4327454
Validation loss decreased (inf --> 11.551615).  Saving model ...
Updating learning rate to 0.0005
tensor(14.0693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8001504 KL Loss: 7.1745944 DSM Loss: 9.9650041 Overall Loss:18.9397490
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.0640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5509, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8431559 KL Loss: 7.1787178 DSM Loss: 9.4567894 Overall Loss:18.4786631
Validation loss decreased (11.551615 --> 10.860185).  Saving model ...
Updating learning rate to 0.000125
tensor(17.0573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7654313 KL Loss: 7.1269596 DSM Loss: 9.4211310 Overall Loss:18.3135220
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.6222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7723152 KL Loss: 7.1553778 DSM Loss: 8.9983382 Overall Loss:17.9260311
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(29.4075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7808460 KL Loss: 7.2034255 DSM Loss: 9.0276344 Overall Loss:18.0119060
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.248083114624023
Use GPU: cuda:0
>>>>>>>start training : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.1367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8620299 KL Loss: 7.2935815 DSM Loss: 12.1730701 Overall Loss:21.3286815
Validation loss decreased (inf --> 11.045224).  Saving model ...
Updating learning rate to 0.0005
tensor(14.9498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1000, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8142292 KL Loss: 7.1887482 DSM Loss: 9.8327380 Overall Loss:18.8357155
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.5642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.6558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7887030 KL Loss: 7.1521098 DSM Loss: 9.7266935 Overall Loss:18.6675062
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.2430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.0420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7578132 KL Loss: 7.2082044 DSM Loss: 9.4060399 Overall Loss:18.3720576
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.375595569610596


Running on file HD.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.4464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7889921 KL Loss: 7.1792248 DSM Loss: 12.3756176 Overall Loss:21.3438344
Validation loss decreased (inf --> 6.852194).  Saving model ...
Updating learning rate to 0.0005
tensor(23.8759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1741, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7720202 KL Loss: 7.1108177 DSM Loss: 10.0693607 Overall Loss:18.9521985
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.1438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8582945 KL Loss: 7.1791274 DSM Loss: 9.7344501 Overall Loss:18.7718720
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.6496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8030277 KL Loss: 7.1963335 DSM Loss: 9.4439963 Overall Loss:18.4433574
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.9098501205444336
Use GPU: cuda:0
>>>>>>>start training : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.1397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8290438 KL Loss: 7.2031961 DSM Loss: 11.7927950 Overall Loss:20.8250348
Validation loss decreased (inf --> 7.766114).  Saving model ...
Updating learning rate to 0.0005
tensor(24.4527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7976205 KL Loss: 7.1279655 DSM Loss: 9.8481825 Overall Loss:18.7737687
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.3279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7851880 KL Loss: 7.1157223 DSM Loss: 9.6907604 Overall Loss:18.5916708
Validation loss decreased (7.766114 --> 7.325054).  Saving model ...
Updating learning rate to 0.000125
tensor(17.1784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8065103 KL Loss: 7.2184188 DSM Loss: 9.3921456 Overall Loss:18.4170747
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(19.2727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7320331 KL Loss: 7.0967892 DSM Loss: 9.3709583 Overall Loss:18.1997806
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(16.4809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0533, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8034972 KL Loss: 7.1665280 DSM Loss: 9.3181624 Overall Loss:18.2881876
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.286168098449707
Use GPU: cuda:0
>>>>>>>start training : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.3082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8329896 KL Loss: 7.1953662 DSM Loss: 11.5084097 Overall Loss:20.5367656
Validation loss decreased (inf --> 6.979198).  Saving model ...
Updating learning rate to 0.0005
tensor(21.4033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8436031 KL Loss: 7.1732914 DSM Loss: 9.9383008 Overall Loss:18.9551952
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.1778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7846359 KL Loss: 7.1821117 DSM Loss: 9.6298330 Overall Loss:18.5965806
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(23.2728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8151247 KL Loss: 7.1941189 DSM Loss: 9.4443721 Overall Loss:18.4536158
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.960742473602295
Use GPU: cuda:0
>>>>>>>start training : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.5424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8085021 KL Loss: 7.2384558 DSM Loss: 12.3211086 Overall Loss:21.3680665
Validation loss decreased (inf --> 8.129261).  Saving model ...
Updating learning rate to 0.0005
tensor(20.2912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8348557 KL Loss: 7.0890373 DSM Loss: 10.3919797 Overall Loss:19.3158725
Validation loss decreased (8.129261 --> 7.546942).  Saving model ...
Updating learning rate to 0.00025
tensor(19.1294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8675, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8000101 KL Loss: 7.2007382 DSM Loss: 9.7309505 Overall Loss:18.7316988
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.8141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7451746 KL Loss: 7.1264841 DSM Loss: 9.5469118 Overall Loss:18.4185705
Validation loss decreased (7.546942 --> 7.402046).  Saving model ...
Updating learning rate to 6.25e-05
tensor(19.0570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7298096 KL Loss: 7.1123181 DSM Loss: 9.3191287 Overall Loss:18.1612564
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(22.1064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7478806 KL Loss: 7.1622508 DSM Loss: 9.1256633 Overall Loss:18.0357945
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(20.0170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7851294 KL Loss: 7.2174120 DSM Loss: 9.1988848 Overall Loss:18.2014261
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.32781457901001
Use GPU: cuda:0
>>>>>>>start training : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(19.7058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7611508 KL Loss: 7.2192725 DSM Loss: 14.5192295 Overall Loss:23.4996528
Validation loss decreased (inf --> 7.857325).  Saving model ...
Updating learning rate to 0.0005
tensor(20.8927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8926, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8144293 KL Loss: 7.1197339 DSM Loss: 9.9723065 Overall Loss:18.9064696
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.5871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7981825 KL Loss: 7.1156105 DSM Loss: 9.6170700 Overall Loss:18.5308632
Validation loss decreased (7.857325 --> 7.746863).  Saving model ...
Updating learning rate to 0.000125
tensor(14.1786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4798, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8616593 KL Loss: 7.2916716 DSM Loss: 9.4426453 Overall Loss:18.5959762
Validation loss decreased (7.746863 --> 7.226890).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.1552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7671443 KL Loss: 7.1357034 DSM Loss: 9.2821735 Overall Loss:18.1850211
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(22.6311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7943061 KL Loss: 7.1581832 DSM Loss: 9.1860872 Overall Loss:18.1385766
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(24.8382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7562422 KL Loss: 7.1026642 DSM Loss: 9.3035483 Overall Loss:18.1624547
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.198239803314209


Running on file HON.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.6670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7778377 KL Loss: 7.2106781 DSM Loss: 12.1463679 Overall Loss:21.1348837
Validation loss decreased (inf --> 3.718344).  Saving model ...
Updating learning rate to 0.0005
tensor(25.8070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8064119 KL Loss: 7.1372755 DSM Loss: 9.8719503 Overall Loss:18.8156378
Validation loss decreased (3.718344 --> 3.320713).  Saving model ...
Updating learning rate to 0.00025
tensor(19.0565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.0541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8279124 KL Loss: 7.1882505 DSM Loss: 9.6717322 Overall Loss:18.6878951
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(26.7092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7733069 KL Loss: 7.1249874 DSM Loss: 9.4096666 Overall Loss:18.3079609
Validation loss decreased (3.320713 --> 3.236673).  Saving model ...
Updating learning rate to 6.25e-05
tensor(24.1969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7586050 KL Loss: 7.1001601 DSM Loss: 9.2661753 Overall Loss:18.1249404
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(14.8671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7761304 KL Loss: 7.2055156 DSM Loss: 9.1500893 Overall Loss:18.1317354
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(24.6512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7742829 KL Loss: 7.2037599 DSM Loss: 9.0852969 Overall Loss:18.0633397
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.4665048122406006
Use GPU: cuda:0
>>>>>>>start training : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(20.0456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4738, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8789142 KL Loss: 7.2726445 DSM Loss: 11.1866857 Overall Loss:20.3382445
Validation loss decreased (inf --> 2.543293).  Saving model ...
Updating learning rate to 0.0005
tensor(25.3870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7962294 KL Loss: 7.1911643 DSM Loss: 10.2105205 Overall Loss:19.1979143
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.4240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8344664 KL Loss: 7.1964141 DSM Loss: 9.4524401 Overall Loss:18.4833205
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.5093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8076222 KL Loss: 7.2079848 DSM Loss: 9.4210435 Overall Loss:18.4366505
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.875274419784546
Use GPU: cuda:0
>>>>>>>start training : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.5358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3048, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8245017 KL Loss: 7.2113291 DSM Loss: 12.1032589 Overall Loss:21.1390897
Validation loss decreased (inf --> 3.478022).  Saving model ...
Updating learning rate to 0.0005
tensor(15.2827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8016057 KL Loss: 7.1880779 DSM Loss: 9.8872692 Overall Loss:18.8769528
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(28.1191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7504671 KL Loss: 7.1544703 DSM Loss: 9.3724194 Overall Loss:18.2773567
Validation loss decreased (3.478022 --> 3.141853).  Saving model ...
Updating learning rate to 0.000125
tensor(16.4338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8602, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8372970 KL Loss: 7.2374298 DSM Loss: 9.2949867 Overall Loss:18.3697135
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.3910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7672318 KL Loss: 7.1724901 DSM Loss: 9.2269705 Overall Loss:18.1666924
Validation loss decreased (3.141853 --> 3.130147).  Saving model ...
Updating learning rate to 3.125e-05
tensor(13.6673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7916961 KL Loss: 7.2035819 DSM Loss: 9.2428673 Overall Loss:18.2381455
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(13.9239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7987733 KL Loss: 7.2328061 DSM Loss: 9.0491930 Overall Loss:18.0807723
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(12.5943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7761792 KL Loss: 7.1027441 DSM Loss: 9.2791488 Overall Loss:18.1580722
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.3797287940979004
Use GPU: cuda:0
>>>>>>>start training : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.8383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8079528 KL Loss: 7.1950935 DSM Loss: 11.5756623 Overall Loss:20.5787087
Validation loss decreased (inf --> 3.408854).  Saving model ...
Updating learning rate to 0.0005
tensor(19.2835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8373445 KL Loss: 7.1788779 DSM Loss: 10.0246283 Overall Loss:19.0408507
Validation loss decreased (3.408854 --> 3.300076).  Saving model ...
Updating learning rate to 0.00025
tensor(22.7067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7919210 KL Loss: 7.1437496 DSM Loss: 9.7103714 Overall Loss:18.6460419
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.7465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8179864 KL Loss: 7.2378664 DSM Loss: 9.2454112 Overall Loss:18.3012639
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.7795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7663690 KL Loss: 7.1661259 DSM Loss: 9.3005946 Overall Loss:18.2330896
Validation loss decreased (3.300076 --> 3.193754).  Saving model ...
Updating learning rate to 3.125e-05
tensor(20.5352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7629603 KL Loss: 7.1015312 DSM Loss: 9.2947458 Overall Loss:18.1592374
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(22.3590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1822, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7904703 KL Loss: 7.1358823 DSM Loss: 9.1827832 Overall Loss:18.1091358
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(16.1770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7955863 KL Loss: 7.2037278 DSM Loss: 9.1617611 Overall Loss:18.1610751
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.4356191158294678
Use GPU: cuda:0
>>>>>>>start training : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.8515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8254769 KL Loss: 7.2082162 DSM Loss: 11.3552347 Overall Loss:20.3889278
Validation loss decreased (inf --> 3.438032).  Saving model ...
Updating learning rate to 0.0005
tensor(15.8551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8236742 KL Loss: 7.1950184 DSM Loss: 9.9449520 Overall Loss:18.9636446
Validation loss decreased (3.438032 --> 3.223598).  Saving model ...
Updating learning rate to 0.00025
tensor(16.8451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8031392 KL Loss: 7.1735010 DSM Loss: 9.4856775 Overall Loss:18.4623176
Validation loss decreased (3.223598 --> 2.968794).  Saving model ...
Updating learning rate to 0.000125
tensor(18.7212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7691379 KL Loss: 7.1398264 DSM Loss: 9.3783970 Overall Loss:18.2873613
Validation loss decreased (2.968794 --> 2.942161).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.7131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7804154 KL Loss: 7.1617397 DSM Loss: 9.1668647 Overall Loss:18.1090198
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(16.0698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2607, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7200116 KL Loss: 7.1199521 DSM Loss: 9.1784310 Overall Loss:18.0183947
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(26.2091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7928712 KL Loss: 7.1247432 DSM Loss: 9.2657357 Overall Loss:18.1833502
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.2255945205688477


Running on file HSBC.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.3937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8277282 KL Loss: 7.2186678 DSM Loss: 11.7333991 Overall Loss:20.7797950
Validation loss decreased (inf --> 0.272247).  Saving model ...
Updating learning rate to 0.0005
tensor(19.5070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7746384 KL Loss: 7.1680769 DSM Loss: 10.3544514 Overall Loss:19.2971666
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.5127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8101879 KL Loss: 7.1997132 DSM Loss: 10.1038414 Overall Loss:19.1137426
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.1382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7466884 KL Loss: 7.1122752 DSM Loss: 9.7924538 Overall Loss:18.6514173
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9385364055633545
Use GPU: cuda:0
>>>>>>>start training : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.8917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8416398 KL Loss: 7.2269600 DSM Loss: 12.4387214 Overall Loss:21.5073212
Validation loss decreased (inf --> 0.362847).  Saving model ...
Updating learning rate to 0.0005
tensor(15.9400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8376049 KL Loss: 7.1938776 DSM Loss: 10.4182515 Overall Loss:19.4497339
Validation loss decreased (0.362847 --> 0.265283).  Saving model ...
Updating learning rate to 0.00025
tensor(25.0244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7726781 KL Loss: 7.1323802 DSM Loss: 9.7478973 Overall Loss:18.6529556
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.4433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7698296 KL Loss: 7.1697410 DSM Loss: 9.6157957 Overall Loss:18.5553663
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.5971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8089988 KL Loss: 7.2134997 DSM Loss: 9.6336917 Overall Loss:18.6561902
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.146613359451294
Use GPU: cuda:0
>>>>>>>start training : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.7666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8341707 KL Loss: 7.1815522 DSM Loss: 11.7613657 Overall Loss:20.7770886
Validation loss decreased (inf --> 0.218301).  Saving model ...
Updating learning rate to 0.0005
tensor(21.7988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7777599 KL Loss: 7.0668849 DSM Loss: 10.3603577 Overall Loss:19.2050025
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.5842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7736299 KL Loss: 7.1683144 DSM Loss: 10.0695503 Overall Loss:19.0114946
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.5935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.1892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7804236 KL Loss: 7.1635190 DSM Loss: 9.4718157 Overall Loss:18.4157582
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9293293356895447
Use GPU: cuda:0
>>>>>>>start training : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.2351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8726219 KL Loss: 7.2551661 DSM Loss: 11.6810865 Overall Loss:20.8088745
Validation loss decreased (inf --> 0.304111).  Saving model ...
Updating learning rate to 0.0005
tensor(18.8629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7850741 KL Loss: 7.1713164 DSM Loss: 10.3487415 Overall Loss:19.3051321
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.6684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7913189 KL Loss: 7.1870975 DSM Loss: 9.7143366 Overall Loss:18.6927529
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(24.1813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7951350 KL Loss: 7.1413220 DSM Loss: 9.6051447 Overall Loss:18.5416017
Validation loss decreased (0.304111 --> 0.292664).  Saving model ...
Updating learning rate to 6.25e-05
tensor(23.0501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7836022 KL Loss: 7.1679551 DSM Loss: 9.5329454 Overall Loss:18.4845025
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(15.4731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7515354 KL Loss: 7.2122164 DSM Loss: 9.5909454 Overall Loss:18.5546973
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(18.4142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1355, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7781139 KL Loss: 7.1762177 DSM Loss: 9.4421329 Overall Loss:18.3964643
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1010087728500366
Use GPU: cuda:0
>>>>>>>start training : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.7037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8534330 KL Loss: 7.1974331 DSM Loss: 12.5007311 Overall Loss:21.5515972
Validation loss decreased (inf --> 0.450292).  Saving model ...
Updating learning rate to 0.0005
tensor(21.7935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8166647 KL Loss: 7.1630793 DSM Loss: 10.3927156 Overall Loss:19.3724595
Validation loss decreased (0.450292 --> 0.387791).  Saving model ...
Updating learning rate to 0.00025
tensor(19.7806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7925168 KL Loss: 7.1992150 DSM Loss: 9.8033232 Overall Loss:18.7950549
Validation loss decreased (0.387791 --> 0.317068).  Saving model ...
Updating learning rate to 0.000125
tensor(17.7785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3229, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7483831 KL Loss: 7.1374527 DSM Loss: 9.6509234 Overall Loss:18.5367592
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.3245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4822, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7368913 KL Loss: 7.1229781 DSM Loss: 9.5046144 Overall Loss:18.3644838
Validation loss decreased (0.317068 --> 0.312169).  Saving model ...
Updating learning rate to 3.125e-05
tensor(17.8404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7405070 KL Loss: 7.1155773 DSM Loss: 9.4278356 Overall Loss:18.2839200
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(15.5086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8051923 KL Loss: 7.2227425 DSM Loss: 9.6068314 Overall Loss:18.6347662
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(16.9582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7857836 KL Loss: 7.1800121 DSM Loss: 9.4845748 Overall Loss:18.4503705
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0939542055130005


Running on file IEP.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.7023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5882, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9018361 KL Loss: 7.2281252 DSM Loss: 11.8693720 Overall Loss:20.9993332
Validation loss decreased (inf --> 2.618630).  Saving model ...
Updating learning rate to 0.0005
tensor(19.6026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6035, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8563313 KL Loss: 7.2073406 DSM Loss: 10.2221502 Overall Loss:19.2858220
Validation loss decreased (2.618630 --> 2.002529).  Saving model ...
Updating learning rate to 0.00025
tensor(19.1967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7328872 KL Loss: 7.1374692 DSM Loss: 9.7360976 Overall Loss:18.6064542
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.4506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8105306 KL Loss: 7.2307436 DSM Loss: 9.4555775 Overall Loss:18.4968515
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.9765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6216, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7721493 KL Loss: 7.1538206 DSM Loss: 9.4102047 Overall Loss:18.3361745
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.1539504528045654
Use GPU: cuda:0
>>>>>>>start training : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.4347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8026498 KL Loss: 7.1899518 DSM Loss: 12.4339523 Overall Loss:21.4265537
Validation loss decreased (inf --> 2.118878).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7260320 KL Loss: 7.0769818 DSM Loss: 9.9440132 Overall Loss:18.7470271
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.3801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8011388 KL Loss: 7.1538848 DSM Loss: 9.7573198 Overall Loss:18.7123434
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.2824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8218715 KL Loss: 7.1926457 DSM Loss: 9.5384551 Overall Loss:18.5529723
Validation loss decreased (2.118878 --> 1.984481).  Saving model ...
Updating learning rate to 6.25e-05
tensor(19.0291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7601824 KL Loss: 7.1453428 DSM Loss: 9.4232025 Overall Loss:18.3287275
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(18.4094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7363239 KL Loss: 7.1429134 DSM Loss: 9.3489269 Overall Loss:18.2281641
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.5554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7575660 KL Loss: 7.1177068 DSM Loss: 9.3929472 Overall Loss:18.2682200
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.2167553901672363
Use GPU: cuda:0
>>>>>>>start training : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.3311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8425466 KL Loss: 7.1977024 DSM Loss: 13.1428890 Overall Loss:22.1831378
Validation loss decreased (inf --> 1.850456).  Saving model ...
Updating learning rate to 0.0005
tensor(20.5694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6571, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7959445 KL Loss: 7.0919892 DSM Loss: 10.2750840 Overall Loss:19.1630175
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.1391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7492206 KL Loss: 7.1202126 DSM Loss: 9.4743947 Overall Loss:18.3438277
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.6850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7505078 KL Loss: 7.0740106 DSM Loss: 9.6135271 Overall Loss:18.4380454
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.160738706588745
Use GPU: cuda:0
>>>>>>>start training : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.8168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8212985 KL Loss: 7.1879108 DSM Loss: 11.0350979 Overall Loss:20.0443071
Validation loss decreased (inf --> 1.829281).  Saving model ...
Updating learning rate to 0.0005
tensor(20.1842, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8717469 KL Loss: 7.1870410 DSM Loss: 10.0991225 Overall Loss:19.1579105
Validation loss decreased (1.829281 --> 1.681306).  Saving model ...
Updating learning rate to 0.00025
tensor(16.4433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8021333 KL Loss: 7.1883072 DSM Loss: 9.6760472 Overall Loss:18.6664877
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.7866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4115, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7995314 KL Loss: 7.1931166 DSM Loss: 9.3738570 Overall Loss:18.3665050
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.7542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2732, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7614654 KL Loss: 7.1100731 DSM Loss: 9.4416646 Overall Loss:18.3132031
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.123792886734009
Use GPU: cuda:0
>>>>>>>start training : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.6083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8636293 KL Loss: 7.2329225 DSM Loss: 13.8772598 Overall Loss:22.9738115
Validation loss decreased (inf --> 1.785195).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8769, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.9175716 KL Loss: 7.1496519 DSM Loss: 10.2862092 Overall Loss:19.3534327
Validation loss decreased (1.785195 --> 1.675039).  Saving model ...
Updating learning rate to 0.00025
tensor(17.6920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8505564 KL Loss: 7.2267920 DSM Loss: 9.5352932 Overall Loss:18.6126415
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.9457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8077874 KL Loss: 7.1499552 DSM Loss: 9.5214817 Overall Loss:18.4792242
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.5280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5891, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7450167 KL Loss: 7.1087288 DSM Loss: 9.4511389 Overall Loss:18.3048844
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.009974241256714


Running on file INTC.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.9508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5056, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8374102 KL Loss: 7.2047690 DSM Loss: 12.2332416 Overall Loss:21.2754207
Validation loss decreased (inf --> 0.632902).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8452, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8274795 KL Loss: 7.1628093 DSM Loss: 9.9792578 Overall Loss:18.9695465
Validation loss decreased (0.632902 --> 0.358829).  Saving model ...
Updating learning rate to 0.00025
tensor(18.6812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8155157 KL Loss: 7.1614018 DSM Loss: 9.7213506 Overall Loss:18.6982681
Validation loss decreased (0.358829 --> 0.279890).  Saving model ...
Updating learning rate to 0.000125
tensor(18.0441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8440163 KL Loss: 7.1735972 DSM Loss: 9.5468892 Overall Loss:18.5645026
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(14.5175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7984655 KL Loss: 7.1586385 DSM Loss: 9.6295987 Overall Loss:18.5867028
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(14.4356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7412048 KL Loss: 7.0734953 DSM Loss: 9.3136809 Overall Loss:18.1283810
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.9934084415435791
Use GPU: cuda:0
>>>>>>>start training : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.6612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8246993 KL Loss: 7.1618834 DSM Loss: 12.0106287 Overall Loss:20.9972115
Validation loss decreased (inf --> 0.312592).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7800015 KL Loss: 7.1613678 DSM Loss: 10.0411510 Overall Loss:18.9825202
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.8578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7905738 KL Loss: 7.2120817 DSM Loss: 9.7017477 Overall Loss:18.7044033
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.6717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8127841 KL Loss: 7.2450304 DSM Loss: 9.5196883 Overall Loss:18.5775027
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.177257776260376
Use GPU: cuda:0
>>>>>>>start training : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.6694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8173066 KL Loss: 7.1638340 DSM Loss: 12.7577743 Overall Loss:21.7389149
Validation loss decreased (inf --> 0.470405).  Saving model ...
Updating learning rate to 0.0005
tensor(19.1369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8451459 KL Loss: 7.2423429 DSM Loss: 9.8960607 Overall Loss:18.9835495
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.8494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8287804 KL Loss: 7.2023221 DSM Loss: 9.6119265 Overall Loss:18.6430290
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(23.5950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5844, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7947136 KL Loss: 7.1810971 DSM Loss: 9.4954311 Overall Loss:18.4712418
Validation loss decreased (0.470405 --> 0.356932).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.3548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8100118 KL Loss: 7.1896724 DSM Loss: 9.3935945 Overall Loss:18.3932787
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(18.9316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7812985 KL Loss: 7.1872424 DSM Loss: 9.3768278 Overall Loss:18.3453686
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.6254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7391181 KL Loss: 7.1903867 DSM Loss: 9.2551402 Overall Loss:18.1846450
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2187234163284302
Use GPU: cuda:0
>>>>>>>start training : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.6169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8960919 KL Loss: 7.2404809 DSM Loss: 11.4502205 Overall Loss:20.5867934
Validation loss decreased (inf --> 0.377810).  Saving model ...
Updating learning rate to 0.0005
tensor(19.8713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3179, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8429340 KL Loss: 7.2583381 DSM Loss: 10.1368581 Overall Loss:19.2381302
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(23.1363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8783068 KL Loss: 7.2115875 DSM Loss: 9.7326767 Overall Loss:18.8225711
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.1141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5123, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7645456 KL Loss: 7.1661262 DSM Loss: 9.5630582 Overall Loss:18.4937300
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.160027265548706
Use GPU: cuda:0
>>>>>>>start training : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.0491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8792512 KL Loss: 7.1520337 DSM Loss: 12.5444427 Overall Loss:21.5757276
Validation loss decreased (inf --> 0.607333).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5040, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8284906 KL Loss: 7.1601695 DSM Loss: 10.2361426 Overall Loss:19.2248027
Validation loss decreased (0.607333 --> 0.361478).  Saving model ...
Updating learning rate to 0.00025
tensor(20.8416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4863, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8322246 KL Loss: 7.1937253 DSM Loss: 9.7900387 Overall Loss:18.8159885
Validation loss decreased (0.361478 --> 0.346973).  Saving model ...
Updating learning rate to 0.000125
tensor(16.5636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7633055 KL Loss: 7.0356099 DSM Loss: 9.4181109 Overall Loss:18.2170263
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.9547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7414975 KL Loss: 7.1712497 DSM Loss: 9.2973619 Overall Loss:18.2101090
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.8239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7843, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7350650 KL Loss: 7.0572669 DSM Loss: 9.4167210 Overall Loss:18.2090528
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.0667386054992676


Running on file JNJ.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.3340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8428612 KL Loss: 7.1684250 DSM Loss: 12.0608184 Overall Loss:21.0721045
Validation loss decreased (inf --> 4.441415).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8337050 KL Loss: 7.1468600 DSM Loss: 10.0242216 Overall Loss:19.0047866
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.2289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8287519 KL Loss: 7.1656614 DSM Loss: 9.4086722 Overall Loss:18.4030854
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.6397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.6698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7818906 KL Loss: 7.2143460 DSM Loss: 9.1687915 Overall Loss:18.1650280
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.492100238800049
Use GPU: cuda:0
>>>>>>>start training : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.8906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8439481 KL Loss: 7.2497182 DSM Loss: 11.0689482 Overall Loss:20.1626147
Validation loss decreased (inf --> 4.788676).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8134720 KL Loss: 7.1974574 DSM Loss: 9.8778568 Overall Loss:18.8887862
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(14.9400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7895980 KL Loss: 7.1761009 DSM Loss: 9.2048102 Overall Loss:18.1705091
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.9956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7513313 KL Loss: 7.1255612 DSM Loss: 9.3012490 Overall Loss:18.1781413
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.892049312591553
Use GPU: cuda:0
>>>>>>>start training : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(20.1897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8276035 KL Loss: 7.2114688 DSM Loss: 11.3548409 Overall Loss:20.3939130
Validation loss decreased (inf --> 4.979458).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8200065 KL Loss: 7.1737900 DSM Loss: 9.9584494 Overall Loss:18.9522460
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.8208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7748321 KL Loss: 7.1579180 DSM Loss: 9.4474958 Overall Loss:18.3802459
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.3595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8066869 KL Loss: 7.1549185 DSM Loss: 9.1664246 Overall Loss:18.1280300
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.1109185218811035
Use GPU: cuda:0
>>>>>>>start training : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.9574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8220498 KL Loss: 7.1846103 DSM Loss: 11.7656759 Overall Loss:20.7723360
Validation loss decreased (inf --> 5.166157).  Saving model ...
Updating learning rate to 0.0005
tensor(15.3854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7892388 KL Loss: 7.1626053 DSM Loss: 9.6032253 Overall Loss:18.5550694
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.3574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4845, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8588772 KL Loss: 7.1956444 DSM Loss: 9.3395038 Overall Loss:18.3940253
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.0336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7905659 KL Loss: 7.1890739 DSM Loss: 9.0628249 Overall Loss:18.0424646
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.296539306640625
Use GPU: cuda:0
>>>>>>>start training : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.0803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8269416 KL Loss: 7.2204732 DSM Loss: 11.3517699 Overall Loss:20.3991847
Validation loss decreased (inf --> 6.419328).  Saving model ...
Updating learning rate to 0.0005
tensor(16.8622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8343016 KL Loss: 7.2162513 DSM Loss: 9.6374066 Overall Loss:18.6879594
Validation loss decreased (6.419328 --> 5.298022).  Saving model ...
Updating learning rate to 0.00025
tensor(18.3265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8400994 KL Loss: 7.2021234 DSM Loss: 9.4668507 Overall Loss:18.5090735
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.4112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7796830 KL Loss: 7.1388447 DSM Loss: 9.1715723 Overall Loss:18.0901001
Validation loss decreased (5.298022 --> 4.952359).  Saving model ...
Updating learning rate to 6.25e-05
tensor(20.4261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7589962 KL Loss: 7.1499102 DSM Loss: 8.9867922 Overall Loss:17.8956985
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(14.7407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7666413 KL Loss: 7.1135473 DSM Loss: 8.9941406 Overall Loss:17.8743291
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(20.6082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2572, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7735417 KL Loss: 7.1748330 DSM Loss: 9.0819749 Overall Loss:18.0303494
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.060098171234131


Running on file JPM.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.6559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8491196 KL Loss: 7.2158744 DSM Loss: 11.4825706 Overall Loss:20.5475647
Validation loss decreased (inf --> 4.512463).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4371, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8858354 KL Loss: 7.1917357 DSM Loss: 9.8817540 Overall Loss:18.9593250
Validation loss decreased (4.512463 --> 4.232858).  Saving model ...
Updating learning rate to 0.00025
tensor(15.1727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8307937 KL Loss: 7.1771660 DSM Loss: 9.6757418 Overall Loss:18.6837015
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.6912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8249584 KL Loss: 7.2053438 DSM Loss: 9.2283435 Overall Loss:18.2586458
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(12.7098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7642230 KL Loss: 7.1604616 DSM Loss: 9.1128923 Overall Loss:18.0375769
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.682518720626831
Use GPU: cuda:0
>>>>>>>start training : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.5571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8320650 KL Loss: 7.2613383 DSM Loss: 11.2308488 Overall Loss:20.3242520
Validation loss decreased (inf --> 4.337182).  Saving model ...
Updating learning rate to 0.0005
tensor(20.7371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8229368 KL Loss: 7.1571498 DSM Loss: 9.8534020 Overall Loss:18.8334887
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.0092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8204954 KL Loss: 7.1681938 DSM Loss: 9.3236913 Overall Loss:18.3123806
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(24.4163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7314937 KL Loss: 7.1447831 DSM Loss: 9.3934153 Overall Loss:18.2696923
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.7310867309570312
Use GPU: cuda:0
>>>>>>>start training : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.7882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5563, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8149677 KL Loss: 7.1692836 DSM Loss: 11.6695754 Overall Loss:20.6538268
Validation loss decreased (inf --> 4.330958).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8244372 KL Loss: 7.1963046 DSM Loss: 10.0528004 Overall Loss:19.0735421
Validation loss decreased (4.330958 --> 3.456144).  Saving model ...
Updating learning rate to 0.00025
tensor(21.2372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7828291 KL Loss: 7.1015812 DSM Loss: 9.5616583 Overall Loss:18.4460686
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.0954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7872455 KL Loss: 7.1571475 DSM Loss: 9.4685397 Overall Loss:18.4129328
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.3270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7030475 KL Loss: 7.0690741 DSM Loss: 9.4165241 Overall Loss:18.1886456
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.10141921043396
Use GPU: cuda:0
>>>>>>>start training : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.6623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7716986 KL Loss: 7.2014749 DSM Loss: 14.2897124 Overall Loss:23.2628859
Validation loss decreased (inf --> 4.351939).  Saving model ...
Updating learning rate to 0.0005
tensor(20.4742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7578476 KL Loss: 7.0834813 DSM Loss: 10.9550723 Overall Loss:19.7964012
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.3720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7457, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8056243 KL Loss: 7.1753737 DSM Loss: 9.6592321 Overall Loss:18.6402301
Validation loss decreased (4.351939 --> 3.890392).  Saving model ...
Updating learning rate to 0.000125
tensor(18.8919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7024552 KL Loss: 7.0728094 DSM Loss: 9.4759936 Overall Loss:18.2512582
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.2697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7646439 KL Loss: 7.1470490 DSM Loss: 9.4332588 Overall Loss:18.3449517
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(19.6458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8014072 KL Loss: 7.1623901 DSM Loss: 9.3130447 Overall Loss:18.2768420
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.447972536087036
Use GPU: cuda:0
>>>>>>>start training : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.9650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9190511 KL Loss: 7.2335363 DSM Loss: 11.1380205 Overall Loss:20.2906078
Validation loss decreased (inf --> 5.050622).  Saving model ...
Updating learning rate to 0.0005
tensor(20.0825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8899177 KL Loss: 7.2552622 DSM Loss: 9.6948539 Overall Loss:18.8400336
Validation loss decreased (5.050622 --> 4.247428).  Saving model ...
Updating learning rate to 0.00025
tensor(21.4289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3675, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7920760 KL Loss: 7.1111419 DSM Loss: 9.4537329 Overall Loss:18.3569508
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.3766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7766917 KL Loss: 7.1703407 DSM Loss: 9.3995136 Overall Loss:18.3465461
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.1885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8185608 KL Loss: 7.1934378 DSM Loss: 9.4712573 Overall Loss:18.4832559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.6762356758117676


Running on file KO.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.0509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8677906 KL Loss: 7.2722303 DSM Loss: 13.1180608 Overall Loss:22.2580818
Validation loss decreased (inf --> 7.396698).  Saving model ...
Updating learning rate to 0.0005
tensor(21.4874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9708, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8020457 KL Loss: 7.1915060 DSM Loss: 9.9900174 Overall Loss:18.9835690
Validation loss decreased (7.396698 --> 7.335535).  Saving model ...
Updating learning rate to 0.00025
tensor(13.7702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3882, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7969001 KL Loss: 7.1623210 DSM Loss: 9.6795289 Overall Loss:18.6387500
Validation loss decreased (7.335535 --> 6.876869).  Saving model ...
Updating learning rate to 0.000125
tensor(16.0153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8152374 KL Loss: 7.1930385 DSM Loss: 9.2768798 Overall Loss:18.2851557
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(19.2353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7849033 KL Loss: 7.1609419 DSM Loss: 9.3720616 Overall Loss:18.3179069
Validation loss decreased (6.876869 --> 6.833234).  Saving model ...
Updating learning rate to 3.125e-05
tensor(20.8120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7723493 KL Loss: 7.1389794 DSM Loss: 9.4898565 Overall Loss:18.4011853
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(20.6588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7802168 KL Loss: 7.1422824 DSM Loss: 9.3745985 Overall Loss:18.2970977
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(20.7929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7703385 KL Loss: 7.0941652 DSM Loss: 9.3025321 Overall Loss:18.1670357
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:10.228899955749512
Use GPU: cuda:0
>>>>>>>start training : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.9831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8406097 KL Loss: 7.2012389 DSM Loss: 11.2774011 Overall Loss:20.3192496
Validation loss decreased (inf --> 7.354103).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8112855 KL Loss: 7.1861625 DSM Loss: 10.1191470 Overall Loss:19.1165950
Validation loss decreased (7.354103 --> 6.912024).  Saving model ...
Updating learning rate to 0.00025
tensor(22.5541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7938518 KL Loss: 7.1983412 DSM Loss: 9.6357063 Overall Loss:18.6278993
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.3308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7903056 KL Loss: 7.1373189 DSM Loss: 9.3902923 Overall Loss:18.3179169
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.4183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8065963 KL Loss: 7.1950929 DSM Loss: 9.2803984 Overall Loss:18.2820877
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:10.287931442260742
Use GPU: cuda:0
>>>>>>>start training : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.1709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8526236 KL Loss: 7.2424601 DSM Loss: 11.7515843 Overall Loss:20.8466680
Validation loss decreased (inf --> 7.214566).  Saving model ...
Updating learning rate to 0.0005
tensor(25.7402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8596773 KL Loss: 7.1650287 DSM Loss: 10.2594349 Overall Loss:19.2841408
Validation loss decreased (7.214566 --> 6.936291).  Saving model ...
Updating learning rate to 0.00025
tensor(21.4740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8319296 KL Loss: 7.1132409 DSM Loss: 9.5513760 Overall Loss:18.4965467
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.4811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6474, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7904066 KL Loss: 7.1796800 DSM Loss: 9.5030033 Overall Loss:18.4730899
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.5300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7609465 KL Loss: 7.1505253 DSM Loss: 9.3837072 Overall Loss:18.2951791
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:10.369635581970215
Use GPU: cuda:0
>>>>>>>start training : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.9314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8547546 KL Loss: 7.1798434 DSM Loss: 11.9620844 Overall Loss:20.9966824
Validation loss decreased (inf --> 7.675047).  Saving model ...
Updating learning rate to 0.0005
tensor(14.8324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7990251 KL Loss: 7.1542575 DSM Loss: 9.8975493 Overall Loss:18.8508319
Validation loss decreased (7.675047 --> 6.717925).  Saving model ...
Updating learning rate to 0.00025
tensor(20.1473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8769, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8036108 KL Loss: 7.1419812 DSM Loss: 9.7371394 Overall Loss:18.6827313
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.3717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3736, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7711899 KL Loss: 7.1061093 DSM Loss: 9.4715489 Overall Loss:18.3488481
Validation loss decreased (6.717925 --> 6.686031).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.6390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7483698 KL Loss: 7.0895731 DSM Loss: 9.3734858 Overall Loss:18.2114288
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(15.7761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7615692 KL Loss: 7.1088731 DSM Loss: 9.2496881 Overall Loss:18.1201305
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(16.4157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7780523 KL Loss: 7.1586214 DSM Loss: 9.3129389 Overall Loss:18.2496125
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:10.145875930786133
Use GPU: cuda:0
>>>>>>>start training : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.2480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3720, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8175971 KL Loss: 7.1912690 DSM Loss: 11.5309865 Overall Loss:20.5398527
Validation loss decreased (inf --> 6.714224).  Saving model ...
Updating learning rate to 0.0005
tensor(18.9646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4125, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8104119 KL Loss: 7.1991975 DSM Loss: 10.0010964 Overall Loss:19.0107057
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.6606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6918, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6948, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8091333 KL Loss: 7.1567908 DSM Loss: 9.5711504 Overall Loss:18.5370744
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.1833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7955796 KL Loss: 7.1787685 DSM Loss: 9.6119632 Overall Loss:18.5863114
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:10.08834457397461


Running on file LMT.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.8215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8417621 KL Loss: 7.2025069 DSM Loss: 11.3024194 Overall Loss:20.3466884
Validation loss decreased (inf --> 2.427019).  Saving model ...
Updating learning rate to 0.0005
tensor(19.7901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8226320 KL Loss: 7.1856820 DSM Loss: 9.7533773 Overall Loss:18.7616913
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.4154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8605990 KL Loss: 7.2053349 DSM Loss: 9.5313519 Overall Loss:18.5972858
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.9760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7522974 KL Loss: 7.1237069 DSM Loss: 9.4408095 Overall Loss:18.3168136
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.361355304718018
Use GPU: cuda:0
>>>>>>>start training : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8527203 KL Loss: 7.2179345 DSM Loss: 11.6783258 Overall Loss:20.7489805
Validation loss decreased (inf --> 2.964229).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8181545 KL Loss: 7.2020393 DSM Loss: 9.7698398 Overall Loss:18.7900337
Validation loss decreased (2.964229 --> 2.578529).  Saving model ...
Updating learning rate to 0.00025
tensor(16.2952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8313359 KL Loss: 7.2118413 DSM Loss: 9.4573488 Overall Loss:18.5005258
Validation loss decreased (2.578529 --> 2.310966).  Saving model ...
Updating learning rate to 0.000125
tensor(20.6199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8037123 KL Loss: 7.1505623 DSM Loss: 9.3968583 Overall Loss:18.3511327
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(21.9054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7950377 KL Loss: 7.1713546 DSM Loss: 9.3445227 Overall Loss:18.3109150
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(18.6423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7717595 KL Loss: 7.1917234 DSM Loss: 9.3353902 Overall Loss:18.2988731
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.125617504119873
Use GPU: cuda:0
>>>>>>>start training : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.1535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6927, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8812924 KL Loss: 7.1878602 DSM Loss: 12.6320856 Overall Loss:21.7012383
Validation loss decreased (inf --> 2.200442).  Saving model ...
Updating learning rate to 0.0005
tensor(17.8433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8393777 KL Loss: 7.1937934 DSM Loss: 9.9773365 Overall Loss:19.0105076
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.5327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7719388 KL Loss: 7.1816449 DSM Loss: 9.5931312 Overall Loss:18.5467151
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.4674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1621, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7721536 KL Loss: 7.1508877 DSM Loss: 9.4825568 Overall Loss:18.4055980
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.81901741027832
Use GPU: cuda:0
>>>>>>>start training : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.6010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8400365 KL Loss: 7.1705586 DSM Loss: 11.5798512 Overall Loss:20.5904463
Validation loss decreased (inf --> 3.143098).  Saving model ...
Updating learning rate to 0.0005
tensor(12.6173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4234, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8379947 KL Loss: 7.1626315 DSM Loss: 9.9029371 Overall Loss:18.9035633
Validation loss decreased (3.143098 --> 2.507395).  Saving model ...
Updating learning rate to 0.00025
tensor(23.9472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7650618 KL Loss: 7.1412519 DSM Loss: 9.5235690 Overall Loss:18.4298827
Validation loss decreased (2.507395 --> 2.350854).  Saving model ...
Updating learning rate to 0.000125
tensor(17.3618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7655453 KL Loss: 7.1567291 DSM Loss: 9.4206123 Overall Loss:18.3428866
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.9147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7225395 KL Loss: 7.1041330 DSM Loss: 9.2455126 Overall Loss:18.0721850
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(14.1639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7558456 KL Loss: 7.1477901 DSM Loss: 9.3198944 Overall Loss:18.2235301
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.140481472015381
Use GPU: cuda:0
>>>>>>>start training : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(35.0663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8636329 KL Loss: 7.2859614 DSM Loss: 12.4987707 Overall Loss:21.6483650
Validation loss decreased (inf --> 2.803483).  Saving model ...
Updating learning rate to 0.0005
tensor(23.7305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8275566 KL Loss: 7.2315479 DSM Loss: 9.9800872 Overall Loss:19.0391918
Validation loss decreased (2.803483 --> 2.460855).  Saving model ...
Updating learning rate to 0.00025
tensor(18.8626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8359913 KL Loss: 7.2164887 DSM Loss: 9.6105104 Overall Loss:18.6629903
Validation loss decreased (2.460855 --> 2.348288).  Saving model ...
Updating learning rate to 0.000125
tensor(21.4945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8042453 KL Loss: 7.1972774 DSM Loss: 9.4746654 Overall Loss:18.4761881
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.9789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7947875 KL Loss: 7.1680342 DSM Loss: 9.1563137 Overall Loss:18.1191353
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.7351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0094, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7526146 KL Loss: 7.1499066 DSM Loss: 9.3281613 Overall Loss:18.2306824
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.228469371795654


Running on file MA.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.5144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7864234 KL Loss: 7.1197139 DSM Loss: 11.7493140 Overall Loss:20.6554512
Validation loss decreased (inf --> 2.485343).  Saving model ...
Updating learning rate to 0.0005
tensor(21.4788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7694787 KL Loss: 7.1078802 DSM Loss: 10.1002252 Overall Loss:18.9775841
Validation loss decreased (2.485343 --> 2.215901).  Saving model ...
Updating learning rate to 0.00025
tensor(16.9211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8249587 KL Loss: 7.1648669 DSM Loss: 9.9518474 Overall Loss:18.9416729
Validation loss decreased (2.215901 --> 2.054435).  Saving model ...
Updating learning rate to 0.000125
tensor(19.7010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7727150 KL Loss: 7.0977498 DSM Loss: 9.6724780 Overall Loss:18.5429427
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.6584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7673534 KL Loss: 7.1967696 DSM Loss: 9.5658862 Overall Loss:18.5300091
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.7749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7629477 KL Loss: 7.1099472 DSM Loss: 9.4039501 Overall Loss:18.2768450
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.562796115875244
Use GPU: cuda:0
>>>>>>>start training : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.3077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8798823 KL Loss: 7.1676044 DSM Loss: 12.1138838 Overall Loss:21.1613705
Validation loss decreased (inf --> 2.722218).  Saving model ...
Updating learning rate to 0.0005
tensor(20.5318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8304431 KL Loss: 7.1425344 DSM Loss: 9.9426611 Overall Loss:18.9156386
Validation loss decreased (2.722218 --> 2.335364).  Saving model ...
Updating learning rate to 0.00025
tensor(19.6518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9239, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8360703 KL Loss: 7.1753192 DSM Loss: 9.8257523 Overall Loss:18.8371417
Validation loss decreased (2.335364 --> 2.264929).  Saving model ...
Updating learning rate to 0.000125
tensor(20.8673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7043, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7854460 KL Loss: 7.1679554 DSM Loss: 9.5808815 Overall Loss:18.5342828
Validation loss decreased (2.264929 --> 2.185549).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.2508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1875, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7726297 KL Loss: 7.1471880 DSM Loss: 9.4854381 Overall Loss:18.4052559
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(21.3157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7976688 KL Loss: 7.1741268 DSM Loss: 9.4320126 Overall Loss:18.4038082
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.9358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7879572 KL Loss: 7.2147673 DSM Loss: 9.3289683 Overall Loss:18.3316927
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.720804452896118
Use GPU: cuda:0
>>>>>>>start training : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.8604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8171645 KL Loss: 7.2149672 DSM Loss: 12.0220429 Overall Loss:21.0541746
Validation loss decreased (inf --> 1.961228).  Saving model ...
Updating learning rate to 0.0005
tensor(20.8167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8184966 KL Loss: 7.1782138 DSM Loss: 10.1170623 Overall Loss:19.1137726
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.7951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7880666 KL Loss: 7.1453752 DSM Loss: 9.6865097 Overall Loss:18.6199515
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.3267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8146221 KL Loss: 7.2315996 DSM Loss: 9.4714052 Overall Loss:18.5176268
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.4774537086486816
Use GPU: cuda:0
>>>>>>>start training : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.3646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1146, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8579366 KL Loss: 7.2469199 DSM Loss: 11.4774648 Overall Loss:20.5823212
Validation loss decreased (inf --> 3.296166).  Saving model ...
Updating learning rate to 0.0005
tensor(18.7458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8270281 KL Loss: 7.1794257 DSM Loss: 10.2586428 Overall Loss:19.2650966
Validation loss decreased (3.296166 --> 3.182286).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7831213 KL Loss: 7.0942185 DSM Loss: 9.7076714 Overall Loss:18.5850113
Validation loss decreased (3.182286 --> 1.707996).  Saving model ...
Updating learning rate to 0.000125
tensor(17.4695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8305175 KL Loss: 7.2125521 DSM Loss: 9.5709775 Overall Loss:18.6140473
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.8702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9179, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7601361 KL Loss: 7.1625118 DSM Loss: 9.3967876 Overall Loss:18.3194355
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.3150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6735, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7904490 KL Loss: 7.1708431 DSM Loss: 9.3849055 Overall Loss:18.3461977
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.1925721168518066
Use GPU: cuda:0
>>>>>>>start training : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(21.4953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8456007 KL Loss: 7.2220389 DSM Loss: 12.4692640 Overall Loss:21.5369037
Validation loss decreased (inf --> 1.780835).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8599579 KL Loss: 7.1588353 DSM Loss: 10.1462242 Overall Loss:19.1650175
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.6570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8106028 KL Loss: 7.1494606 DSM Loss: 9.7005827 Overall Loss:18.6606462
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.5245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7752021 KL Loss: 7.1644775 DSM Loss: 9.6429873 Overall Loss:18.5826668
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.327348232269287


Running on file MCD.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.7517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5236, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8486535 KL Loss: 7.2561732 DSM Loss: 11.1711934 Overall Loss:20.2760200
Validation loss decreased (inf --> 4.270267).  Saving model ...
Updating learning rate to 0.0005
tensor(21.6803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8015357 KL Loss: 7.1194851 DSM Loss: 9.9775972 Overall Loss:18.8986180
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.5345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7553386 KL Loss: 7.1372308 DSM Loss: 9.6150137 Overall Loss:18.5075831
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.3577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7852098 KL Loss: 7.1605591 DSM Loss: 9.4703423 Overall Loss:18.4161113
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.916033744812012
Use GPU: cuda:0
>>>>>>>start training : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.6166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8542008 KL Loss: 7.2024171 DSM Loss: 11.8393003 Overall Loss:20.8959182
Validation loss decreased (inf --> 4.682184).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8010001 KL Loss: 7.1877279 DSM Loss: 9.7753513 Overall Loss:18.7640793
Validation loss decreased (4.682184 --> 4.601989).  Saving model ...
Updating learning rate to 0.00025
tensor(17.3827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8210791 KL Loss: 7.1993485 DSM Loss: 9.7581944 Overall Loss:18.7786220
Validation loss decreased (4.601989 --> 4.410351).  Saving model ...
Updating learning rate to 0.000125
tensor(16.2002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7520665 KL Loss: 7.1233780 DSM Loss: 9.4281596 Overall Loss:18.3036041
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.7199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7748908 KL Loss: 7.1647838 DSM Loss: 9.2582868 Overall Loss:18.1979615
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(16.3352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7704931 KL Loss: 7.1883192 DSM Loss: 9.2974074 Overall Loss:18.2562199
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.997769355773926
Use GPU: cuda:0
>>>>>>>start training : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.8841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8641333 KL Loss: 7.2583721 DSM Loss: 11.2726682 Overall Loss:20.3951736
Validation loss decreased (inf --> 4.424367).  Saving model ...
Updating learning rate to 0.0005
tensor(20.8886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7883614 KL Loss: 7.1048076 DSM Loss: 10.1089428 Overall Loss:19.0021118
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(14.7790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7732015 KL Loss: 7.1429953 DSM Loss: 9.5098102 Overall Loss:18.4260071
Validation loss decreased (4.424367 --> 4.231271).  Saving model ...
Updating learning rate to 0.000125
tensor(19.6234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7699114 KL Loss: 7.1863173 DSM Loss: 9.3346838 Overall Loss:18.2909124
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.1253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7630280 KL Loss: 7.1770921 DSM Loss: 9.3950566 Overall Loss:18.3351767
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(19.1153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7942, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7885783 KL Loss: 7.1488434 DSM Loss: 9.2810318 Overall Loss:18.2184534
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.845210552215576
Use GPU: cuda:0
>>>>>>>start training : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.9385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8099230 KL Loss: 7.2603477 DSM Loss: 12.8070790 Overall Loss:21.8773496
Validation loss decreased (inf --> 4.892776).  Saving model ...
Updating learning rate to 0.0005
tensor(21.1244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8352767 KL Loss: 7.2131059 DSM Loss: 10.0515432 Overall Loss:19.0999256
Validation loss decreased (4.892776 --> 4.020379).  Saving model ...
Updating learning rate to 0.00025
tensor(16.0684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7881258 KL Loss: 7.1308055 DSM Loss: 9.6019052 Overall Loss:18.5208364
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.4269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7890779 KL Loss: 7.1756651 DSM Loss: 9.4252157 Overall Loss:18.3899587
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.6802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7643718 KL Loss: 7.1375206 DSM Loss: 9.2771193 Overall Loss:18.1790116
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.552318096160889
Use GPU: cuda:0
>>>>>>>start training : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.7989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9177684 KL Loss: 7.1873737 DSM Loss: 11.5718807 Overall Loss:20.6770228
Validation loss decreased (inf --> 4.141911).  Saving model ...
Updating learning rate to 0.0005
tensor(22.2079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7906058 KL Loss: 7.1647146 DSM Loss: 9.9917987 Overall Loss:18.9471190
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.6297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8050155 KL Loss: 7.1785438 DSM Loss: 9.5568587 Overall Loss:18.5404180
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.2543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7918315 KL Loss: 7.1326692 DSM Loss: 9.5067864 Overall Loss:18.4312872
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.760186195373535


Running on file MDT.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.2213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8292264 KL Loss: 7.1881718 DSM Loss: 11.0307631 Overall Loss:20.0481611
Validation loss decreased (inf --> 3.237581).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8578304 KL Loss: 7.1797822 DSM Loss: 9.8330089 Overall Loss:18.8706215
Validation loss decreased (3.237581 --> 2.620253).  Saving model ...
Updating learning rate to 0.00025
tensor(19.8876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7990005 KL Loss: 7.1260542 DSM Loss: 9.7986786 Overall Loss:18.7237333
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.8630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7990875 KL Loss: 7.1373015 DSM Loss: 9.4334776 Overall Loss:18.3698665
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.5592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7537038 KL Loss: 7.1126640 DSM Loss: 9.2016824 Overall Loss:18.0680502
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.10129992663860321
Use GPU: cuda:0
>>>>>>>start training : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.9384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8381121 KL Loss: 7.2058212 DSM Loss: 12.2592657 Overall Loss:21.3031990
Validation loss decreased (inf --> 2.352037).  Saving model ...
Updating learning rate to 0.0005
tensor(21.3003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8145673 KL Loss: 7.1378698 DSM Loss: 9.8739714 Overall Loss:18.8264085
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(13.6452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7399008 KL Loss: 7.1457530 DSM Loss: 9.7476820 Overall Loss:18.6333357
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.8640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7920275 KL Loss: 7.1830892 DSM Loss: 9.4385122 Overall Loss:18.4136291
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.16371509432792664
Use GPU: cuda:0
>>>>>>>start training : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.0814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8726090 KL Loss: 7.1609613 DSM Loss: 11.4631330 Overall Loss:20.4967033
Validation loss decreased (inf --> 2.569511).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8321694 KL Loss: 7.0889317 DSM Loss: 10.3149516 Overall Loss:19.2360527
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(27.7184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8564661 KL Loss: 7.1732787 DSM Loss: 9.6575328 Overall Loss:18.6872776
Validation loss decreased (2.569511 --> 2.443888).  Saving model ...
Updating learning rate to 0.000125
tensor(24.4759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7619103 KL Loss: 7.1425110 DSM Loss: 9.4573487 Overall Loss:18.3617700
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(25.1863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7850405 KL Loss: 7.1221498 DSM Loss: 9.2655114 Overall Loss:18.1727017
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(22.4755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7409452 KL Loss: 7.1614792 DSM Loss: 9.3642536 Overall Loss:18.2666780
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1337936371564865
Use GPU: cuda:0
>>>>>>>start training : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(36.4638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9480, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8741453 KL Loss: 7.1801672 DSM Loss: 11.2390072 Overall Loss:20.2933198
Validation loss decreased (inf --> 2.560629).  Saving model ...
Updating learning rate to 0.0005
tensor(20.9290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0708, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8021545 KL Loss: 7.1198575 DSM Loss: 9.9044104 Overall Loss:18.8264225
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.1439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7990679 KL Loss: 7.1033863 DSM Loss: 10.0411706 Overall Loss:18.9436248
Validation loss decreased (2.560629 --> 2.393032).  Saving model ...
Updating learning rate to 0.000125
tensor(17.3562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8382955 KL Loss: 7.2000404 DSM Loss: 9.5588628 Overall Loss:18.5971986
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.2365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7770182 KL Loss: 7.1441122 DSM Loss: 9.4068753 Overall Loss:18.3280058
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(15.7623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7804875 KL Loss: 7.1903082 DSM Loss: 9.2756934 Overall Loss:18.2464890
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1442725956439972
Use GPU: cuda:0
>>>>>>>start training : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.7677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8389311 KL Loss: 7.1855998 DSM Loss: 11.1667637 Overall Loss:20.1912945
Validation loss decreased (inf --> 2.926661).  Saving model ...
Updating learning rate to 0.0005
tensor(12.7860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8071884 KL Loss: 7.1762634 DSM Loss: 9.9932131 Overall Loss:18.9766648
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.1788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8371946 KL Loss: 7.1502392 DSM Loss: 9.6105079 Overall Loss:18.5979418
Validation loss decreased (2.926661 --> 2.489344).  Saving model ...
Updating learning rate to 0.000125
tensor(12.8565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7842129 KL Loss: 7.1951859 DSM Loss: 9.5535562 Overall Loss:18.5329550
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.3189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7498346 KL Loss: 7.0901476 DSM Loss: 9.1454524 Overall Loss:17.9854347
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(13.7438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5052, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7637627 KL Loss: 7.1782545 DSM Loss: 9.2535981 Overall Loss:18.1956152
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1222214624285698


Running on file MMM.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.8640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7838568 KL Loss: 7.1265301 DSM Loss: 11.5042009 Overall Loss:20.4145877
Validation loss decreased (inf --> 0.462269).  Saving model ...
Updating learning rate to 0.0005
tensor(22.8666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0254, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7865323 KL Loss: 7.1766612 DSM Loss: 9.6641472 Overall Loss:18.6273405
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.4836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8230602 KL Loss: 7.1099846 DSM Loss: 9.5590350 Overall Loss:18.4920797
Validation loss decreased (0.462269 --> 0.392745).  Saving model ...
Updating learning rate to 0.000125
tensor(20.4509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6226, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7342204 KL Loss: 7.1348347 DSM Loss: 9.1984142 Overall Loss:18.0674694
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.9006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7453889 KL Loss: 7.1213071 DSM Loss: 8.9825490 Overall Loss:17.8492450
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.8818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7400174 KL Loss: 7.1554771 DSM Loss: 9.1816187 Overall Loss:18.0771133
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.9234654903411865
Use GPU: cuda:0
>>>>>>>start training : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(21.8715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7065, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8967675 KL Loss: 7.2263211 DSM Loss: 11.4817530 Overall Loss:20.6048416
Validation loss decreased (inf --> 0.497316).  Saving model ...
Updating learning rate to 0.0005
tensor(15.0328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7952550 KL Loss: 7.2019109 DSM Loss: 9.4351153 Overall Loss:18.4322812
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.1247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7669357 KL Loss: 7.1768173 DSM Loss: 9.3242220 Overall Loss:18.2679750
Validation loss decreased (0.497316 --> 0.478829).  Saving model ...
Updating learning rate to 0.000125
tensor(17.2283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7721607 KL Loss: 7.1410441 DSM Loss: 9.1030581 Overall Loss:18.0162628
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.1241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7353318 KL Loss: 7.1914361 DSM Loss: 9.1082929 Overall Loss:18.0350607
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.9506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8034824 KL Loss: 7.2210591 DSM Loss: 9.0136730 Overall Loss:18.0382144
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.712141990661621
Use GPU: cuda:0
>>>>>>>start training : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.4031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7236, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8346488 KL Loss: 7.2688451 DSM Loss: 12.2272363 Overall Loss:21.3307302
Validation loss decreased (inf --> 0.464208).  Saving model ...
Updating learning rate to 0.0005
tensor(18.8748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7782346 KL Loss: 7.1426928 DSM Loss: 9.8631507 Overall Loss:18.7840781
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.4034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3006, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8075777 KL Loss: 7.1978081 DSM Loss: 9.4760782 Overall Loss:18.4814639
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.0750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8061390 KL Loss: 7.2139366 DSM Loss: 9.3059427 Overall Loss:18.3260183
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.069228172302246
Use GPU: cuda:0
>>>>>>>start training : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(34.8983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8346762 KL Loss: 7.2173772 DSM Loss: 11.1465356 Overall Loss:20.1985889
Validation loss decreased (inf --> 0.469189).  Saving model ...
Updating learning rate to 0.0005
tensor(14.3437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8319859 KL Loss: 7.1941498 DSM Loss: 9.6223402 Overall Loss:18.6484759
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.8285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7927, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7602799 KL Loss: 7.1260180 DSM Loss: 9.2610708 Overall Loss:18.1473687
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.7238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7836956 KL Loss: 7.1567080 DSM Loss: 9.1624133 Overall Loss:18.1028169
Validation loss decreased (0.469189 --> 0.457920).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.9782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7702949 KL Loss: 7.1040241 DSM Loss: 9.1834455 Overall Loss:18.0577646
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(16.2129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3534, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7605836 KL Loss: 7.1576597 DSM Loss: 8.8516568 Overall Loss:17.7699002
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(14.2351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7252097 KL Loss: 7.1685685 DSM Loss: 8.9596156 Overall Loss:17.8533936
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.798532009124756
Use GPU: cuda:0
>>>>>>>start training : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.1247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8058983 KL Loss: 7.1950393 DSM Loss: 10.7243211 Overall Loss:19.7252586
Validation loss decreased (inf --> 0.454916).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7777358 KL Loss: 7.1872642 DSM Loss: 9.6334320 Overall Loss:18.5984319
Validation loss decreased (0.454916 --> 0.453221).  Saving model ...
Updating learning rate to 0.00025
tensor(18.1739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8154425 KL Loss: 7.1542289 DSM Loss: 9.2743707 Overall Loss:18.2440421
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(22.3640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7807718 KL Loss: 7.1588697 DSM Loss: 9.1879624 Overall Loss:18.1276039
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.5442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7736190 KL Loss: 7.1956453 DSM Loss: 9.0612267 Overall Loss:18.0304909
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.211314678192139


Running on file MO.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.6482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8239905 KL Loss: 7.1764036 DSM Loss: 11.7945514 Overall Loss:20.7949455
Validation loss decreased (inf --> 1.203422).  Saving model ...
Updating learning rate to 0.0005
tensor(19.1429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7789726 KL Loss: 7.1691321 DSM Loss: 10.6106080 Overall Loss:19.5587126
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.3914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8604210 KL Loss: 7.2377352 DSM Loss: 10.0495738 Overall Loss:19.1477300
Validation loss decreased (1.203422 --> 1.051347).  Saving model ...
Updating learning rate to 0.000125
tensor(19.4080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5391, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7923051 KL Loss: 7.1584361 DSM Loss: 9.7045671 Overall Loss:18.6553083
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(18.3916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9580, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8302434 KL Loss: 7.2782840 DSM Loss: 9.5668964 Overall Loss:18.6754238
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.4346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7704897 KL Loss: 7.1146021 DSM Loss: 9.5720536 Overall Loss:18.4571454
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6186131834983826
Use GPU: cuda:0
>>>>>>>start training : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.0278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8233168 KL Loss: 7.1802989 DSM Loss: 11.6675900 Overall Loss:20.6712057
Validation loss decreased (inf --> 1.124757).  Saving model ...
Updating learning rate to 0.0005
tensor(18.3755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8292903 KL Loss: 7.1498855 DSM Loss: 10.2431397 Overall Loss:19.2223155
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.5533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7917658 KL Loss: 7.1924101 DSM Loss: 9.9401750 Overall Loss:18.9243508
Validation loss decreased (1.124757 --> 1.053019).  Saving model ...
Updating learning rate to 0.000125
tensor(19.2366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7784141 KL Loss: 7.2319648 DSM Loss: 9.6654380 Overall Loss:18.6758170
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(19.3482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8974, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8359372 KL Loss: 7.2536588 DSM Loss: 9.7952264 Overall Loss:18.8848224
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(19.5187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8034876 KL Loss: 7.2232737 DSM Loss: 9.6233872 Overall Loss:18.6501482
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6194117069244385
Use GPU: cuda:0
>>>>>>>start training : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(34.9055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8636750 KL Loss: 7.2389352 DSM Loss: 12.9620045 Overall Loss:22.0646147
Validation loss decreased (inf --> 1.123810).  Saving model ...
Updating learning rate to 0.0005
tensor(20.7326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7918389 KL Loss: 7.1568653 DSM Loss: 9.8805215 Overall Loss:18.8292258
Validation loss decreased (1.123810 --> 0.987762).  Saving model ...
Updating learning rate to 0.00025
tensor(18.0576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7761039 KL Loss: 7.1527973 DSM Loss: 9.7646929 Overall Loss:18.6935942
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.9825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2732, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7602836 KL Loss: 7.1474144 DSM Loss: 9.7138184 Overall Loss:18.6215162
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.9192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7642080 KL Loss: 7.1217152 DSM Loss: 9.5854646 Overall Loss:18.4713878
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.569908857345581
Use GPU: cuda:0
>>>>>>>start training : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.5073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9120661 KL Loss: 7.2725642 DSM Loss: 13.4548828 Overall Loss:22.6395131
Validation loss decreased (inf --> 1.025141).  Saving model ...
Updating learning rate to 0.0005
tensor(22.4796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8096408 KL Loss: 7.1627246 DSM Loss: 10.6029099 Overall Loss:19.5752752
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.3432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8111817 KL Loss: 7.2001152 DSM Loss: 10.1892566 Overall Loss:19.2005535
Validation loss decreased (1.025141 --> 0.947690).  Saving model ...
Updating learning rate to 0.000125
tensor(19.2498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8235320 KL Loss: 7.2102514 DSM Loss: 9.7387044 Overall Loss:18.7724878
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.3080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4496, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7659992 KL Loss: 7.1453706 DSM Loss: 9.8347510 Overall Loss:18.7461207
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.6431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7204859 KL Loss: 7.1473775 DSM Loss: 9.7518030 Overall Loss:18.6196663
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5292224287986755
Use GPU: cuda:0
>>>>>>>start training : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.3122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7877536 KL Loss: 7.1717186 DSM Loss: 13.0487335 Overall Loss:22.0082057
Validation loss decreased (inf --> 1.039165).  Saving model ...
Updating learning rate to 0.0005
tensor(22.9328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7696, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8198134 KL Loss: 7.1763276 DSM Loss: 10.6253128 Overall Loss:19.6214538
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.8443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8514642 KL Loss: 7.2735225 DSM Loss: 9.9923404 Overall Loss:19.1173271
Validation loss decreased (1.039165 --> 0.925637).  Saving model ...
Updating learning rate to 0.000125
tensor(17.5077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0693, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8056949 KL Loss: 7.1978639 DSM Loss: 9.6167602 Overall Loss:18.6203188
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.6720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7837676 KL Loss: 7.1934866 DSM Loss: 9.7871078 Overall Loss:18.7643619
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(18.7354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1233, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8023888 KL Loss: 7.2376116 DSM Loss: 9.7306879 Overall Loss:18.7706883
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5205738544464111


Running on file MRK.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.9833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9737, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8182552 KL Loss: 7.2480310 DSM Loss: 12.0504456 Overall Loss:21.1167319
Validation loss decreased (inf --> 2.902902).  Saving model ...
Updating learning rate to 0.0005
tensor(15.5582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8452684 KL Loss: 7.2274785 DSM Loss: 9.9627622 Overall Loss:19.0355092
Validation loss decreased (2.902902 --> 2.488883).  Saving model ...
Updating learning rate to 0.00025
tensor(18.8150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4415, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8237944 KL Loss: 7.1790623 DSM Loss: 9.4449368 Overall Loss:18.4477934
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.0008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7640825 KL Loss: 7.1557607 DSM Loss: 9.5169185 Overall Loss:18.4367617
Validation loss decreased (2.488883 --> 2.418418).  Saving model ...
Updating learning rate to 6.25e-05
tensor(19.1256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7483348 KL Loss: 7.1267187 DSM Loss: 9.3197293 Overall Loss:18.1947829
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(14.8164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7791327 KL Loss: 7.1912765 DSM Loss: 9.3193626 Overall Loss:18.2897718
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(19.7552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7726378 KL Loss: 7.1960288 DSM Loss: 9.3030170 Overall Loss:18.2716835
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:14.665547370910645
Use GPU: cuda:0
>>>>>>>start training : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.5907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8416548 KL Loss: 7.2210709 DSM Loss: 11.6942308 Overall Loss:20.7569565
Validation loss decreased (inf --> 2.193270).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7808592 KL Loss: 7.1554408 DSM Loss: 10.0531032 Overall Loss:18.9894032
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.0716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7835421 KL Loss: 7.1395872 DSM Loss: 9.6820378 Overall Loss:18.6051670
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.6110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8828, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7563247 KL Loss: 7.1259364 DSM Loss: 9.4797084 Overall Loss:18.3619695
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:14.529438018798828
Use GPU: cuda:0
>>>>>>>start training : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.3870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8616400 KL Loss: 7.2530469 DSM Loss: 12.5033918 Overall Loss:21.6180788
Validation loss decreased (inf --> 2.612291).  Saving model ...
Updating learning rate to 0.0005
tensor(21.9720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7966003 KL Loss: 7.1912929 DSM Loss: 9.9811576 Overall Loss:18.9690509
Validation loss decreased (2.612291 --> 2.469430).  Saving model ...
Updating learning rate to 0.00025
tensor(17.8624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8546669 KL Loss: 7.1624382 DSM Loss: 9.7996174 Overall Loss:18.8167225
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.3771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7964519 KL Loss: 7.2446317 DSM Loss: 9.4521609 Overall Loss:18.4932446
Validation loss decreased (2.469430 --> 2.382482).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.5856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7632013 KL Loss: 7.1663626 DSM Loss: 9.4583722 Overall Loss:18.3879361
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(18.2958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7955337 KL Loss: 7.1787927 DSM Loss: 9.3449214 Overall Loss:18.3192477
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(20.6361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0178, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7877992 KL Loss: 7.1940811 DSM Loss: 9.2760516 Overall Loss:18.2579320
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:14.847123146057129
Use GPU: cuda:0
>>>>>>>start training : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.6700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8301671 KL Loss: 7.1970904 DSM Loss: 11.9801878 Overall Loss:21.0074452
Validation loss decreased (inf --> 2.611741).  Saving model ...
Updating learning rate to 0.0005
tensor(22.0143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8226, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8445901 KL Loss: 7.1711963 DSM Loss: 10.0924942 Overall Loss:19.1082806
Validation loss decreased (2.611741 --> 2.587099).  Saving model ...
Updating learning rate to 0.00025
tensor(19.8604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7859822 KL Loss: 7.1944553 DSM Loss: 9.6587475 Overall Loss:18.6391849
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.7795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8268675 KL Loss: 7.2050199 DSM Loss: 9.6182498 Overall Loss:18.6501372
Validation loss decreased (2.587099 --> 2.535074).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.3473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7995277 KL Loss: 7.2584579 DSM Loss: 9.4131566 Overall Loss:18.4711420
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(18.9274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8037279 KL Loss: 7.2125139 DSM Loss: 9.3428843 Overall Loss:18.3591261
Validation loss decreased (2.535074 --> 2.458477).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(15.9996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7722147 KL Loss: 7.1589584 DSM Loss: 9.3407503 Overall Loss:18.2719233
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(21.7606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7607907 KL Loss: 7.1465329 DSM Loss: 9.3281343 Overall Loss:18.2354579
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(15.9236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.8043477 KL Loss: 7.1996407 DSM Loss: 9.3451792 Overall Loss:18.3491676
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:14.991745948791504
Use GPU: cuda:0
>>>>>>>start training : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.4309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8454289 KL Loss: 7.2152791 DSM Loss: 12.0972666 Overall Loss:21.1579747
Validation loss decreased (inf --> 2.499911).  Saving model ...
Updating learning rate to 0.0005
tensor(17.8771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8142881 KL Loss: 7.1550489 DSM Loss: 10.1311158 Overall Loss:19.1004528
Validation loss decreased (2.499911 --> 2.428725).  Saving model ...
Updating learning rate to 0.00025
tensor(18.1689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7375857 KL Loss: 7.1196189 DSM Loss: 9.4579076 Overall Loss:18.3151120
Validation loss decreased (2.428725 --> 2.028310).  Saving model ...
Updating learning rate to 0.000125
tensor(19.0264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7528127 KL Loss: 7.1096392 DSM Loss: 9.4829405 Overall Loss:18.3453922
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(23.1956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7662086 KL Loss: 7.1520601 DSM Loss: 9.4962340 Overall Loss:18.4145026
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.6666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7665441 KL Loss: 7.2040541 DSM Loss: 9.3059857 Overall Loss:18.2765838
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:13.275954246520996


Running on file MSFT.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.1804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8713624 KL Loss: 7.2539060 DSM Loss: 13.0676100 Overall Loss:22.1928783
Validation loss decreased (inf --> 9.585955).  Saving model ...
Updating learning rate to 0.0005
tensor(21.1001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8528562 KL Loss: 7.2281795 DSM Loss: 9.8941043 Overall Loss:18.9751401
Validation loss decreased (9.585955 --> 7.473309).  Saving model ...
Updating learning rate to 0.00025
tensor(18.9423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8185858 KL Loss: 7.1832485 DSM Loss: 9.6538971 Overall Loss:18.6557314
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.3023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7870835 KL Loss: 7.1578641 DSM Loss: 9.6397193 Overall Loss:18.5846668
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.7733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1279, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7134128 KL Loss: 7.1093061 DSM Loss: 9.2758174 Overall Loss:18.0985363
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.8209381103515625
Use GPU: cuda:0
>>>>>>>start training : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.6872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7099, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8696699 KL Loss: 7.2509196 DSM Loss: 11.4447329 Overall Loss:20.5653225
Validation loss decreased (inf --> 7.939660).  Saving model ...
Updating learning rate to 0.0005
tensor(18.3074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8463, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7920571 KL Loss: 7.1503005 DSM Loss: 10.0689029 Overall Loss:19.0112605
Validation loss decreased (7.939660 --> 6.732720).  Saving model ...
Updating learning rate to 0.00025
tensor(17.4086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7977298 KL Loss: 7.1393689 DSM Loss: 9.7200426 Overall Loss:18.6571412
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.2956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7709507 KL Loss: 7.1633020 DSM Loss: 9.4566186 Overall Loss:18.3908712
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.7190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7740442 KL Loss: 7.1795689 DSM Loss: 9.3169377 Overall Loss:18.2705507
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.09790563583374
Use GPU: cuda:0
>>>>>>>start training : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.3013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8507369 KL Loss: 7.2368228 DSM Loss: 12.8767727 Overall Loss:21.9643326
Validation loss decreased (inf --> 7.592796).  Saving model ...
Updating learning rate to 0.0005
tensor(15.3393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8121619 KL Loss: 7.1366657 DSM Loss: 10.0841318 Overall Loss:19.0329594
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(14.2535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7569938 KL Loss: 7.1419574 DSM Loss: 9.6224048 Overall Loss:18.5213561
Validation loss decreased (7.592796 --> 7.553560).  Saving model ...
Updating learning rate to 0.000125
tensor(16.4281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7757803 KL Loss: 7.1835296 DSM Loss: 9.5909313 Overall Loss:18.5502411
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(22.0123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7471, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7744689 KL Loss: 7.1625265 DSM Loss: 9.6162715 Overall Loss:18.5532670
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(19.5065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7553914 KL Loss: 7.1557642 DSM Loss: 9.3218629 Overall Loss:18.2330185
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.867852687835693
Use GPU: cuda:0
>>>>>>>start training : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.7541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7802163 KL Loss: 7.1639902 DSM Loss: 11.9411159 Overall Loss:20.8853223
Validation loss decreased (inf --> 7.648729).  Saving model ...
Updating learning rate to 0.0005
tensor(20.4993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8143307 KL Loss: 7.1698817 DSM Loss: 10.0849925 Overall Loss:19.0692049
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.8509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7669844 KL Loss: 7.1337494 DSM Loss: 9.5617840 Overall Loss:18.4625178
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.3261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7646994 KL Loss: 7.0929633 DSM Loss: 9.4833120 Overall Loss:18.3409747
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.936037540435791
Use GPU: cuda:0
>>>>>>>start training : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8540371 KL Loss: 7.2236671 DSM Loss: 11.8805172 Overall Loss:20.9582213
Validation loss decreased (inf --> 6.833515).  Saving model ...
Updating learning rate to 0.0005
tensor(25.6248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4099, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8625315 KL Loss: 7.1681112 DSM Loss: 9.7333492 Overall Loss:18.7639920
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.0238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2919, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7593696 KL Loss: 7.1288455 DSM Loss: 9.5715808 Overall Loss:18.4597958
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.1939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7582806 KL Loss: 7.1418337 DSM Loss: 9.5829384 Overall Loss:18.4830526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.182164669036865


Running on file NEE.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.7073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8983479 KL Loss: 7.1940936 DSM Loss: 11.6749389 Overall Loss:20.7673803
Validation loss decreased (inf --> 4.789080).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8105761 KL Loss: 7.1272109 DSM Loss: 9.7320894 Overall Loss:18.6698765
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.0353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8434517 KL Loss: 7.1357745 DSM Loss: 9.8226858 Overall Loss:18.8019119
Validation loss decreased (4.789080 --> 3.948704).  Saving model ...
Updating learning rate to 0.000125
tensor(22.0529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7925207 KL Loss: 7.1257566 DSM Loss: 9.4953141 Overall Loss:18.4135913
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(19.7078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7291726 KL Loss: 7.1245526 DSM Loss: 9.4260549 Overall Loss:18.2797800
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(21.4597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7978066 KL Loss: 7.1559429 DSM Loss: 9.3287335 Overall Loss:18.2824829
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.9532663822174072
Use GPU: cuda:0
>>>>>>>start training : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.7640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8074469 KL Loss: 7.2593488 DSM Loss: 13.6729486 Overall Loss:22.7397442
Validation loss decreased (inf --> 4.228490).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8074136 KL Loss: 7.1427346 DSM Loss: 10.0115174 Overall Loss:18.9616657
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.5496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7587, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7977005 KL Loss: 7.1641859 DSM Loss: 9.6753849 Overall Loss:18.6372713
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.1061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7734281 KL Loss: 7.1706867 DSM Loss: 9.4742080 Overall Loss:18.4183227
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.1583688259124756
Use GPU: cuda:0
>>>>>>>start training : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.2026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8075666 KL Loss: 7.2142840 DSM Loss: 10.9278445 Overall Loss:19.9496951
Validation loss decreased (inf --> 3.479301).  Saving model ...
Updating learning rate to 0.0005
tensor(19.9865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8076317 KL Loss: 7.0925001 DSM Loss: 9.8078020 Overall Loss:18.7079338
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.8681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.9653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7888083 KL Loss: 7.1366736 DSM Loss: 9.8723984 Overall Loss:18.7978801
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(22.2605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8117595 KL Loss: 7.2221996 DSM Loss: 9.3823751 Overall Loss:18.4163341
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.524866819381714
Use GPU: cuda:0
>>>>>>>start training : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.8548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4090, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8386565 KL Loss: 7.1941081 DSM Loss: 12.4207587 Overall Loss:21.4535233
Validation loss decreased (inf --> 3.928665).  Saving model ...
Updating learning rate to 0.0005
tensor(19.2333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7856795 KL Loss: 7.1784888 DSM Loss: 10.1750163 Overall Loss:19.1391845
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.7252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7673701 KL Loss: 7.0932039 DSM Loss: 9.6770087 Overall Loss:18.5375827
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.0135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7202924 KL Loss: 7.1326988 DSM Loss: 9.3110298 Overall Loss:18.1640210
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.926068067550659
Use GPU: cuda:0
>>>>>>>start training : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.9192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7511, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8402017 KL Loss: 7.2258377 DSM Loss: 11.5905244 Overall Loss:20.6565637
Validation loss decreased (inf --> 3.884399).  Saving model ...
Updating learning rate to 0.0005
tensor(22.3625, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8416025 KL Loss: 7.1580912 DSM Loss: 10.3024976 Overall Loss:19.3021912
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.3950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7805342 KL Loss: 7.1350006 DSM Loss: 9.7996297 Overall Loss:18.7151644
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.7465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7700796 KL Loss: 7.1467570 DSM Loss: 9.5684279 Overall Loss:18.4852645
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.874727725982666


Running on file NGG.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(32.0074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8330665 KL Loss: 7.1937197 DSM Loss: 12.1213839 Overall Loss:21.1481702
Validation loss decreased (inf --> 10.246201).  Saving model ...
Updating learning rate to 0.0005
tensor(19.9815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8022008 KL Loss: 7.1281486 DSM Loss: 10.1891043 Overall Loss:19.1194537
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.3323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8059946 KL Loss: 7.1480011 DSM Loss: 9.7465996 Overall Loss:18.7005953
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.9838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7953177 KL Loss: 7.1703985 DSM Loss: 9.5979286 Overall Loss:18.5636448
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.079752922058105
Use GPU: cuda:0
>>>>>>>start training : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.9462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8117403 KL Loss: 7.1876493 DSM Loss: 11.3131266 Overall Loss:20.3125162
Validation loss decreased (inf --> 11.384187).  Saving model ...
Updating learning rate to 0.0005
tensor(20.1604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8131231 KL Loss: 7.1552640 DSM Loss: 9.9861585 Overall Loss:18.9545456
Validation loss decreased (11.384187 --> 10.899796).  Saving model ...
Updating learning rate to 0.00025
tensor(22.8162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7715174 KL Loss: 7.1507685 DSM Loss: 9.9360373 Overall Loss:18.8583233
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.9438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3984, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7940220 KL Loss: 7.2021546 DSM Loss: 9.5393061 Overall Loss:18.5354827
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.4912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7772200 KL Loss: 7.1521914 DSM Loss: 9.3272841 Overall Loss:18.2566954
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.598352432250977
Use GPU: cuda:0
>>>>>>>start training : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.4101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8501332 KL Loss: 7.2201940 DSM Loss: 12.8481088 Overall Loss:21.9184359
Validation loss decreased (inf --> 11.711756).  Saving model ...
Updating learning rate to 0.0005
tensor(18.5517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4489, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8016598 KL Loss: 7.1538621 DSM Loss: 10.2583515 Overall Loss:19.2138733
Validation loss decreased (11.711756 --> 10.390370).  Saving model ...
Updating learning rate to 0.00025
tensor(18.2463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8209700 KL Loss: 7.1854633 DSM Loss: 9.7499665 Overall Loss:18.7563998
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.0301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8028863 KL Loss: 7.1654951 DSM Loss: 9.7950935 Overall Loss:18.7634749
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.3588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5609, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7873073 KL Loss: 7.1518141 DSM Loss: 9.4735030 Overall Loss:18.4126244
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.159517288208008
Use GPU: cuda:0
>>>>>>>start training : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.7467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6844, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8107067 KL Loss: 7.1970664 DSM Loss: 11.5094181 Overall Loss:20.5171911
Validation loss decreased (inf --> 10.091830).  Saving model ...
Updating learning rate to 0.0005
tensor(18.4028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8286016 KL Loss: 7.1368172 DSM Loss: 10.1328668 Overall Loss:19.0982856
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.3831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7995477 KL Loss: 7.1993709 DSM Loss: 9.8113078 Overall Loss:18.8102264
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.6405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7584477 KL Loss: 7.1444766 DSM Loss: 9.5843024 Overall Loss:18.4872268
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.881209373474121
Use GPU: cuda:0
>>>>>>>start training : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.1105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7937602 KL Loss: 7.2317667 DSM Loss: 12.6758130 Overall Loss:21.7013399
Validation loss decreased (inf --> 10.082741).  Saving model ...
Updating learning rate to 0.0005
tensor(20.7286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6974, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7600559 KL Loss: 7.1197216 DSM Loss: 10.3011904 Overall Loss:19.1809679
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.1617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7649329 KL Loss: 7.1831170 DSM Loss: 9.8382166 Overall Loss:18.7862665
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.7777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8205, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7857963 KL Loss: 7.1785103 DSM Loss: 9.6461327 Overall Loss:18.6104392
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.8810343742370605


Running on file NVS.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.2603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8248032 KL Loss: 7.1876777 DSM Loss: 11.5029310 Overall Loss:20.5154118
Validation loss decreased (inf --> 1.808398).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6720, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8261771 KL Loss: 7.1789781 DSM Loss: 10.2159146 Overall Loss:19.2210698
Validation loss decreased (1.808398 --> 1.403339).  Saving model ...
Updating learning rate to 0.00025
tensor(20.3690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7830886 KL Loss: 7.1994554 DSM Loss: 9.5956428 Overall Loss:18.5781870
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.1048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8065846 KL Loss: 7.1837811 DSM Loss: 9.5584074 Overall Loss:18.5487731
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(22.5241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8130122 KL Loss: 7.1948861 DSM Loss: 9.4971831 Overall Loss:18.5050812
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.76313591003418
Use GPU: cuda:0
>>>>>>>start training : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.2013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6710, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9521157 KL Loss: 7.3147688 DSM Loss: 12.7614814 Overall Loss:22.0283657
Validation loss decreased (inf --> 1.493700).  Saving model ...
Updating learning rate to 0.0005
tensor(19.5065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8246718 KL Loss: 7.1967935 DSM Loss: 10.0355550 Overall Loss:19.0570203
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.3759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8156782 KL Loss: 7.2192079 DSM Loss: 9.9310713 Overall Loss:18.9659574
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.6955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7992156 KL Loss: 7.1697665 DSM Loss: 9.7099478 Overall Loss:18.6789297
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.954967021942139
Use GPU: cuda:0
>>>>>>>start training : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.1753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8583016 KL Loss: 7.2111454 DSM Loss: 12.2785304 Overall Loss:21.3479773
Validation loss decreased (inf --> 1.559156).  Saving model ...
Updating learning rate to 0.0005
tensor(18.4215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0769, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8524674 KL Loss: 7.1612435 DSM Loss: 10.1186892 Overall Loss:19.1324000
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.0962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3103, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7670507 KL Loss: 7.1161107 DSM Loss: 9.7677073 Overall Loss:18.6508688
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.0090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7527959 KL Loss: 7.1077210 DSM Loss: 9.5915551 Overall Loss:18.4520719
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.077451229095459
Use GPU: cuda:0
>>>>>>>start training : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.7977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1043, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9185915 KL Loss: 7.2890444 DSM Loss: 12.1829768 Overall Loss:21.3906127
Validation loss decreased (inf --> 2.039147).  Saving model ...
Updating learning rate to 0.0005
tensor(20.0864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8759735 KL Loss: 7.1868919 DSM Loss: 10.7374659 Overall Loss:19.8003313
Validation loss decreased (2.039147 --> 1.464444).  Saving model ...
Updating learning rate to 0.00025
tensor(16.9633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8246544 KL Loss: 7.2066740 DSM Loss: 9.7320449 Overall Loss:18.7633734
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.4394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8026593 KL Loss: 7.1876689 DSM Loss: 9.5361412 Overall Loss:18.5264696
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.3180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4344, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7455704 KL Loss: 7.1166246 DSM Loss: 9.4721663 Overall Loss:18.3343613
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.986208438873291
Use GPU: cuda:0
>>>>>>>start training : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0560, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8596986 KL Loss: 7.2764208 DSM Loss: 11.9286873 Overall Loss:21.0648067
Validation loss decreased (inf --> 1.514545).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8376051 KL Loss: 7.1995079 DSM Loss: 10.2932607 Overall Loss:19.3303736
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.9423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7750243 KL Loss: 7.1699954 DSM Loss: 9.7348437 Overall Loss:18.6798633
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.1056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7581, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7751746 KL Loss: 7.1632399 DSM Loss: 9.5136813 Overall Loss:18.4520957
Validation loss decreased (1.514545 --> 1.378570).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.6670, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8029999 KL Loss: 7.1553538 DSM Loss: 9.5041325 Overall Loss:18.4624862
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(16.2699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7532088 KL Loss: 7.1356110 DSM Loss: 9.4999281 Overall Loss:18.3887479
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(16.1272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7429801 KL Loss: 7.1710806 DSM Loss: 9.4579366 Overall Loss:18.3719973
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.720046520233154


Running on file ORCL.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(37.8657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5296, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8262468 KL Loss: 7.1605097 DSM Loss: 11.8703758 Overall Loss:20.8571324
Validation loss decreased (inf --> 10.235362).  Saving model ...
Updating learning rate to 0.0005
tensor(25.5294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8183875 KL Loss: 7.1648034 DSM Loss: 9.8523696 Overall Loss:18.8355605
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(12.6286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5114, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7527888 KL Loss: 7.1126430 DSM Loss: 9.5265914 Overall Loss:18.3920231
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.8436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7501538 KL Loss: 7.1000790 DSM Loss: 9.2775593 Overall Loss:18.1277921
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:17.849409103393555
Use GPU: cuda:0
>>>>>>>start training : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(21.1716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8435101 KL Loss: 7.1895174 DSM Loss: 12.3284230 Overall Loss:21.3614506
Validation loss decreased (inf --> 10.476372).  Saving model ...
Updating learning rate to 0.0005
tensor(29.3977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.1711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8235145 KL Loss: 7.1814213 DSM Loss: 9.9046789 Overall Loss:18.9096147
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.6772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8118240 KL Loss: 7.1254386 DSM Loss: 9.3998618 Overall Loss:18.3371244
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.9569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6418, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7804682 KL Loss: 7.1216550 DSM Loss: 9.5199499 Overall Loss:18.4220731
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:18.32692527770996
Use GPU: cuda:0
>>>>>>>start training : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.5095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8766734 KL Loss: 7.2977759 DSM Loss: 11.0466101 Overall Loss:20.2210594
Validation loss decreased (inf --> 10.817868).  Saving model ...
Updating learning rate to 0.0005
tensor(15.1571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7966441 KL Loss: 7.1830641 DSM Loss: 9.8262562 Overall Loss:18.8059644
Validation loss decreased (10.817868 --> 10.298578).  Saving model ...
Updating learning rate to 0.00025
tensor(22.9729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8118057 KL Loss: 7.1341857 DSM Loss: 9.3170636 Overall Loss:18.2630550
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.2974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.0354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7725034 KL Loss: 7.0983203 DSM Loss: 8.9700397 Overall Loss:17.8408634
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.8909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.5717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7877298 KL Loss: 7.1722600 DSM Loss: 9.0118202 Overall Loss:17.9718101
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:17.952388763427734
Use GPU: cuda:0
>>>>>>>start training : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(35.4652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8623093 KL Loss: 7.2088459 DSM Loss: 10.8879956 Overall Loss:19.9591508
Validation loss decreased (inf --> 11.078651).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7193, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8595324 KL Loss: 7.2030645 DSM Loss: 9.5588816 Overall Loss:18.6214785
Validation loss decreased (11.078651 --> 9.590871).  Saving model ...
Updating learning rate to 0.00025
tensor(17.3591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5922, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.9034782 KL Loss: 7.1912923 DSM Loss: 9.5840733 Overall Loss:18.6788438
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(23.9310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7508501 KL Loss: 7.1087103 DSM Loss: 9.2891992 Overall Loss:18.1487596
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.2671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7731886 KL Loss: 7.1807991 DSM Loss: 9.0158225 Overall Loss:17.9698101
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:17.049732208251953
Use GPU: cuda:0
>>>>>>>start training : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.7299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8602582 KL Loss: 7.2152851 DSM Loss: 10.8992047 Overall Loss:19.9747481
Validation loss decreased (inf --> 12.034301).  Saving model ...
Updating learning rate to 0.0005
tensor(13.5785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8049868 KL Loss: 7.1761119 DSM Loss: 9.7164747 Overall Loss:18.6975734
Validation loss decreased (12.034301 --> 11.465799).  Saving model ...
Updating learning rate to 0.00025
tensor(24.1938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7341356 KL Loss: 7.0898827 DSM Loss: 9.3399264 Overall Loss:18.1639447
Validation loss decreased (11.465799 --> 11.312644).  Saving model ...
Updating learning rate to 0.000125
tensor(13.1957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7638005 KL Loss: 7.1421842 DSM Loss: 9.2384455 Overall Loss:18.1444300
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(24.9086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7924575 KL Loss: 7.1759332 DSM Loss: 8.9249606 Overall Loss:17.8933513
Validation loss decreased (11.312644 --> 11.285478).  Saving model ...
Updating learning rate to 3.125e-05
tensor(14.8349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7822729 KL Loss: 7.1819636 DSM Loss: 9.0472578 Overall Loss:18.0114942
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(14.1318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4127, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7804766 KL Loss: 7.2152869 DSM Loss: 8.9471611 Overall Loss:17.9429247
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(16.6414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.1329, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7898174 KL Loss: 7.1275120 DSM Loss: 8.9465337 Overall Loss:17.8638631
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:19.130027770996094


Running on file PCG.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.6934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8526064 KL Loss: 7.2059770 DSM Loss: 12.0867591 Overall Loss:21.1453425
Validation loss decreased (inf --> 1.014590).  Saving model ...
Updating learning rate to 0.0005
tensor(19.8641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8075401 KL Loss: 7.1257716 DSM Loss: 10.2636161 Overall Loss:19.1969277
Validation loss decreased (1.014590 --> 0.966071).  Saving model ...
Updating learning rate to 0.00025
tensor(17.3404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5279, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8182679 KL Loss: 7.1697674 DSM Loss: 9.7247653 Overall Loss:18.7128005
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.3510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8202543 KL Loss: 7.2260389 DSM Loss: 9.8037968 Overall Loss:18.8500899
Validation loss decreased (0.966071 --> 0.925097).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.4219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8088185 KL Loss: 7.1791778 DSM Loss: 9.5317387 Overall Loss:18.5197350
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(16.5786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7921112 KL Loss: 7.1960073 DSM Loss: 9.5410839 Overall Loss:18.5292026
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(15.2987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7988522 KL Loss: 7.1763681 DSM Loss: 9.5218387 Overall Loss:18.4970590
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6323838829994202
Use GPU: cuda:0
>>>>>>>start training : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.5449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8637583 KL Loss: 7.2171632 DSM Loss: 11.5016015 Overall Loss:20.5825229
Validation loss decreased (inf --> 1.485599).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1585, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8491731 KL Loss: 7.1922181 DSM Loss: 10.0542066 Overall Loss:19.0955979
Validation loss decreased (1.485599 --> 0.857031).  Saving model ...
Updating learning rate to 0.00025
tensor(18.5454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8263376 KL Loss: 7.1575894 DSM Loss: 9.8076270 Overall Loss:18.7915540
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.4011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8302022 KL Loss: 7.1934349 DSM Loss: 9.6359988 Overall Loss:18.6596361
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.1548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7912597 KL Loss: 7.1886094 DSM Loss: 9.6588520 Overall Loss:18.6387211
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5863783955574036
Use GPU: cuda:0
>>>>>>>start training : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.2553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9063085 KL Loss: 7.2955231 DSM Loss: 12.4357451 Overall Loss:21.6375768
Validation loss decreased (inf --> 0.758550).  Saving model ...
Updating learning rate to 0.0005
tensor(20.6042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8366792 KL Loss: 7.1922739 DSM Loss: 9.8991439 Overall Loss:18.9280971
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.0583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8116171 KL Loss: 7.2285365 DSM Loss: 9.8368154 Overall Loss:18.8769688
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.9821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7688447 KL Loss: 7.1140533 DSM Loss: 9.8613359 Overall Loss:18.7442339
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5078103542327881
Use GPU: cuda:0
>>>>>>>start training : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.5041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8375732 KL Loss: 7.2281407 DSM Loss: 11.9745607 Overall Loss:21.0402747
Validation loss decreased (inf --> 1.266104).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5685, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7915641 KL Loss: 7.2113434 DSM Loss: 10.1892135 Overall Loss:19.1921211
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.7001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2148, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8099031 KL Loss: 7.1245700 DSM Loss: 9.8511380 Overall Loss:18.7856112
Validation loss decreased (1.266104 --> 0.977263).  Saving model ...
Updating learning rate to 0.000125
tensor(18.5746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7922744 KL Loss: 7.1853459 DSM Loss: 9.7029767 Overall Loss:18.6805970
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.9581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7327397 KL Loss: 7.0948242 DSM Loss: 9.6480798 Overall Loss:18.4756437
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.1438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9832, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7764843 KL Loss: 7.2218599 DSM Loss: 9.5593551 Overall Loss:18.5576991
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.67995285987854
Use GPU: cuda:0
>>>>>>>start training : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.8411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8346387 KL Loss: 7.2532862 DSM Loss: 11.7052298 Overall Loss:20.7931546
Validation loss decreased (inf --> 1.182492).  Saving model ...
Updating learning rate to 0.0005
tensor(18.5895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8564388 KL Loss: 7.2274033 DSM Loss: 10.1699334 Overall Loss:19.2537754
Validation loss decreased (1.182492 --> 0.871660).  Saving model ...
Updating learning rate to 0.00025
tensor(18.0953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5379, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7941607 KL Loss: 7.1486288 DSM Loss: 10.0758133 Overall Loss:19.0186028
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.6391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8101300 KL Loss: 7.2110894 DSM Loss: 9.6108620 Overall Loss:18.6320813
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(17.1220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7877222 KL Loss: 7.1837715 DSM Loss: 9.6374939 Overall Loss:18.6089876
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5918518900871277


Running on file PEP.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.0701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5258, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8674525 KL Loss: 7.1850848 DSM Loss: 11.9880726 Overall Loss:21.0406099
Validation loss decreased (inf --> 7.941819).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7964454 KL Loss: 7.1360470 DSM Loss: 9.9465874 Overall Loss:18.8790799
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.7799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7377884 KL Loss: 7.1482241 DSM Loss: 9.6002359 Overall Loss:18.4862483
Validation loss decreased (7.941819 --> 7.289931).  Saving model ...
Updating learning rate to 0.000125
tensor(21.9985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7195322 KL Loss: 7.0750958 DSM Loss: 9.2990497 Overall Loss:18.0936776
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(14.5817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7764128 KL Loss: 7.1759958 DSM Loss: 9.1632650 Overall Loss:18.1156736
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(16.7923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7763794 KL Loss: 7.1638316 DSM Loss: 9.2817317 Overall Loss:18.2219427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.994704246520996
Use GPU: cuda:0
>>>>>>>start training : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.7759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8420125 KL Loss: 7.1905857 DSM Loss: 11.3121016 Overall Loss:20.3446997
Validation loss decreased (inf --> 7.584775).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8190082 KL Loss: 7.1651719 DSM Loss: 9.9969585 Overall Loss:18.9811385
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.5730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4063, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7987511 KL Loss: 7.1898335 DSM Loss: 9.5399525 Overall Loss:18.5285369
Validation loss decreased (7.584775 --> 7.215316).  Saving model ...
Updating learning rate to 0.000125
tensor(18.3639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1173, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7808026 KL Loss: 7.1266039 DSM Loss: 9.4336854 Overall Loss:18.3410920
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.3812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7690737 KL Loss: 7.2286484 DSM Loss: 9.3059495 Overall Loss:18.3036714
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.9341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7838259 KL Loss: 7.1636451 DSM Loss: 9.1966895 Overall Loss:18.1441605
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.865275382995605
Use GPU: cuda:0
>>>>>>>start training : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.3869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8123562 KL Loss: 7.2657825 DSM Loss: 13.0066890 Overall Loss:22.0848277
Validation loss decreased (inf --> 7.738996).  Saving model ...
Updating learning rate to 0.0005
tensor(23.1860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0987, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8342138 KL Loss: 7.1767317 DSM Loss: 10.4400991 Overall Loss:19.4510446
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.5526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7770218 KL Loss: 7.1426707 DSM Loss: 9.5054940 Overall Loss:18.4251864
Validation loss decreased (7.738996 --> 7.489341).  Saving model ...
Updating learning rate to 0.000125
tensor(19.6721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8153121 KL Loss: 7.1947216 DSM Loss: 9.2041889 Overall Loss:18.2142226
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(18.5866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8468, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7403993 KL Loss: 7.0981282 DSM Loss: 9.2676268 Overall Loss:18.1061542
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(14.1220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7401631 KL Loss: 7.1632147 DSM Loss: 9.1550430 Overall Loss:18.0584208
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:13.239115715026855
Use GPU: cuda:0
>>>>>>>start training : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.2115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8171734 KL Loss: 7.1584748 DSM Loss: 11.7979312 Overall Loss:20.7735793
Validation loss decreased (inf --> 7.448836).  Saving model ...
Updating learning rate to 0.0005
tensor(18.0348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8326483 KL Loss: 7.2017723 DSM Loss: 9.9226320 Overall Loss:18.9570526
Validation loss decreased (7.448836 --> 7.446203).  Saving model ...
Updating learning rate to 0.00025
tensor(15.2016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8352237 KL Loss: 7.1718486 DSM Loss: 9.7119614 Overall Loss:18.7190337
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.0517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7938023 KL Loss: 7.1739495 DSM Loss: 9.3811913 Overall Loss:18.3489431
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.1840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7761887 KL Loss: 7.1674742 DSM Loss: 9.2431688 Overall Loss:18.1868316
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:13.148150444030762
Use GPU: cuda:0
>>>>>>>start training : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.9446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8406969 KL Loss: 7.2033657 DSM Loss: 11.4860186 Overall Loss:20.5300810
Validation loss decreased (inf --> 7.430014).  Saving model ...
Updating learning rate to 0.0005
tensor(22.8154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4922, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8067138 KL Loss: 7.1376320 DSM Loss: 9.7837315 Overall Loss:18.7280773
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.4354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7865575 KL Loss: 7.1354041 DSM Loss: 9.5481699 Overall Loss:18.4701314
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.0857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8363087 KL Loss: 7.2241324 DSM Loss: 9.3932005 Overall Loss:18.4536416
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:13.189591407775879


Running on file PFE.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6846, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8758571 KL Loss: 7.2215618 DSM Loss: 11.8943877 Overall Loss:20.9918066
Validation loss decreased (inf --> 17.754090).  Saving model ...
Updating learning rate to 0.0005
tensor(17.5990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8363511 KL Loss: 7.1788015 DSM Loss: 9.8615671 Overall Loss:18.8767198
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.0426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4361, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7761482 KL Loss: 7.1634832 DSM Loss: 9.3463099 Overall Loss:18.2859412
Validation loss decreased (17.754090 --> 16.928139).  Saving model ...
Updating learning rate to 0.000125
tensor(13.3689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4690, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8131867 KL Loss: 7.1809605 DSM Loss: 9.1879989 Overall Loss:18.1821462
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.4571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7843548 KL Loss: 7.1327511 DSM Loss: 9.1003910 Overall Loss:18.0174969
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(22.5117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7615266 KL Loss: 7.1611862 DSM Loss: 9.1661264 Overall Loss:18.0888392
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.592720985412598
Use GPU: cuda:0
>>>>>>>start training : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.3298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8277264 KL Loss: 7.2137046 DSM Loss: 11.7034384 Overall Loss:20.7448693
Validation loss decreased (inf --> 21.159760).  Saving model ...
Updating learning rate to 0.0005
tensor(16.3439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9680, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8168158 KL Loss: 7.2230331 DSM Loss: 9.9386743 Overall Loss:18.9785232
Validation loss decreased (21.159760 --> 18.432376).  Saving model ...
Updating learning rate to 0.00025
tensor(15.9730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4111, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8232469 KL Loss: 7.2343138 DSM Loss: 9.3482316 Overall Loss:18.4057923
Validation loss decreased (18.432376 --> 17.607496).  Saving model ...
Updating learning rate to 0.000125
tensor(16.9504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7709195 KL Loss: 7.1615816 DSM Loss: 9.2409862 Overall Loss:18.1734871
Validation loss decreased (17.607496 --> 16.960244).  Saving model ...
Updating learning rate to 6.25e-05
tensor(14.6041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7933137 KL Loss: 7.1946687 DSM Loss: 9.2464702 Overall Loss:18.2344527
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(21.8157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7371505 KL Loss: 7.0923514 DSM Loss: 9.1701672 Overall Loss:17.9996692
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(18.8765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9892, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7561245 KL Loss: 7.1363772 DSM Loss: 9.0992224 Overall Loss:17.9917241
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.662527084350586
Use GPU: cuda:0
>>>>>>>start training : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.0104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8553919 KL Loss: 7.2121399 DSM Loss: 11.7769744 Overall Loss:20.8445063
Validation loss decreased (inf --> 17.861891).  Saving model ...
Updating learning rate to 0.0005
tensor(22.9327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7669799 KL Loss: 7.0980606 DSM Loss: 9.9735811 Overall Loss:18.8386216
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.1556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7123, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7746199 KL Loss: 7.1428573 DSM Loss: 9.5500307 Overall Loss:18.4675078
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.4992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4980, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7681423 KL Loss: 7.1420450 DSM Loss: 9.2901411 Overall Loss:18.2003284
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.2253999710083
Use GPU: cuda:0
>>>>>>>start training : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.8799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8468789 KL Loss: 7.1719989 DSM Loss: 12.2154733 Overall Loss:21.2343509
Validation loss decreased (inf --> 21.078010).  Saving model ...
Updating learning rate to 0.0005
tensor(22.1074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2375, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7580057 KL Loss: 7.0972103 DSM Loss: 9.9020771 Overall Loss:18.7572930
Validation loss decreased (21.078010 --> 17.503285).  Saving model ...
Updating learning rate to 0.00025
tensor(19.1432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7551675 KL Loss: 7.1466798 DSM Loss: 9.4458528 Overall Loss:18.3477001
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.6509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8068665 KL Loss: 7.2088617 DSM Loss: 9.2145863 Overall Loss:18.2303145
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.1690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2846, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8206510 KL Loss: 7.1995081 DSM Loss: 9.1017730 Overall Loss:18.1219320
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.95893383026123
Use GPU: cuda:0
>>>>>>>start training : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.9074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2031, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9136491 KL Loss: 7.2794461 DSM Loss: 10.7836987 Overall Loss:19.9767938
Validation loss decreased (inf --> 18.493134).  Saving model ...
Updating learning rate to 0.0005
tensor(18.1121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8607688 KL Loss: 7.1940900 DSM Loss: 9.9468343 Overall Loss:19.0016932
Validation loss decreased (18.493134 --> 17.251869).  Saving model ...
Updating learning rate to 0.00025
tensor(20.6415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7658483 KL Loss: 7.0992398 DSM Loss: 9.4835695 Overall Loss:18.3486576
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.7808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7474417 KL Loss: 7.1239681 DSM Loss: 9.1526722 Overall Loss:18.0240822
Validation loss decreased (17.251869 --> 16.947556).  Saving model ...
Updating learning rate to 6.25e-05
tensor(19.9787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7642173 KL Loss: 7.1402768 DSM Loss: 9.1756670 Overall Loss:18.0801611
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(22.0243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4367, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7823499 KL Loss: 7.1669072 DSM Loss: 9.0533133 Overall Loss:18.0025703
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(16.2815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7543086 KL Loss: 7.0956799 DSM Loss: 9.1665164 Overall Loss:18.0165049
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.562165260314941


Running on file PG.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.3109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7433, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8054199 KL Loss: 7.1866788 DSM Loss: 11.1292501 Overall Loss:20.1213488
Validation loss decreased (inf --> 6.651671).  Saving model ...
Updating learning rate to 0.0005
tensor(18.3831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8623822 KL Loss: 7.2904564 DSM Loss: 9.9255799 Overall Loss:19.0784184
Validation loss decreased (6.651671 --> 5.077517).  Saving model ...
Updating learning rate to 0.00025
tensor(18.1621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7990862 KL Loss: 7.1914410 DSM Loss: 9.5343539 Overall Loss:18.5248811
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.1538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7715534 KL Loss: 7.1728442 DSM Loss: 9.4265673 Overall Loss:18.3709650
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.0272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2523, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7677287 KL Loss: 7.1645342 DSM Loss: 9.3973339 Overall Loss:18.3295969
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.841318130493164
Use GPU: cuda:0
>>>>>>>start training : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.1064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8651350 KL Loss: 7.1757650 DSM Loss: 11.2542791 Overall Loss:20.2951790
Validation loss decreased (inf --> 5.464041).  Saving model ...
Updating learning rate to 0.0005
tensor(24.6299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2413, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8083689 KL Loss: 7.2042576 DSM Loss: 9.8867592 Overall Loss:18.8993857
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.8621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8007704 KL Loss: 7.1415199 DSM Loss: 9.5586623 Overall Loss:18.5009526
Validation loss decreased (5.464041 --> 5.458920).  Saving model ...
Updating learning rate to 0.000125
tensor(23.0848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9562, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7649939 KL Loss: 7.1552579 DSM Loss: 9.4336360 Overall Loss:18.3538877
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.1994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7597949 KL Loss: 7.1548620 DSM Loss: 9.5192732 Overall Loss:18.4339301
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.9387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7942016 KL Loss: 7.1640742 DSM Loss: 9.2759064 Overall Loss:18.2341823
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.208661079406738
Use GPU: cuda:0
>>>>>>>start training : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.1077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9146, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8860901 KL Loss: 7.2384652 DSM Loss: 12.0057142 Overall Loss:21.1302697
Validation loss decreased (inf --> 5.539298).  Saving model ...
Updating learning rate to 0.0005
tensor(16.3599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8099309 KL Loss: 7.1727972 DSM Loss: 10.1380846 Overall Loss:19.1208127
Validation loss decreased (5.539298 --> 5.203275).  Saving model ...
Updating learning rate to 0.00025
tensor(17.8036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8145505 KL Loss: 7.1670294 DSM Loss: 9.8157148 Overall Loss:18.7972948
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.1688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9205, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7915142 KL Loss: 7.2016516 DSM Loss: 9.5512033 Overall Loss:18.5443691
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.9498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7658305 KL Loss: 7.1715277 DSM Loss: 9.4403555 Overall Loss:18.3777137
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.958862781524658
Use GPU: cuda:0
>>>>>>>start training : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.0314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6560, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8387942 KL Loss: 7.1918131 DSM Loss: 11.3568339 Overall Loss:20.3874412
Validation loss decreased (inf --> 5.119467).  Saving model ...
Updating learning rate to 0.0005
tensor(14.5663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8262414 KL Loss: 7.1520995 DSM Loss: 9.9506526 Overall Loss:18.9289936
Validation loss decreased (5.119467 --> 4.966836).  Saving model ...
Updating learning rate to 0.00025
tensor(15.8947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7769228 KL Loss: 7.1492430 DSM Loss: 9.6891694 Overall Loss:18.6153353
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.1544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8005014 KL Loss: 7.2031090 DSM Loss: 9.4881636 Overall Loss:18.4917740
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.8628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7448069 KL Loss: 7.1685466 DSM Loss: 9.4110643 Overall Loss:18.3244180
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.72154426574707
Use GPU: cuda:0
>>>>>>>start training : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(32.4348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8894091 KL Loss: 7.1938962 DSM Loss: 11.5582635 Overall Loss:20.6415687
Validation loss decreased (inf --> 5.524730).  Saving model ...
Updating learning rate to 0.0005
tensor(23.2177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8087482 KL Loss: 7.1542860 DSM Loss: 10.2963387 Overall Loss:19.2593730
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.7598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7556, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7666015 KL Loss: 7.1130321 DSM Loss: 9.7708673 Overall Loss:18.6505009
Validation loss decreased (5.524730 --> 5.358080).  Saving model ...
Updating learning rate to 0.000125
tensor(21.1563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7805245 KL Loss: 7.1398822 DSM Loss: 9.5049635 Overall Loss:18.4253703
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.8440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7509905 KL Loss: 7.1696831 DSM Loss: 9.2839480 Overall Loss:18.2046215
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.9852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7877822 KL Loss: 7.1556476 DSM Loss: 9.4301908 Overall Loss:18.3736205
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:5.111624240875244


Running on file PM.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.9024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8773433 KL Loss: 7.2497601 DSM Loss: 11.2846965 Overall Loss:20.4117999
Validation loss decreased (inf --> 4.973458).  Saving model ...
Updating learning rate to 0.0005
tensor(14.3431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8358088 KL Loss: 7.1906789 DSM Loss: 10.4563846 Overall Loss:19.4828723
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.3838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8086784 KL Loss: 7.2205553 DSM Loss: 9.6355873 Overall Loss:18.6648209
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.1454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7538288 KL Loss: 7.1578029 DSM Loss: 9.2986997 Overall Loss:18.2103313
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.823995590209961
Use GPU: cuda:0
>>>>>>>start training : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.1025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8763489 KL Loss: 7.2392039 DSM Loss: 11.9544346 Overall Loss:21.0699875
Validation loss decreased (inf --> 5.251529).  Saving model ...
Updating learning rate to 0.0005
tensor(21.8480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7994721 KL Loss: 7.1435675 DSM Loss: 10.0353981 Overall Loss:18.9784377
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.4027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7755438 KL Loss: 7.1584110 DSM Loss: 9.5346020 Overall Loss:18.4685567
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.4884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5354, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7613121 KL Loss: 7.0929704 DSM Loss: 9.4700098 Overall Loss:18.3242923
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.138018608093262
Use GPU: cuda:0
>>>>>>>start training : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.4255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8554158 KL Loss: 7.2336905 DSM Loss: 12.8495500 Overall Loss:21.9386563
Validation loss decreased (inf --> 5.486313).  Saving model ...
Updating learning rate to 0.0005
tensor(18.8421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8210283 KL Loss: 7.1274232 DSM Loss: 10.0965615 Overall Loss:19.0450129
Validation loss decreased (5.486313 --> 5.046329).  Saving model ...
Updating learning rate to 0.00025
tensor(22.9857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7890215 KL Loss: 7.1446492 DSM Loss: 9.7026480 Overall Loss:18.6363187
Validation loss decreased (5.046329 --> 4.988960).  Saving model ...
Updating learning rate to 0.000125
tensor(14.8374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7233, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8515951 KL Loss: 7.1821997 DSM Loss: 9.4276922 Overall Loss:18.4614870
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(22.3881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7794298 KL Loss: 7.1526481 DSM Loss: 9.2919919 Overall Loss:18.2240698
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(19.7262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7365227 KL Loss: 7.1445300 DSM Loss: 9.2625608 Overall Loss:18.1436136
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.742269992828369
Use GPU: cuda:0
>>>>>>>start training : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(18.8041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8575050 KL Loss: 7.1720746 DSM Loss: 11.8421401 Overall Loss:20.8717197
Validation loss decreased (inf --> 6.372482).  Saving model ...
Updating learning rate to 0.0005
tensor(20.2858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8119774 KL Loss: 7.1623346 DSM Loss: 10.3215956 Overall Loss:19.2959077
Validation loss decreased (6.372482 --> 6.126056).  Saving model ...
Updating learning rate to 0.00025
tensor(16.6847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3916, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8253322 KL Loss: 7.1763350 DSM Loss: 9.6909221 Overall Loss:18.6925892
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.8964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7775494 KL Loss: 7.1423943 DSM Loss: 9.2616004 Overall Loss:18.1815442
Validation loss decreased (6.126056 --> 6.059246).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.9141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.4730, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7296880 KL Loss: 7.1020250 DSM Loss: 9.2850515 Overall Loss:18.1167644
Validation loss decreased (6.059246 --> 5.530378).  Saving model ...
Updating learning rate to 3.125e-05
tensor(18.8097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7428321 KL Loss: 7.0912133 DSM Loss: 9.3313492 Overall Loss:18.1653947
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(22.5902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7447290 KL Loss: 7.1784936 DSM Loss: 9.2364991 Overall Loss:18.1597217
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(17.7905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7426095 KL Loss: 7.1584102 DSM Loss: 9.2524460 Overall Loss:18.1534655
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.420886039733887
Use GPU: cuda:0
>>>>>>>start training : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.1527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8091916 KL Loss: 7.2236996 DSM Loss: 11.6374813 Overall Loss:20.6703725
Validation loss decreased (inf --> 5.966518).  Saving model ...
Updating learning rate to 0.0005
tensor(16.7854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8274401 KL Loss: 7.2080009 DSM Loss: 10.0136359 Overall Loss:19.0490769
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.2365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8586298 KL Loss: 7.1837360 DSM Loss: 9.5156856 Overall Loss:18.5580514
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.6393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7802602 KL Loss: 7.1708201 DSM Loss: 9.3747826 Overall Loss:18.3258628
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.946638107299805


Running on file PPL.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.7963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4744, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8682665 KL Loss: 7.2701878 DSM Loss: 11.4234758 Overall Loss:20.5619299
Validation loss decreased (inf --> 0.417658).  Saving model ...
Updating learning rate to 0.0005
tensor(15.1827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1128, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7970194 KL Loss: 7.1421840 DSM Loss: 10.4184600 Overall Loss:19.3576633
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.4136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8011384 KL Loss: 7.1923211 DSM Loss: 9.7456282 Overall Loss:18.7390878
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.4027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7914697 KL Loss: 7.2490299 DSM Loss: 9.7395960 Overall Loss:18.7800955
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.5955911874771118
Use GPU: cuda:0
>>>>>>>start training : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.1695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8315219 KL Loss: 7.2096531 DSM Loss: 11.5522166 Overall Loss:20.5933916
Validation loss decreased (inf --> 0.540500).  Saving model ...
Updating learning rate to 0.0005
tensor(22.5058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8536366 KL Loss: 7.1991003 DSM Loss: 10.2455642 Overall Loss:19.2983012
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.5257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7950850 KL Loss: 7.1378073 DSM Loss: 9.8101628 Overall Loss:18.7430552
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.1229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7472792 KL Loss: 7.1689135 DSM Loss: 9.8072388 Overall Loss:18.7234315
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6836358308792114
Use GPU: cuda:0
>>>>>>>start training : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.5797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8476766 KL Loss: 7.2435099 DSM Loss: 12.3686970 Overall Loss:21.4598836
Validation loss decreased (inf --> 0.745571).  Saving model ...
Updating learning rate to 0.0005
tensor(20.3322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8413555 KL Loss: 7.2226593 DSM Loss: 10.2674447 Overall Loss:19.3314595
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.9524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8086448 KL Loss: 7.1656555 DSM Loss: 10.0079182 Overall Loss:18.9822184
Validation loss decreased (0.745571 --> 0.628457).  Saving model ...
Updating learning rate to 0.000125
tensor(20.4657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1896, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7724512 KL Loss: 7.1916365 DSM Loss: 9.6347375 Overall Loss:18.5988251
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.0439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7457, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8012105 KL Loss: 7.1555685 DSM Loss: 9.7680487 Overall Loss:18.7248277
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(24.8170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.5854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7687745 KL Loss: 7.1685603 DSM Loss: 9.4083634 Overall Loss:18.3456981
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.747782289981842
Use GPU: cuda:0
>>>>>>>start training : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.7681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2169, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8238698 KL Loss: 7.1975550 DSM Loss: 11.7543473 Overall Loss:20.7757720
Validation loss decreased (inf --> 0.744252).  Saving model ...
Updating learning rate to 0.0005
tensor(14.8678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1186, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8291534 KL Loss: 7.2014194 DSM Loss: 10.4416310 Overall Loss:19.4722038
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.4077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8378, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8266802 KL Loss: 7.1827819 DSM Loss: 9.8594903 Overall Loss:18.8689525
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.5736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8161055 KL Loss: 7.2032491 DSM Loss: 9.8746127 Overall Loss:18.8939672
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.8445842266082764
Use GPU: cuda:0
>>>>>>>start training : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.5392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9369, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7999284 KL Loss: 7.1770380 DSM Loss: 12.6659054 Overall Loss:21.6428718
Validation loss decreased (inf --> 0.543227).  Saving model ...
Updating learning rate to 0.0005
tensor(21.6644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7188, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7945410 KL Loss: 7.1666020 DSM Loss: 10.3874183 Overall Loss:19.3485614
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.0266, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5224, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8351895 KL Loss: 7.1496362 DSM Loss: 9.9494369 Overall Loss:18.9342627
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.0133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7651594 KL Loss: 7.1727717 DSM Loss: 9.7768481 Overall Loss:18.7147793
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.6787440180778503


Running on file REX.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.1420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8847275 KL Loss: 7.1987181 DSM Loss: 11.6126811 Overall Loss:20.6961269
Validation loss decreased (inf --> 1.519031).  Saving model ...
Updating learning rate to 0.0005
tensor(26.8243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5953, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8207385 KL Loss: 7.1894472 DSM Loss: 9.6335028 Overall Loss:18.6436885
Validation loss decreased (1.519031 --> 1.242680).  Saving model ...
Updating learning rate to 0.00025
tensor(22.2390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7479652 KL Loss: 7.1047031 DSM Loss: 9.6350340 Overall Loss:18.4877024
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(23.0858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8046569 KL Loss: 7.2165499 DSM Loss: 9.3531554 Overall Loss:18.3743621
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(16.5933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7453432 KL Loss: 7.0853659 DSM Loss: 9.1724373 Overall Loss:18.0031464
Validation loss decreased (1.242680 --> 1.231029).  Saving model ...
Updating learning rate to 3.125e-05
tensor(19.1391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0306, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7805549 KL Loss: 7.1917333 DSM Loss: 9.2764912 Overall Loss:18.2487795
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(13.6626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8198720 KL Loss: 7.2174365 DSM Loss: 8.9842714 Overall Loss:18.0215797
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(15.8940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7919393 KL Loss: 7.2298073 DSM Loss: 9.0877961 Overall Loss:18.1095427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.05281925201416
Use GPU: cuda:0
>>>>>>>start training : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(37.9399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9192314 KL Loss: 7.2100812 DSM Loss: 12.1560549 Overall Loss:21.2853675
Validation loss decreased (inf --> 1.256252).  Saving model ...
Updating learning rate to 0.0005
tensor(16.5196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8362304 KL Loss: 7.2020569 DSM Loss: 10.0317008 Overall Loss:19.0699882
Validation loss decreased (1.256252 --> 1.056740).  Saving model ...
Updating learning rate to 0.00025
tensor(19.5191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8243222 KL Loss: 7.2118421 DSM Loss: 9.6761660 Overall Loss:18.7123302
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.3046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.7733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7911714 KL Loss: 7.1559187 DSM Loss: 9.3621332 Overall Loss:18.3092232
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(13.7096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8324625 KL Loss: 7.2389107 DSM Loss: 9.1239982 Overall Loss:18.1953712
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.7561697959899902
Use GPU: cuda:0
>>>>>>>start training : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.7338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8163856 KL Loss: 7.2101403 DSM Loss: 12.1466886 Overall Loss:21.1732145
Validation loss decreased (inf --> 1.421503).  Saving model ...
Updating learning rate to 0.0005
tensor(18.2726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8236212 KL Loss: 7.2361481 DSM Loss: 9.8574165 Overall Loss:18.9171858
Validation loss decreased (1.421503 --> 1.381251).  Saving model ...
Updating learning rate to 0.00025
tensor(16.3208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8016487 KL Loss: 7.1904618 DSM Loss: 9.5271663 Overall Loss:18.5192770
Validation loss decreased (1.381251 --> 1.295959).  Saving model ...
Updating learning rate to 0.000125
tensor(12.1213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8032168 KL Loss: 7.1897531 DSM Loss: 9.3144671 Overall Loss:18.3074370
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.0300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7426, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7434090 KL Loss: 7.1244530 DSM Loss: 9.2920968 Overall Loss:18.1599587
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(12.6199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7467835 KL Loss: 7.1542363 DSM Loss: 9.2303911 Overall Loss:18.1314108
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.172950029373169
Use GPU: cuda:0
>>>>>>>start training : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8210409 KL Loss: 7.1702265 DSM Loss: 11.5748064 Overall Loss:20.5660738
Validation loss decreased (inf --> 1.300648).  Saving model ...
Updating learning rate to 0.0005
tensor(12.7913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8700251 KL Loss: 7.2460518 DSM Loss: 9.8933202 Overall Loss:19.0093971
Validation loss decreased (1.300648 --> 1.032517).  Saving model ...
Updating learning rate to 0.00025
tensor(16.1892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7938230 KL Loss: 7.1556226 DSM Loss: 9.5331556 Overall Loss:18.4826012
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.4429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7997851 KL Loss: 7.2148215 DSM Loss: 9.3322322 Overall Loss:18.3468386
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.1150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7395319 KL Loss: 7.1253968 DSM Loss: 9.1611816 Overall Loss:18.0261104
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.6050922870635986
Use GPU: cuda:0
>>>>>>>start training : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.1477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8807091 KL Loss: 7.3496839 DSM Loss: 11.1684569 Overall Loss:20.3988499
Validation loss decreased (inf --> 1.723159).  Saving model ...
Updating learning rate to 0.0005
tensor(23.6359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1522, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8254128 KL Loss: 7.1544501 DSM Loss: 9.9737400 Overall Loss:18.9536029
Validation loss decreased (1.723159 --> 1.297478).  Saving model ...
Updating learning rate to 0.00025
tensor(20.9819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.3086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8513099 KL Loss: 7.2259865 DSM Loss: 9.4596126 Overall Loss:18.5369089
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.1870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7762067 KL Loss: 7.2012084 DSM Loss: 9.3874175 Overall Loss:18.3648327
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.7056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1498, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7956538 KL Loss: 7.1641607 DSM Loss: 9.2673625 Overall Loss:18.2271772
Validation loss decreased (1.297478 --> 1.233948).  Saving model ...
Updating learning rate to 3.125e-05
tensor(17.1048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7584057 KL Loss: 7.2067270 DSM Loss: 9.1464757 Overall Loss:18.1116084
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(20.0837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.8135796 KL Loss: 7.2004306 DSM Loss: 9.1985984 Overall Loss:18.2126085
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(18.8858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7569485 KL Loss: 7.1851198 DSM Loss: 9.1602399 Overall Loss:18.1023081
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.0604746341705322


Running on file SLB.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.3809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8798080 KL Loss: 7.2940321 DSM Loss: 11.6389172 Overall Loss:20.8127573
Validation loss decreased (inf --> 0.570516).  Saving model ...
Updating learning rate to 0.0005
tensor(17.3668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8046522 KL Loss: 7.1758688 DSM Loss: 10.4291555 Overall Loss:19.4096766
Validation loss decreased (0.570516 --> 0.410699).  Saving model ...
Updating learning rate to 0.00025
tensor(18.3511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9851, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8156320 KL Loss: 7.1780639 DSM Loss: 9.9307120 Overall Loss:18.9244078
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(16.9786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7683613 KL Loss: 7.1431061 DSM Loss: 9.7411673 Overall Loss:18.6526347
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.0591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7769989 KL Loss: 7.1471710 DSM Loss: 9.6074769 Overall Loss:18.5316470
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.27931350469589233
Use GPU: cuda:0
>>>>>>>start training : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.3397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8621619 KL Loss: 7.2262948 DSM Loss: 11.7359164 Overall Loss:20.8243732
Validation loss decreased (inf --> 0.477228).  Saving model ...
Updating learning rate to 0.0005
tensor(18.3567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7812892 KL Loss: 7.1336268 DSM Loss: 10.4276997 Overall Loss:19.3426158
Validation loss decreased (0.477228 --> 0.419033).  Saving model ...
Updating learning rate to 0.00025
tensor(19.1984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3772, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7590636 KL Loss: 7.1100982 DSM Loss: 9.8627541 Overall Loss:18.7319157
Validation loss decreased (0.419033 --> 0.337871).  Saving model ...
Updating learning rate to 0.000125
tensor(19.2933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7623310 KL Loss: 7.1614346 DSM Loss: 9.6871718 Overall Loss:18.6109374
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(19.5744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6639, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7201310 KL Loss: 7.1031914 DSM Loss: 9.6650498 Overall Loss:18.4883721
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.3453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2029, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8083753 KL Loss: 7.1863836 DSM Loss: 9.6165674 Overall Loss:18.6113263
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.3525090515613556
Use GPU: cuda:0
>>>>>>>start training : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.7396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9347, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8490856 KL Loss: 7.1924836 DSM Loss: 12.2205086 Overall Loss:21.2620778
Validation loss decreased (inf --> 0.326439).  Saving model ...
Updating learning rate to 0.0005
tensor(15.5217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7366, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8044207 KL Loss: 7.1460942 DSM Loss: 10.3099307 Overall Loss:19.2604456
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.0114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8066118 KL Loss: 7.1614413 DSM Loss: 9.9507604 Overall Loss:18.9188135
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.5152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8181907 KL Loss: 7.2391329 DSM Loss: 9.7766318 Overall Loss:18.8339555
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.31340745091438293
Use GPU: cuda:0
>>>>>>>start training : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2374, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8616787 KL Loss: 7.2176747 DSM Loss: 11.8447989 Overall Loss:20.9241522
Validation loss decreased (inf --> 1.087036).  Saving model ...
Updating learning rate to 0.0005
tensor(22.3346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8310610 KL Loss: 7.1770692 DSM Loss: 10.1462253 Overall Loss:19.1543556
Validation loss decreased (1.087036 --> 0.306969).  Saving model ...
Updating learning rate to 0.00025
tensor(18.4649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9642, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7998218 KL Loss: 7.1908514 DSM Loss: 10.0965584 Overall Loss:19.0872316
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.5514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8239027 KL Loss: 7.2208393 DSM Loss: 9.7646513 Overall Loss:18.8093934
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.0008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8161546 KL Loss: 7.2016503 DSM Loss: 9.7232587 Overall Loss:18.7410637
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.4106515645980835
Use GPU: cuda:0
>>>>>>>start training : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.8078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8704336 KL Loss: 7.2173067 DSM Loss: 11.5334962 Overall Loss:20.6212366
Validation loss decreased (inf --> 0.438080).  Saving model ...
Updating learning rate to 0.0005
tensor(16.5624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6703, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7713840 KL Loss: 7.1411210 DSM Loss: 10.2618256 Overall Loss:19.1743305
Validation loss decreased (0.438080 --> 0.355118).  Saving model ...
Updating learning rate to 0.00025
tensor(18.0674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7913596 KL Loss: 7.1709141 DSM Loss: 9.9313816 Overall Loss:18.8936553
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.2601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7852387 KL Loss: 7.1991705 DSM Loss: 9.8256951 Overall Loss:18.8101043
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.9916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8361, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7856113 KL Loss: 7.2084016 DSM Loss: 9.5054023 Overall Loss:18.4994152
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.283785343170166


Running on file SNY.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.7964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8783008 KL Loss: 7.2343443 DSM Loss: 11.6565439 Overall Loss:20.7691889
Validation loss decreased (inf --> 3.035399).  Saving model ...
Updating learning rate to 0.0005
tensor(16.0527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9710, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8362431 KL Loss: 7.2036570 DSM Loss: 10.0566242 Overall Loss:19.0965244
Validation loss decreased (3.035399 --> 2.872096).  Saving model ...
Updating learning rate to 0.00025
tensor(18.4429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7883397 KL Loss: 7.1251888 DSM Loss: 9.7323023 Overall Loss:18.6458309
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.7706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8183518 KL Loss: 7.2154915 DSM Loss: 9.5769573 Overall Loss:18.6108006
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.7869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8225247 KL Loss: 7.2488018 DSM Loss: 9.4822572 Overall Loss:18.5535837
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.8722176551818848
Use GPU: cuda:0
>>>>>>>start training : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.7937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8642928 KL Loss: 7.2108968 DSM Loss: 11.1267186 Overall Loss:20.2019082
Validation loss decreased (inf --> 3.294965).  Saving model ...
Updating learning rate to 0.0005
tensor(22.2967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0252, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8176486 KL Loss: 7.1431251 DSM Loss: 9.9989728 Overall Loss:18.9597464
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.7566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8030050 KL Loss: 7.1468893 DSM Loss: 9.7720772 Overall Loss:18.7219715
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.6128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8251495 KL Loss: 7.2140461 DSM Loss: 9.4775867 Overall Loss:18.5167823
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.300248146057129
Use GPU: cuda:0
>>>>>>>start training : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.0212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9024858 KL Loss: 7.2252928 DSM Loss: 11.2849414 Overall Loss:20.4127199
Validation loss decreased (inf --> 4.173479).  Saving model ...
Updating learning rate to 0.0005
tensor(15.5911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8439888 KL Loss: 7.1727913 DSM Loss: 10.2752343 Overall Loss:19.2920144
Validation loss decreased (4.173479 --> 3.724430).  Saving model ...
Updating learning rate to 0.00025
tensor(21.3201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8529343 KL Loss: 7.1922276 DSM Loss: 9.7949720 Overall Loss:18.8401338
Validation loss decreased (3.724430 --> 3.433294).  Saving model ...
Updating learning rate to 0.000125
tensor(17.3886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7557647 KL Loss: 7.1387435 DSM Loss: 9.5687508 Overall Loss:18.4632589
Validation loss decreased (3.433294 --> 3.339871).  Saving model ...
Updating learning rate to 6.25e-05
tensor(18.1888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8010515 KL Loss: 7.2006127 DSM Loss: 9.4904896 Overall Loss:18.4921537
Validation loss decreased (3.339871 --> 3.120966).  Saving model ...
Updating learning rate to 3.125e-05
tensor(22.7085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6332, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7554154 KL Loss: 7.1397234 DSM Loss: 9.2704625 Overall Loss:18.1656013
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(18.4992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3125, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7618783 KL Loss: 7.1781793 DSM Loss: 9.2989719 Overall Loss:18.2390294
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(17.3275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0688, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7685195 KL Loss: 7.2008651 DSM Loss: 9.3323279 Overall Loss:18.3017126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.137612342834473
Use GPU: cuda:0
>>>>>>>start training : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.3237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9309410 KL Loss: 7.3424750 DSM Loss: 12.0275353 Overall Loss:21.3009514
Validation loss decreased (inf --> 2.704617).  Saving model ...
Updating learning rate to 0.0005
tensor(15.6013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8241703 KL Loss: 7.1535954 DSM Loss: 9.8555124 Overall Loss:18.8332780
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.7994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7611343 KL Loss: 7.1820992 DSM Loss: 9.8044893 Overall Loss:18.7477227
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.6379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8223783 KL Loss: 7.1501343 DSM Loss: 9.4528398 Overall Loss:18.4253525
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.688833713531494
Use GPU: cuda:0
>>>>>>>start training : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.2967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8527973 KL Loss: 7.2413462 DSM Loss: 11.4634834 Overall Loss:20.5576269
Validation loss decreased (inf --> 4.010194).  Saving model ...
Updating learning rate to 0.0005
tensor(19.5538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8239309 KL Loss: 7.1443521 DSM Loss: 10.2645532 Overall Loss:19.2328362
Validation loss decreased (4.010194 --> 3.501726).  Saving model ...
Updating learning rate to 0.00025
tensor(16.9098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7672868 KL Loss: 7.1224869 DSM Loss: 9.6648109 Overall Loss:18.5545847
Validation loss decreased (3.501726 --> 3.346585).  Saving model ...
Updating learning rate to 0.000125
tensor(21.6547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8046979 KL Loss: 7.1730765 DSM Loss: 9.5910078 Overall Loss:18.5687823
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(15.8505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8135725 KL Loss: 7.2129737 DSM Loss: 9.4361671 Overall Loss:18.4627132
Validation loss decreased (3.346585 --> 3.240306).  Saving model ...
Updating learning rate to 3.125e-05
tensor(19.6219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8241895 KL Loss: 7.2172053 DSM Loss: 9.3480775 Overall Loss:18.3894723
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(21.6601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3646, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7869988 KL Loss: 7.1819819 DSM Loss: 9.2927319 Overall Loss:18.2617126
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(19.4836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2098, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7288619 KL Loss: 7.1119032 DSM Loss: 9.4056887 Overall Loss:18.2464538
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.254175186157227


Running on file SO.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.4458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8021157 KL Loss: 7.1888246 DSM Loss: 12.3915885 Overall Loss:21.3825288
Validation loss decreased (inf --> 5.727425).  Saving model ...
Updating learning rate to 0.0005
tensor(16.4573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7836243 KL Loss: 7.1147964 DSM Loss: 10.1432434 Overall Loss:19.0416640
Validation loss decreased (5.727425 --> 5.646362).  Saving model ...
Updating learning rate to 0.00025
tensor(18.2529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7779, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7898835 KL Loss: 7.1264737 DSM Loss: 9.6780701 Overall Loss:18.5944273
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.7071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8184741 KL Loss: 7.1384999 DSM Loss: 9.4799147 Overall Loss:18.4368887
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(24.3074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7600000 KL Loss: 7.0865955 DSM Loss: 9.4532432 Overall Loss:18.2998387
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.380285263061523
Use GPU: cuda:0
>>>>>>>start training : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.0523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8966767 KL Loss: 7.1994310 DSM Loss: 11.9734040 Overall Loss:21.0695118
Validation loss decreased (inf --> 4.559626).  Saving model ...
Updating learning rate to 0.0005
tensor(18.8142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8427739 KL Loss: 7.0868673 DSM Loss: 10.1477781 Overall Loss:19.0774193
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.9091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7666636 KL Loss: 7.1197158 DSM Loss: 9.6342276 Overall Loss:18.5206071
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(21.1287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7671156 KL Loss: 7.1169273 DSM Loss: 9.4930967 Overall Loss:18.3771397
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:8.019937515258789
Use GPU: cuda:0
>>>>>>>start training : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.9847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9247911 KL Loss: 7.2501362 DSM Loss: 11.7710573 Overall Loss:20.9459848
Validation loss decreased (inf --> 5.493924).  Saving model ...
Updating learning rate to 0.0005
tensor(18.8573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.0761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4361, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7998592 KL Loss: 7.1558496 DSM Loss: 9.9654309 Overall Loss:18.9211397
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.7465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7740390 KL Loss: 7.1566372 DSM Loss: 9.5492059 Overall Loss:18.4798820
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.7032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7831274 KL Loss: 7.1068230 DSM Loss: 9.4565986 Overall Loss:18.3465490
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.221571922302246
Use GPU: cuda:0
>>>>>>>start training : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.7739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6006, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7967814 KL Loss: 7.1871542 DSM Loss: 11.6572828 Overall Loss:20.6412183
Validation loss decreased (inf --> 5.326385).  Saving model ...
Updating learning rate to 0.0005
tensor(18.5238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8186775 KL Loss: 7.1918418 DSM Loss: 10.0173372 Overall Loss:19.0278565
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(13.8483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8211735 KL Loss: 7.1921477 DSM Loss: 9.6614888 Overall Loss:18.6748099
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.8991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8160676 KL Loss: 7.1682394 DSM Loss: 9.5409068 Overall Loss:18.5252140
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.041781425476074
Use GPU: cuda:0
>>>>>>>start training : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.4123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8916855 KL Loss: 7.1905297 DSM Loss: 12.2200250 Overall Loss:21.3022403
Validation loss decreased (inf --> 6.303043).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8125282 KL Loss: 7.1446967 DSM Loss: 10.1113146 Overall Loss:19.0685394
Validation loss decreased (6.303043 --> 5.956014).  Saving model ...
Updating learning rate to 0.00025
tensor(17.2759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7891142 KL Loss: 7.1685518 DSM Loss: 9.7594356 Overall Loss:18.7171015
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.3793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8142595 KL Loss: 7.1842271 DSM Loss: 9.5344459 Overall Loss:18.5329324
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.0616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8731, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7649648 KL Loss: 7.1549626 DSM Loss: 9.3804437 Overall Loss:18.3003710
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:9.786113739013672


Running on file SPLP.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.1676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.0485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8109658 KL Loss: 7.1623649 DSM Loss: 11.6677234 Overall Loss:20.6410540
Validation loss decreased (inf --> 19.586472).  Saving model ...
Updating learning rate to 0.0005
tensor(25.3139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8096897 KL Loss: 7.0817702 DSM Loss: 10.0018636 Overall Loss:18.8933233
Validation loss decreased (19.586472 --> 19.545490).  Saving model ...
Updating learning rate to 0.00025
tensor(23.4483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8066710 KL Loss: 7.2163161 DSM Loss: 9.5970012 Overall Loss:18.6199883
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.7648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8291919 KL Loss: 7.2260517 DSM Loss: 9.2309194 Overall Loss:18.2861630
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(12.8743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7525357 KL Loss: 7.1643888 DSM Loss: 9.3120156 Overall Loss:18.2289400
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:31.768701553344727
Use GPU: cuda:0
>>>>>>>start training : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.5794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8717835 KL Loss: 7.1897278 DSM Loss: 12.3625528 Overall Loss:21.4240639
Validation loss decreased (inf --> 19.886835).  Saving model ...
Updating learning rate to 0.0005
tensor(14.4341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8524370 KL Loss: 7.2208124 DSM Loss: 10.3027310 Overall Loss:19.3759804
Validation loss decreased (19.886835 --> 19.851642).  Saving model ...
Updating learning rate to 0.00025
tensor(15.1609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8128746 KL Loss: 7.2196038 DSM Loss: 9.6690971 Overall Loss:18.7015757
Validation loss decreased (19.851642 --> 19.664865).  Saving model ...
Updating learning rate to 0.000125
tensor(23.6415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8249724 KL Loss: 7.2828386 DSM Loss: 9.3951629 Overall Loss:18.5029739
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(14.3039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7931788 KL Loss: 7.1792718 DSM Loss: 9.2619633 Overall Loss:18.2344139
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.4082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7227867 KL Loss: 7.1385324 DSM Loss: 9.2511700 Overall Loss:18.1124891
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:32.0706901550293
Use GPU: cuda:0
>>>>>>>start training : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.2901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8747357 KL Loss: 7.2125051 DSM Loss: 12.1795832 Overall Loss:21.2668240
Validation loss decreased (inf --> 19.748343).  Saving model ...
Updating learning rate to 0.0005
tensor(24.2547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7935444 KL Loss: 7.0951367 DSM Loss: 10.2652830 Overall Loss:19.1539641
Validation loss decreased (19.748343 --> 18.223377).  Saving model ...
Updating learning rate to 0.00025
tensor(18.3972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7864615 KL Loss: 7.1495858 DSM Loss: 9.1762286 Overall Loss:18.1122758
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.6149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.8322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3857, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7566072 KL Loss: 7.1278683 DSM Loss: 9.5298300 Overall Loss:18.4143057
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.5583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7962169 KL Loss: 7.1481339 DSM Loss: 9.3748047 Overall Loss:18.3191555
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:30.378955841064453
Use GPU: cuda:0
>>>>>>>start training : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.7933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7888550 KL Loss: 7.1230804 DSM Loss: 12.6157895 Overall Loss:21.5277248
Validation loss decreased (inf --> 18.738339).  Saving model ...
Updating learning rate to 0.0005
tensor(17.8617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8084453 KL Loss: 7.1158925 DSM Loss: 10.0771618 Overall Loss:19.0014995
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(25.2529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7948532 KL Loss: 7.1533200 DSM Loss: 9.8230446 Overall Loss:18.7712177
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(11.0550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7888036 KL Loss: 7.1461509 DSM Loss: 9.4515031 Overall Loss:18.3864577
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:30.882787704467773
Use GPU: cuda:0
>>>>>>>start training : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.1131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9147584 KL Loss: 7.2504072 DSM Loss: 13.2767468 Overall Loss:22.4419122
Validation loss decreased (inf --> 19.469693).  Saving model ...
Updating learning rate to 0.0005
tensor(22.3894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7947435 KL Loss: 7.1641472 DSM Loss: 10.1230282 Overall Loss:19.0819188
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.6965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.1203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8260966 KL Loss: 7.1168632 DSM Loss: 9.6355009 Overall Loss:18.5784607
Validation loss decreased (19.469693 --> 19.142189).  Saving model ...
Updating learning rate to 0.000125
tensor(28.4111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8030456 KL Loss: 7.1886601 DSM Loss: 9.3195060 Overall Loss:18.3112117
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(13.8505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8076423 KL Loss: 7.1584710 DSM Loss: 9.2673060 Overall Loss:18.2334192
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(13.9400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7745665 KL Loss: 7.1638533 DSM Loss: 9.2029155 Overall Loss:18.1413354
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:31.288822174072266


Running on file SRE.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.9310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1562, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8945199 KL Loss: 7.1794056 DSM Loss: 12.0536253 Overall Loss:21.1275507
Validation loss decreased (inf --> 3.768863).  Saving model ...
Updating learning rate to 0.0005
tensor(16.6760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8791796 KL Loss: 7.1586050 DSM Loss: 9.6917399 Overall Loss:18.7295244
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.0073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8239799 KL Loss: 7.2067356 DSM Loss: 9.5447745 Overall Loss:18.5754900
Validation loss decreased (3.768863 --> 3.744079).  Saving model ...
Updating learning rate to 0.000125
tensor(15.9907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8200376 KL Loss: 7.2051372 DSM Loss: 9.4047675 Overall Loss:18.4299422
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(23.1486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1320, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7752645 KL Loss: 7.1840040 DSM Loss: 9.2248120 Overall Loss:18.1840803
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(17.9202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8310, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7477466 KL Loss: 7.1551467 DSM Loss: 9.2261747 Overall Loss:18.1290681
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:7.508701801300049
Use GPU: cuda:0
>>>>>>>start training : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.1203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8777369 KL Loss: 7.1951756 DSM Loss: 13.5397059 Overall Loss:22.6126183
Validation loss decreased (inf --> 3.451955).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8388700 KL Loss: 7.1789512 DSM Loss: 10.0474432 Overall Loss:19.0652643
Validation loss decreased (3.451955 --> 2.923225).  Saving model ...
Updating learning rate to 0.00025
tensor(20.6720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8014674 KL Loss: 7.1601489 DSM Loss: 9.5504698 Overall Loss:18.5120861
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(12.8785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7624694 KL Loss: 7.1459890 DSM Loss: 9.4153495 Overall Loss:18.3238078
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.3206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5769, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7747285 KL Loss: 7.2015752 DSM Loss: 9.2642851 Overall Loss:18.2405888
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.053967475891113
Use GPU: cuda:0
>>>>>>>start training : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.5724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2738, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8963742 KL Loss: 7.2583328 DSM Loss: 12.0868927 Overall Loss:21.2415997
Validation loss decreased (inf --> 3.309647).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8400149 KL Loss: 7.1844099 DSM Loss: 10.0096840 Overall Loss:19.0341088
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.1990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8287484 KL Loss: 7.1718632 DSM Loss: 9.5864028 Overall Loss:18.5870143
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.9172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7639608 KL Loss: 7.1597580 DSM Loss: 9.2130298 Overall Loss:18.1367485
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.749835014343262
Use GPU: cuda:0
>>>>>>>start training : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.6864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1417, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8566664 KL Loss: 7.2117022 DSM Loss: 13.0378087 Overall Loss:22.1061773
Validation loss decreased (inf --> 3.420387).  Saving model ...
Updating learning rate to 0.0005
tensor(18.4472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8299690 KL Loss: 7.1729401 DSM Loss: 10.1259707 Overall Loss:19.1288797
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.0284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8071211 KL Loss: 7.1774140 DSM Loss: 9.6030636 Overall Loss:18.5875987
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(22.7469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7350665 KL Loss: 7.0631882 DSM Loss: 9.4331523 Overall Loss:18.2314071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.945143699645996
Use GPU: cuda:0
>>>>>>>start training : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.9398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9268241 KL Loss: 7.2433299 DSM Loss: 11.2483317 Overall Loss:20.4184858
Validation loss decreased (inf --> 4.361903).  Saving model ...
Updating learning rate to 0.0005
tensor(19.6327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8000161 KL Loss: 7.0994770 DSM Loss: 9.9146287 Overall Loss:18.8141218
Validation loss decreased (4.361903 --> 3.385168).  Saving model ...
Updating learning rate to 0.00025
tensor(21.5133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1952, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7740058 KL Loss: 7.1280943 DSM Loss: 9.4447978 Overall Loss:18.3468978
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(22.4355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7632982 KL Loss: 7.1531089 DSM Loss: 9.4547847 Overall Loss:18.3711919
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.6325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7755511 KL Loss: 7.1297750 DSM Loss: 9.3305968 Overall Loss:18.2359228
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:6.90785026550293


Running on file T.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.8554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8026288 KL Loss: 7.1428979 DSM Loss: 11.2406940 Overall Loss:20.1862208
Validation loss decreased (inf --> 0.571388).  Saving model ...
Updating learning rate to 0.0005
tensor(18.5444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7735788 KL Loss: 7.1812409 DSM Loss: 9.9564893 Overall Loss:18.9113090
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.5518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7873899 KL Loss: 7.1445882 DSM Loss: 9.7127325 Overall Loss:18.6447105
Validation loss decreased (0.571388 --> 0.528708).  Saving model ...
Updating learning rate to 0.000125
tensor(15.7984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4135, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8007753 KL Loss: 7.2352891 DSM Loss: 9.3007584 Overall Loss:18.3368229
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(27.7852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7875336 KL Loss: 7.1591452 DSM Loss: 9.1777640 Overall Loss:18.1244428
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(16.6070, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7774398 KL Loss: 7.1160841 DSM Loss: 9.2712160 Overall Loss:18.1647398
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.5545986890792847
Use GPU: cuda:0
>>>>>>>start training : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.1111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8131023 KL Loss: 7.2185161 DSM Loss: 12.1013333 Overall Loss:21.1329517
Validation loss decreased (inf --> 0.420765).  Saving model ...
Updating learning rate to 0.0005
tensor(17.9200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8207949 KL Loss: 7.2035685 DSM Loss: 9.7447095 Overall Loss:18.7690728
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.6876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8001885 KL Loss: 7.1554089 DSM Loss: 9.8822722 Overall Loss:18.8378694
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.1660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7514722 KL Loss: 7.1675969 DSM Loss: 9.4117097 Overall Loss:18.3307788
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.377436876296997
Use GPU: cuda:0
>>>>>>>start training : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8135702 KL Loss: 7.1815228 DSM Loss: 11.5558384 Overall Loss:20.5509314
Validation loss decreased (inf --> 0.693103).  Saving model ...
Updating learning rate to 0.0005
tensor(22.9692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9846, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8434382 KL Loss: 7.1732272 DSM Loss: 9.9250433 Overall Loss:18.9417086
Validation loss decreased (0.693103 --> 0.507564).  Saving model ...
Updating learning rate to 0.00025
tensor(16.3376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8297154 KL Loss: 7.2123567 DSM Loss: 9.5930682 Overall Loss:18.6351403
Validation loss decreased (0.507564 --> 0.489290).  Saving model ...
Updating learning rate to 0.000125
tensor(20.0837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5125, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8428788 KL Loss: 7.1799412 DSM Loss: 9.3342887 Overall Loss:18.3571087
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(18.3041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7781640 KL Loss: 7.1471013 DSM Loss: 9.3334453 Overall Loss:18.2587107
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(20.6283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7711528 KL Loss: 7.1750103 DSM Loss: 9.3399164 Overall Loss:18.2860794
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.4858853816986084
Use GPU: cuda:0
>>>>>>>start training : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.0951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7669288 KL Loss: 7.1697247 DSM Loss: 11.5956000 Overall Loss:20.5322533
Validation loss decreased (inf --> 0.367383).  Saving model ...
Updating learning rate to 0.0005
tensor(19.1539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8209596 KL Loss: 7.1839159 DSM Loss: 10.0313053 Overall Loss:19.0361808
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.9296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7896870 KL Loss: 7.1451100 DSM Loss: 9.4263489 Overall Loss:18.3611459
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.6962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7871110 KL Loss: 7.1196577 DSM Loss: 9.3909945 Overall Loss:18.2977632
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.189598560333252
Use GPU: cuda:0
>>>>>>>start training : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(35.1965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7867194 KL Loss: 7.1819208 DSM Loss: 11.1870975 Overall Loss:20.1557376
Validation loss decreased (inf --> 0.717187).  Saving model ...
Updating learning rate to 0.0005
tensor(24.8381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8021816 KL Loss: 7.1836808 DSM Loss: 9.8471439 Overall Loss:18.8330061
Validation loss decreased (0.717187 --> 0.466300).  Saving model ...
Updating learning rate to 0.00025
tensor(18.8564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7780303 KL Loss: 7.1619546 DSM Loss: 9.4914641 Overall Loss:18.4314490
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(12.1400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5937, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7965951 KL Loss: 7.1625132 DSM Loss: 9.1776246 Overall Loss:18.1367328
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.4292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8045549 KL Loss: 7.2131053 DSM Loss: 9.2820531 Overall Loss:18.2997132
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.449346899986267


Running on file TM.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.6306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8205484 KL Loss: 7.2070734 DSM Loss: 11.0728470 Overall Loss:20.1004688
Validation loss decreased (inf --> 11.236447).  Saving model ...
Updating learning rate to 0.0005
tensor(18.1732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8258299 KL Loss: 7.1411620 DSM Loss: 10.1222418 Overall Loss:19.0892336
Validation loss decreased (11.236447 --> 10.527279).  Saving model ...
Updating learning rate to 0.00025
tensor(16.5149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7916220 KL Loss: 7.1957685 DSM Loss: 9.6555899 Overall Loss:18.6429803
Validation loss decreased (10.527279 --> 10.412994).  Saving model ...
Updating learning rate to 0.000125
tensor(18.7756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7966350 KL Loss: 7.1370085 DSM Loss: 9.3222104 Overall Loss:18.2558540
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(14.9255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8905, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8048891 KL Loss: 7.2114707 DSM Loss: 9.0922671 Overall Loss:18.1086269
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(21.6551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7543339 KL Loss: 7.1453533 DSM Loss: 9.4155179 Overall Loss:18.3152051
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.6105799674987793
Use GPU: cuda:0
>>>>>>>start training : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(21.5560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5728, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8266503 KL Loss: 7.2396035 DSM Loss: 12.3372070 Overall Loss:21.4034608
Validation loss decreased (inf --> 10.577197).  Saving model ...
Updating learning rate to 0.0005
tensor(26.6180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6861, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7881335 KL Loss: 7.1386574 DSM Loss: 10.2481465 Overall Loss:19.1749374
Validation loss decreased (10.577197 --> 9.969759).  Saving model ...
Updating learning rate to 0.00025
tensor(12.8173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7641594 KL Loss: 7.1760717 DSM Loss: 9.6922241 Overall Loss:18.6324551
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(22.4346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7411849 KL Loss: 7.1219515 DSM Loss: 9.5238128 Overall Loss:18.3869492
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.7182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7323537 KL Loss: 7.1104270 DSM Loss: 9.1832438 Overall Loss:18.0260244
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.3590033054351807
Use GPU: cuda:0
>>>>>>>start training : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.5846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8861800 KL Loss: 7.2912720 DSM Loss: 12.2693855 Overall Loss:21.4468374
Validation loss decreased (inf --> 10.072912).  Saving model ...
Updating learning rate to 0.0005
tensor(14.8996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7764016 KL Loss: 7.1111672 DSM Loss: 10.0351576 Overall Loss:18.9227265
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.8327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8193797 KL Loss: 7.2182775 DSM Loss: 9.4309666 Overall Loss:18.4686237
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(37.2146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7975747 KL Loss: 7.1613883 DSM Loss: 9.5751938 Overall Loss:18.5341568
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.444275140762329
Use GPU: cuda:0
>>>>>>>start training : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.4663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9094974 KL Loss: 7.1867517 DSM Loss: 11.4780260 Overall Loss:20.5742751
Validation loss decreased (inf --> 10.649348).  Saving model ...
Updating learning rate to 0.0005
tensor(13.7000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8280848 KL Loss: 7.2264007 DSM Loss: 9.6416128 Overall Loss:18.6960983
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(14.1318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8126566 KL Loss: 7.1174620 DSM Loss: 9.5754201 Overall Loss:18.5055388
Validation loss decreased (10.649348 --> 10.421767).  Saving model ...
Updating learning rate to 0.000125
tensor(20.6466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7892402 KL Loss: 7.1705669 DSM Loss: 9.5122598 Overall Loss:18.4720671
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(12.5554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7230826 KL Loss: 7.0565908 DSM Loss: 9.3823975 Overall Loss:18.1620709
Validation loss decreased (10.421767 --> 9.972928).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.6839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7275597 KL Loss: 7.1458945 DSM Loss: 9.2110066 Overall Loss:18.0844607
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(19.1771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7733656 KL Loss: 7.2012606 DSM Loss: 9.0471484 Overall Loss:18.0217746
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(21.8709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.2034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7633976 KL Loss: 7.0735348 DSM Loss: 9.2696229 Overall Loss:18.1065553
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.439490556716919
Use GPU: cuda:0
>>>>>>>start training : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.4960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8771955 KL Loss: 7.2446341 DSM Loss: 11.1579705 Overall Loss:20.2798002
Validation loss decreased (inf --> 10.191757).  Saving model ...
Updating learning rate to 0.0005
tensor(14.1163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8337314 KL Loss: 7.1509171 DSM Loss: 9.8316493 Overall Loss:18.8162978
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.1309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8374900 KL Loss: 7.2194275 DSM Loss: 9.5848482 Overall Loss:18.6417656
Validation loss decreased (10.191757 --> 10.087677).  Saving model ...
Updating learning rate to 0.000125
tensor(20.1315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.4623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7796965 KL Loss: 7.1697412 DSM Loss: 9.5435953 Overall Loss:18.4930330
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.7696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7368, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7631309 KL Loss: 7.1695819 DSM Loss: 9.1268524 Overall Loss:18.0595650
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(18.1682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.3778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7577369 KL Loss: 7.0993414 DSM Loss: 9.2674605 Overall Loss:18.1245388
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.4296228885650635


Running on file TSM.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.9344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2368, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8875594 KL Loss: 7.2547482 DSM Loss: 14.2668766 Overall Loss:23.4091840
Validation loss decreased (inf --> 4.690774).  Saving model ...
Updating learning rate to 0.0005
tensor(19.8644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8854729 KL Loss: 7.2006515 DSM Loss: 10.1218124 Overall Loss:19.2079367
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(11.0974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8133630 KL Loss: 7.1338378 DSM Loss: 10.0963770 Overall Loss:19.0435778
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.1413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7378, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7701671 KL Loss: 7.1070151 DSM Loss: 9.4824733 Overall Loss:18.3596554
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.9075465202331543
Use GPU: cuda:0
>>>>>>>start training : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(23.0831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8285417 KL Loss: 7.1681917 DSM Loss: 13.1462119 Overall Loss:22.1429453
Validation loss decreased (inf --> 3.895081).  Saving model ...
Updating learning rate to 0.0005
tensor(21.4644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7980435 KL Loss: 7.1645103 DSM Loss: 10.1735215 Overall Loss:19.1360754
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(12.1485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.2080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7530201 KL Loss: 7.1718463 DSM Loss: 9.7841537 Overall Loss:18.7090200
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.8078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8128340 KL Loss: 7.1734610 DSM Loss: 9.5150403 Overall Loss:18.5013353
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.4101064205169678
Use GPU: cuda:0
>>>>>>>start training : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(34.0919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.7548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.5748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8450870 KL Loss: 7.2423248 DSM Loss: 11.5966022 Overall Loss:20.6840140
Validation loss decreased (inf --> 5.039491).  Saving model ...
Updating learning rate to 0.0005
tensor(24.8723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9366, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7813407 KL Loss: 7.1281110 DSM Loss: 9.8885505 Overall Loss:18.7980021
Validation loss decreased (5.039491 --> 4.182616).  Saving model ...
Updating learning rate to 0.00025
tensor(15.3550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2808, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7969308 KL Loss: 7.1486811 DSM Loss: 9.7840668 Overall Loss:18.7296787
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(13.5612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(9.9296, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7648542 KL Loss: 7.1354716 DSM Loss: 9.7028635 Overall Loss:18.6031893
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(29.4715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7813160 KL Loss: 7.1645071 DSM Loss: 9.2785120 Overall Loss:18.2243351
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.6213653087615967
Use GPU: cuda:0
>>>>>>>start training : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.8434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7953193 KL Loss: 7.1414563 DSM Loss: 12.6235490 Overall Loss:21.5603245
Validation loss decreased (inf --> 5.086975).  Saving model ...
Updating learning rate to 0.0005
tensor(22.6613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.3701, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8032169 KL Loss: 7.0941997 DSM Loss: 10.2583979 Overall Loss:19.1558144
Validation loss decreased (5.086975 --> 4.175879).  Saving model ...
Updating learning rate to 0.00025
tensor(16.1405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8331891 KL Loss: 7.1460250 DSM Loss: 9.6330601 Overall Loss:18.6122742
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(15.8550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7315044 KL Loss: 7.0901198 DSM Loss: 9.5326320 Overall Loss:18.3542563
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(29.6025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.9798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7146230 KL Loss: 7.0531708 DSM Loss: 9.6291098 Overall Loss:18.3969036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.5888248682022095
Use GPU: cuda:0
>>>>>>>start training : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.6647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.0265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8447943 KL Loss: 7.2532789 DSM Loss: 13.1311396 Overall Loss:22.2292129
Validation loss decreased (inf --> 6.198449).  Saving model ...
Updating learning rate to 0.0005
tensor(23.1554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3793, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8468863 KL Loss: 7.1360031 DSM Loss: 10.1019796 Overall Loss:19.0848692
Validation loss decreased (6.198449 --> 4.698621).  Saving model ...
Updating learning rate to 0.00025
tensor(22.1901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6922, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7861959 KL Loss: 7.1162826 DSM Loss: 9.7783646 Overall Loss:18.6808431
Validation loss decreased (4.698621 --> 4.627824).  Saving model ...
Updating learning rate to 0.000125
tensor(18.9019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.7425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7944530 KL Loss: 7.0968646 DSM Loss: 9.5058272 Overall Loss:18.3971448
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.9015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.7398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3474, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7269403 KL Loss: 7.0702999 DSM Loss: 9.4435729 Overall Loss:18.2408131
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(16.0722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7569535 KL Loss: 7.1299991 DSM Loss: 9.4022981 Overall Loss:18.2892507
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.936503529548645


Running on file UL.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.5439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8686826 KL Loss: 7.2298395 DSM Loss: 13.1234822 Overall Loss:22.2220044
Validation loss decreased (inf --> 0.668657).  Saving model ...
Updating learning rate to 0.0005
tensor(24.3871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7668624 KL Loss: 7.1399568 DSM Loss: 10.1544756 Overall Loss:19.0612948
Validation loss decreased (0.668657 --> 0.167000).  Saving model ...
Updating learning rate to 0.00025
tensor(20.4139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.4166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7539798 KL Loss: 7.0878046 DSM Loss: 9.5347304 Overall Loss:18.3765148
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.1274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6749, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7923911 KL Loss: 7.1470035 DSM Loss: 9.3646435 Overall Loss:18.3040380
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(15.9461, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7352857 KL Loss: 7.1345042 DSM Loss: 9.1175032 Overall Loss:17.9872929
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1701529622077942
Use GPU: cuda:0
>>>>>>>start training : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.5906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7968799 KL Loss: 7.1578646 DSM Loss: 13.0819152 Overall Loss:22.0366597
Validation loss decreased (inf --> 0.290450).  Saving model ...
Updating learning rate to 0.0005
tensor(16.2531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7970480 KL Loss: 7.1697215 DSM Loss: 9.9360582 Overall Loss:18.9028278
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.0534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7788559 KL Loss: 7.1190898 DSM Loss: 9.4835076 Overall Loss:18.3814533
Validation loss decreased (0.290450 --> 0.289267).  Saving model ...
Updating learning rate to 0.000125
tensor(19.3382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7601144 KL Loss: 7.1572275 DSM Loss: 9.3577404 Overall Loss:18.2750823
Validation loss decreased (0.289267 --> 0.280671).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.0450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2777, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7556926 KL Loss: 7.1553373 DSM Loss: 9.3431926 Overall Loss:18.2542224
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(20.7732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7888877 KL Loss: 7.2079872 DSM Loss: 9.2532246 Overall Loss:18.2500994
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(20.6633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7678946 KL Loss: 7.1622680 DSM Loss: 9.1010230 Overall Loss:18.0311856
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.31830140948295593
Use GPU: cuda:0
>>>>>>>start training : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.1653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8173781 KL Loss: 7.1978593 DSM Loss: 11.3860222 Overall Loss:20.4012596
Validation loss decreased (inf --> 0.260863).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8598832 KL Loss: 7.2136836 DSM Loss: 9.6494325 Overall Loss:18.7229995
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.9290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8089548 KL Loss: 7.1779590 DSM Loss: 9.5037571 Overall Loss:18.4906710
Validation loss decreased (0.260863 --> 0.246042).  Saving model ...
Updating learning rate to 0.000125
tensor(13.4985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3082, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7876995 KL Loss: 7.1810713 DSM Loss: 9.3113829 Overall Loss:18.2801536
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(17.6294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7470456 KL Loss: 7.1248280 DSM Loss: 9.3417516 Overall Loss:18.2136251
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(22.5564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7339, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7601776 KL Loss: 7.1627940 DSM Loss: 9.2355141 Overall Loss:18.1584856
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.26888594031333923
Use GPU: cuda:0
>>>>>>>start training : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.4727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4088, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8342775 KL Loss: 7.1889770 DSM Loss: 11.0300501 Overall Loss:20.0533045
Validation loss decreased (inf --> 0.350109).  Saving model ...
Updating learning rate to 0.0005
tensor(18.4993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8097042 KL Loss: 7.1802308 DSM Loss: 9.9314409 Overall Loss:18.9213758
Validation loss decreased (0.350109 --> 0.246054).  Saving model ...
Updating learning rate to 0.00025
tensor(15.4920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8830, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7524138 KL Loss: 7.1155989 DSM Loss: 9.2516817 Overall Loss:18.1196943
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(20.2392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7393225 KL Loss: 7.1250794 DSM Loss: 9.1183004 Overall Loss:17.9827023
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.1559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3309, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7663252 KL Loss: 7.1749184 DSM Loss: 9.3084557 Overall Loss:18.2496992
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.26955217123031616
Use GPU: cuda:0
>>>>>>>start training : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.6811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8163958 KL Loss: 7.1651280 DSM Loss: 11.1176233 Overall Loss:20.0991471
Validation loss decreased (inf --> 0.350897).  Saving model ...
Updating learning rate to 0.0005
tensor(18.4993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7753294 KL Loss: 7.1386347 DSM Loss: 9.9186411 Overall Loss:18.8326051
Validation loss decreased (0.350897 --> 0.250692).  Saving model ...
Updating learning rate to 0.00025
tensor(24.2813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7644234 KL Loss: 7.1461309 DSM Loss: 9.4788398 Overall Loss:18.3893940
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(17.4223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7623169 KL Loss: 7.1631315 DSM Loss: 9.5125313 Overall Loss:18.4379798
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.2622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8114556 KL Loss: 7.1680608 DSM Loss: 9.3747042 Overall Loss:18.3542205
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.28246551752090454


Running on file UNH.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.8554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8019413 KL Loss: 7.1773198 DSM Loss: 11.9253395 Overall Loss:20.9046007
Validation loss decreased (inf --> 10.365673).  Saving model ...
Updating learning rate to 0.0005
tensor(13.9146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8254424 KL Loss: 7.1890112 DSM Loss: 10.0083238 Overall Loss:19.0227774
Validation loss decreased (10.365673 --> 9.443701).  Saving model ...
Updating learning rate to 0.00025
tensor(23.6237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8248484 KL Loss: 7.1858708 DSM Loss: 9.6398892 Overall Loss:18.6506083
Validation loss decreased (9.443701 --> 8.619738).  Saving model ...
Updating learning rate to 0.000125
tensor(24.6921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7798913 KL Loss: 7.2287043 DSM Loss: 9.2771686 Overall Loss:18.2857642
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.6035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7980432 KL Loss: 7.1365375 DSM Loss: 9.3152025 Overall Loss:18.2497831
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(15.5301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7768379 KL Loss: 7.1907359 DSM Loss: 9.1940198 Overall Loss:18.1615937
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.536909103393555
Use GPU: cuda:0
>>>>>>>start training : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(20.9025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8862773 KL Loss: 7.2698229 DSM Loss: 11.5449533 Overall Loss:20.7010535
Validation loss decreased (inf --> 8.508821).  Saving model ...
Updating learning rate to 0.0005
tensor(20.5932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8515077 KL Loss: 7.2102474 DSM Loss: 9.8962852 Overall Loss:18.9580402
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.6627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8115739 KL Loss: 7.1908240 DSM Loss: 9.6511452 Overall Loss:18.6535432
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(12.9622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7961085 KL Loss: 7.1553912 DSM Loss: 8.9351866 Overall Loss:17.8866863
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.368952751159668
Use GPU: cuda:0
>>>>>>>start training : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.4593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8255533 KL Loss: 7.1883183 DSM Loss: 11.6437711 Overall Loss:20.6576427
Validation loss decreased (inf --> 10.241886).  Saving model ...
Updating learning rate to 0.0005
tensor(14.0623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8411906 KL Loss: 7.1910606 DSM Loss: 9.8356569 Overall Loss:18.8679080
Validation loss decreased (10.241886 --> 10.117220).  Saving model ...
Updating learning rate to 0.00025
tensor(16.1566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8010007 KL Loss: 7.1796973 DSM Loss: 9.5959649 Overall Loss:18.5766629
Validation loss decreased (10.117220 --> 9.491259).  Saving model ...
Updating learning rate to 0.000125
tensor(20.7226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.8458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7685452 KL Loss: 7.1127658 DSM Loss: 9.4717548 Overall Loss:18.3530658
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.8441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7647214 KL Loss: 7.1621548 DSM Loss: 9.4070802 Overall Loss:18.3339563
Validation loss decreased (9.491259 --> 9.341785).  Saving model ...
Updating learning rate to 3.125e-05
tensor(20.1097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.4686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7475221 KL Loss: 7.1402221 DSM Loss: 9.1300225 Overall Loss:18.0177666
Validation loss decreased (9.341785 --> 9.294595).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(21.8756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7431515 KL Loss: 7.1074994 DSM Loss: 9.1853061 Overall Loss:18.0359570
Validation loss decreased (9.294595 --> 9.249889).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(20.3322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7362610 KL Loss: 7.1703221 DSM Loss: 9.1183393 Overall Loss:18.0249224
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
tensor(21.0909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 86 | MSE Loss: 1.7846219 KL Loss: 7.2709708 DSM Loss: 9.0357647 Overall Loss:18.0913574
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
tensor(18.9404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.1348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 86 | MSE Loss: 1.7629292 KL Loss: 7.1046810 DSM Loss: 9.2345479 Overall Loss:18.1021579
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:13.29367446899414
Use GPU: cuda:0
>>>>>>>start training : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.4543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.3434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9057498 KL Loss: 7.2359485 DSM Loss: 12.3060988 Overall Loss:21.4477971
Validation loss decreased (inf --> 9.142178).  Saving model ...
Updating learning rate to 0.0005
tensor(12.3367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8375061 KL Loss: 7.1617156 DSM Loss: 9.9723027 Overall Loss:18.9715244
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.2971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7816975 KL Loss: 7.1646531 DSM Loss: 9.5214728 Overall Loss:18.4678233
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.9380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7806736 KL Loss: 7.1179463 DSM Loss: 9.4812408 Overall Loss:18.3798609
Validation loss decreased (9.142178 --> 8.673449).  Saving model ...
Updating learning rate to 6.25e-05
tensor(21.1151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.0269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7815757 KL Loss: 7.1809389 DSM Loss: 9.3171297 Overall Loss:18.2796442
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(16.5276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5119, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.8065891 KL Loss: 7.1981252 DSM Loss: 9.2740786 Overall Loss:18.2787929
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(18.7528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7591402 KL Loss: 7.1679428 DSM Loss: 9.1185733 Overall Loss:18.0456564
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.575058937072754
Use GPU: cuda:0
>>>>>>>start training : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.8588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8697443 KL Loss: 7.2132999 DSM Loss: 11.5666553 Overall Loss:20.6496994
Validation loss decreased (inf --> 9.462556).  Saving model ...
Updating learning rate to 0.0005
tensor(18.8301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8736705 KL Loss: 7.1845674 DSM Loss: 10.0932358 Overall Loss:19.1514737
Validation loss decreased (9.462556 --> 9.043241).  Saving model ...
Updating learning rate to 0.00025
tensor(16.4200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8543325 KL Loss: 7.1399448 DSM Loss: 9.6336203 Overall Loss:18.6278978
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(22.3212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7614431 KL Loss: 7.1249404 DSM Loss: 9.3207894 Overall Loss:18.2071728
Validation loss decreased (9.043241 --> 8.803175).  Saving model ...
Updating learning rate to 6.25e-05
tensor(20.2763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.6191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7961872 KL Loss: 7.1750842 DSM Loss: 9.3029546 Overall Loss:18.2742260
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(18.0170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7937227 KL Loss: 7.1739782 DSM Loss: 9.1881229 Overall Loss:18.1558238
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.6125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7382053 KL Loss: 7.0783313 DSM Loss: 9.3251742 Overall Loss:18.1417110
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:12.691461563110352


Running on file UPS.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.0591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8298349 KL Loss: 7.1972847 DSM Loss: 12.7527777 Overall Loss:21.7798974
Validation loss decreased (inf --> 7.472687).  Saving model ...
Updating learning rate to 0.0005
tensor(19.9558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8286140 KL Loss: 7.0894071 DSM Loss: 10.0878904 Overall Loss:19.0059114
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.0378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7915612 KL Loss: 7.1105622 DSM Loss: 9.9602239 Overall Loss:18.8623472
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.5368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9035, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8233339 KL Loss: 7.1840677 DSM Loss: 9.4347472 Overall Loss:18.4421489
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.580709934234619
Use GPU: cuda:0
>>>>>>>start training : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(33.5611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2148, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7868252 KL Loss: 7.1069062 DSM Loss: 11.7076564 Overall Loss:20.6013878
Validation loss decreased (inf --> 8.939711).  Saving model ...
Updating learning rate to 0.0005
tensor(20.2320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1580, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7868470 KL Loss: 7.1095379 DSM Loss: 10.2854716 Overall Loss:19.1818566
Validation loss decreased (8.939711 --> 7.796781).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8308515 KL Loss: 7.1593263 DSM Loss: 9.7820550 Overall Loss:18.7722328
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(11.1108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.7118, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7746710 KL Loss: 7.1408244 DSM Loss: 9.2148204 Overall Loss:18.1303158
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(20.5190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7745665 KL Loss: 7.1398323 DSM Loss: 9.4960901 Overall Loss:18.4104889
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.804355144500732
Use GPU: cuda:0
>>>>>>>start training : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.3097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7534980 KL Loss: 7.1138537 DSM Loss: 11.6211265 Overall Loss:20.4884783
Validation loss decreased (inf --> 7.630302).  Saving model ...
Updating learning rate to 0.0005
tensor(14.5409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8216, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7921494 KL Loss: 7.1378967 DSM Loss: 10.2406970 Overall Loss:19.1707431
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(15.0744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.8287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7500948 KL Loss: 7.1480850 DSM Loss: 9.5806788 Overall Loss:18.4788587
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.7346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7412352 KL Loss: 7.0752740 DSM Loss: 9.5903588 Overall Loss:18.4068680
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.6712846755981445
Use GPU: cuda:0
>>>>>>>start training : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(31.1509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7787226 KL Loss: 7.1659588 DSM Loss: 13.1217975 Overall Loss:22.0664789
Validation loss decreased (inf --> 6.940768).  Saving model ...
Updating learning rate to 0.0005
tensor(21.1122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1410, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8539618 KL Loss: 7.1660887 DSM Loss: 10.1304750 Overall Loss:19.1505254
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(12.7171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.8723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7645843 KL Loss: 7.0455446 DSM Loss: 9.5706120 Overall Loss:18.3807409
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(11.3237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.7101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7371687 KL Loss: 7.1385001 DSM Loss: 9.6973178 Overall Loss:18.5729866
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.192374229431152
Use GPU: cuda:0
>>>>>>>start training : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(20.9107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8527366 KL Loss: 7.2139154 DSM Loss: 12.7748762 Overall Loss:21.8415282
Validation loss decreased (inf --> 7.073822).  Saving model ...
Updating learning rate to 0.0005
tensor(21.3809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8122500 KL Loss: 7.1544225 DSM Loss: 10.0462909 Overall Loss:19.0129633
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(27.3436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7861106 KL Loss: 7.1316435 DSM Loss: 9.5607417 Overall Loss:18.4784958
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(24.2721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7921424 KL Loss: 7.1632317 DSM Loss: 9.4177100 Overall Loss:18.3730839
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:4.253974437713623


Running on file V.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(37.6607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.6549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8608009 KL Loss: 7.2612984 DSM Loss: 11.5508233 Overall Loss:20.6729227
Validation loss decreased (inf --> 1.933792).  Saving model ...
Updating learning rate to 0.0005
tensor(17.7877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7928735 KL Loss: 7.1235561 DSM Loss: 9.5661713 Overall Loss:18.4826008
Validation loss decreased (1.933792 --> 1.914017).  Saving model ...
Updating learning rate to 0.00025
tensor(14.3726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.0618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8053068 KL Loss: 7.1955788 DSM Loss: 9.6466042 Overall Loss:18.6474898
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(26.8795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7601688 KL Loss: 7.1535534 DSM Loss: 9.5919936 Overall Loss:18.5057158
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(19.3123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6115, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7686934 KL Loss: 7.1598575 DSM Loss: 9.4755475 Overall Loss:18.4040984
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.3560895919799805
Use GPU: cuda:0
>>>>>>>start training : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.5964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8283922 KL Loss: 7.1731282 DSM Loss: 12.5173084 Overall Loss:21.5188288
Validation loss decreased (inf --> 2.347027).  Saving model ...
Updating learning rate to 0.0005
tensor(16.9775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7976670 KL Loss: 7.2007606 DSM Loss: 9.9504850 Overall Loss:18.9489128
Validation loss decreased (2.347027 --> 1.934775).  Saving model ...
Updating learning rate to 0.00025
tensor(23.1684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.4876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8014493 KL Loss: 7.1718940 DSM Loss: 9.4619663 Overall Loss:18.4353095
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(18.3523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7661600 KL Loss: 7.1420750 DSM Loss: 9.5117496 Overall Loss:18.4199846
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(14.0363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7940630 KL Loss: 7.2095664 DSM Loss: 9.3910904 Overall Loss:18.3947200
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.373420238494873
Use GPU: cuda:0
>>>>>>>start training : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.7185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8326356 KL Loss: 7.1496768 DSM Loss: 12.8039058 Overall Loss:21.7862183
Validation loss decreased (inf --> 1.851794).  Saving model ...
Updating learning rate to 0.0005
tensor(16.2127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7928902 KL Loss: 7.1823710 DSM Loss: 9.9510206 Overall Loss:18.9262817
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.3794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8122317 KL Loss: 7.2115253 DSM Loss: 9.6347581 Overall Loss:18.6585150
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(20.8186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7733093 KL Loss: 7.1569757 DSM Loss: 9.5992021 Overall Loss:18.5294871
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.291874647140503
Use GPU: cuda:0
>>>>>>>start training : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.1241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5688, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8025108 KL Loss: 7.1297663 DSM Loss: 11.8115869 Overall Loss:20.7438640
Validation loss decreased (inf --> 1.848515).  Saving model ...
Updating learning rate to 0.0005
tensor(21.1252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8459540 KL Loss: 7.1960483 DSM Loss: 10.0170667 Overall Loss:19.0590689
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(17.7841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7725268 KL Loss: 7.1419478 DSM Loss: 9.7392167 Overall Loss:18.6536911
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.4287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(11.9727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7968838 KL Loss: 7.2027582 DSM Loss: 9.3126941 Overall Loss:18.3123362
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.2918291091918945
Use GPU: cuda:0
>>>>>>>start training : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.7102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0288, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8695451 KL Loss: 7.2373474 DSM Loss: 13.1558935 Overall Loss:22.2627859
Validation loss decreased (inf --> 1.660049).  Saving model ...
Updating learning rate to 0.0005
tensor(18.4745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8228589 KL Loss: 7.1903141 DSM Loss: 10.1707918 Overall Loss:19.1839650
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.1872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7788851 KL Loss: 7.1435704 DSM Loss: 9.7641479 Overall Loss:18.6866032
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(19.1506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7844015 KL Loss: 7.1880809 DSM Loss: 9.4738171 Overall Loss:18.4462994
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:2.05122447013855


Running on file VZ.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.7283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8140850 KL Loss: 7.2144713 DSM Loss: 11.9590864 Overall Loss:20.9876427
Validation loss decreased (inf --> 0.466376).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8133385 KL Loss: 7.1269456 DSM Loss: 10.0930386 Overall Loss:19.0333227
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.1870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1919, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7874909 KL Loss: 7.1364717 DSM Loss: 9.7867294 Overall Loss:18.7106919
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(17.6981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7055645 KL Loss: 7.0692540 DSM Loss: 9.3286981 Overall Loss:18.1035166
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.3327823877334595
Use GPU: cuda:0
>>>>>>>start training : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(22.0144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8353568 KL Loss: 7.1355964 DSM Loss: 11.9671634 Overall Loss:20.9381167
Validation loss decreased (inf --> 0.582321).  Saving model ...
Updating learning rate to 0.0005
tensor(17.3555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8520127 KL Loss: 7.1906714 DSM Loss: 10.2795284 Overall Loss:19.3222126
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.2564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7844691 KL Loss: 7.1449643 DSM Loss: 9.6506305 Overall Loss:18.5800638
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.3337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8070112 KL Loss: 7.1511910 DSM Loss: 9.4316603 Overall Loss:18.3898626
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2678637504577637
Use GPU: cuda:0
>>>>>>>start training : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(34.3687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8259888 KL Loss: 7.2052593 DSM Loss: 12.0940119 Overall Loss:21.1252600
Validation loss decreased (inf --> 0.647016).  Saving model ...
Updating learning rate to 0.0005
tensor(18.0862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8597479 KL Loss: 7.1846323 DSM Loss: 10.1640253 Overall Loss:19.2084055
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(21.4097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7963360 KL Loss: 7.1950088 DSM Loss: 9.6121256 Overall Loss:18.6034705
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.5094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.4120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8192138 KL Loss: 7.2025764 DSM Loss: 9.4079583 Overall Loss:18.4297484
Validation loss decreased (0.647016 --> 0.641308).  Saving model ...
Updating learning rate to 6.25e-05
tensor(17.1696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7878931 KL Loss: 7.2249998 DSM Loss: 9.3415768 Overall Loss:18.3544699
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(19.7620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7567054 KL Loss: 7.1105424 DSM Loss: 9.3530543 Overall Loss:18.2203021
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(17.4013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7816661 KL Loss: 7.2158692 DSM Loss: 9.2818741 Overall Loss:18.2794095
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.299839735031128
Use GPU: cuda:0
>>>>>>>start training : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.0513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8267702 KL Loss: 7.1309085 DSM Loss: 11.3530255 Overall Loss:20.3107042
Validation loss decreased (inf --> 0.992421).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2942, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7977009 KL Loss: 7.1825938 DSM Loss: 10.0609582 Overall Loss:19.0412528
Validation loss decreased (0.992421 --> 0.537232).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.5538, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8149565 KL Loss: 7.1832089 DSM Loss: 9.6419238 Overall Loss:18.6400891
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(21.2618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7932209 KL Loss: 7.1908886 DSM Loss: 9.4415658 Overall Loss:18.4256755
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.4722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7879818 KL Loss: 7.1667542 DSM Loss: 9.3176107 Overall Loss:18.2723466
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.1628817319869995
Use GPU: cuda:0
>>>>>>>start training : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(29.2662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2298, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8004315 KL Loss: 7.1746044 DSM Loss: 11.5997774 Overall Loss:20.5748133
Validation loss decreased (inf --> 0.627074).  Saving model ...
Updating learning rate to 0.0005
tensor(19.6758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7916291 KL Loss: 7.1212629 DSM Loss: 9.9746676 Overall Loss:18.8875595
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.7639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9128, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7866864 KL Loss: 7.1767814 DSM Loss: 9.5031987 Overall Loss:18.4666664
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(16.8912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7623527 KL Loss: 7.1750607 DSM Loss: 9.4652602 Overall Loss:18.4026736
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:1.2170709371566772


Running on file WFC.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(36.8672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.9249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8668062 KL Loss: 7.2410977 DSM Loss: 12.0019120 Overall Loss:21.1098159
Validation loss decreased (inf --> 0.731548).  Saving model ...
Updating learning rate to 0.0005
tensor(12.8910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8037522 KL Loss: 7.0608774 DSM Loss: 10.2496259 Overall Loss:19.1142554
Validation loss decreased (0.731548 --> 0.623946).  Saving model ...
Updating learning rate to 0.00025
tensor(16.4014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.0697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7815187 KL Loss: 7.1689681 DSM Loss: 9.9426268 Overall Loss:18.8931135
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(27.1130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.6039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7937665 KL Loss: 7.2008125 DSM Loss: 9.7312447 Overall Loss:18.7258238
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(21.3583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7693, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.8013811 KL Loss: 7.1274786 DSM Loss: 9.9131394 Overall Loss:18.8419990
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1246761828660965
Use GPU: cuda:0
>>>>>>>start training : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.8022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3453, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8447102 KL Loss: 7.2229479 DSM Loss: 12.1116748 Overall Loss:21.1793330
Validation loss decreased (inf --> 0.925190).  Saving model ...
Updating learning rate to 0.0005
tensor(19.2947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7725, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8099355 KL Loss: 7.1665674 DSM Loss: 10.4350914 Overall Loss:19.4115944
Validation loss decreased (0.925190 --> 0.890103).  Saving model ...
Updating learning rate to 0.00025
tensor(21.3590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8009670 KL Loss: 7.2123603 DSM Loss: 9.8079385 Overall Loss:18.8212658
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(21.1387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7841115 KL Loss: 7.1677237 DSM Loss: 9.7251732 Overall Loss:18.6770085
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(17.0382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7426604 KL Loss: 7.1236257 DSM Loss: 9.6854408 Overall Loss:18.5517268
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1367940455675125
Use GPU: cuda:0
>>>>>>>start training : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(26.2038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8110939 KL Loss: 7.1921237 DSM Loss: 11.6570907 Overall Loss:20.6603083
Validation loss decreased (inf --> 0.976183).  Saving model ...
Updating learning rate to 0.0005
tensor(18.6143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.7890500 KL Loss: 7.1315083 DSM Loss: 10.3292872 Overall Loss:19.2498456
Validation loss decreased (0.976183 --> 0.974041).  Saving model ...
Updating learning rate to 0.00025
tensor(17.0259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8122011 KL Loss: 7.1904341 DSM Loss: 9.9244527 Overall Loss:18.9270879
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(14.4161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.7993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7870965 KL Loss: 7.1803014 DSM Loss: 9.7969993 Overall Loss:18.7643973
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(29.1004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7630960 KL Loss: 7.1365378 DSM Loss: 9.6577776 Overall Loss:18.5574114
Validation loss decreased (0.974041 --> 0.889379).  Saving model ...
Updating learning rate to 3.125e-05
tensor(13.1414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7763491 KL Loss: 7.1934686 DSM Loss: 9.4146804 Overall Loss:18.3844981
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(24.1124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.2338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.6799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7761206 KL Loss: 7.1655602 DSM Loss: 9.6587695 Overall Loss:18.6004503
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(16.4115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.8204560 KL Loss: 7.1921721 DSM Loss: 9.4495959 Overall Loss:18.4622240
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1328412890434265
Use GPU: cuda:0
>>>>>>>start training : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(39.0726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1016, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.9622794 KL Loss: 7.2390942 DSM Loss: 12.6268899 Overall Loss:21.8282635
Validation loss decreased (inf --> 1.054077).  Saving model ...
Updating learning rate to 0.0005
tensor(22.2427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8244955 KL Loss: 7.1838702 DSM Loss: 10.3331582 Overall Loss:19.3415239
Validation loss decreased (1.054077 --> 1.033375).  Saving model ...
Updating learning rate to 0.00025
tensor(16.7943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7745343 KL Loss: 7.1176473 DSM Loss: 10.0658761 Overall Loss:18.9580578
Validation loss decreased (1.033375 --> 0.881835).  Saving model ...
Updating learning rate to 0.000125
tensor(15.0438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.4151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7484224 KL Loss: 7.1529832 DSM Loss: 9.7434786 Overall Loss:18.6448842
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.7566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.5559, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7765705 KL Loss: 7.1852839 DSM Loss: 9.7833515 Overall Loss:18.7452059
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(14.4881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7711240 KL Loss: 7.2119156 DSM Loss: 9.8940427 Overall Loss:18.8770823
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.1316538006067276
Use GPU: cuda:0
>>>>>>>start training : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.0311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.6825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8778724 KL Loss: 7.2365296 DSM Loss: 12.0017166 Overall Loss:21.1161186
Validation loss decreased (inf --> 1.190145).  Saving model ...
Updating learning rate to 0.0005
tensor(17.0806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.0678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8486212 KL Loss: 7.1910987 DSM Loss: 10.6761389 Overall Loss:19.7158589
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(32.5846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8184779 KL Loss: 7.1352123 DSM Loss: 10.4280984 Overall Loss:19.3817886
Validation loss decreased (1.190145 --> 1.101707).  Saving model ...
Updating learning rate to 0.000125
tensor(22.7966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8257833 KL Loss: 7.1859035 DSM Loss: 9.9121983 Overall Loss:18.9238852
Validation loss decreased (1.101707 --> 0.780404).  Saving model ...
Updating learning rate to 6.25e-05
tensor(16.8769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4602, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7860457 KL Loss: 7.1838077 DSM Loss: 9.6928616 Overall Loss:18.6627151
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(16.5017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.2863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7762716 KL Loss: 7.1462766 DSM Loss: 9.6576495 Overall Loss:18.5801977
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(21.6123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4362, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7842695 KL Loss: 7.1671572 DSM Loss: 9.6185754 Overall Loss:18.5700021
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:0.12055553495883942


Running on file WMT.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.7801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.1776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8463122 KL Loss: 7.3039205 DSM Loss: 11.7478636 Overall Loss:20.8980963
Validation loss decreased (inf --> 4.040323).  Saving model ...
Updating learning rate to 0.0005
tensor(21.1954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4832, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8557031 KL Loss: 7.1893727 DSM Loss: 10.0873804 Overall Loss:19.1324560
Validation loss decreased (4.040323 --> 3.108510).  Saving model ...
Updating learning rate to 0.00025
tensor(16.8117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.5153, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7740894 KL Loss: 7.1418851 DSM Loss: 9.6406721 Overall Loss:18.5566467
Validation loss decreased (3.108510 --> 2.641332).  Saving model ...
Updating learning rate to 0.000125
tensor(14.8395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9820, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7917385 KL Loss: 7.1437077 DSM Loss: 9.5634208 Overall Loss:18.4988671
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(16.1587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.9326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7850061 KL Loss: 7.1896727 DSM Loss: 9.3275746 Overall Loss:18.3022535
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(16.1348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.0337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7557, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7794027 KL Loss: 7.1480455 DSM Loss: 9.2825138 Overall Loss:18.2099620
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.344505786895752
Use GPU: cuda:0
>>>>>>>start training : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(24.3271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.9238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8327307 KL Loss: 7.2118966 DSM Loss: 11.4677711 Overall Loss:20.5123985
Validation loss decreased (inf --> 3.077896).  Saving model ...
Updating learning rate to 0.0005
tensor(23.5377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8268552 KL Loss: 7.1864168 DSM Loss: 9.8743496 Overall Loss:18.8876216
Validation loss decreased (3.077896 --> 3.018496).  Saving model ...
Updating learning rate to 0.00025
tensor(20.7605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.2602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7674595 KL Loss: 7.1166635 DSM Loss: 9.7291344 Overall Loss:18.6132573
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(19.5695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.5149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7902602 KL Loss: 7.2011285 DSM Loss: 9.3644577 Overall Loss:18.3558464
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(14.7619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.2027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.8489, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7983446 KL Loss: 7.1902069 DSM Loss: 9.4235511 Overall Loss:18.4121024
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.767866611480713
Use GPU: cuda:0
>>>>>>>start training : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.4785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.7902248 KL Loss: 7.1832976 DSM Loss: 11.6163669 Overall Loss:20.5898893
Validation loss decreased (inf --> 2.924067).  Saving model ...
Updating learning rate to 0.0005
tensor(15.7289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.8613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8428706 KL Loss: 7.1680902 DSM Loss: 10.0396141 Overall Loss:19.0505747
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.0152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7814579 KL Loss: 7.1419446 DSM Loss: 9.9294873 Overall Loss:18.8528897
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.1784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.9466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.8200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8379463 KL Loss: 7.2042673 DSM Loss: 9.5066035 Overall Loss:18.5488170
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.6381845474243164
Use GPU: cuda:0
>>>>>>>start training : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.1658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5744, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8737698 KL Loss: 7.2149638 DSM Loss: 11.0316142 Overall Loss:20.1203478
Validation loss decreased (inf --> 2.823939).  Saving model ...
Updating learning rate to 0.0005
tensor(17.6773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.6740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8066455 KL Loss: 7.2231971 DSM Loss: 10.1121361 Overall Loss:19.1419789
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.7244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.7293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8130988 KL Loss: 7.1063581 DSM Loss: 9.6353362 Overall Loss:18.5547931
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.1556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.2972, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7792060 KL Loss: 7.1341880 DSM Loss: 9.3437243 Overall Loss:18.2571182
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.5458030700683594
Use GPU: cuda:0
>>>>>>>start training : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(30.3730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8315774 KL Loss: 7.2006228 DSM Loss: 11.6879839 Overall Loss:20.7201840
Validation loss decreased (inf --> 2.664051).  Saving model ...
Updating learning rate to 0.0005
tensor(19.4523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.5557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.3351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8224343 KL Loss: 7.2137994 DSM Loss: 10.2468148 Overall Loss:19.2830486
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(18.6127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.0543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.8778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7972247 KL Loss: 7.1667297 DSM Loss: 9.6892060 Overall Loss:18.6531605
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.3664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.7800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7704872 KL Loss: 7.1036158 DSM Loss: 9.2812256 Overall Loss:18.1553285
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:3.3751633167266846


Running on file XOM.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(28.7369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.4609, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8339335 KL Loss: 7.2463905 DSM Loss: 11.7629166 Overall Loss:20.8432409
Validation loss decreased (inf --> 2.841076).  Saving model ...
Updating learning rate to 0.0005
tensor(23.0233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.1265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8816511 KL Loss: 7.2109464 DSM Loss: 10.4682091 Overall Loss:19.5608066
Validation loss decreased (2.841076 --> 2.390480).  Saving model ...
Updating learning rate to 0.00025
tensor(14.9578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.6947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8083118 KL Loss: 7.1941250 DSM Loss: 10.0568911 Overall Loss:19.0593279
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(28.0783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0374, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7886942 KL Loss: 7.1629916 DSM Loss: 9.8479897 Overall Loss:18.7996755
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(18.9049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.0888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7841241 KL Loss: 7.1184181 DSM Loss: 9.5784372 Overall Loss:18.4809794
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:23.997913360595703
Use GPU: cuda:0
>>>>>>>start training : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(27.3445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.7803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8682046 KL Loss: 7.2097291 DSM Loss: 12.2392444 Overall Loss:21.3171782
Validation loss decreased (inf --> 2.378059).  Saving model ...
Updating learning rate to 0.0005
tensor(21.8991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8310391 KL Loss: 7.1530452 DSM Loss: 10.3698888 Overall Loss:19.3539733
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(16.2473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(10.4614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.3802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.7679478 KL Loss: 7.1481297 DSM Loss: 10.0578779 Overall Loss:18.9739553
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(15.1762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.1901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7949966 KL Loss: 7.1408816 DSM Loss: 9.8160207 Overall Loss:18.7518989
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:23.949512481689453
Use GPU: cuda:0
>>>>>>>start training : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(25.4642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6127, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8492251 KL Loss: 7.2190564 DSM Loss: 11.8449143 Overall Loss:20.9131957
Validation loss decreased (inf --> 2.204904).  Saving model ...
Updating learning rate to 0.0005
tensor(19.0882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.0389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6720, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8546396 KL Loss: 7.1899554 DSM Loss: 10.4909523 Overall Loss:19.5355472
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(19.7431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.2158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8027374 KL Loss: 7.1574599 DSM Loss: 9.9949034 Overall Loss:18.9551006
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(18.7133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.7492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7355218 KL Loss: 7.1301121 DSM Loss: 9.8660711 Overall Loss:18.7317051
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:22.825328826904297
Use GPU: cuda:0
>>>>>>>start training : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(19.5514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(13.5960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8786413 KL Loss: 7.2223879 DSM Loss: 12.0474657 Overall Loss:21.1484948
Validation loss decreased (inf --> 2.275841).  Saving model ...
Updating learning rate to 0.0005
tensor(23.0194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.4104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8703801 KL Loss: 7.1878346 DSM Loss: 10.6030933 Overall Loss:19.6613080
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(13.1003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.8495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.1291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8242784 KL Loss: 7.1799938 DSM Loss: 10.0226965 Overall Loss:19.0269688
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(14.2784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.5351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.7815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.7668659 KL Loss: 7.1245773 DSM Loss: 9.8537354 Overall Loss:18.7451785
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:23.566661834716797
Use GPU: cuda:0
>>>>>>>start training : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1389
val 192
test 393
tensor(40.2092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.8058, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 86 | MSE Loss: 1.8406522 KL Loss: 7.2547599 DSM Loss: 12.6859040 Overall Loss:21.7813162
Validation loss decreased (inf --> 2.985444).  Saving model ...
Updating learning rate to 0.0005
tensor(17.7417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3684, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 86 | MSE Loss: 1.8422193 KL Loss: 7.2021125 DSM Loss: 10.5578486 Overall Loss:19.6021805
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(20.7112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5288, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 86 | MSE Loss: 1.8548012 KL Loss: 7.2015146 DSM Loss: 10.0910474 Overall Loss:19.1473630
Validation loss decreased (2.985444 --> 2.654003).  Saving model ...
Updating learning rate to 0.000125
tensor(11.9530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(17.7469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 86 | MSE Loss: 1.8202987 KL Loss: 7.1566343 DSM Loss: 9.7613069 Overall Loss:18.7382400
Validation loss decreased (2.654003 --> 2.649242).  Saving model ...
Updating learning rate to 6.25e-05
tensor(20.7641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(16.2287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 86 | MSE Loss: 1.7641459 KL Loss: 7.1481847 DSM Loss: 9.8357324 Overall Loss:18.7480630
Validation loss decreased (2.649242 --> 2.349286).  Saving model ...
Updating learning rate to 3.125e-05
tensor(16.9212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(14.9187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(12.7315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 86 | MSE Loss: 1.7881398 KL Loss: 7.1209164 DSM Loss: 9.5529444 Overall Loss:18.4620005
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(11.7148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.3925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.7116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 86 | MSE Loss: 1.7601489 KL Loss: 7.1217697 DSM Loss: 9.8373404 Overall Loss:18.7192590
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(23.1740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.8140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(15.5463, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 86 | MSE Loss: 1.7346250 KL Loss: 7.1032106 DSM Loss: 9.6160841 Overall Loss:18.4539197
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl10>>>>>>>>>>>>>>>>>>>>>>>>>>
test 393
mse:23.829145431518555
   Ticker        MSE    StdDev
0    AAPL   8.409575  0.196877
1    ABBV  16.955694   0.52629
2     AEP   3.420028  0.041043
3    AMGN   4.735614  0.168261
4    AMZN   0.474295  0.089179
..    ...        ...       ...
66      V   2.272888  0.115657
67     VZ   1.256088  0.060241
68    WFC   0.129304  0.005867
69    WMT   3.534305  0.159263
70    XOM  23.633713   0.43094

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=5, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=3, prediction_length=20, root_path='data/EcmP_stock_L_2016_24_dva_spec', scale=1, sequence_length=20, target_dim=1, train_epochs=20, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.8704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9215184 KL Loss: 14.3064432 DSM Loss: 21.9396321 Overall Loss:38.1675936
Validation loss decreased (inf --> 8.928744).  Saving model ...
Updating learning rate to 0.0005
tensor(24.3770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4056, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9111129 KL Loss: 14.2369578 DSM Loss: 19.5166550 Overall Loss:35.6647255
Validation loss decreased (8.928744 --> 8.255133).  Saving model ...
Updating learning rate to 0.00025
tensor(40.4342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8774693 KL Loss: 14.1271193 DSM Loss: 18.9143267 Overall Loss:34.9189151
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(46.3538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9277644 KL Loss: 14.3451544 DSM Loss: 18.4876567 Overall Loss:34.7605755
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(34.8921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8239, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9000188 KL Loss: 14.2550064 DSM Loss: 18.5482151 Overall Loss:34.7032401
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.753702163696289
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.1994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0962, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9208334 KL Loss: 14.2833361 DSM Loss: 22.6531966 Overall Loss:38.8573660
Validation loss decreased (inf --> 8.572448).  Saving model ...
Updating learning rate to 0.0005
tensor(32.2347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9253447 KL Loss: 14.2377471 DSM Loss: 19.9367032 Overall Loss:36.0997949
Validation loss decreased (8.572448 --> 6.659772).  Saving model ...
Updating learning rate to 0.00025
tensor(25.8730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9295327 KL Loss: 14.1014720 DSM Loss: 18.6384984 Overall Loss:34.6695032
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(39.5398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6070, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8657947 KL Loss: 14.1700540 DSM Loss: 18.3309324 Overall Loss:34.3667811
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(39.0124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8579455 KL Loss: 14.1446796 DSM Loss: 18.4190773 Overall Loss:34.4217024
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.090582370758057
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(50.7551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9552345 KL Loss: 14.2445546 DSM Loss: 22.4239742 Overall Loss:38.6237631
Validation loss decreased (inf --> 8.169457).  Saving model ...
Updating learning rate to 0.0005
tensor(31.2484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8994009 KL Loss: 14.1865998 DSM Loss: 19.4877399 Overall Loss:35.5737405
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(32.5057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8727475 KL Loss: 14.1172392 DSM Loss: 19.0892901 Overall Loss:35.0792765
Validation loss decreased (8.169457 --> 8.167249).  Saving model ...
Updating learning rate to 0.000125
tensor(31.8238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8946646 KL Loss: 14.2087269 DSM Loss: 18.6922050 Overall Loss:34.7955966
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(40.6870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8897632 KL Loss: 14.1963589 DSM Loss: 18.3865089 Overall Loss:34.4726311
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(34.8289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9070, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8744452 KL Loss: 14.1625225 DSM Loss: 18.2672315 Overall Loss:34.3041989
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.645939826965332
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.9134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8979149 KL Loss: 14.3626971 DSM Loss: 36.8100573 Overall Loss:53.0706692
Validation loss decreased (inf --> 8.220857).  Saving model ...
Updating learning rate to 0.0005
tensor(43.7700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0375, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8865792 KL Loss: 14.2051952 DSM Loss: 21.3329336 Overall Loss:37.4247078
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(35.8034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8771241 KL Loss: 14.2092371 DSM Loss: 18.7499444 Overall Loss:34.8363057
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(38.5789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.1864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 2.0112984 KL Loss: 14.4398139 DSM Loss: 18.5501040 Overall Loss:35.0012163
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.721019744873047
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(67.7497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 2.0030592 KL Loss: 14.2604222 DSM Loss: 24.2096318 Overall Loss:40.4731129
Validation loss decreased (inf --> 8.186944).  Saving model ...
Updating learning rate to 0.0005
tensor(28.5517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.8742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9887187 KL Loss: 14.2233137 DSM Loss: 19.4907856 Overall Loss:35.7028182
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(27.1876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8867805 KL Loss: 14.0527988 DSM Loss: 18.5309382 Overall Loss:34.4705176
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(42.1310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8723479 KL Loss: 14.1994276 DSM Loss: 18.7543914 Overall Loss:34.8261669
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.684502601623535


Running on file ABBV.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.6101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9432415 KL Loss: 14.2690753 DSM Loss: 21.5808589 Overall Loss:37.7931756
Validation loss decreased (inf --> 10.301141).  Saving model ...
Updating learning rate to 0.0005
tensor(37.3188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9229574 KL Loss: 14.3346826 DSM Loss: 18.9959326 Overall Loss:35.2535728
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(33.8344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9387169 KL Loss: 14.2659221 DSM Loss: 18.5024397 Overall Loss:34.7070786
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(30.1346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8943295 KL Loss: 14.2784140 DSM Loss: 18.0783395 Overall Loss:34.2510829
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:18.28188705444336
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.9472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3169, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9184133 KL Loss: 14.3670944 DSM Loss: 22.3824323 Overall Loss:38.6679401
Validation loss decreased (inf --> 9.609202).  Saving model ...
Updating learning rate to 0.0005
tensor(40.4607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9781206 KL Loss: 14.3112091 DSM Loss: 19.0645773 Overall Loss:35.3539072
Validation loss decreased (9.609202 --> 9.397900).  Saving model ...
Updating learning rate to 0.00025
tensor(38.4645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9257070 KL Loss: 14.3321649 DSM Loss: 17.9696918 Overall Loss:34.2275637
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(33.5028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8938203 KL Loss: 14.2874016 DSM Loss: 18.2139137 Overall Loss:34.3951353
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(37.1555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6303, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8936067 KL Loss: 14.2801199 DSM Loss: 17.9072343 Overall Loss:34.0809609
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:16.99897003173828
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.2863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8942961 KL Loss: 14.3401792 DSM Loss: 21.3639793 Overall Loss:37.5984547
Validation loss decreased (inf --> 10.624643).  Saving model ...
Updating learning rate to 0.0005
tensor(34.4607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9249782 KL Loss: 14.3262820 DSM Loss: 18.6604348 Overall Loss:34.9116951
Validation loss decreased (10.624643 --> 9.172391).  Saving model ...
Updating learning rate to 0.00025
tensor(29.3692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9049477 KL Loss: 14.2702695 DSM Loss: 18.3574811 Overall Loss:34.5326984
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(30.5306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8126, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8642419 KL Loss: 14.2802079 DSM Loss: 18.0076613 Overall Loss:34.1521110
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(33.9395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8799824 KL Loss: 14.3032406 DSM Loss: 17.6023502 Overall Loss:33.7855729
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:16.659807205200195
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.6264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9026142 KL Loss: 14.2352388 DSM Loss: 22.0384744 Overall Loss:38.1763274
Validation loss decreased (inf --> 8.962670).  Saving model ...
Updating learning rate to 0.0005
tensor(29.9071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9142648 KL Loss: 14.2192655 DSM Loss: 19.1563708 Overall Loss:35.2899010
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(37.7146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8642174 KL Loss: 14.2225818 DSM Loss: 18.4153677 Overall Loss:34.5021668
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(34.9519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8984448 KL Loss: 14.2851126 DSM Loss: 18.2836955 Overall Loss:34.4672530
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:16.39097023010254
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(44.2861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8767088 KL Loss: 14.2754899 DSM Loss: 21.1767956 Overall Loss:37.3289940
Validation loss decreased (inf --> 11.258369).  Saving model ...
Updating learning rate to 0.0005
tensor(33.8719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0710, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8861110 KL Loss: 14.2886483 DSM Loss: 18.6365428 Overall Loss:34.8113021
Validation loss decreased (11.258369 --> 10.207090).  Saving model ...
Updating learning rate to 0.00025
tensor(34.6760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8899994 KL Loss: 14.3470366 DSM Loss: 18.3880084 Overall Loss:34.6250443
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(27.5510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8868915 KL Loss: 14.2702962 DSM Loss: 18.3425522 Overall Loss:34.4997400
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(27.8777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5241, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8844677 KL Loss: 14.2013975 DSM Loss: 17.9216951 Overall Loss:34.0075603
Validation loss decreased (10.207090 --> 9.969118).  Saving model ...
Updating learning rate to 3.125e-05
tensor(45.8795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8928774 KL Loss: 14.2225809 DSM Loss: 17.9986066 Overall Loss:34.1140648
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(26.7868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8628986 KL Loss: 14.2741041 DSM Loss: 17.6787708 Overall Loss:33.8157735
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(45.3277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8553953 KL Loss: 14.3162731 DSM Loss: 18.0412082 Overall Loss:34.2128764
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:17.782176971435547


Running on file AEP.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.2002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9830532 KL Loss: 14.3028862 DSM Loss: 25.7448092 Overall Loss:42.0307484
Validation loss decreased (inf --> 2.828977).  Saving model ...
Updating learning rate to 0.0005
tensor(41.4269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9330088 KL Loss: 14.2891363 DSM Loss: 18.9337122 Overall Loss:35.1558573
Validation loss decreased (2.828977 --> 2.491189).  Saving model ...
Updating learning rate to 0.00025
tensor(29.7567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0126, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9134575 KL Loss: 14.2535470 DSM Loss: 18.7790352 Overall Loss:34.9460399
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(32.4684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9097734 KL Loss: 14.3004236 DSM Loss: 18.3998241 Overall Loss:34.6100213
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(35.1648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9337683 KL Loss: 14.2942615 DSM Loss: 18.4385597 Overall Loss:34.6665896
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.4058408737182617
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(45.3714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9126, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8621823 KL Loss: 14.2236022 DSM Loss: 23.1207717 Overall Loss:39.2065560
Validation loss decreased (inf --> 2.737320).  Saving model ...
Updating learning rate to 0.0005
tensor(37.7711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8621, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8664577 KL Loss: 14.1860523 DSM Loss: 19.2621311 Overall Loss:35.3146411
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(45.4439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0904, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8880488 KL Loss: 14.2018188 DSM Loss: 18.8519492 Overall Loss:34.9418165
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(29.6557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8490354 KL Loss: 14.1708980 DSM Loss: 18.5394113 Overall Loss:34.5593445
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.6692111492156982
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(55.1250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9356734 KL Loss: 14.3028189 DSM Loss: 22.4879205 Overall Loss:38.7264128
Validation loss decreased (inf --> 2.835268).  Saving model ...
Updating learning rate to 0.0005
tensor(31.8521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9744711 KL Loss: 14.3522035 DSM Loss: 20.2335013 Overall Loss:36.5601757
Validation loss decreased (2.835268 --> 2.553479).  Saving model ...
Updating learning rate to 0.00025
tensor(39.7715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8667747 KL Loss: 14.2169245 DSM Loss: 19.2583424 Overall Loss:35.3420415
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(36.4382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8867802 KL Loss: 14.2766400 DSM Loss: 18.3719843 Overall Loss:34.5354045
Validation loss decreased (2.553479 --> 2.538108).  Saving model ...
Updating learning rate to 6.25e-05
tensor(36.5434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8736377 KL Loss: 14.2329432 DSM Loss: 18.4460785 Overall Loss:34.5526593
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(33.1271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6755, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8658917 KL Loss: 14.2231797 DSM Loss: 18.3800379 Overall Loss:34.4691093
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(41.0490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8681045 KL Loss: 14.3009573 DSM Loss: 17.9666471 Overall Loss:34.1357088
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.4458398818969727
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.5709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8989067 KL Loss: 14.2806841 DSM Loss: 23.8285168 Overall Loss:40.0081075
Validation loss decreased (inf --> 3.154651).  Saving model ...
Updating learning rate to 0.0005
tensor(38.2100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9219116 KL Loss: 14.3290882 DSM Loss: 19.6888918 Overall Loss:35.9398916
Validation loss decreased (3.154651 --> 2.742696).  Saving model ...
Updating learning rate to 0.00025
tensor(33.6931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8730856 KL Loss: 14.2464311 DSM Loss: 18.6968870 Overall Loss:34.8164036
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(31.9674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8915116 KL Loss: 14.3750682 DSM Loss: 18.4679584 Overall Loss:34.7345382
Validation loss decreased (2.742696 --> 2.586423).  Saving model ...
Updating learning rate to 6.25e-05
tensor(34.1794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8840605 KL Loss: 14.2804492 DSM Loss: 18.3129605 Overall Loss:34.4774701
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(37.9417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8692091 KL Loss: 14.2708571 DSM Loss: 18.1281994 Overall Loss:34.2682654
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(36.7855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8722393 KL Loss: 14.2643984 DSM Loss: 18.3100407 Overall Loss:34.4466783
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.5042569637298584
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(62.8490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9720443 KL Loss: 14.3172506 DSM Loss: 22.2465186 Overall Loss:38.5358137
Validation loss decreased (inf --> 2.460225).  Saving model ...
Updating learning rate to 0.0005
tensor(36.8317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9191760 KL Loss: 14.1914500 DSM Loss: 19.7965556 Overall Loss:35.9071819
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(37.1123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9103308 KL Loss: 14.2938464 DSM Loss: 18.8187203 Overall Loss:35.0228977
Validation loss decreased (2.460225 --> 2.406427).  Saving model ...
Updating learning rate to 0.000125
tensor(31.7806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1563, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8792658 KL Loss: 14.2133085 DSM Loss: 18.8164001 Overall Loss:34.9089743
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(34.9646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8938697 KL Loss: 14.4129313 DSM Loss: 18.2381357 Overall Loss:34.5449368
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(30.5017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8745192 KL Loss: 14.2341950 DSM Loss: 18.2203764 Overall Loss:34.3290908
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.284227132797241


Running on file AMGN.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.3930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 2.0075511 KL Loss: 14.3460670 DSM Loss: 22.8072130 Overall Loss:39.1608309
Validation loss decreased (inf --> 2.109843).  Saving model ...
Updating learning rate to 0.0005
tensor(34.2569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9258772 KL Loss: 14.3722830 DSM Loss: 19.6210167 Overall Loss:35.9191768
Validation loss decreased (2.109843 --> 1.628274).  Saving model ...
Updating learning rate to 0.00025
tensor(33.9613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9105373 KL Loss: 14.3156434 DSM Loss: 19.0407991 Overall Loss:35.2669798
Validation loss decreased (1.628274 --> 1.416591).  Saving model ...
Updating learning rate to 0.000125
tensor(32.7889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9487431 KL Loss: 14.3718373 DSM Loss: 18.4994178 Overall Loss:34.8199982
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(32.7204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9666285 KL Loss: 14.4740271 DSM Loss: 18.4169307 Overall Loss:34.8575862
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(35.9040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9258938 KL Loss: 14.4045826 DSM Loss: 18.2222418 Overall Loss:34.5527182
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.6634321212768555
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.0143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8825978 KL Loss: 14.3138017 DSM Loss: 23.3351903 Overall Loss:39.5315898
Validation loss decreased (inf --> 1.511840).  Saving model ...
Updating learning rate to 0.0005
tensor(38.4153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9186473 KL Loss: 14.3411019 DSM Loss: 19.7283871 Overall Loss:35.9881366
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(38.6471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9151306 KL Loss: 14.3177950 DSM Loss: 18.8313661 Overall Loss:35.0642916
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(31.5639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4242, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8724786 KL Loss: 14.2783208 DSM Loss: 19.0026034 Overall Loss:35.1534027
Validation loss decreased (1.511840 --> 1.427528).  Saving model ...
Updating learning rate to 6.25e-05
tensor(34.8871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2088, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8516377 KL Loss: 14.2134766 DSM Loss: 18.5071263 Overall Loss:34.5722409
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(43.5564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8784766 KL Loss: 14.3000216 DSM Loss: 18.3356202 Overall Loss:34.5141185
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(34.2879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8626476 KL Loss: 14.2700508 DSM Loss: 18.4814311 Overall Loss:34.6141292
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.6727728843688965
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(41.4587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8966015 KL Loss: 14.3726019 DSM Loss: 22.0944765 Overall Loss:38.3636798
Validation loss decreased (inf --> 1.385581).  Saving model ...
Updating learning rate to 0.0005
tensor(33.6375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9118588 KL Loss: 14.2814012 DSM Loss: 19.3846738 Overall Loss:35.5779337
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(37.6229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8832952 KL Loss: 14.1618515 DSM Loss: 18.9168330 Overall Loss:34.9619800
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(32.0013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8791479 KL Loss: 14.1836143 DSM Loss: 18.6667629 Overall Loss:34.7295252
Validation loss decreased (1.385581 --> 1.377150).  Saving model ...
Updating learning rate to 6.25e-05
tensor(33.0302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8964501 KL Loss: 14.2838048 DSM Loss: 18.7256136 Overall Loss:34.9058684
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(42.1833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7649, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8890033 KL Loss: 14.2587390 DSM Loss: 18.5107556 Overall Loss:34.6584981
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(31.3989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8782042 KL Loss: 14.3134195 DSM Loss: 18.2901794 Overall Loss:34.4818031
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.584244251251221
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(59.7047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9045046 KL Loss: 14.2527862 DSM Loss: 23.1696234 Overall Loss:39.3269142
Validation loss decreased (inf --> 1.601346).  Saving model ...
Updating learning rate to 0.0005
tensor(33.4497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6336, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9219743 KL Loss: 14.2876074 DSM Loss: 19.8357540 Overall Loss:36.0453359
Validation loss decreased (1.601346 --> 1.490384).  Saving model ...
Updating learning rate to 0.00025
tensor(36.3926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8736253 KL Loss: 14.1139412 DSM Loss: 18.9363698 Overall Loss:34.9239362
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(36.5997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8987850 KL Loss: 14.2017454 DSM Loss: 18.5614420 Overall Loss:34.6619721
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(45.3952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9049139 KL Loss: 14.3394706 DSM Loss: 18.3799343 Overall Loss:34.6243188
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.753698348999023
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.2402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9285670 KL Loss: 14.4097519 DSM Loss: 22.7184709 Overall Loss:39.0567897
Validation loss decreased (inf --> 1.785372).  Saving model ...
Updating learning rate to 0.0005
tensor(34.9322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8854273 KL Loss: 14.2274788 DSM Loss: 19.5326478 Overall Loss:35.6455534
Validation loss decreased (1.785372 --> 1.703962).  Saving model ...
Updating learning rate to 0.00025
tensor(38.0423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8890926 KL Loss: 14.1925057 DSM Loss: 18.8269958 Overall Loss:34.9085941
Validation loss decreased (1.703962 --> 1.321418).  Saving model ...
Updating learning rate to 0.000125
tensor(32.0377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8710922 KL Loss: 14.1600197 DSM Loss: 18.7887239 Overall Loss:34.8198357
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(42.1239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8754164 KL Loss: 14.2827540 DSM Loss: 18.5166924 Overall Loss:34.6748626
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(34.0059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5003, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8540262 KL Loss: 14.2163701 DSM Loss: 18.6487486 Overall Loss:34.7191448
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.339121341705322


Running on file AMZN.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.6610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9136753 KL Loss: 14.2792944 DSM Loss: 22.2920598 Overall Loss:38.4850294
Validation loss decreased (inf --> 2.654850).  Saving model ...
Updating learning rate to 0.0005
tensor(39.0993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8665343 KL Loss: 14.1937014 DSM Loss: 19.1664865 Overall Loss:35.2267224
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(34.5196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7515, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9253192 KL Loss: 14.3080149 DSM Loss: 19.0324711 Overall Loss:35.2658055
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(34.9747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9324430 KL Loss: 14.3484814 DSM Loss: 18.4559081 Overall Loss:34.7368323
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.47209909558296204
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.0153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9389554 KL Loss: 14.3146618 DSM Loss: 21.9378827 Overall Loss:38.1915000
Validation loss decreased (inf --> 2.820956).  Saving model ...
Updating learning rate to 0.0005
tensor(31.6844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8973410 KL Loss: 14.2547227 DSM Loss: 19.3397983 Overall Loss:35.4918619
Validation loss decreased (2.820956 --> 2.425983).  Saving model ...
Updating learning rate to 0.00025
tensor(33.3731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8922919 KL Loss: 14.2231514 DSM Loss: 18.6524690 Overall Loss:34.7679122
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(42.8448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9082431 KL Loss: 14.3170127 DSM Loss: 18.4631647 Overall Loss:34.6884205
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(31.2568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8594041 KL Loss: 14.1758412 DSM Loss: 18.0498664 Overall Loss:34.0851117
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4090173542499542
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(64.1190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1843, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9443013 KL Loss: 14.2901705 DSM Loss: 21.7116422 Overall Loss:37.9461140
Validation loss decreased (inf --> 2.358994).  Saving model ...
Updating learning rate to 0.0005
tensor(28.0363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9096013 KL Loss: 14.2624400 DSM Loss: 19.5947090 Overall Loss:35.7667504
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.7379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8855447 KL Loss: 14.2652011 DSM Loss: 18.9037132 Overall Loss:35.0544591
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(29.5663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9149836 KL Loss: 14.3206141 DSM Loss: 18.4311622 Overall Loss:34.6667596
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.40180516242980957
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(59.1996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8848971 KL Loss: 14.2401103 DSM Loss: 23.3245519 Overall Loss:39.4495591
Validation loss decreased (inf --> 2.667785).  Saving model ...
Updating learning rate to 0.0005
tensor(39.4088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8971414 KL Loss: 14.1322768 DSM Loss: 19.5114324 Overall Loss:35.5408504
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(35.7354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8755545 KL Loss: 14.2347588 DSM Loss: 18.9801361 Overall Loss:35.0904493
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(27.7410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9046250 KL Loss: 14.3686962 DSM Loss: 18.4995514 Overall Loss:34.7728725
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.662358820438385
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.6939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8751099 KL Loss: 14.2559715 DSM Loss: 26.0315301 Overall Loss:42.1626115
Validation loss decreased (inf --> 2.631984).  Saving model ...
Updating learning rate to 0.0005
tensor(25.5500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8762127 KL Loss: 14.1502603 DSM Loss: 19.7098467 Overall Loss:35.7363199
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(39.7925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9427340 KL Loss: 14.4432210 DSM Loss: 18.7088648 Overall Loss:35.0948197
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(30.4770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8896832 KL Loss: 14.2467580 DSM Loss: 18.5118629 Overall Loss:34.6483041
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4579997956752777


Running on file BA.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.2401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7000, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8783947 KL Loss: 14.3270327 DSM Loss: 23.1732904 Overall Loss:39.3787176
Validation loss decreased (inf --> 0.309450).  Saving model ...
Updating learning rate to 0.0005
tensor(37.2896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9037964 KL Loss: 14.1693998 DSM Loss: 20.1441097 Overall Loss:36.2173059
Validation loss decreased (0.309450 --> 0.179589).  Saving model ...
Updating learning rate to 0.00025
tensor(33.7648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9409151 KL Loss: 14.2570066 DSM Loss: 19.1995037 Overall Loss:35.3974251
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(35.9946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6384, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8652399 KL Loss: 14.0932596 DSM Loss: 18.8672508 Overall Loss:34.8257502
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(32.2056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8659691 KL Loss: 14.1529202 DSM Loss: 18.6545039 Overall Loss:34.6733930
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.38818302750587463
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.3959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9223729 KL Loss: 14.2789105 DSM Loss: 22.3502195 Overall Loss:38.5515028
Validation loss decreased (inf --> 0.212427).  Saving model ...
Updating learning rate to 0.0005
tensor(32.5339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8959461 KL Loss: 14.2961800 DSM Loss: 19.6307952 Overall Loss:35.8229212
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(40.6593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8977064 KL Loss: 14.2896320 DSM Loss: 19.4951442 Overall Loss:35.6824826
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(34.5423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8469167 KL Loss: 14.1720631 DSM Loss: 18.9015667 Overall Loss:34.9205465
Validation loss decreased (0.212427 --> 0.192718).  Saving model ...
Updating learning rate to 6.25e-05
tensor(30.6766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8892145 KL Loss: 14.2730923 DSM Loss: 18.6023125 Overall Loss:34.7646194
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(34.2600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8502276 KL Loss: 14.2262366 DSM Loss: 18.5961167 Overall Loss:34.6725810
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(32.3155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8816067 KL Loss: 14.2584969 DSM Loss: 18.6020113 Overall Loss:34.7421149
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.43650341033935547
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.2401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8777853 KL Loss: 14.3134431 DSM Loss: 24.7786939 Overall Loss:40.9699226
Validation loss decreased (inf --> 0.201290).  Saving model ...
Updating learning rate to 0.0005
tensor(38.9946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.8095, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8917897 KL Loss: 14.2327505 DSM Loss: 20.1718681 Overall Loss:36.2964081
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(42.4964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8836433 KL Loss: 14.1815368 DSM Loss: 19.4835650 Overall Loss:35.5487448
Validation loss decreased (0.201290 --> 0.159314).  Saving model ...
Updating learning rate to 0.000125
tensor(30.3944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8663661 KL Loss: 14.1977497 DSM Loss: 18.7827180 Overall Loss:34.8468339
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(34.7648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8975490 KL Loss: 14.2991241 DSM Loss: 18.9364653 Overall Loss:35.1331382
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(30.3054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8696581 KL Loss: 14.2927929 DSM Loss: 18.6471072 Overall Loss:34.8095579
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.3564445376396179
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(47.4311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8936936 KL Loss: 14.3467606 DSM Loss: 23.2032328 Overall Loss:39.4436870
Validation loss decreased (inf --> 0.138283).  Saving model ...
Updating learning rate to 0.0005
tensor(31.9783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9352617 KL Loss: 14.3824437 DSM Loss: 19.5819918 Overall Loss:35.8996970
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(34.5984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9001721 KL Loss: 14.2273176 DSM Loss: 19.1441342 Overall Loss:35.2716240
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(33.2511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9025426 KL Loss: 14.3211287 DSM Loss: 18.7910417 Overall Loss:35.0147130
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.3521605134010315
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(59.1857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6149, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8885453 KL Loss: 14.1834159 DSM Loss: 23.2161129 Overall Loss:39.2880741
Validation loss decreased (inf --> 0.237593).  Saving model ...
Updating learning rate to 0.0005
tensor(32.9502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9560569 KL Loss: 14.3597770 DSM Loss: 19.7274312 Overall Loss:36.0432649
Validation loss decreased (0.237593 --> 0.190134).  Saving model ...
Updating learning rate to 0.00025
tensor(43.5447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9153876 KL Loss: 14.2363290 DSM Loss: 19.2682296 Overall Loss:35.4199460
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(38.1428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8647657 KL Loss: 14.2159408 DSM Loss: 18.9819960 Overall Loss:35.0627024
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(35.9622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8823236 KL Loss: 14.2396121 DSM Loss: 18.8322436 Overall Loss:34.9541792
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4187195301055908


Running on file BAC.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(47.3026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5244, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9313129 KL Loss: 14.3793720 DSM Loss: 21.8888945 Overall Loss:38.1995794
Validation loss decreased (inf --> 7.501516).  Saving model ...
Updating learning rate to 0.0005
tensor(33.7416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8775243 KL Loss: 14.3126165 DSM Loss: 19.1099844 Overall Loss:35.3001253
Validation loss decreased (7.501516 --> 6.789182).  Saving model ...
Updating learning rate to 0.00025
tensor(41.8676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9006505 KL Loss: 14.3583787 DSM Loss: 18.2863046 Overall Loss:34.5453338
Validation loss decreased (6.789182 --> 6.552642).  Saving model ...
Updating learning rate to 0.000125
tensor(28.6692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9090366 KL Loss: 14.3085641 DSM Loss: 17.9404574 Overall Loss:34.1580580
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(39.3596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8872639 KL Loss: 14.1968025 DSM Loss: 17.6378288 Overall Loss:33.7218951
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(48.1280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8767377 KL Loss: 14.2251800 DSM Loss: 17.5259539 Overall Loss:33.6278715
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9529378414154053
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.0417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8904704 KL Loss: 14.2922076 DSM Loss: 23.4946628 Overall Loss:39.6773411
Validation loss decreased (inf --> 7.238132).  Saving model ...
Updating learning rate to 0.0005
tensor(31.4296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8542773 KL Loss: 14.2209754 DSM Loss: 18.8320934 Overall Loss:34.9073462
Validation loss decreased (7.238132 --> 6.643893).  Saving model ...
Updating learning rate to 0.00025
tensor(50.3738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8757505 KL Loss: 14.1139594 DSM Loss: 18.4844794 Overall Loss:34.4741892
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(34.2869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8739812 KL Loss: 14.2283506 DSM Loss: 18.0710035 Overall Loss:34.1733352
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(34.4102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5382, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8474264 KL Loss: 14.1373019 DSM Loss: 17.9752389 Overall Loss:33.9599672
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.0109878778457642
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(75.9592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9468263 KL Loss: 14.3083061 DSM Loss: 22.6154909 Overall Loss:38.8706231
Validation loss decreased (inf --> 6.239888).  Saving model ...
Updating learning rate to 0.0005
tensor(29.5650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 2.0039302 KL Loss: 14.2529222 DSM Loss: 18.8721487 Overall Loss:35.1290011
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(31.4396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8927918 KL Loss: 14.2049525 DSM Loss: 18.1328837 Overall Loss:34.2306278
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(31.7717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8512032 KL Loss: 14.1703949 DSM Loss: 18.1434373 Overall Loss:34.1650352
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.857261598110199
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.3076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9141547 KL Loss: 14.3394205 DSM Loss: 20.5845722 Overall Loss:36.8381475
Validation loss decreased (inf --> 6.939475).  Saving model ...
Updating learning rate to 0.0005
tensor(40.0154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9567878 KL Loss: 14.3314923 DSM Loss: 18.8628469 Overall Loss:35.1511270
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(40.2505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9465645 KL Loss: 14.4044576 DSM Loss: 17.9968805 Overall Loss:34.3479025
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(45.2087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9380294 KL Loss: 14.3835639 DSM Loss: 17.8571190 Overall Loss:34.1787122
Validation loss decreased (6.939475 --> 6.024010).  Saving model ...
Updating learning rate to 6.25e-05
tensor(46.6972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9538481 KL Loss: 14.4477421 DSM Loss: 17.6819469 Overall Loss:34.0835370
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(48.5520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9265414 KL Loss: 14.4924373 DSM Loss: 17.9392098 Overall Loss:34.3581885
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(49.9415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9468735 KL Loss: 14.5620602 DSM Loss: 17.6399823 Overall Loss:34.1489160
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.8001992702484131
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.3849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9081994 KL Loss: 14.4257230 DSM Loss: 23.3893567 Overall Loss:39.7232789
Validation loss decreased (inf --> 6.737933).  Saving model ...
Updating learning rate to 0.0005
tensor(35.9344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.6821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8974133 KL Loss: 14.2769391 DSM Loss: 19.2233142 Overall Loss:35.3976665
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(39.8120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8765664 KL Loss: 14.2400344 DSM Loss: 18.4931657 Overall Loss:34.6097666
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(38.8733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8768266 KL Loss: 14.2680817 DSM Loss: 17.9389678 Overall Loss:34.0838761
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.038446068763733


Running on file BCH.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.2867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1573, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9528069 KL Loss: 14.3343608 DSM Loss: 23.7587765 Overall Loss:40.0459443
Validation loss decreased (inf --> 1.457114).  Saving model ...
Updating learning rate to 0.0005
tensor(34.6866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9751613 KL Loss: 14.4370930 DSM Loss: 19.4027707 Overall Loss:35.8150249
Validation loss decreased (1.457114 --> 0.769108).  Saving model ...
Updating learning rate to 0.00025
tensor(31.2403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9467099 KL Loss: 14.3748560 DSM Loss: 19.1538206 Overall Loss:35.4753865
Validation loss decreased (0.769108 --> 0.655538).  Saving model ...
Updating learning rate to 0.000125
tensor(35.7505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3964, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8783586 KL Loss: 14.2133274 DSM Loss: 18.8092903 Overall Loss:34.9009762
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(36.2133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8697558 KL Loss: 14.2589447 DSM Loss: 18.6761310 Overall Loss:34.8048312
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(33.6261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8766548 KL Loss: 14.2343632 DSM Loss: 18.5826078 Overall Loss:34.6936257
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.25879696011543274
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(61.8519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2406, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9460540 KL Loss: 14.3193984 DSM Loss: 22.0357216 Overall Loss:38.3011739
Validation loss decreased (inf --> 0.810337).  Saving model ...
Updating learning rate to 0.0005
tensor(38.8648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9094254 KL Loss: 14.2447233 DSM Loss: 19.4398127 Overall Loss:35.5939613
Validation loss decreased (0.810337 --> 0.631191).  Saving model ...
Updating learning rate to 0.00025
tensor(34.5561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2099, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8648605 KL Loss: 14.1491318 DSM Loss: 19.2715071 Overall Loss:35.2854997
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(29.9487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8631024 KL Loss: 14.2496501 DSM Loss: 18.7575319 Overall Loss:34.8702844
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(36.8636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8813177 KL Loss: 14.2990354 DSM Loss: 18.5032553 Overall Loss:34.6836084
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.2550182640552521
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(59.9152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9470326 KL Loss: 14.2725066 DSM Loss: 22.1022436 Overall Loss:38.3217826
Validation loss decreased (inf --> 0.867826).  Saving model ...
Updating learning rate to 0.0005
tensor(26.5582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9358360 KL Loss: 14.2618399 DSM Loss: 19.8755123 Overall Loss:36.0731883
Validation loss decreased (0.867826 --> 0.455257).  Saving model ...
Updating learning rate to 0.00025
tensor(39.6727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9453, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8944667 KL Loss: 14.2410120 DSM Loss: 18.7763463 Overall Loss:34.9118251
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(31.1499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0681, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9018612 KL Loss: 14.3145924 DSM Loss: 18.7320340 Overall Loss:34.9484880
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(41.9502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8977506 KL Loss: 14.3260104 DSM Loss: 18.3108506 Overall Loss:34.5346115
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.26354947686195374
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(45.7880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5182, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9063635 KL Loss: 14.2173018 DSM Loss: 25.1910429 Overall Loss:41.3147083
Validation loss decreased (inf --> 0.547180).  Saving model ...
Updating learning rate to 0.0005
tensor(30.4408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9215533 KL Loss: 14.2406567 DSM Loss: 20.3564295 Overall Loss:36.5186393
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(37.4651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9111896 KL Loss: 14.2679895 DSM Loss: 19.0511977 Overall Loss:35.2303770
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(30.3531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8500097 KL Loss: 14.0658535 DSM Loss: 18.8742536 Overall Loss:34.7901167
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.1788136512041092
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.0768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8115, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8946187 KL Loss: 14.2406551 DSM Loss: 22.2397542 Overall Loss:38.3750280
Validation loss decreased (inf --> 0.494408).  Saving model ...
Updating learning rate to 0.0005
tensor(40.0647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8835590 KL Loss: 14.2508774 DSM Loss: 19.5896614 Overall Loss:35.7240976
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(34.1250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8769381 KL Loss: 14.1957870 DSM Loss: 18.8510261 Overall Loss:34.9237511
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(37.7052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8877042 KL Loss: 14.3317878 DSM Loss: 18.9086348 Overall Loss:35.1281268
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.2728751301765442


Running on file BHP.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.6863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8422122 KL Loss: 14.1608954 DSM Loss: 22.1134922 Overall Loss:38.1165996
Validation loss decreased (inf --> 1.821622).  Saving model ...
Updating learning rate to 0.0005
tensor(21.6150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1179, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8672558 KL Loss: 14.1433912 DSM Loss: 18.5001305 Overall Loss:34.5107776
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(35.7790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.0866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8748580 KL Loss: 14.2174365 DSM Loss: 18.2176987 Overall Loss:34.3099933
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(27.4797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8636, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8743963 KL Loss: 14.3152617 DSM Loss: 17.4291989 Overall Loss:33.6188571
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.9893486499786377
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(55.3498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9112520 KL Loss: 14.1965148 DSM Loss: 22.7385689 Overall Loss:38.8463357
Validation loss decreased (inf --> 2.274573).  Saving model ...
Updating learning rate to 0.0005
tensor(38.6201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9400861 KL Loss: 14.2995385 DSM Loss: 18.7676012 Overall Loss:35.0072257
Validation loss decreased (2.274573 --> 1.806900).  Saving model ...
Updating learning rate to 0.00025
tensor(38.2948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9189973 KL Loss: 14.5187109 DSM Loss: 18.2893394 Overall Loss:34.7270477
Validation loss decreased (1.806900 --> 1.770164).  Saving model ...
Updating learning rate to 0.000125
tensor(21.1814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9191636 KL Loss: 14.5865789 DSM Loss: 17.9972157 Overall Loss:34.5029582
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(32.8185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0200, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9358194 KL Loss: 14.5912395 DSM Loss: 17.7845166 Overall Loss:34.3115755
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(43.5707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8864, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9039700 KL Loss: 14.5420094 DSM Loss: 17.6718363 Overall Loss:34.1178156
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.889972448348999
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.7508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9011977 KL Loss: 14.2374995 DSM Loss: 21.9571441 Overall Loss:38.0958414
Validation loss decreased (inf --> 1.635036).  Saving model ...
Updating learning rate to 0.0005
tensor(35.7432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.6238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9166521 KL Loss: 14.1897963 DSM Loss: 18.7545835 Overall Loss:34.8610317
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(49.0664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9291669 KL Loss: 14.3251578 DSM Loss: 17.9983207 Overall Loss:34.2526453
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(50.5636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9105083 KL Loss: 14.2634237 DSM Loss: 17.7604661 Overall Loss:33.9343984
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.7516818046569824
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(40.4939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0594, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9697624 KL Loss: 14.3038576 DSM Loss: 20.9679444 Overall Loss:37.2415644
Validation loss decreased (inf --> 1.804639).  Saving model ...
Updating learning rate to 0.0005
tensor(33.5981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9415850 KL Loss: 14.3227532 DSM Loss: 18.3980023 Overall Loss:34.6623404
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(24.4897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8718727 KL Loss: 14.1819026 DSM Loss: 18.3063605 Overall Loss:34.3601358
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(24.1163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9089962 KL Loss: 14.3000644 DSM Loss: 17.6635792 Overall Loss:33.8726397
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.96510648727417
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(63.5689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9013037 KL Loss: 14.2055289 DSM Loss: 24.2225124 Overall Loss:40.3293451
Validation loss decreased (inf --> 2.493114).  Saving model ...
Updating learning rate to 0.0005
tensor(51.4166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8996001 KL Loss: 14.2394548 DSM Loss: 18.8365520 Overall Loss:34.9756071
Validation loss decreased (2.493114 --> 1.750521).  Saving model ...
Updating learning rate to 0.00025
tensor(38.2630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9190133 KL Loss: 14.3386782 DSM Loss: 17.8000170 Overall Loss:34.0577087
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(31.2519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8943871 KL Loss: 14.1878839 DSM Loss: 18.0623439 Overall Loss:34.1446149
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(30.6715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8558153 KL Loss: 14.1825772 DSM Loss: 17.7475820 Overall Loss:33.7859742
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.893702745437622


Running on file BP.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(55.2692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9231413 KL Loss: 14.3132751 DSM Loss: 24.0290583 Overall Loss:40.2654747
Validation loss decreased (inf --> 0.195906).  Saving model ...
Updating learning rate to 0.0005
tensor(33.5062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8869526 KL Loss: 14.1887232 DSM Loss: 19.5912787 Overall Loss:35.6669547
Validation loss decreased (0.195906 --> 0.183386).  Saving model ...
Updating learning rate to 0.00025
tensor(28.5170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9383166 KL Loss: 14.3322365 DSM Loss: 19.1343969 Overall Loss:35.4049500
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(34.8106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8428537 KL Loss: 14.1679347 DSM Loss: 18.8002259 Overall Loss:34.8110145
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(34.4027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8617611 KL Loss: 14.2455196 DSM Loss: 18.7953123 Overall Loss:34.9025932
Validation loss decreased (0.183386 --> 0.172213).  Saving model ...
Updating learning rate to 3.125e-05
tensor(32.6110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4448, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8923586 KL Loss: 14.2281422 DSM Loss: 18.7877839 Overall Loss:34.9082847
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(29.3140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8415912 KL Loss: 14.1100517 DSM Loss: 18.7402769 Overall Loss:34.6919197
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(37.2975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1388, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8495680 KL Loss: 14.1948034 DSM Loss: 18.3577926 Overall Loss:34.4021639
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.5460612773895264
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.6257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9191734 KL Loss: 14.2532858 DSM Loss: 23.4313241 Overall Loss:39.6037831
Validation loss decreased (inf --> 0.176792).  Saving model ...
Updating learning rate to 0.0005
tensor(32.5566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0957, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9439509 KL Loss: 14.2766297 DSM Loss: 20.7228792 Overall Loss:36.9434598
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(39.6333, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8618958 KL Loss: 14.1474150 DSM Loss: 19.1968087 Overall Loss:35.2061196
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(40.4653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3835, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9224506 KL Loss: 14.2854387 DSM Loss: 18.9235996 Overall Loss:35.1314886
Validation loss decreased (0.176792 --> 0.170400).  Saving model ...
Updating learning rate to 6.25e-05
tensor(42.3846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8774616 KL Loss: 14.2186325 DSM Loss: 18.8158507 Overall Loss:34.9119446
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(40.5885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8534058 KL Loss: 14.2073052 DSM Loss: 18.5094103 Overall Loss:34.5701215
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(27.5867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8589812 KL Loss: 14.1802445 DSM Loss: 18.4974134 Overall Loss:34.5366391
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.51259708404541
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.7195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9097632 KL Loss: 14.3079426 DSM Loss: 23.3576476 Overall Loss:39.5753531
Validation loss decreased (inf --> 0.185391).  Saving model ...
Updating learning rate to 0.0005
tensor(37.9856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8937899 KL Loss: 14.2385343 DSM Loss: 20.1221189 Overall Loss:36.2544431
Validation loss decreased (0.185391 --> 0.177030).  Saving model ...
Updating learning rate to 0.00025
tensor(37.8822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9181547 KL Loss: 14.2801242 DSM Loss: 19.0959663 Overall Loss:35.2942451
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(45.2064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8854246 KL Loss: 14.2466402 DSM Loss: 18.9063792 Overall Loss:35.0384440
Validation loss decreased (0.177030 --> 0.172706).  Saving model ...
Updating learning rate to 6.25e-05
tensor(35.0209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.1262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8766889 KL Loss: 14.2722829 DSM Loss: 18.9494876 Overall Loss:35.0984597
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(40.8009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8897171 KL Loss: 14.2694768 DSM Loss: 18.8617348 Overall Loss:35.0209290
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(38.7888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3910, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8886640 KL Loss: 14.3361885 DSM Loss: 18.6240069 Overall Loss:34.8488595
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.5004265308380127
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.0837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9079768 KL Loss: 14.2895879 DSM Loss: 23.3391512 Overall Loss:39.5367156
Validation loss decreased (inf --> 0.207857).  Saving model ...
Updating learning rate to 0.0005
tensor(36.8861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9283167 KL Loss: 14.3255547 DSM Loss: 20.0797993 Overall Loss:36.3336709
Validation loss decreased (0.207857 --> 0.174882).  Saving model ...
Updating learning rate to 0.00025
tensor(35.1091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9086451 KL Loss: 14.3298952 DSM Loss: 19.3325532 Overall Loss:35.5710935
Validation loss decreased (0.174882 --> 0.174246).  Saving model ...
Updating learning rate to 0.000125
tensor(34.1255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8933557 KL Loss: 14.2417876 DSM Loss: 19.0870074 Overall Loss:35.2221508
Validation loss decreased (0.174246 --> 0.173819).  Saving model ...
Updating learning rate to 6.25e-05
tensor(33.4686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8864765 KL Loss: 14.2359391 DSM Loss: 19.0539092 Overall Loss:35.1763246
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(35.7807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8753617 KL Loss: 14.2619295 DSM Loss: 18.7813620 Overall Loss:34.9186530
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(34.0247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3358, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8806768 KL Loss: 14.2366743 DSM Loss: 18.7654559 Overall Loss:34.8828067
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.345977544784546
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(59.6803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9086599 KL Loss: 14.2456341 DSM Loss: 23.1372676 Overall Loss:39.2915613
Validation loss decreased (inf --> 0.261420).  Saving model ...
Updating learning rate to 0.0005
tensor(28.6590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9297876 KL Loss: 14.2915384 DSM Loss: 19.8385384 Overall Loss:36.0598644
Validation loss decreased (0.261420 --> 0.185869).  Saving model ...
Updating learning rate to 0.00025
tensor(36.2486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9196627 KL Loss: 14.3176262 DSM Loss: 19.0669217 Overall Loss:35.3042107
Validation loss decreased (0.185869 --> 0.170063).  Saving model ...
Updating learning rate to 0.000125
tensor(32.0527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5720, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9218523 KL Loss: 14.3608206 DSM Loss: 18.9376413 Overall Loss:35.2203142
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(31.7683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9030051 KL Loss: 14.4034144 DSM Loss: 18.9338066 Overall Loss:35.2402261
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(44.5007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8832711 KL Loss: 14.2855788 DSM Loss: 18.8435088 Overall Loss:35.0123587
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.421347141265869


Running on file BRK-A.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.6986, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9072944 KL Loss: 14.3401575 DSM Loss: 22.2855134 Overall Loss:38.5329654
Validation loss decreased (inf --> 11.436935).  Saving model ...
Updating learning rate to 0.0005
tensor(31.9007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8994867 KL Loss: 14.2206764 DSM Loss: 18.5143466 Overall Loss:34.6345098
Validation loss decreased (11.436935 --> 9.043554).  Saving model ...
Updating learning rate to 0.00025
tensor(51.2079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8665162 KL Loss: 14.1886104 DSM Loss: 18.1474823 Overall Loss:34.2026089
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(22.7138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8692099 KL Loss: 14.2254520 DSM Loss: 17.4280992 Overall Loss:33.5227610
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(32.8107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8782057 KL Loss: 14.1842288 DSM Loss: 17.4465703 Overall Loss:33.5090048
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:11.66279125213623
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.6431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8872799 KL Loss: 14.2945308 DSM Loss: 22.2575639 Overall Loss:38.4393744
Validation loss decreased (inf --> 10.199104).  Saving model ...
Updating learning rate to 0.0005
tensor(35.7072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8811406 KL Loss: 14.2589035 DSM Loss: 18.2768816 Overall Loss:34.4169259
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(29.4805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1092, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8558234 KL Loss: 14.2805695 DSM Loss: 18.0453378 Overall Loss:34.1817307
Validation loss decreased (10.199104 --> 9.345802).  Saving model ...
Updating learning rate to 0.000125
tensor(30.0500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8651011 KL Loss: 14.2313371 DSM Loss: 17.5867098 Overall Loss:33.6831480
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(26.0814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8834396 KL Loss: 14.2308390 DSM Loss: 17.7490603 Overall Loss:33.8633390
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(27.0104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8903832 KL Loss: 14.3769388 DSM Loss: 17.1320046 Overall Loss:33.3993265
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:11.953615188598633
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.2301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9470070 KL Loss: 14.2540670 DSM Loss: 21.0281862 Overall Loss:37.2292601
Validation loss decreased (inf --> 10.144718).  Saving model ...
Updating learning rate to 0.0005
tensor(31.4345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9187438 KL Loss: 14.2567870 DSM Loss: 18.3692532 Overall Loss:34.5447840
Validation loss decreased (10.144718 --> 9.929121).  Saving model ...
Updating learning rate to 0.00025
tensor(24.9911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1486, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8875463 KL Loss: 14.1659312 DSM Loss: 17.8701605 Overall Loss:33.9236378
Validation loss decreased (9.929121 --> 9.512749).  Saving model ...
Updating learning rate to 0.000125
tensor(44.8281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9112567 KL Loss: 14.3060929 DSM Loss: 17.4075134 Overall Loss:33.6248631
Validation loss decreased (9.512749 --> 9.483395).  Saving model ...
Updating learning rate to 6.25e-05
tensor(37.8622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7798, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9082617 KL Loss: 14.3302547 DSM Loss: 17.3835418 Overall Loss:33.6220584
Validation loss decreased (9.483395 --> 9.284245).  Saving model ...
Updating learning rate to 3.125e-05
tensor(41.4287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8697569 KL Loss: 14.3002270 DSM Loss: 17.5386176 Overall Loss:33.7086014
Validation loss decreased (9.284245 --> 9.216706).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(38.8791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8925647 KL Loss: 14.3004193 DSM Loss: 17.4535746 Overall Loss:33.6465585
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(33.1740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.9163412 KL Loss: 14.4676457 DSM Loss: 17.1880893 Overall Loss:33.5720761
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(39.1769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0229, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.9485069 KL Loss: 14.3941390 DSM Loss: 16.9522012 Overall Loss:33.2948470
Validation loss decreased (9.216706 --> 9.041425).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(25.2248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.9424769 KL Loss: 14.3944947 DSM Loss: 17.2868902 Overall Loss:33.6238619
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
tensor(36.0318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.2412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8854505 KL Loss: 14.3977090 DSM Loss: 17.3278559 Overall Loss:33.6110153
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
tensor(23.3474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5861, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.9394355 KL Loss: 14.4954514 DSM Loss: 17.1168349 Overall Loss:33.5517219
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:11.623146057128906
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.1007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9181220 KL Loss: 14.1542660 DSM Loss: 21.3126975 Overall Loss:37.3850855
Validation loss decreased (inf --> 9.667296).  Saving model ...
Updating learning rate to 0.0005
tensor(24.0913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9735, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9327911 KL Loss: 14.2367403 DSM Loss: 18.2714956 Overall Loss:34.4410269
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(36.4978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9110604 KL Loss: 14.2267469 DSM Loss: 17.7373559 Overall Loss:33.8751632
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(26.8672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8960926 KL Loss: 14.2626663 DSM Loss: 17.7497112 Overall Loss:33.9084702
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:12.342385292053223
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.4889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9272246 KL Loss: 14.3084719 DSM Loss: 23.6408368 Overall Loss:39.8765336
Validation loss decreased (inf --> 8.796456).  Saving model ...
Updating learning rate to 0.0005
tensor(30.3790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8933121 KL Loss: 14.2032724 DSM Loss: 18.2595518 Overall Loss:34.3561362
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(41.2792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8333610 KL Loss: 14.2199585 DSM Loss: 17.9188107 Overall Loss:33.9721302
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(30.9777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8709919 KL Loss: 14.2304425 DSM Loss: 17.7931916 Overall Loss:33.8946260
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:11.332006454467773


Running on file BSAC.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.4678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7857, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9420852 KL Loss: 14.3058241 DSM Loss: 23.8697163 Overall Loss:40.1176255
Validation loss decreased (inf --> 0.299704).  Saving model ...
Updating learning rate to 0.0005
tensor(38.9199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9082285 KL Loss: 14.2808430 DSM Loss: 19.4172937 Overall Loss:35.6063652
Validation loss decreased (0.299704 --> 0.198010).  Saving model ...
Updating learning rate to 0.00025
tensor(36.7301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8921978 KL Loss: 14.2213648 DSM Loss: 18.7190100 Overall Loss:34.8325728
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(37.9959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9011919 KL Loss: 14.3516096 DSM Loss: 18.5232746 Overall Loss:34.7760759
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(29.9009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8853328 KL Loss: 14.2566289 DSM Loss: 18.3017214 Overall Loss:34.4436831
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4346766471862793
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(45.7364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8006, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9058083 KL Loss: 14.2903386 DSM Loss: 22.9537293 Overall Loss:39.1498766
Validation loss decreased (inf --> 0.206426).  Saving model ...
Updating learning rate to 0.0005
tensor(33.0572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9447921 KL Loss: 14.2192226 DSM Loss: 19.8894609 Overall Loss:36.0534756
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(37.9664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9000, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8785012 KL Loss: 14.1389187 DSM Loss: 18.7180785 Overall Loss:34.7354986
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(33.8782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2344, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8830983 KL Loss: 14.1327133 DSM Loss: 18.6122952 Overall Loss:34.6281068
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4454454481601715
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(39.7804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8589852 KL Loss: 14.2266455 DSM Loss: 23.5186932 Overall Loss:39.6043238
Validation loss decreased (inf --> 0.212318).  Saving model ...
Updating learning rate to 0.0005
tensor(36.8789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9979017 KL Loss: 14.4848111 DSM Loss: 19.7005397 Overall Loss:36.1832525
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(42.7119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9396793 KL Loss: 14.3680837 DSM Loss: 18.9175486 Overall Loss:35.2253115
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(32.6039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9171406 KL Loss: 14.3529709 DSM Loss: 18.8593305 Overall Loss:35.1294421
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4536112844944
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.2127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9414725 KL Loss: 14.3475139 DSM Loss: 23.2746735 Overall Loss:39.5636598
Validation loss decreased (inf --> 0.262185).  Saving model ...
Updating learning rate to 0.0005
tensor(37.6117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9272169 KL Loss: 14.2384776 DSM Loss: 19.6732204 Overall Loss:35.8389145
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(36.5816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8680789 KL Loss: 14.2282600 DSM Loss: 18.7602455 Overall Loss:34.8565844
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(37.5451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8951155 KL Loss: 14.2250157 DSM Loss: 18.4508754 Overall Loss:34.5710063
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5256727337837219
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.0228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9298883 KL Loss: 14.2948986 DSM Loss: 24.4617536 Overall Loss:40.6865406
Validation loss decreased (inf --> 0.334618).  Saving model ...
Updating learning rate to 0.0005
tensor(32.1852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9734563 KL Loss: 14.3079708 DSM Loss: 20.3890447 Overall Loss:36.6704720
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(34.2700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9177754 KL Loss: 14.3299539 DSM Loss: 18.8555158 Overall Loss:35.1032449
Validation loss decreased (0.334618 --> 0.235750).  Saving model ...
Updating learning rate to 0.000125
tensor(34.4323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8708, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8754950 KL Loss: 14.2267678 DSM Loss: 18.6563045 Overall Loss:34.7585674
Validation loss decreased (0.235750 --> 0.215982).  Saving model ...
Updating learning rate to 6.25e-05
tensor(36.7941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8614129 KL Loss: 14.2511768 DSM Loss: 18.3678772 Overall Loss:34.4804671
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(33.9575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0594, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8356154 KL Loss: 14.2050555 DSM Loss: 18.3248742 Overall Loss:34.3655452
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(39.1775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8704571 KL Loss: 14.1965580 DSM Loss: 18.1530770 Overall Loss:34.2200919
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4597254991531372


Running on file BUD.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.2222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.0726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8846613 KL Loss: 14.2121414 DSM Loss: 23.7991348 Overall Loss:39.8959375
Validation loss decreased (inf --> 1.217660).  Saving model ...
Updating learning rate to 0.0005
tensor(30.3956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8955180 KL Loss: 14.2872231 DSM Loss: 20.3930998 Overall Loss:36.5758405
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(30.4914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9128675 KL Loss: 14.2727067 DSM Loss: 19.3227374 Overall Loss:35.5083115
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(27.2651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8869195 KL Loss: 14.3100544 DSM Loss: 19.2143287 Overall Loss:35.4113027
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.5444608926773071
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.9108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2391, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9018556 KL Loss: 14.2811299 DSM Loss: 23.6991478 Overall Loss:39.8821332
Validation loss decreased (inf --> 1.751680).  Saving model ...
Updating learning rate to 0.0005
tensor(33.1883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9052378 KL Loss: 14.2793837 DSM Loss: 19.7306128 Overall Loss:35.9152341
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(29.1980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8869049 KL Loss: 14.3003561 DSM Loss: 19.3475526 Overall Loss:35.5348138
Validation loss decreased (1.751680 --> 1.475936).  Saving model ...
Updating learning rate to 0.000125
tensor(32.9349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1797, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9065981 KL Loss: 14.3679633 DSM Loss: 19.4367537 Overall Loss:35.7113151
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(37.4693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9143362 KL Loss: 14.3845755 DSM Loss: 19.3183678 Overall Loss:35.6172794
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(48.0756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9788, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9411306 KL Loss: 14.4924007 DSM Loss: 18.7483191 Overall Loss:35.1818503
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.8297673463821411
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.2030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9617916 KL Loss: 14.3426006 DSM Loss: 22.5355925 Overall Loss:38.8399849
Validation loss decreased (inf --> 1.649551).  Saving model ...
Updating learning rate to 0.0005
tensor(41.0982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5126, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8815085 KL Loss: 14.1552539 DSM Loss: 20.1497882 Overall Loss:36.1865507
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(33.9876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8780560 KL Loss: 14.2991651 DSM Loss: 19.8045315 Overall Loss:35.9817524
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(27.8238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0419, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8833983 KL Loss: 14.2979605 DSM Loss: 19.3639020 Overall Loss:35.5452607
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.015540361404419
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(61.9404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9076980 KL Loss: 14.2946165 DSM Loss: 24.3886564 Overall Loss:40.5909709
Validation loss decreased (inf --> 1.701451).  Saving model ...
Updating learning rate to 0.0005
tensor(41.9845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9059208 KL Loss: 14.3073818 DSM Loss: 19.8007125 Overall Loss:36.0140150
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(35.9993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8879371 KL Loss: 14.2163380 DSM Loss: 19.3184176 Overall Loss:35.4226924
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(32.0848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8754187 KL Loss: 14.2110721 DSM Loss: 19.6834637 Overall Loss:35.7699545
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.0699172019958496
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.4994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8954490 KL Loss: 14.4088935 DSM Loss: 24.1940849 Overall Loss:40.4984273
Validation loss decreased (inf --> 2.134614).  Saving model ...
Updating learning rate to 0.0005
tensor(35.7605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8951381 KL Loss: 14.3440028 DSM Loss: 20.4699696 Overall Loss:36.7091105
Validation loss decreased (2.134614 --> 1.922336).  Saving model ...
Updating learning rate to 0.00025
tensor(38.5454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8757, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8845565 KL Loss: 14.2281693 DSM Loss: 19.4990380 Overall Loss:35.6117636
Validation loss decreased (1.922336 --> 1.739420).  Saving model ...
Updating learning rate to 0.000125
tensor(46.1742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8793570 KL Loss: 14.2682767 DSM Loss: 19.2682561 Overall Loss:35.4158898
Validation loss decreased (1.739420 --> 1.663479).  Saving model ...
Updating learning rate to 6.25e-05
tensor(39.2322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8775604 KL Loss: 14.3019823 DSM Loss: 18.9159018 Overall Loss:35.0954445
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(35.8756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8577184 KL Loss: 14.1556637 DSM Loss: 19.0560281 Overall Loss:35.0694101
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(40.7400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8837533 KL Loss: 14.3361339 DSM Loss: 18.9469805 Overall Loss:35.1668675
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.0338001251220703


Running on file C.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.2309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8890200 KL Loss: 14.2403445 DSM Loss: 23.5211544 Overall Loss:39.6505188
Validation loss decreased (inf --> 0.923016).  Saving model ...
Updating learning rate to 0.0005
tensor(31.0976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9432941 KL Loss: 14.3573447 DSM Loss: 19.4581307 Overall Loss:35.7587691
Validation loss decreased (0.923016 --> 0.821002).  Saving model ...
Updating learning rate to 0.00025
tensor(36.1203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8820586 KL Loss: 14.2037378 DSM Loss: 18.6988251 Overall Loss:34.7846216
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(28.2303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1514, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9024937 KL Loss: 14.3114512 DSM Loss: 18.4899639 Overall Loss:34.7039087
Validation loss decreased (0.821002 --> 0.799657).  Saving model ...
Updating learning rate to 6.25e-05
tensor(28.0994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8975996 KL Loss: 14.3086203 DSM Loss: 18.2397161 Overall Loss:34.4459361
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(34.4336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9191962 KL Loss: 14.3253046 DSM Loss: 18.0913828 Overall Loss:34.3358838
Validation loss decreased (0.799657 --> 0.708898).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(34.1475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9018562 KL Loss: 14.3113587 DSM Loss: 18.0734990 Overall Loss:34.2867138
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(32.4738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8768312 KL Loss: 14.2486001 DSM Loss: 18.1130966 Overall Loss:34.2385277
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(33.1385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8529099 KL Loss: 14.2527855 DSM Loss: 17.9438651 Overall Loss:34.0495607
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.6648054718971252
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.5175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9536542 KL Loss: 14.3345588 DSM Loss: 22.0237529 Overall Loss:38.3119661
Validation loss decreased (inf --> 0.719190).  Saving model ...
Updating learning rate to 0.0005
tensor(32.7616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9423102 KL Loss: 14.3189849 DSM Loss: 19.2446062 Overall Loss:35.5059014
Validation loss decreased (0.719190 --> 0.641363).  Saving model ...
Updating learning rate to 0.00025
tensor(47.5858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5454, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9229984 KL Loss: 14.2752285 DSM Loss: 18.8862371 Overall Loss:35.0844641
Validation loss decreased (0.641363 --> 0.628820).  Saving model ...
Updating learning rate to 0.000125
tensor(30.2022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8928877 KL Loss: 14.2395942 DSM Loss: 18.4831822 Overall Loss:34.6156640
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(36.3951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8887345 KL Loss: 14.3037576 DSM Loss: 17.9518109 Overall Loss:34.1443029
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(39.7921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8621627 KL Loss: 14.2708199 DSM Loss: 18.0499959 Overall Loss:34.1829784
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7680574655532837
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.7645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0840, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9284883 KL Loss: 14.3513278 DSM Loss: 23.6831103 Overall Loss:39.9629262
Validation loss decreased (inf --> 0.799269).  Saving model ...
Updating learning rate to 0.0005
tensor(40.5702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8932062 KL Loss: 14.2061395 DSM Loss: 19.7911240 Overall Loss:35.8904700
Validation loss decreased (0.799269 --> 0.739022).  Saving model ...
Updating learning rate to 0.00025
tensor(28.3204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3350, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8558635 KL Loss: 14.2055650 DSM Loss: 18.3784744 Overall Loss:34.4399030
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(29.9778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8370, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8842287 KL Loss: 14.2823827 DSM Loss: 18.4841099 Overall Loss:34.6507212
Validation loss decreased (0.739022 --> 0.637175).  Saving model ...
Updating learning rate to 6.25e-05
tensor(36.2175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8839048 KL Loss: 14.2538460 DSM Loss: 18.0853943 Overall Loss:34.2231452
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(32.1419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8734319 KL Loss: 14.3289590 DSM Loss: 18.0515926 Overall Loss:34.2539836
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(35.1777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9035062 KL Loss: 14.1997930 DSM Loss: 18.2934047 Overall Loss:34.3967038
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7502967119216919
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.6680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9070612 KL Loss: 14.3787256 DSM Loss: 21.3654438 Overall Loss:37.6512304
Validation loss decreased (inf --> 0.773375).  Saving model ...
Updating learning rate to 0.0005
tensor(44.3981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9206487 KL Loss: 14.2745575 DSM Loss: 18.6989612 Overall Loss:34.8941675
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(31.9422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8797208 KL Loss: 14.1872352 DSM Loss: 18.8577597 Overall Loss:34.9247159
Validation loss decreased (0.773375 --> 0.677754).  Saving model ...
Updating learning rate to 0.000125
tensor(33.7736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9205820 KL Loss: 14.2802065 DSM Loss: 18.3321302 Overall Loss:34.5329187
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(33.2001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8745960 KL Loss: 14.2228447 DSM Loss: 18.4521159 Overall Loss:34.5495567
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(35.5924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8773981 KL Loss: 14.2082130 DSM Loss: 18.0838585 Overall Loss:34.1694698
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7234947085380554
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(55.2533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9165443 KL Loss: 14.3868283 DSM Loss: 23.3002543 Overall Loss:39.6036267
Validation loss decreased (inf --> 1.060816).  Saving model ...
Updating learning rate to 0.0005
tensor(27.5459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8579187 KL Loss: 14.2452830 DSM Loss: 20.4621918 Overall Loss:36.5653934
Validation loss decreased (1.060816 --> 0.538969).  Saving model ...
Updating learning rate to 0.00025
tensor(35.8952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8791525 KL Loss: 14.2635437 DSM Loss: 18.6704016 Overall Loss:34.8130977
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(40.2992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8666376 KL Loss: 14.2508939 DSM Loss: 18.3320788 Overall Loss:34.4496104
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(34.9559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8569280 KL Loss: 14.2221600 DSM Loss: 18.0337037 Overall Loss:34.1127918
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.91733318567276


Running on file CAT.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.9482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9068128 KL Loss: 14.2063846 DSM Loss: 32.9889126 Overall Loss:49.1021099
Validation loss decreased (inf --> 3.507621).  Saving model ...
Updating learning rate to 0.0005
tensor(41.0466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3663, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9269501 KL Loss: 14.2663436 DSM Loss: 19.2755074 Overall Loss:35.4688011
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(29.6046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3656, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8787557 KL Loss: 14.1804038 DSM Loss: 18.5746923 Overall Loss:34.6338517
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(33.6108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4142, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8868576 KL Loss: 14.2421434 DSM Loss: 17.7540414 Overall Loss:33.8830425
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:6.997452259063721
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.8341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8714608 KL Loss: 14.2741240 DSM Loss: 23.3992876 Overall Loss:39.5448723
Validation loss decreased (inf --> 3.828102).  Saving model ...
Updating learning rate to 0.0005
tensor(30.0393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8859767 KL Loss: 14.2537381 DSM Loss: 18.9033677 Overall Loss:35.0430824
Validation loss decreased (3.828102 --> 3.212178).  Saving model ...
Updating learning rate to 0.00025
tensor(25.5156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8898269 KL Loss: 14.1814466 DSM Loss: 18.6575787 Overall Loss:34.7288522
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(45.2754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8536201 KL Loss: 14.1695736 DSM Loss: 18.4581559 Overall Loss:34.4813494
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(46.4374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8373048 KL Loss: 14.0161884 DSM Loss: 18.0758908 Overall Loss:33.9293839
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:6.495397567749023
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(64.9485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7982, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9113704 KL Loss: 14.2909143 DSM Loss: 23.0419370 Overall Loss:39.2442217
Validation loss decreased (inf --> 3.830628).  Saving model ...
Updating learning rate to 0.0005
tensor(34.3025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9353188 KL Loss: 14.2514569 DSM Loss: 18.8245291 Overall Loss:35.0113049
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(34.8869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9314399 KL Loss: 14.2404796 DSM Loss: 18.4029211 Overall Loss:34.5748406
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(35.3641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4388, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9288100 KL Loss: 14.3139935 DSM Loss: 18.0102227 Overall Loss:34.2530262
Validation loss decreased (3.830628 --> 3.450846).  Saving model ...
Updating learning rate to 6.25e-05
tensor(25.5957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9301492 KL Loss: 14.3120769 DSM Loss: 17.7151097 Overall Loss:33.9573357
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(39.6494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9621194 KL Loss: 14.3647674 DSM Loss: 17.6928070 Overall Loss:34.0196938
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(27.7689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.8997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9794130 KL Loss: 14.2954688 DSM Loss: 17.8683298 Overall Loss:34.1432116
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:6.999416828155518
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.7077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9109237 KL Loss: 14.1921161 DSM Loss: 22.1536164 Overall Loss:38.2566560
Validation loss decreased (inf --> 3.366210).  Saving model ...
Updating learning rate to 0.0005
tensor(47.7995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.2068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9340139 KL Loss: 14.2143970 DSM Loss: 18.8938000 Overall Loss:35.0422108
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(25.4521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.8663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8923012 KL Loss: 14.1607187 DSM Loss: 18.2841848 Overall Loss:34.3372047
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(25.3469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8595741 KL Loss: 14.1347012 DSM Loss: 18.0039205 Overall Loss:33.9981956
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:6.7036027908325195
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.4118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.1750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3500, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8630738 KL Loss: 14.2151129 DSM Loss: 21.2729972 Overall Loss:37.3511837
Validation loss decreased (inf --> 3.812786).  Saving model ...
Updating learning rate to 0.0005
tensor(39.3736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9236224 KL Loss: 14.2406201 DSM Loss: 18.6973863 Overall Loss:34.8616287
Validation loss decreased (3.812786 --> 3.793764).  Saving model ...
Updating learning rate to 0.00025
tensor(27.7093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8723961 KL Loss: 14.2559922 DSM Loss: 18.2762583 Overall Loss:34.4046466
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(26.6944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9075231 KL Loss: 14.2169871 DSM Loss: 17.9467398 Overall Loss:34.0712499
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(39.8712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8677726 KL Loss: 14.1795584 DSM Loss: 17.9452496 Overall Loss:33.9925806
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.378396034240723


Running on file CHTR.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(50.0065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9518640 KL Loss: 14.2343436 DSM Loss: 25.0873520 Overall Loss:41.2735594
Validation loss decreased (inf --> 5.010505).  Saving model ...
Updating learning rate to 0.0005
tensor(32.2447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9086024 KL Loss: 14.1874903 DSM Loss: 19.3583208 Overall Loss:35.4544134
Validation loss decreased (5.010505 --> 3.035594).  Saving model ...
Updating learning rate to 0.00025
tensor(33.1495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8754748 KL Loss: 14.1414424 DSM Loss: 18.3099095 Overall Loss:34.3268267
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(32.9444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8833372 KL Loss: 14.0942299 DSM Loss: 18.0174905 Overall Loss:33.9950577
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(34.3015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4654, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8986171 KL Loss: 14.2957600 DSM Loss: 17.9531087 Overall Loss:34.1474859
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.10480545461177826
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(45.9733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9038689 KL Loss: 14.2910954 DSM Loss: 22.6214164 Overall Loss:38.8163804
Validation loss decreased (inf --> 2.907721).  Saving model ...
Updating learning rate to 0.0005
tensor(39.4764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8992304 KL Loss: 14.2734252 DSM Loss: 18.9814582 Overall Loss:35.1541137
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(35.7529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8863545 KL Loss: 14.2119979 DSM Loss: 18.4213441 Overall Loss:34.5196965
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(37.2361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9037785 KL Loss: 14.2795580 DSM Loss: 17.9683291 Overall Loss:34.1516655
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.1344720721244812
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.8019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8939568 KL Loss: 14.3355769 DSM Loss: 21.2773894 Overall Loss:37.5069231
Validation loss decreased (inf --> 3.175283).  Saving model ...
Updating learning rate to 0.0005
tensor(35.8369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9035699 KL Loss: 14.2467125 DSM Loss: 18.6972385 Overall Loss:34.8475209
Validation loss decreased (3.175283 --> 3.135019).  Saving model ...
Updating learning rate to 0.00025
tensor(33.0809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6884, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8700474 KL Loss: 14.1142857 DSM Loss: 18.2553828 Overall Loss:34.2397160
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(33.2957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8706495 KL Loss: 14.2004014 DSM Loss: 18.2811410 Overall Loss:34.3521920
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(22.3689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8773174 KL Loss: 14.2474587 DSM Loss: 17.8164067 Overall Loss:33.9411827
Validation loss decreased (3.135019 --> 3.121215).  Saving model ...
Updating learning rate to 3.125e-05
tensor(31.8697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8729445 KL Loss: 14.1951880 DSM Loss: 17.9800452 Overall Loss:34.0481778
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(26.4496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5974, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9043899 KL Loss: 14.2786046 DSM Loss: 17.6555409 Overall Loss:33.8385352
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(30.6113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.1167, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8868926 KL Loss: 14.2579864 DSM Loss: 17.9615157 Overall Loss:34.1063946
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.12091773003339767
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(72.0591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9090865 KL Loss: 14.2762238 DSM Loss: 23.0434605 Overall Loss:39.2287705
Validation loss decreased (inf --> 3.004094).  Saving model ...
Updating learning rate to 0.0005
tensor(43.3554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6767, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9284902 KL Loss: 14.2404511 DSM Loss: 18.8673193 Overall Loss:35.0362609
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(40.2881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8785173 KL Loss: 14.1754810 DSM Loss: 18.3805630 Overall Loss:34.4345612
Validation loss decreased (3.004094 --> 2.834450).  Saving model ...
Updating learning rate to 0.000125
tensor(43.9254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8934634 KL Loss: 14.2328830 DSM Loss: 17.4836040 Overall Loss:33.6099504
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(35.2363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9097181 KL Loss: 14.3305498 DSM Loss: 17.8386901 Overall Loss:34.0789579
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(40.0338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8821656 KL Loss: 14.2606303 DSM Loss: 17.9479324 Overall Loss:34.0907281
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.13059042394161224
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.0099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9642000 KL Loss: 14.3808083 DSM Loss: 23.7330251 Overall Loss:40.0780333
Validation loss decreased (inf --> 3.546367).  Saving model ...
Updating learning rate to 0.0005
tensor(35.1171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1463, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9679420 KL Loss: 14.3121002 DSM Loss: 18.7979756 Overall Loss:35.0780177
Validation loss decreased (3.546367 --> 2.537116).  Saving model ...
Updating learning rate to 0.00025
tensor(32.6916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8704357 KL Loss: 14.1173070 DSM Loss: 18.7571907 Overall Loss:34.7449331
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(41.2317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8904610 KL Loss: 14.1914105 DSM Loss: 18.1879810 Overall Loss:34.2698524
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(37.5350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8588547 KL Loss: 14.2478926 DSM Loss: 18.2785851 Overall Loss:34.3853325
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.182173952460289


Running on file CMCSA.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.2322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9489263 KL Loss: 14.3758929 DSM Loss: 21.1461485 Overall Loss:37.4709679
Validation loss decreased (inf --> 3.604764).  Saving model ...
Updating learning rate to 0.0005
tensor(35.7221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9272910 KL Loss: 14.2483051 DSM Loss: 18.7670482 Overall Loss:34.9426443
Validation loss decreased (3.604764 --> 3.570793).  Saving model ...
Updating learning rate to 0.00025
tensor(26.4681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9112057 KL Loss: 14.2148328 DSM Loss: 18.1422695 Overall Loss:34.2683080
Validation loss decreased (3.570793 --> 3.314832).  Saving model ...
Updating learning rate to 0.000125
tensor(26.4131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8755112 KL Loss: 14.1801081 DSM Loss: 17.8442185 Overall Loss:33.8998377
Validation loss decreased (3.314832 --> 3.070614).  Saving model ...
Updating learning rate to 6.25e-05
tensor(26.5017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9019492 KL Loss: 14.3143188 DSM Loss: 17.6127256 Overall Loss:33.8289937
Validation loss decreased (3.070614 --> 2.864812).  Saving model ...
Updating learning rate to 3.125e-05
tensor(35.6637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8880924 KL Loss: 14.2660946 DSM Loss: 17.5712697 Overall Loss:33.7254567
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(38.4331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8374336 KL Loss: 14.2074632 DSM Loss: 17.6362181 Overall Loss:33.6811150
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(26.6976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8798365 KL Loss: 14.3190723 DSM Loss: 17.3961777 Overall Loss:33.5950864
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.42468851804733276
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(66.5558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9244254 KL Loss: 14.3008415 DSM Loss: 20.9220525 Overall Loss:37.1473193
Validation loss decreased (inf --> 4.320845).  Saving model ...
Updating learning rate to 0.0005
tensor(55.9473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3922, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9130240 KL Loss: 14.2161121 DSM Loss: 19.2402854 Overall Loss:35.3694217
Validation loss decreased (4.320845 --> 3.243924).  Saving model ...
Updating learning rate to 0.00025
tensor(31.6307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8899017 KL Loss: 14.1785263 DSM Loss: 17.8639647 Overall Loss:33.9323929
Validation loss decreased (3.243924 --> 3.109783).  Saving model ...
Updating learning rate to 0.000125
tensor(32.8443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0581, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8663588 KL Loss: 14.2507516 DSM Loss: 17.7477506 Overall Loss:33.8648607
Validation loss decreased (3.109783 --> 3.103351).  Saving model ...
Updating learning rate to 6.25e-05
tensor(42.2368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4312, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8451232 KL Loss: 14.1001344 DSM Loss: 17.7740658 Overall Loss:33.7193233
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(29.0092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8668551 KL Loss: 14.2805016 DSM Loss: 17.6188983 Overall Loss:33.7662549
Validation loss decreased (3.103351 --> 3.057440).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(35.5186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8724652 KL Loss: 14.2245126 DSM Loss: 17.5271569 Overall Loss:33.6241349
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(34.7191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5391, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8660495 KL Loss: 14.2205665 DSM Loss: 17.2743249 Overall Loss:33.3609406
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(39.7660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8421123 KL Loss: 14.2071100 DSM Loss: 17.3458759 Overall Loss:33.3950980
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4544773995876312
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(62.5355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9688121 KL Loss: 14.3341609 DSM Loss: 21.5096672 Overall Loss:37.8126404
Validation loss decreased (inf --> 4.024518).  Saving model ...
Updating learning rate to 0.0005
tensor(50.8562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9438000 KL Loss: 14.2427874 DSM Loss: 18.8522385 Overall Loss:35.0388259
Validation loss decreased (4.024518 --> 3.413297).  Saving model ...
Updating learning rate to 0.00025
tensor(32.7086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9734393 KL Loss: 14.1724376 DSM Loss: 18.0952231 Overall Loss:34.2410998
Validation loss decreased (3.413297 --> 3.054223).  Saving model ...
Updating learning rate to 0.000125
tensor(36.0033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8627525 KL Loss: 14.1038714 DSM Loss: 17.9460087 Overall Loss:33.9126326
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(34.2338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.6660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8654839 KL Loss: 14.1800131 DSM Loss: 17.7667291 Overall Loss:33.8122259
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(30.7436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9050161 KL Loss: 14.3934968 DSM Loss: 17.6986630 Overall Loss:33.9971760
Validation loss decreased (3.054223 --> 3.042734).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(26.9882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3573, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9118248 KL Loss: 14.3619833 DSM Loss: 17.7108746 Overall Loss:33.9846826
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
tensor(43.8682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4206, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8639092 KL Loss: 14.2588902 DSM Loss: 17.7003815 Overall Loss:33.8231807
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
tensor(26.3969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8982936 KL Loss: 14.2980834 DSM Loss: 17.5010294 Overall Loss:33.6974063
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.451770156621933
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(65.8911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9604912 KL Loss: 14.3120334 DSM Loss: 21.6584739 Overall Loss:37.9309983
Validation loss decreased (inf --> 2.986379).  Saving model ...
Updating learning rate to 0.0005
tensor(25.4148, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9160912 KL Loss: 14.3134609 DSM Loss: 18.2227496 Overall Loss:34.4523018
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(28.6822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9968063 KL Loss: 14.4974385 DSM Loss: 17.9584999 Overall Loss:34.4527446
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(30.2995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9139700 KL Loss: 14.3376937 DSM Loss: 17.9554881 Overall Loss:34.2071520
Validation loss decreased (2.986379 --> 2.918347).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.4376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6736, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9718595 KL Loss: 14.4509864 DSM Loss: 17.3677055 Overall Loss:33.7905517
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(31.5170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1494, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9188116 KL Loss: 14.4033318 DSM Loss: 17.4615131 Overall Loss:33.7836565
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(35.5560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9147322 KL Loss: 14.3643949 DSM Loss: 17.4174142 Overall Loss:33.6965413
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.43384870886802673
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(66.3478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9766316 KL Loss: 14.4175607 DSM Loss: 22.6225728 Overall Loss:39.0167652
Validation loss decreased (inf --> 3.247960).  Saving model ...
Updating learning rate to 0.0005
tensor(37.2864, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9524025 KL Loss: 14.2386905 DSM Loss: 18.3905090 Overall Loss:34.5816021
Validation loss decreased (3.247960 --> 2.818723).  Saving model ...
Updating learning rate to 0.00025
tensor(27.9322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8849090 KL Loss: 14.2155098 DSM Loss: 18.3675218 Overall Loss:34.4679404
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(34.5318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8838873 KL Loss: 14.2014105 DSM Loss: 17.4937115 Overall Loss:33.5790091
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(29.0958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1586, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8994529 KL Loss: 14.3378942 DSM Loss: 17.5098608 Overall Loss:33.7472080
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.41406145691871643


Running on file CODI.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.7724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9573451 KL Loss: 14.3132500 DSM Loss: 21.7279653 Overall Loss:37.9985605
Validation loss decreased (inf --> 13.127158).  Saving model ...
Updating learning rate to 0.0005
tensor(28.3395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9445116 KL Loss: 14.2701311 DSM Loss: 18.8925305 Overall Loss:35.1071731
Validation loss decreased (13.127158 --> 11.560849).  Saving model ...
Updating learning rate to 0.00025
tensor(49.5573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8838741 KL Loss: 14.2681289 DSM Loss: 18.5522467 Overall Loss:34.7042497
Validation loss decreased (11.560849 --> 10.861137).  Saving model ...
Updating learning rate to 0.000125
tensor(32.5650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7922, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8796538 KL Loss: 14.1815329 DSM Loss: 18.3129116 Overall Loss:34.3740981
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(20.8517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6225, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8711005 KL Loss: 14.1967369 DSM Loss: 18.2067875 Overall Loss:34.2746248
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(34.1387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8611044 KL Loss: 14.2526664 DSM Loss: 18.2562271 Overall Loss:34.3699982
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.2541110515594482
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.2217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9592043 KL Loss: 14.2594442 DSM Loss: 22.8693075 Overall Loss:39.0879559
Validation loss decreased (inf --> 11.187589).  Saving model ...
Updating learning rate to 0.0005
tensor(23.8754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5099, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9783260 KL Loss: 14.2955616 DSM Loss: 18.7797540 Overall Loss:35.0536418
Validation loss decreased (11.187589 --> 11.137881).  Saving model ...
Updating learning rate to 0.00025
tensor(34.8644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9277070 KL Loss: 14.1886094 DSM Loss: 18.4557068 Overall Loss:34.5720230
Validation loss decreased (11.137881 --> 10.495206).  Saving model ...
Updating learning rate to 0.000125
tensor(41.8135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8532386 KL Loss: 14.1495968 DSM Loss: 18.5813369 Overall Loss:34.5841722
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(42.7825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3021, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8938688 KL Loss: 14.2966031 DSM Loss: 17.8140545 Overall Loss:34.0045265
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(27.5826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8630736 KL Loss: 14.1613800 DSM Loss: 17.8288223 Overall Loss:33.8532758
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.8971292972564697
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.1501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9322832 KL Loss: 14.2425885 DSM Loss: 22.0412283 Overall Loss:38.2161002
Validation loss decreased (inf --> 10.833426).  Saving model ...
Updating learning rate to 0.0005
tensor(44.7365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9456143 KL Loss: 14.1751360 DSM Loss: 18.8843227 Overall Loss:35.0050731
Validation loss decreased (10.833426 --> 9.665252).  Saving model ...
Updating learning rate to 0.00025
tensor(42.2585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8967546 KL Loss: 14.0996499 DSM Loss: 18.7279370 Overall Loss:34.7243414
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(34.8528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8620482 KL Loss: 14.1546503 DSM Loss: 17.8665489 Overall Loss:33.8832472
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(28.9116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8632869 KL Loss: 14.1590822 DSM Loss: 17.8556975 Overall Loss:33.8780665
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.5128767490386963
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(64.6406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9213563 KL Loss: 14.2475127 DSM Loss: 22.8620909 Overall Loss:39.0309602
Validation loss decreased (inf --> 11.956979).  Saving model ...
Updating learning rate to 0.0005
tensor(39.8367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7688, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8988558 KL Loss: 14.1829888 DSM Loss: 19.3843059 Overall Loss:35.4661502
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(29.9264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9270403 KL Loss: 14.1781551 DSM Loss: 18.1772286 Overall Loss:34.2824240
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(39.4445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9076342 KL Loss: 14.2901698 DSM Loss: 18.0260149 Overall Loss:34.2238189
Validation loss decreased (11.956979 --> 10.891447).  Saving model ...
Updating learning rate to 6.25e-05
tensor(34.2987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9200057 KL Loss: 14.2446706 DSM Loss: 17.9782470 Overall Loss:34.1429235
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(34.5393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3957, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9043568 KL Loss: 14.2898449 DSM Loss: 17.9721412 Overall Loss:34.1663429
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(28.0730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8981, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9352036 KL Loss: 14.3720723 DSM Loss: 17.7253524 Overall Loss:34.0326284
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.109679698944092
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.9617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9277780 KL Loss: 14.3314667 DSM Loss: 21.5600701 Overall Loss:37.8193147
Validation loss decreased (inf --> 9.334957).  Saving model ...
Updating learning rate to 0.0005
tensor(28.6810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4663, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9027953 KL Loss: 14.1779627 DSM Loss: 19.5565911 Overall Loss:35.6373491
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(43.1938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8760580 KL Loss: 14.0802849 DSM Loss: 18.8258812 Overall Loss:34.7822241
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(41.3716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.6300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8849048 KL Loss: 14.1902689 DSM Loss: 18.1254833 Overall Loss:34.2006570
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.3070521354675293


Running on file CSCO.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.4526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9317316 KL Loss: 14.3132529 DSM Loss: 21.9183063 Overall Loss:38.1632909
Validation loss decreased (inf --> 3.707744).  Saving model ...
Updating learning rate to 0.0005
tensor(32.0534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9304743 KL Loss: 14.2786625 DSM Loss: 18.5825331 Overall Loss:34.7916701
Validation loss decreased (3.707744 --> 3.257049).  Saving model ...
Updating learning rate to 0.00025
tensor(40.3286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8776299 KL Loss: 14.1845634 DSM Loss: 18.4008219 Overall Loss:34.4630154
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(47.0322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2367, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8836673 KL Loss: 14.3434826 DSM Loss: 17.7688384 Overall Loss:33.9959884
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(33.2589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8809831 KL Loss: 14.2556176 DSM Loss: 17.9959006 Overall Loss:34.1325011
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.573660135269165
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.1934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9704439 KL Loss: 14.3448360 DSM Loss: 24.1478653 Overall Loss:40.4631450
Validation loss decreased (inf --> 4.040522).  Saving model ...
Updating learning rate to 0.0005
tensor(34.5606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.8703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9243997 KL Loss: 14.2552569 DSM Loss: 19.2980061 Overall Loss:35.4776626
Validation loss decreased (4.040522 --> 3.945046).  Saving model ...
Updating learning rate to 0.00025
tensor(34.6654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8775298 KL Loss: 14.1690617 DSM Loss: 18.2427884 Overall Loss:34.2893797
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(33.6114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8697414 KL Loss: 14.2239718 DSM Loss: 18.0785475 Overall Loss:34.1722609
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(38.6722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8867867 KL Loss: 14.2641797 DSM Loss: 17.6139717 Overall Loss:33.7649379
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.0227620601654053
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(50.9615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8910097 KL Loss: 14.3514098 DSM Loss: 22.4528024 Overall Loss:38.6952222
Validation loss decreased (inf --> 3.981270).  Saving model ...
Updating learning rate to 0.0005
tensor(37.9409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8731686 KL Loss: 14.2377823 DSM Loss: 18.7357547 Overall Loss:34.8467055
Validation loss decreased (3.981270 --> 3.775246).  Saving model ...
Updating learning rate to 0.00025
tensor(37.5641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8680464 KL Loss: 14.1864646 DSM Loss: 18.1392414 Overall Loss:34.1937524
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(38.0849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9596, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9040534 KL Loss: 14.3534719 DSM Loss: 17.7046293 Overall Loss:33.9621549
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(30.4299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9113160 KL Loss: 14.2977332 DSM Loss: 17.7631343 Overall Loss:33.9721834
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.9085497856140137
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.1895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9188360 KL Loss: 14.3086146 DSM Loss: 21.7944680 Overall Loss:38.0219184
Validation loss decreased (inf --> 3.789924).  Saving model ...
Updating learning rate to 0.0005
tensor(30.4133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9701191 KL Loss: 14.2766440 DSM Loss: 19.1313888 Overall Loss:35.3781520
Validation loss decreased (3.789924 --> 3.637746).  Saving model ...
Updating learning rate to 0.00025
tensor(36.8660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4586, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9191387 KL Loss: 14.2447401 DSM Loss: 18.2731082 Overall Loss:34.4369871
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(29.9578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7211, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9155805 KL Loss: 14.2018199 DSM Loss: 17.9798662 Overall Loss:34.0972667
Validation loss decreased (3.637746 --> 3.400500).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.6547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4454, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8901456 KL Loss: 14.2432859 DSM Loss: 17.4680931 Overall Loss:33.6015246
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(29.5647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9029922 KL Loss: 14.1937775 DSM Loss: 17.8786978 Overall Loss:33.9754673
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(40.4537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8916591 KL Loss: 14.1959824 DSM Loss: 17.6527564 Overall Loss:33.7403976
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.6655687093734741
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(61.8182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9433608 KL Loss: 14.3394129 DSM Loss: 22.4051790 Overall Loss:38.6879527
Validation loss decreased (inf --> 4.402766).  Saving model ...
Updating learning rate to 0.0005
tensor(39.9284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9066705 KL Loss: 14.2036626 DSM Loss: 18.5668575 Overall Loss:34.6771910
Validation loss decreased (4.402766 --> 3.754041).  Saving model ...
Updating learning rate to 0.00025
tensor(30.8240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7822, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8878323 KL Loss: 14.1928673 DSM Loss: 17.9984756 Overall Loss:34.0791752
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(30.8365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8639748 KL Loss: 14.0931965 DSM Loss: 17.8353628 Overall Loss:33.7925340
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(39.2995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8396995 KL Loss: 14.1059774 DSM Loss: 17.6991567 Overall Loss:33.6448333
Validation loss decreased (3.754041 --> 3.698625).  Saving model ...
Updating learning rate to 3.125e-05
tensor(36.3906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8388, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8446068 KL Loss: 14.1684961 DSM Loss: 17.4811605 Overall Loss:33.4942633
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(25.5751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8532043 KL Loss: 14.1965278 DSM Loss: 17.4278944 Overall Loss:33.4776264
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(30.0661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8421036 KL Loss: 14.2145723 DSM Loss: 17.5706628 Overall Loss:33.6273387
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.8594573736190796


Running on file CVX.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.8693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9137481 KL Loss: 14.3244664 DSM Loss: 21.6426133 Overall Loss:37.8808276
Validation loss decreased (inf --> 10.963596).  Saving model ...
Updating learning rate to 0.0005
tensor(31.4672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9112348 KL Loss: 14.2438047 DSM Loss: 18.8145312 Overall Loss:34.9695710
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(33.0636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.2136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9141012 KL Loss: 14.2780261 DSM Loss: 17.6180725 Overall Loss:33.8101999
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(35.1498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8915563 KL Loss: 14.2770937 DSM Loss: 17.7549512 Overall Loss:33.9236010
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:36.25019454956055
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.5743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8337654 KL Loss: 14.1721778 DSM Loss: 22.4534587 Overall Loss:38.4594019
Validation loss decreased (inf --> 12.972872).  Saving model ...
Updating learning rate to 0.0005
tensor(35.3084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9684526 KL Loss: 14.3642897 DSM Loss: 18.2253406 Overall Loss:34.5580827
Validation loss decreased (12.972872 --> 11.126307).  Saving model ...
Updating learning rate to 0.00025
tensor(30.7290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9105965 KL Loss: 14.2486601 DSM Loss: 18.0223030 Overall Loss:34.1815596
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(34.7126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8987974 KL Loss: 14.1913168 DSM Loss: 17.5605434 Overall Loss:33.6506578
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(37.0082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8573464 KL Loss: 14.2414424 DSM Loss: 17.3238165 Overall Loss:33.4226052
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:36.73215103149414
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(55.1068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9849472 KL Loss: 14.3276122 DSM Loss: 21.2261698 Overall Loss:37.5387292
Validation loss decreased (inf --> 11.039070).  Saving model ...
Updating learning rate to 0.0005
tensor(32.1666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9098075 KL Loss: 14.2508671 DSM Loss: 18.5697593 Overall Loss:34.7304340
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(31.5647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8835394 KL Loss: 14.1963573 DSM Loss: 18.1656437 Overall Loss:34.2455404
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(31.3120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8961900 KL Loss: 14.2650260 DSM Loss: 17.6079445 Overall Loss:33.7691606
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:36.3681640625
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.9248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8995757 KL Loss: 14.2611189 DSM Loss: 21.2926449 Overall Loss:37.4533394
Validation loss decreased (inf --> 11.618988).  Saving model ...
Updating learning rate to 0.0005
tensor(37.2561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9513295 KL Loss: 14.2982268 DSM Loss: 18.1796108 Overall Loss:34.4291669
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(29.5999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8818794 KL Loss: 14.2290142 DSM Loss: 17.9831957 Overall Loss:34.0940893
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(36.3819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8940020 KL Loss: 14.2389724 DSM Loss: 17.6357296 Overall Loss:33.7687042
Validation loss decreased (11.618988 --> 11.359202).  Saving model ...
Updating learning rate to 6.25e-05
tensor(30.2314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8823543 KL Loss: 14.2130032 DSM Loss: 17.3488401 Overall Loss:33.4441976
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(27.1013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8255, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8462684 KL Loss: 14.1803040 DSM Loss: 17.4397292 Overall Loss:33.4663016
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(32.1095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8465210 KL Loss: 14.2457420 DSM Loss: 17.4051803 Overall Loss:33.4974433
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:37.01353454589844
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.4823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8538122 KL Loss: 14.1691203 DSM Loss: 21.4769891 Overall Loss:37.4999213
Validation loss decreased (inf --> 12.959437).  Saving model ...
Updating learning rate to 0.0005
tensor(34.3699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9053194 KL Loss: 14.2928867 DSM Loss: 18.6632838 Overall Loss:34.8614897
Validation loss decreased (12.959437 --> 11.302687).  Saving model ...
Updating learning rate to 0.00025
tensor(33.2338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4871, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8853612 KL Loss: 14.2567353 DSM Loss: 17.9518804 Overall Loss:34.0939769
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(37.5389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8662141 KL Loss: 14.2043032 DSM Loss: 17.6246222 Overall Loss:33.6951395
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(40.5576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8806216 KL Loss: 14.2792745 DSM Loss: 17.3918763 Overall Loss:33.5517724
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:36.8917350769043


Running on file D.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.4493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0343, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8707645 KL Loss: 14.3172447 DSM Loss: 22.5350094 Overall Loss:38.7230185
Validation loss decreased (inf --> 3.054356).  Saving model ...
Updating learning rate to 0.0005
tensor(34.9743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9018952 KL Loss: 14.2415226 DSM Loss: 19.1903055 Overall Loss:35.3337231
Validation loss decreased (3.054356 --> 2.700711).  Saving model ...
Updating learning rate to 0.00025
tensor(34.9391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9084399 KL Loss: 14.2076670 DSM Loss: 18.8192919 Overall Loss:34.9353985
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(32.3961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9031716 KL Loss: 14.2650449 DSM Loss: 18.3756676 Overall Loss:34.5438842
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(27.4719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8866198 KL Loss: 14.2690477 DSM Loss: 18.3433821 Overall Loss:34.4990497
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.144392728805542
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.7598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9545472 KL Loss: 14.2841000 DSM Loss: 23.3061410 Overall Loss:39.5447881
Validation loss decreased (inf --> 3.064262).  Saving model ...
Updating learning rate to 0.0005
tensor(32.6380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9193397 KL Loss: 14.2281930 DSM Loss: 19.0144408 Overall Loss:35.1619733
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(33.0418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4514, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8754053 KL Loss: 14.2429727 DSM Loss: 18.2154188 Overall Loss:34.3337969
Validation loss decreased (3.064262 --> 2.860078).  Saving model ...
Updating learning rate to 0.000125
tensor(42.4588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8394355 KL Loss: 14.1075131 DSM Loss: 18.3726971 Overall Loss:34.3196455
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(33.6531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8318197 KL Loss: 14.1871367 DSM Loss: 18.2581360 Overall Loss:34.2770924
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(33.3491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0176, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8671685 KL Loss: 14.2201445 DSM Loss: 18.2891667 Overall Loss:34.3764796
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.104527711868286
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(47.0254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9153807 KL Loss: 14.3627633 DSM Loss: 22.3087197 Overall Loss:38.5868639
Validation loss decreased (inf --> 2.859710).  Saving model ...
Updating learning rate to 0.0005
tensor(39.6247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8969872 KL Loss: 14.2534978 DSM Loss: 19.9021495 Overall Loss:36.0526344
Validation loss decreased (2.859710 --> 2.847939).  Saving model ...
Updating learning rate to 0.00025
tensor(29.7781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8852977 KL Loss: 14.1774382 DSM Loss: 18.7703669 Overall Loss:34.8331028
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(33.1336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9053861 KL Loss: 14.2304901 DSM Loss: 18.0870101 Overall Loss:34.2228862
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(34.3581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8889801 KL Loss: 14.2262920 DSM Loss: 18.1638537 Overall Loss:34.2791258
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.965599536895752
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(41.5527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8819706 KL Loss: 14.3371877 DSM Loss: 22.1154704 Overall Loss:38.3346287
Validation loss decreased (inf --> 4.092010).  Saving model ...
Updating learning rate to 0.0005
tensor(34.0845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9244676 KL Loss: 14.2909456 DSM Loss: 19.2622925 Overall Loss:35.4777056
Validation loss decreased (4.092010 --> 2.845709).  Saving model ...
Updating learning rate to 0.00025
tensor(41.1231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3202, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8791927 KL Loss: 14.2438179 DSM Loss: 18.7885656 Overall Loss:34.9115760
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(31.8512, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8748173 KL Loss: 14.2795658 DSM Loss: 18.2798132 Overall Loss:34.4341963
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(39.6218, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8260953 KL Loss: 14.1699125 DSM Loss: 18.0715326 Overall Loss:34.0675406
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.16938853263855
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(55.9547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8961181 KL Loss: 14.2257548 DSM Loss: 21.6999256 Overall Loss:37.8217982
Validation loss decreased (inf --> 2.537442).  Saving model ...
Updating learning rate to 0.0005
tensor(33.5742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9086420 KL Loss: 14.1478529 DSM Loss: 19.3451388 Overall Loss:35.4016337
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(37.2062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8008, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9028522 KL Loss: 14.2322417 DSM Loss: 18.7261146 Overall Loss:34.8612085
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(40.0575, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9073142 KL Loss: 14.1567311 DSM Loss: 18.6421932 Overall Loss:34.7062384
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.2898221015930176


Running on file DHR.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.3344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9106338 KL Loss: 14.2817741 DSM Loss: 22.3654506 Overall Loss:38.5578583
Validation loss decreased (inf --> 8.468933).  Saving model ...
Updating learning rate to 0.0005
tensor(35.4327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5329, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9119422 KL Loss: 14.1795714 DSM Loss: 20.0103617 Overall Loss:36.1018753
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(30.1873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8798047 KL Loss: 14.1473982 DSM Loss: 19.0207330 Overall Loss:35.0479359
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(37.9226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8672675 KL Loss: 14.1975767 DSM Loss: 18.4492921 Overall Loss:34.5141366
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.693134307861328
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.0154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8987943 KL Loss: 14.2943451 DSM Loss: 23.5085710 Overall Loss:39.7017105
Validation loss decreased (inf --> 7.957322).  Saving model ...
Updating learning rate to 0.0005
tensor(42.4125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9032801 KL Loss: 14.1777134 DSM Loss: 19.8253658 Overall Loss:35.9063592
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(32.3889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8788429 KL Loss: 14.1588509 DSM Loss: 19.5917685 Overall Loss:35.6294622
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(31.8805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8862809 KL Loss: 14.1763302 DSM Loss: 18.2753690 Overall Loss:34.3379799
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.333074569702148
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(74.3973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9500400 KL Loss: 14.2557469 DSM Loss: 22.5505609 Overall Loss:38.7563475
Validation loss decreased (inf --> 8.091664).  Saving model ...
Updating learning rate to 0.0005
tensor(41.6669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9201940 KL Loss: 14.0999350 DSM Loss: 19.1267858 Overall Loss:35.1469146
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(31.6204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9194939 KL Loss: 14.1481715 DSM Loss: 18.7778363 Overall Loss:34.8455015
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(41.8572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8950795 KL Loss: 14.1600078 DSM Loss: 18.2186908 Overall Loss:34.2737781
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.423083305358887
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.3109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9002605 KL Loss: 14.1979118 DSM Loss: 25.7090491 Overall Loss:41.8072215
Validation loss decreased (inf --> 8.214673).  Saving model ...
Updating learning rate to 0.0005
tensor(26.1460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8987739 KL Loss: 14.2159158 DSM Loss: 18.9318280 Overall Loss:35.0465175
Validation loss decreased (8.214673 --> 7.859168).  Saving model ...
Updating learning rate to 0.00025
tensor(33.5539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7556, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8947975 KL Loss: 14.2309690 DSM Loss: 18.5397198 Overall Loss:34.6654865
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(27.0454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2870, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8634881 KL Loss: 14.1876740 DSM Loss: 18.3118974 Overall Loss:34.3630593
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(46.0764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8733685 KL Loss: 14.1619323 DSM Loss: 17.9587749 Overall Loss:33.9940753
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.254727840423584
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(61.7574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9701867 KL Loss: 14.3497170 DSM Loss: 23.1108067 Overall Loss:39.4307103
Validation loss decreased (inf --> 8.577983).  Saving model ...
Updating learning rate to 0.0005
tensor(29.6851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8740051 KL Loss: 14.1744331 DSM Loss: 18.9066189 Overall Loss:34.9550570
Validation loss decreased (8.577983 --> 7.601501).  Saving model ...
Updating learning rate to 0.00025
tensor(34.1465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6454, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8346622 KL Loss: 14.1187434 DSM Loss: 18.3253479 Overall Loss:34.2787533
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(33.2581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8478597 KL Loss: 14.1156258 DSM Loss: 18.0607040 Overall Loss:34.0241896
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(33.3052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8825320 KL Loss: 14.2303586 DSM Loss: 18.2919238 Overall Loss:34.4048143
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.145341873168945


Running on file DIS.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.1541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8924426 KL Loss: 14.2700934 DSM Loss: 24.7417513 Overall Loss:40.9042871
Validation loss decreased (inf --> 2.300110).  Saving model ...
Updating learning rate to 0.0005
tensor(47.5930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9592139 KL Loss: 14.2578951 DSM Loss: 20.2844643 Overall Loss:36.5015731
Validation loss decreased (2.300110 --> 1.923115).  Saving model ...
Updating learning rate to 0.00025
tensor(47.8843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9239697 KL Loss: 14.2540411 DSM Loss: 19.2900413 Overall Loss:35.4680521
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(46.8163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8910924 KL Loss: 14.2390040 DSM Loss: 18.8791051 Overall Loss:35.0092015
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(39.2434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9712247 KL Loss: 14.3953520 DSM Loss: 18.5953322 Overall Loss:34.9619089
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.965386152267456
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.7502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 2.0129567 KL Loss: 14.3992122 DSM Loss: 24.8405944 Overall Loss:41.2527634
Validation loss decreased (inf --> 1.908996).  Saving model ...
Updating learning rate to 0.0005
tensor(38.4999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.0947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9516090 KL Loss: 14.2960962 DSM Loss: 19.6947223 Overall Loss:35.9424276
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(40.3269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9100497 KL Loss: 14.2268843 DSM Loss: 19.1299053 Overall Loss:35.2668392
Validation loss decreased (1.908996 --> 1.719718).  Saving model ...
Updating learning rate to 0.000125
tensor(40.6628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9011490 KL Loss: 14.2667459 DSM Loss: 18.5983678 Overall Loss:34.7662627
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(31.5202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9595, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9015439 KL Loss: 14.3694131 DSM Loss: 18.3787327 Overall Loss:34.6496895
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(23.0019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.8779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9330809 KL Loss: 14.3960731 DSM Loss: 18.2689156 Overall Loss:34.5980696
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.1150195598602295
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(62.0262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8728078 KL Loss: 14.2258024 DSM Loss: 24.1882166 Overall Loss:40.2868269
Validation loss decreased (inf --> 2.367778).  Saving model ...
Updating learning rate to 0.0005
tensor(44.4302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5896, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9180701 KL Loss: 14.2514436 DSM Loss: 19.5264451 Overall Loss:35.6959589
Validation loss decreased (2.367778 --> 2.311207).  Saving model ...
Updating learning rate to 0.00025
tensor(33.1750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8906514 KL Loss: 14.1733275 DSM Loss: 19.2219045 Overall Loss:35.2858834
Validation loss decreased (2.311207 --> 2.252558).  Saving model ...
Updating learning rate to 0.000125
tensor(32.0885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9142445 KL Loss: 14.1813106 DSM Loss: 18.9541699 Overall Loss:35.0497250
Validation loss decreased (2.252558 --> 2.007274).  Saving model ...
Updating learning rate to 6.25e-05
tensor(48.1836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4916, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8719258 KL Loss: 14.1533996 DSM Loss: 18.6803584 Overall Loss:34.7056839
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(27.3233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0894, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8670858 KL Loss: 14.1377077 DSM Loss: 18.7647204 Overall Loss:34.7695137
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(33.5167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8852805 KL Loss: 14.2700580 DSM Loss: 18.4012777 Overall Loss:34.5566161
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.886981725692749
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(47.7389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9494750 KL Loss: 14.2768946 DSM Loss: 23.7777865 Overall Loss:40.0041561
Validation loss decreased (inf --> 2.285342).  Saving model ...
Updating learning rate to 0.0005
tensor(49.8028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9452802 KL Loss: 14.2574359 DSM Loss: 19.8024376 Overall Loss:36.0051539
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(36.6856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6089, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.4438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9009651 KL Loss: 14.2753679 DSM Loss: 19.2144642 Overall Loss:35.3907972
Validation loss decreased (2.285342 --> 2.265442).  Saving model ...
Updating learning rate to 0.000125
tensor(30.3076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.4222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8633976 KL Loss: 14.2068788 DSM Loss: 18.3729066 Overall Loss:34.4431830
Validation loss decreased (2.265442 --> 1.852371).  Saving model ...
Updating learning rate to 6.25e-05
tensor(39.7177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.9079359 KL Loss: 14.2711500 DSM Loss: 18.6288031 Overall Loss:34.8078889
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(31.9154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.9048379 KL Loss: 14.3403320 DSM Loss: 18.4150021 Overall Loss:34.6601721
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(37.7943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8786175 KL Loss: 14.2023789 DSM Loss: 18.5459781 Overall Loss:34.6269743
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.2492830753326416
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.3945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9145088 KL Loss: 14.3412415 DSM Loss: 21.7770699 Overall Loss:38.0328202
Validation loss decreased (inf --> 1.833356).  Saving model ...
Updating learning rate to 0.0005
tensor(30.7700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8976608 KL Loss: 14.1240691 DSM Loss: 20.2533273 Overall Loss:36.2750570
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(33.8690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8865792 KL Loss: 14.1874536 DSM Loss: 19.3389875 Overall Loss:35.4130204
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(40.5878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9601693 KL Loss: 14.3817724 DSM Loss: 18.6472002 Overall Loss:34.9891419
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9300714731216431


Running on file DUK.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.7971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0911, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9432579 KL Loss: 14.3655119 DSM Loss: 24.5682241 Overall Loss:40.8769940
Validation loss decreased (inf --> 6.810295).  Saving model ...
Updating learning rate to 0.0005
tensor(50.4785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8918285 KL Loss: 14.2195564 DSM Loss: 18.3126922 Overall Loss:34.4240771
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(32.9941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7649, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8840730 KL Loss: 14.2763944 DSM Loss: 17.8590042 Overall Loss:34.0194718
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(34.3851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8455135 KL Loss: 14.1575355 DSM Loss: 17.8838320 Overall Loss:33.8868808
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.848569869995117
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(45.7599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8978284 KL Loss: 14.3527709 DSM Loss: 22.2016802 Overall Loss:38.4522795
Validation loss decreased (inf --> 6.901653).  Saving model ...
Updating learning rate to 0.0005
tensor(38.8952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9090722 KL Loss: 14.2702546 DSM Loss: 18.8892916 Overall Loss:35.0686183
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(35.0993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9007948 KL Loss: 14.2454674 DSM Loss: 17.6651869 Overall Loss:33.8114490
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(31.1801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8677393 KL Loss: 14.2741561 DSM Loss: 17.7824756 Overall Loss:33.9243712
Validation loss decreased (6.901653 --> 6.509008).  Saving model ...
Updating learning rate to 6.25e-05
tensor(41.1424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8415088 KL Loss: 14.2113818 DSM Loss: 17.4999930 Overall Loss:33.5528837
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(34.7191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0123, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8449545 KL Loss: 14.0895781 DSM Loss: 17.6622318 Overall Loss:33.5967644
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(31.8296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8477041 KL Loss: 14.1754261 DSM Loss: 17.5008891 Overall Loss:33.5240193
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.584232807159424
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.2600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9061015 KL Loss: 14.3839872 DSM Loss: 24.2740836 Overall Loss:40.5641724
Validation loss decreased (inf --> 6.338727).  Saving model ...
Updating learning rate to 0.0005
tensor(31.2478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9137726 KL Loss: 14.3158871 DSM Loss: 18.8851686 Overall Loss:35.1148280
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(31.5152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7697, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9009256 KL Loss: 14.1784197 DSM Loss: 18.7379439 Overall Loss:34.8172892
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(28.7711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0120, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8642534 KL Loss: 14.1743039 DSM Loss: 18.4115562 Overall Loss:34.4501137
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.424722194671631
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.5256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.2062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9161544 KL Loss: 14.2254635 DSM Loss: 22.8957075 Overall Loss:39.0373254
Validation loss decreased (inf --> 8.517458).  Saving model ...
Updating learning rate to 0.0005
tensor(44.5871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9332122 KL Loss: 14.2876595 DSM Loss: 18.9005772 Overall Loss:35.1214489
Validation loss decreased (8.517458 --> 7.001307).  Saving model ...
Updating learning rate to 0.00025
tensor(31.4687, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7178, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8772737 KL Loss: 14.1761679 DSM Loss: 18.1522771 Overall Loss:34.2057185
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(36.6149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8752, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9134893 KL Loss: 14.2935712 DSM Loss: 17.7397899 Overall Loss:33.9468506
Validation loss decreased (7.001307 --> 6.755262).  Saving model ...
Updating learning rate to 6.25e-05
tensor(41.0841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8986873 KL Loss: 14.2935163 DSM Loss: 17.3854350 Overall Loss:33.5776385
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
tensor(23.4253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8862653 KL Loss: 14.2926459 DSM Loss: 17.6343549 Overall Loss:33.8132661
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
tensor(34.9141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8707363 KL Loss: 14.2463572 DSM Loss: 17.5073893 Overall Loss:33.6244827
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.800886631011963
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(45.0458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9074557 KL Loss: 14.2963702 DSM Loss: 22.7249918 Overall Loss:38.9288176
Validation loss decreased (inf --> 6.671665).  Saving model ...
Updating learning rate to 0.0005
tensor(39.3414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9381621 KL Loss: 14.2444865 DSM Loss: 19.0172619 Overall Loss:35.1999106
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(29.2393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8699744 KL Loss: 14.2078391 DSM Loss: 18.1273648 Overall Loss:34.2051783
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(38.8909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8967928 KL Loss: 14.3763979 DSM Loss: 17.6852840 Overall Loss:33.9584748
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.7329630851745605


Running on file EXC.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.4084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9179532 KL Loss: 14.3200921 DSM Loss: 21.0106116 Overall Loss:37.2486568
Validation loss decreased (inf --> 10.822289).  Saving model ...
Updating learning rate to 0.0005
tensor(41.6543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9037972 KL Loss: 14.1461495 DSM Loss: 18.4044495 Overall Loss:34.4543960
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(40.0023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9292140 KL Loss: 14.2833616 DSM Loss: 18.2663030 Overall Loss:34.4788788
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(34.0335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9854, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9285814 KL Loss: 14.2472206 DSM Loss: 17.5965561 Overall Loss:33.7723581
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:14.310075759887695
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.3385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9063947 KL Loss: 14.3000222 DSM Loss: 23.2728809 Overall Loss:39.4792978
Validation loss decreased (inf --> 10.269799).  Saving model ...
Updating learning rate to 0.0005
tensor(39.0491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9289254 KL Loss: 14.2838258 DSM Loss: 18.7323062 Overall Loss:34.9450572
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(39.4746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9171212 KL Loss: 14.2103206 DSM Loss: 17.4615680 Overall Loss:33.5890097
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(35.1010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8752774 KL Loss: 14.1656101 DSM Loss: 17.5921645 Overall Loss:33.6330521
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:13.707672119140625
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.9108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4128, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9085549 KL Loss: 14.2680935 DSM Loss: 22.0416995 Overall Loss:38.2183479
Validation loss decreased (inf --> 11.767371).  Saving model ...
Updating learning rate to 0.0005
tensor(35.4346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8855644 KL Loss: 14.2625797 DSM Loss: 18.5649710 Overall Loss:34.7131153
Validation loss decreased (11.767371 --> 10.925377).  Saving model ...
Updating learning rate to 0.00025
tensor(31.8161, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8913640 KL Loss: 14.2169465 DSM Loss: 17.7650394 Overall Loss:33.8733499
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(40.0904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8394536 KL Loss: 14.1693129 DSM Loss: 17.3513457 Overall Loss:33.3601120
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(32.9177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8394377 KL Loss: 14.1474328 DSM Loss: 17.6615623 Overall Loss:33.6484327
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:14.593936920166016
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.4122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9251809 KL Loss: 14.3678137 DSM Loss: 22.3093195 Overall Loss:38.6023141
Validation loss decreased (inf --> 11.786998).  Saving model ...
Updating learning rate to 0.0005
tensor(37.3627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8734583 KL Loss: 14.1960653 DSM Loss: 18.9471440 Overall Loss:35.0166676
Validation loss decreased (11.786998 --> 10.238822).  Saving model ...
Updating learning rate to 0.00025
tensor(32.3159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9267894 KL Loss: 14.3233578 DSM Loss: 18.0033253 Overall Loss:34.2534725
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
tensor(28.3621, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9560, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8974185 KL Loss: 14.3462658 DSM Loss: 17.6652514 Overall Loss:33.9089355
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
tensor(29.2172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8589378 KL Loss: 14.2244672 DSM Loss: 17.5020605 Overall Loss:33.5854656
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:13.639913558959961
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.2849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9610950 KL Loss: 14.3646757 DSM Loss: 21.1037379 Overall Loss:37.4295087
Validation loss decreased (inf --> 11.548153).  Saving model ...
Updating learning rate to 0.0005
tensor(35.5002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2863, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8938957 KL Loss: 14.2074143 DSM Loss: 18.2696779 Overall Loss:34.3709880
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(36.4921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9120469 KL Loss: 14.2448215 DSM Loss: 17.7381631 Overall Loss:33.8950314
Validation loss decreased (11.548153 --> 10.818365).  Saving model ...
Updating learning rate to 0.000125
tensor(32.5730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9039166 KL Loss: 14.2141384 DSM Loss: 17.7290621 Overall Loss:33.8471172
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(33.0194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6082, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8404592 KL Loss: 14.0761347 DSM Loss: 17.3655685 Overall Loss:33.2821623
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(32.9080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8256728 KL Loss: 14.0929117 DSM Loss: 17.3367260 Overall Loss:33.2553104
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:14.351940155029297


Running on file GD.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.7404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8836163 KL Loss: 14.3248126 DSM Loss: 22.9716502 Overall Loss:39.1800790
Validation loss decreased (inf --> 5.334122).  Saving model ...
Updating learning rate to 0.0005
tensor(35.7497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9312682 KL Loss: 14.3355330 DSM Loss: 19.4326954 Overall Loss:35.6994966
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(34.5530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9039248 KL Loss: 14.2954755 DSM Loss: 18.0736198 Overall Loss:34.2730201
Validation loss decreased (5.334122 --> 5.322482).  Saving model ...
Updating learning rate to 0.000125
tensor(29.4439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8004, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8998456 KL Loss: 14.2869404 DSM Loss: 17.7244745 Overall Loss:33.9112606
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(33.8777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9288, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8912011 KL Loss: 14.2581579 DSM Loss: 17.5023351 Overall Loss:33.6516942
Validation loss decreased (5.322482 --> 5.181174).  Saving model ...
Updating learning rate to 3.125e-05
tensor(34.0668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8998879 KL Loss: 14.2233122 DSM Loss: 17.6108489 Overall Loss:33.7340492
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
tensor(30.1243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8930896 KL Loss: 14.2396378 DSM Loss: 17.6058680 Overall Loss:33.7385954
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
tensor(31.4606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8966315 KL Loss: 14.2803991 DSM Loss: 17.6559252 Overall Loss:33.8329558
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:9.739701271057129
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.1818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9621271 KL Loss: 14.3039379 DSM Loss: 22.1611981 Overall Loss:38.4272633
Validation loss decreased (inf --> 5.394982).  Saving model ...
Updating learning rate to 0.0005
tensor(46.3179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8942, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9123246 KL Loss: 14.2713788 DSM Loss: 18.4976916 Overall Loss:34.6813949
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(32.7798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8431836 KL Loss: 14.2250455 DSM Loss: 17.8772904 Overall Loss:33.9455195
Validation loss decreased (5.394982 --> 4.931861).  Saving model ...
Updating learning rate to 0.000125
tensor(30.8518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8800137 KL Loss: 14.2738751 DSM Loss: 17.8994102 Overall Loss:34.0532992
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(39.8856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8694720 KL Loss: 14.2496953 DSM Loss: 17.5651939 Overall Loss:33.6843611
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
tensor(30.3908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8930507 KL Loss: 14.3396974 DSM Loss: 17.6493203 Overall Loss:33.8820682
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:9.385326385498047
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.4506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9289049 KL Loss: 14.3899388 DSM Loss: 22.5405653 Overall Loss:38.8594088
Validation loss decreased (inf --> 4.724854).  Saving model ...
Updating learning rate to 0.0005
tensor(33.9673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6454, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9039095 KL Loss: 14.2489558 DSM Loss: 18.3720720 Overall Loss:34.5249371
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
tensor(42.4278, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9053325 KL Loss: 14.2597947 DSM Loss: 17.9708032 Overall Loss:34.1359303
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
tensor(31.2370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.9079392 KL Loss: 14.3140287 DSM Loss: 17.8275146 Overall Loss:34.0494825
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:9.08574104309082
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.3776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9215034 KL Loss: 14.3620516 DSM Loss: 20.9429477 Overall Loss:37.2265026
Validation loss decreased (inf --> 5.841800).  Saving model ...
Updating learning rate to 0.0005
tensor(28.7192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9198915 KL Loss: 14.2432268 DSM Loss: 18.5182538 Overall Loss:34.6813721
Validation loss decreased (5.841800 --> 5.561595).  Saving model ...
Updating learning rate to 0.00025
tensor(40.8443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8744184 KL Loss: 14.2154079 DSM Loss: 18.0203563 Overall Loss:34.1101825
Validation loss decreased (5.561595 --> 5.435598).  Saving model ...
Updating learning rate to 0.000125
tensor(37.3539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8623682 KL Loss: 14.2403180 DSM Loss: 17.7675817 Overall Loss:33.8702678
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
tensor(35.7591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8878588 KL Loss: 14.2182970 DSM Loss: 17.8074078 Overall Loss:33.9135633
Validation loss decreased (5.435598 --> 5.369493).  Saving model ...
Updating learning rate to 3.125e-05
tensor(23.7818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1820, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8646506 KL Loss: 14.2927226 DSM Loss: 17.4612483 Overall Loss:33.6186216
Validation loss decreased (5.369493 --> 5.162284).  Saving model ...
Updating learning rate to 1.5625e-05
