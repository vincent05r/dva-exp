Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=10, prediction_length=20, root_path='data/EcmP_stock_L_2016_24_dva_spec', scale=0.1, sequence_length=20, target_dim=1, train_epochs=30, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.8489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8952948 KL Loss: 14.1678016 DSM Loss: 22.0023243 Overall Loss:38.0654207
Validation loss decreased (inf --> 9.125543).  Saving model ...
Updating learning rate to 0.0005
tensor(24.4960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1502, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8923383 KL Loss: 14.1273542 DSM Loss: 19.4779217 Overall Loss:35.4976141
Validation loss decreased (9.125543 --> 8.401880).  Saving model ...
Updating learning rate to 0.00025
tensor(40.3269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8674113 KL Loss: 14.0025972 DSM Loss: 18.8126598 Overall Loss:34.6826681
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(46.3205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8743434 KL Loss: 13.9890641 DSM Loss: 18.4313031 Overall Loss:34.2947106
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(34.3677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8343667 KL Loss: 13.8149452 DSM Loss: 18.5487585 Overall Loss:34.1980704
Validation loss decreased (8.401880 --> 8.367758).  Saving model ...
Updating learning rate to 3.125e-05
tensor(33.5462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1427, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8465286 KL Loss: 13.8295429 DSM Loss: 18.2300407 Overall Loss:33.9061120
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(34.4572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8622285 KL Loss: 14.0089386 DSM Loss: 18.4542560 Overall Loss:34.3254230
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(34.5638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8385525 KL Loss: 13.8079473 DSM Loss: 18.3513134 Overall Loss:33.9978133
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(24.6704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3117, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8643034 KL Loss: 13.8556313 DSM Loss: 18.0442747 Overall Loss:33.7642094
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(32.9797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8581525 KL Loss: 13.9552937 DSM Loss: 18.3773300 Overall Loss:34.1907762
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(40.3060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8755738 KL Loss: 13.9564653 DSM Loss: 18.2832885 Overall Loss:34.1153274
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(44.1443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8768797 KL Loss: 13.9129595 DSM Loss: 18.1975952 Overall Loss:33.9874344
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(21.8706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.1142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8391978 KL Loss: 13.9866774 DSM Loss: 18.6363429 Overall Loss:34.4622180
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(31.1369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8840027 KL Loss: 14.0548471 DSM Loss: 17.8410796 Overall Loss:33.7799294
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(28.2112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8726584 KL Loss: 13.9628097 DSM Loss: 18.0000969 Overall Loss:33.8355650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.855838775634766


Running on file ABBV.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.8247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9469225 KL Loss: 14.1171514 DSM Loss: 22.4640127 Overall Loss:38.5280866
Validation loss decreased (inf --> 9.938253).  Saving model ...
Updating learning rate to 0.0005
tensor(41.7537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9133186 KL Loss: 14.2636987 DSM Loss: 18.7491195 Overall Loss:34.9261368
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(34.1066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8464115 KL Loss: 14.0583409 DSM Loss: 18.3176745 Overall Loss:34.2224268
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(32.4960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8758186 KL Loss: 14.2420498 DSM Loss: 17.9358872 Overall Loss:34.0537555
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(36.8966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5793, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8554294 KL Loss: 14.1356597 DSM Loss: 17.9129149 Overall Loss:33.9040040
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(37.1158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8825746 KL Loss: 14.1580256 DSM Loss: 17.8382556 Overall Loss:33.8788559
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(30.6514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8440600 KL Loss: 14.0711952 DSM Loss: 17.9799810 Overall Loss:33.8952361
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(33.1001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8559886 KL Loss: 14.1674496 DSM Loss: 17.8834662 Overall Loss:33.9069043
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(27.3029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8710493 KL Loss: 14.1386426 DSM Loss: 17.6088197 Overall Loss:33.6185116
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(21.1052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7085, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8543999 KL Loss: 14.1077685 DSM Loss: 17.5035209 Overall Loss:33.4656894
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(28.7363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2317, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8573982 KL Loss: 14.1729218 DSM Loss: 18.0033120 Overall Loss:34.0336319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:17.784465789794922


Running on file AEP.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.2109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9268553 KL Loss: 14.1914680 DSM Loss: 21.6854775 Overall Loss:37.8038006
Validation loss decreased (inf --> 2.614243).  Saving model ...
Updating learning rate to 0.0005
tensor(35.7835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9186450 KL Loss: 14.1120494 DSM Loss: 19.2376318 Overall Loss:35.2683263
Validation loss decreased (2.614243 --> 2.010141).  Saving model ...
Updating learning rate to 0.00025
tensor(34.0417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3013, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8307826 KL Loss: 13.8148947 DSM Loss: 18.5956097 Overall Loss:34.2412869
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(31.7651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8493379 KL Loss: 14.0203833 DSM Loss: 18.5786619 Overall Loss:34.4483832
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(34.4533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8113465 KL Loss: 13.8409590 DSM Loss: 18.4039441 Overall Loss:34.0562493
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(27.6831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8352864 KL Loss: 13.9595466 DSM Loss: 18.1329282 Overall Loss:33.9277614
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(28.6315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8397809 KL Loss: 13.9903038 DSM Loss: 18.3766626 Overall Loss:34.2067473
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(35.4943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8299, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8024753 KL Loss: 13.8768972 DSM Loss: 18.2054466 Overall Loss:33.8848190
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(38.4065, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8155896 KL Loss: 13.8918132 DSM Loss: 18.0873830 Overall Loss:33.7947856
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(41.1957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0148, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8333585 KL Loss: 13.8913699 DSM Loss: 18.0452662 Overall Loss:33.7699947
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(32.1409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8765, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8112581 KL Loss: 13.7391037 DSM Loss: 17.9158610 Overall Loss:33.4662229
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(37.3950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3131, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8075583 KL Loss: 13.9031895 DSM Loss: 18.1790155 Overall Loss:33.8897634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.756171941757202


Running on file AMGN.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.7726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8903371 KL Loss: 14.0891068 DSM Loss: 23.8922563 Overall Loss:39.8717000
Validation loss decreased (inf --> 1.350634).  Saving model ...
Updating learning rate to 0.0005
tensor(35.1316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8425491 KL Loss: 14.0627570 DSM Loss: 19.2709877 Overall Loss:35.1762938
Validation loss decreased (1.350634 --> 1.100533).  Saving model ...
Updating learning rate to 0.00025
tensor(39.0435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8461423 KL Loss: 14.0444159 DSM Loss: 18.6895318 Overall Loss:34.5800900
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(24.4678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8424743 KL Loss: 14.0270638 DSM Loss: 18.5599041 Overall Loss:34.4294418
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(36.4688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2898, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8794289 KL Loss: 13.9012173 DSM Loss: 18.8210455 Overall Loss:34.6016917
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(33.8862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8857459 KL Loss: 14.1297506 DSM Loss: 18.3561655 Overall Loss:34.3716619
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(32.7552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8818581 KL Loss: 14.1462887 DSM Loss: 18.2595340 Overall Loss:34.2876806
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(33.0227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9814, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8432378 KL Loss: 13.9161356 DSM Loss: 18.6388894 Overall Loss:34.3982629
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(34.2768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0731, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8284498 KL Loss: 13.8811896 DSM Loss: 18.5214493 Overall Loss:34.2310889
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(33.1224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9737, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8431705 KL Loss: 14.0263979 DSM Loss: 18.2399901 Overall Loss:34.1095584
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(34.3849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8476458 KL Loss: 14.0632624 DSM Loss: 18.1460050 Overall Loss:34.0569133
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(32.4410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3374, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8334591 KL Loss: 13.9253304 DSM Loss: 18.0683504 Overall Loss:33.8271399
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.005749702453613


Running on file AMZN.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.7432, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8428187 KL Loss: 14.1857410 DSM Loss: 23.9441121 Overall Loss:39.9726716
Validation loss decreased (inf --> 3.451565).  Saving model ...
Updating learning rate to 0.0005
tensor(33.8846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4319, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9019271 KL Loss: 14.2857665 DSM Loss: 19.7103877 Overall Loss:35.8980813
Validation loss decreased (3.451565 --> 2.834745).  Saving model ...
Updating learning rate to 0.00025
tensor(28.5290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5229, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8583657 KL Loss: 14.1080937 DSM Loss: 18.9765232 Overall Loss:34.9429826
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(38.2973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1928, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8930341 KL Loss: 14.2662741 DSM Loss: 18.3749322 Overall Loss:34.5342404
Validation loss decreased (2.834745 --> 2.784356).  Saving model ...
Updating learning rate to 6.25e-05
tensor(39.7310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8726326 KL Loss: 14.1765211 DSM Loss: 18.2772032 Overall Loss:34.3263567
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(35.9440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8801861 KL Loss: 14.0958512 DSM Loss: 18.4586892 Overall Loss:34.4347265
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(31.9544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8401577 KL Loss: 14.0147242 DSM Loss: 18.2507816 Overall Loss:34.1056632
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(32.5774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1706, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8672402 KL Loss: 14.0980167 DSM Loss: 18.2603599 Overall Loss:34.2256167
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(37.9629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8488633 KL Loss: 13.9914208 DSM Loss: 18.4553105 Overall Loss:34.2955946
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(34.8196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8431012 KL Loss: 14.0678387 DSM Loss: 18.3388297 Overall Loss:34.2497695
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(31.3727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8587352 KL Loss: 14.0808350 DSM Loss: 18.1324345 Overall Loss:34.0720046
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(28.5420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8375949 KL Loss: 13.9150007 DSM Loss: 18.2987057 Overall Loss:34.0513012
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.4449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8686598 KL Loss: 14.1328404 DSM Loss: 18.2718083 Overall Loss:34.2733084
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(32.0388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5067, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8792802 KL Loss: 14.1470700 DSM Loss: 17.9170778 Overall Loss:33.9434279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5201550126075745


Running on file BA.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.9883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9076156 KL Loss: 14.2373200 DSM Loss: 23.1549986 Overall Loss:39.2999341
Validation loss decreased (inf --> 0.172170).  Saving model ...
Updating learning rate to 0.0005
tensor(36.4803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8825422 KL Loss: 14.1713422 DSM Loss: 19.9922185 Overall Loss:36.0461031
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(34.2417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8860827 KL Loss: 14.2084242 DSM Loss: 19.3913897 Overall Loss:35.4858966
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(28.3921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7619, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8365101 KL Loss: 14.1139312 DSM Loss: 18.8489770 Overall Loss:34.7994183
Validation loss decreased (0.172170 --> 0.170765).  Saving model ...
Updating learning rate to 6.25e-05
tensor(38.7970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8585536 KL Loss: 14.1530649 DSM Loss: 18.4853534 Overall Loss:34.4969714
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(34.5097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5549, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8348026 KL Loss: 14.1234877 DSM Loss: 18.5477173 Overall Loss:34.5060075
Validation loss decreased (0.170765 --> 0.168559).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(29.5653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7501, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8515957 KL Loss: 14.0962479 DSM Loss: 18.6857649 Overall Loss:34.6336085
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(35.9709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8224157 KL Loss: 14.0072024 DSM Loss: 18.6438451 Overall Loss:34.4734630
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(35.3392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8283619 KL Loss: 14.0534551 DSM Loss: 18.6237142 Overall Loss:34.5055310
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(35.4646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9625, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8822017 KL Loss: 14.1199965 DSM Loss: 18.8548358 Overall Loss:34.8570339
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(33.7613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7535, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8126706 KL Loss: 13.9986594 DSM Loss: 18.4972169 Overall Loss:34.3085467
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.8102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7911261 KL Loss: 13.9470464 DSM Loss: 18.8131269 Overall Loss:34.5512992
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(36.7522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8238749 KL Loss: 13.9879691 DSM Loss: 18.7858375 Overall Loss:34.5976813
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(26.5721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3371, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8287260 KL Loss: 14.0741764 DSM Loss: 18.5307039 Overall Loss:34.4336064
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(33.3358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8164435 KL Loss: 14.0432095 DSM Loss: 18.5826124 Overall Loss:34.4422654
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(41.2821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8651, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9964, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8163764 KL Loss: 13.9975297 DSM Loss: 18.8138834 Overall Loss:34.6277894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.39223310351371765


Running on file BAC.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.7633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4805, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8705300 KL Loss: 14.1296704 DSM Loss: 21.4295617 Overall Loss:37.4297621
Validation loss decreased (inf --> 6.526980).  Saving model ...
Updating learning rate to 0.0005
tensor(38.3920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3864, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8570118 KL Loss: 14.1616208 DSM Loss: 18.9748169 Overall Loss:34.9934493
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(33.2644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.1691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8656053 KL Loss: 14.0540503 DSM Loss: 18.1177272 Overall Loss:34.0373828
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(47.5891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8603905 KL Loss: 14.0412030 DSM Loss: 18.2492459 Overall Loss:34.1508393
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(22.8369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.9729, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8439674 KL Loss: 13.9722916 DSM Loss: 18.1512999 Overall Loss:33.9675589
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(31.6469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8141793 KL Loss: 13.8231529 DSM Loss: 17.8998542 Overall Loss:33.5371864
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(19.0479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8061023 KL Loss: 13.8359103 DSM Loss: 17.5333216 Overall Loss:33.1753343
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(46.4869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8295488 KL Loss: 13.8458015 DSM Loss: 17.7473502 Overall Loss:33.4227005
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(25.9725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0001, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8396491 KL Loss: 13.8736810 DSM Loss: 17.5807758 Overall Loss:33.2941055
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(30.1525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8057237 KL Loss: 13.8479166 DSM Loss: 18.1047685 Overall Loss:33.7584088
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(34.2061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8590963 KL Loss: 14.0297461 DSM Loss: 17.8669397 Overall Loss:33.7557822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9076538681983948


Running on file BCH.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(45.3676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8513465 KL Loss: 14.0304623 DSM Loss: 21.4850324 Overall Loss:37.3668411
Validation loss decreased (inf --> 0.491920).  Saving model ...
Updating learning rate to 0.0005
tensor(31.0259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9265824 KL Loss: 14.2248081 DSM Loss: 19.9026742 Overall Loss:36.0540648
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(35.1566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8883900 KL Loss: 14.0718355 DSM Loss: 18.7845948 Overall Loss:34.7448201
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(30.9990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2741, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8432019 KL Loss: 14.0704925 DSM Loss: 18.8751658 Overall Loss:34.7888600
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(37.3802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1371, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8393375 KL Loss: 14.0282086 DSM Loss: 18.6937439 Overall Loss:34.5612898
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(35.6344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8144833 KL Loss: 14.0706396 DSM Loss: 18.6864224 Overall Loss:34.5715450
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(37.4821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8624805 KL Loss: 14.1254508 DSM Loss: 18.4734761 Overall Loss:34.4614072
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(30.7099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8919, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8125764 KL Loss: 14.1816306 DSM Loss: 18.3425127 Overall Loss:34.3367198
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(36.5628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8119652 KL Loss: 14.0954779 DSM Loss: 18.2109702 Overall Loss:34.1184133
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(37.3317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8023555 KL Loss: 14.0237320 DSM Loss: 18.2820133 Overall Loss:34.1081006
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(36.6147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8556, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8258678 KL Loss: 14.1365952 DSM Loss: 18.5329795 Overall Loss:34.4954423
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.19074498116970062


Running on file BHP.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(55.2224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1434, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9279463 KL Loss: 14.3521330 DSM Loss: 26.5384116 Overall Loss:42.8184909
Validation loss decreased (inf --> 1.857612).  Saving model ...
Updating learning rate to 0.0005
tensor(41.3242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8801493 KL Loss: 14.1093253 DSM Loss: 18.6612934 Overall Loss:34.6507681
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(33.9790, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8724622 KL Loss: 13.9842598 DSM Loss: 18.1915479 Overall Loss:34.0482699
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(34.1000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8354905 KL Loss: 13.9207163 DSM Loss: 17.5230175 Overall Loss:33.2792243
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(31.6473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1718, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8891613 KL Loss: 14.0372930 DSM Loss: 17.5858966 Overall Loss:33.5123506
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(27.0775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3230, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8997657 KL Loss: 13.9854094 DSM Loss: 17.3277080 Overall Loss:33.2128829
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(50.7280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8462455 KL Loss: 13.9416497 DSM Loss: 17.5638053 Overall Loss:33.3517004
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(23.5832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9688, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7845486 KL Loss: 13.7099371 DSM Loss: 17.4536641 Overall Loss:32.9481497
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(29.3134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6677, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8083770 KL Loss: 13.8666711 DSM Loss: 17.6643182 Overall Loss:33.3393662
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(41.6566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6326, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8290346 KL Loss: 13.9380984 DSM Loss: 17.4513188 Overall Loss:33.2184518
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(28.4058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3865, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7967729 KL Loss: 13.8024732 DSM Loss: 17.4557465 Overall Loss:33.0549925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.0351295471191406


Running on file BP.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.0564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9582139 KL Loss: 14.2120536 DSM Loss: 23.3496239 Overall Loss:39.5198915
Validation loss decreased (inf --> 0.158405).  Saving model ...
Updating learning rate to 0.0005
tensor(34.4385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3844, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9111121 KL Loss: 14.1906528 DSM Loss: 20.2316777 Overall Loss:36.3334427
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(36.5636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8727123 KL Loss: 14.1465045 DSM Loss: 19.1518701 Overall Loss:35.1710867
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(33.9268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8575711 KL Loss: 14.0417341 DSM Loss: 19.0360721 Overall Loss:34.9353770
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(31.2420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8284714 KL Loss: 13.9673301 DSM Loss: 18.8787844 Overall Loss:34.6745857
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(33.1883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7891196 KL Loss: 13.7975574 DSM Loss: 18.5248996 Overall Loss:34.1115768
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(28.8264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8061647 KL Loss: 13.9707794 DSM Loss: 18.8323582 Overall Loss:34.6093022
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(28.4491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8125903 KL Loss: 13.8218704 DSM Loss: 18.6279433 Overall Loss:34.2624039
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(27.6796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8193716 KL Loss: 13.9563728 DSM Loss: 18.7640966 Overall Loss:34.5398407
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(27.3632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7988512 KL Loss: 13.8246818 DSM Loss: 18.6342147 Overall Loss:34.2577478
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(41.8943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6708, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8383484 KL Loss: 13.9672878 DSM Loss: 18.8391688 Overall Loss:34.6448050
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.3333511352539062


Running on file BRK-A.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(64.9088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9333045 KL Loss: 14.1676958 DSM Loss: 21.7325862 Overall Loss:37.8335866
Validation loss decreased (inf --> 9.285150).  Saving model ...
Updating learning rate to 0.0005
tensor(28.4650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5974, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8884583 KL Loss: 14.1237145 DSM Loss: 18.3812331 Overall Loss:34.3934059
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(45.3587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8237934 KL Loss: 13.8781587 DSM Loss: 17.6354507 Overall Loss:33.3374026
Validation loss decreased (9.285150 --> 8.954354).  Saving model ...
Updating learning rate to 0.000125
tensor(38.6210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.8604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8506470 KL Loss: 13.9001069 DSM Loss: 17.3380722 Overall Loss:33.0888260
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(34.7896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8006, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8216460 KL Loss: 13.8430142 DSM Loss: 17.5387785 Overall Loss:33.2034389
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(30.4378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8617751 KL Loss: 13.7433186 DSM Loss: 16.7934924 Overall Loss:32.3985861
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(31.4364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8230750 KL Loss: 13.8344254 DSM Loss: 17.0053090 Overall Loss:32.6628094
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(46.7353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0604, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8610367 KL Loss: 13.8651074 DSM Loss: 17.2814970 Overall Loss:33.0076412
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(33.6246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8621444 KL Loss: 13.9441394 DSM Loss: 17.4934059 Overall Loss:33.2996895
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(24.0653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8308640 KL Loss: 13.8356261 DSM Loss: 17.2896542 Overall Loss:32.9561443
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(39.9267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8342900 KL Loss: 13.8997730 DSM Loss: 17.4623872 Overall Loss:33.1964502
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(25.2097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7675, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8549600 KL Loss: 13.9020368 DSM Loss: 17.5499852 Overall Loss:33.3069819
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(26.0359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8417764 KL Loss: 13.8120126 DSM Loss: 16.6874107 Overall Loss:32.3411997
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:11.421231269836426


Running on file BSAC.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(55.4276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5582, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8778032 KL Loss: 14.1598879 DSM Loss: 22.7056407 Overall Loss:38.7433316
Validation loss decreased (inf --> 0.189297).  Saving model ...
Updating learning rate to 0.0005
tensor(41.1598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4270, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6000, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8557600 KL Loss: 14.0523143 DSM Loss: 19.3702389 Overall Loss:35.2783134
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(36.5771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8762473 KL Loss: 14.1509239 DSM Loss: 18.9972081 Overall Loss:35.0243792
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(41.2346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7177, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8761425 KL Loss: 14.1091277 DSM Loss: 18.4554926 Overall Loss:34.4407628
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(34.0482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7766457 KL Loss: 13.8772593 DSM Loss: 18.2953696 Overall Loss:33.9492745
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(33.9275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8197496 KL Loss: 14.1111994 DSM Loss: 18.3081613 Overall Loss:34.2391104
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(34.5954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7936490 KL Loss: 13.8761716 DSM Loss: 18.4571951 Overall Loss:34.1270158
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(32.1194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8115249 KL Loss: 14.0450692 DSM Loss: 18.0493290 Overall Loss:33.9059230
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(29.5629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7846856 KL Loss: 13.9676169 DSM Loss: 18.3443124 Overall Loss:34.0966149
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(30.8966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8326588 KL Loss: 13.9699523 DSM Loss: 18.3164432 Overall Loss:34.1190540
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(36.5232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8024611 KL Loss: 13.9967514 DSM Loss: 18.3225880 Overall Loss:34.1218003
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.4011850357055664


Running on file BUD.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.4336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8135, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8800288 KL Loss: 14.2009558 DSM Loss: 25.1949968 Overall Loss:41.2759812
Validation loss decreased (inf --> 3.887619).  Saving model ...
Updating learning rate to 0.0005
tensor(27.8353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8826920 KL Loss: 13.9914898 DSM Loss: 19.8392163 Overall Loss:35.7133980
Validation loss decreased (3.887619 --> 1.496525).  Saving model ...
Updating learning rate to 0.00025
tensor(36.2318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6680, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8201508 KL Loss: 13.9209116 DSM Loss: 19.7406700 Overall Loss:35.4817324
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(31.5406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7823919 KL Loss: 13.8734571 DSM Loss: 19.2119532 Overall Loss:34.8678023
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(40.3787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8254311 KL Loss: 14.0133800 DSM Loss: 19.1669464 Overall Loss:35.0057576
Validation loss decreased (1.496525 --> 1.434987).  Saving model ...
Updating learning rate to 3.125e-05
tensor(38.5320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7900895 KL Loss: 13.8393138 DSM Loss: 18.8591862 Overall Loss:34.4885892
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(25.5589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.8451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8121649 KL Loss: 13.8281976 DSM Loss: 19.1027433 Overall Loss:34.7431056
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(28.6878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8305508 KL Loss: 13.9647922 DSM Loss: 19.0375981 Overall Loss:34.8329411
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(30.4194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8199363 KL Loss: 13.9690141 DSM Loss: 19.0162878 Overall Loss:34.8052382
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(35.5095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.8335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7768664 KL Loss: 13.8281248 DSM Loss: 18.7437695 Overall Loss:34.3487606
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(31.3671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7869298 KL Loss: 13.7736377 DSM Loss: 18.6784606 Overall Loss:34.2390282
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(46.8570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3310, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7974653 KL Loss: 13.8492288 DSM Loss: 18.6725034 Overall Loss:34.3191976
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(28.0199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4495, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8084879 KL Loss: 13.8099672 DSM Loss: 19.3802470 Overall Loss:34.9987020
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(29.3170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.7815623 KL Loss: 13.7843160 DSM Loss: 18.7356560 Overall Loss:34.3015343
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(38.3101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8084357 KL Loss: 13.8122001 DSM Loss: 19.0208636 Overall Loss:34.6414994
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.7778106927871704


Running on file C.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.8880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2098, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9881107 KL Loss: 14.3002558 DSM Loss: 23.4720252 Overall Loss:39.7603917
Validation loss decreased (inf --> 0.727414).  Saving model ...
Updating learning rate to 0.0005
tensor(32.6473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9051150 KL Loss: 14.1832256 DSM Loss: 19.4910646 Overall Loss:35.5794050
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(31.0415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9188603 KL Loss: 14.2271226 DSM Loss: 18.6116147 Overall Loss:34.7575976
Validation loss decreased (0.727414 --> 0.628648).  Saving model ...
Updating learning rate to 0.000125
tensor(35.8982, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8851281 KL Loss: 14.0918652 DSM Loss: 18.4817121 Overall Loss:34.4587053
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(41.8829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8181044 KL Loss: 14.0003300 DSM Loss: 18.2308256 Overall Loss:34.0492598
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(36.6012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7901243 KL Loss: 14.0052489 DSM Loss: 18.2368155 Overall Loss:34.0321886
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(32.8966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8110707 KL Loss: 14.1059921 DSM Loss: 18.0090547 Overall Loss:33.9261175
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(36.8507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6542, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8171661 KL Loss: 14.0987105 DSM Loss: 18.0689813 Overall Loss:33.9848581
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(36.6018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8140071 KL Loss: 14.0932653 DSM Loss: 17.9591862 Overall Loss:33.8664584
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(28.7049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8260184 KL Loss: 14.0139683 DSM Loss: 18.0807190 Overall Loss:33.9207057
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(31.5743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8346, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8368584 KL Loss: 14.1616150 DSM Loss: 17.9344629 Overall Loss:33.9329361
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(34.6699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0392, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8334625 KL Loss: 14.1203241 DSM Loss: 18.0402623 Overall Loss:33.9940487
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(31.0328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8216098 KL Loss: 14.0913319 DSM Loss: 18.0056223 Overall Loss:33.9185641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7636295557022095


Running on file CAT.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.0734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9274831 KL Loss: 14.2371047 DSM Loss: 22.9091879 Overall Loss:39.0737757
Validation loss decreased (inf --> 4.253734).  Saving model ...
Updating learning rate to 0.0005
tensor(53.5090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8783430 KL Loss: 14.0991601 DSM Loss: 19.2911173 Overall Loss:35.2686206
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(46.8963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7953, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8437777 KL Loss: 13.9569579 DSM Loss: 18.2036507 Overall Loss:34.0043863
Validation loss decreased (4.253734 --> 3.693055).  Saving model ...
Updating learning rate to 0.000125
tensor(44.0669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8576283 KL Loss: 13.8774807 DSM Loss: 18.1593049 Overall Loss:33.8944138
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(24.2014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7937488 KL Loss: 13.8706080 DSM Loss: 18.1052398 Overall Loss:33.7695965
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(29.7585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8724837 KL Loss: 13.9466587 DSM Loss: 17.8543028 Overall Loss:33.6734451
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(26.1608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8356269 KL Loss: 14.0022988 DSM Loss: 18.3399087 Overall Loss:34.1778343
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(33.4290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8414847 KL Loss: 13.9065537 DSM Loss: 18.0367069 Overall Loss:33.7847453
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(34.4809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8586578 KL Loss: 13.8457040 DSM Loss: 17.0179419 Overall Loss:32.7223037
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(39.8010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0236, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8256788 KL Loss: 13.8741075 DSM Loss: 17.9122761 Overall Loss:33.6120626
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(22.3396, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8086833 KL Loss: 13.9201456 DSM Loss: 17.9653508 Overall Loss:33.6941797
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.2484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4804, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8155124 KL Loss: 13.9140110 DSM Loss: 18.1577108 Overall Loss:33.8872344
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(50.8001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3953, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8871043 KL Loss: 13.9324221 DSM Loss: 18.0135501 Overall Loss:33.8330763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.267029285430908


Running on file CHTR.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.3115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8660573 KL Loss: 14.0398929 DSM Loss: 22.2818012 Overall Loss:38.1877516
Validation loss decreased (inf --> 2.727974).  Saving model ...
Updating learning rate to 0.0005
tensor(38.6882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0804, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8546291 KL Loss: 14.0115603 DSM Loss: 19.2239713 Overall Loss:35.0901607
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(39.7330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.1026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.9345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8689825 KL Loss: 14.0400998 DSM Loss: 18.1977805 Overall Loss:34.1068626
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(42.5911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8595249 KL Loss: 13.9917053 DSM Loss: 18.1273683 Overall Loss:33.9785987
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(35.7040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8244461 KL Loss: 13.9590516 DSM Loss: 17.8422104 Overall Loss:33.6257081
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(26.9662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8104778 KL Loss: 13.8858242 DSM Loss: 17.8456384 Overall Loss:33.5419404
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(39.3426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8083018 KL Loss: 13.9835898 DSM Loss: 17.7709197 Overall Loss:33.5628113
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(38.7373, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8492060 KL Loss: 13.9351490 DSM Loss: 17.7070238 Overall Loss:33.4913786
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(39.8602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8360180 KL Loss: 13.9805548 DSM Loss: 17.6471029 Overall Loss:33.4636756
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(48.7101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8476760 KL Loss: 13.9123080 DSM Loss: 17.8553869 Overall Loss:33.6153711
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(23.9159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7966728 KL Loss: 13.7136292 DSM Loss: 17.8730269 Overall Loss:33.3833288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.1472129374742508


Running on file CMCSA.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.1036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8674575 KL Loss: 14.1699998 DSM Loss: 25.9386184 Overall Loss:41.9760759
Validation loss decreased (inf --> 2.427566).  Saving model ...
Updating learning rate to 0.0005
tensor(41.9972, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8766567 KL Loss: 14.0272188 DSM Loss: 18.4437904 Overall Loss:34.3476657
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(51.4589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8408206 KL Loss: 13.8986401 DSM Loss: 17.7578116 Overall Loss:33.4972724
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(26.4464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8295211 KL Loss: 13.8885160 DSM Loss: 17.5645431 Overall Loss:33.2825802
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(36.6991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2364, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0673, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8400589 KL Loss: 13.8974044 DSM Loss: 17.7767364 Overall Loss:33.5141996
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(37.9958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.6990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2983, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8342387 KL Loss: 13.8948616 DSM Loss: 17.3221808 Overall Loss:33.0512810
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(33.3254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8102295 KL Loss: 13.6574615 DSM Loss: 17.4267728 Overall Loss:32.8944639
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(32.0675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0395, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7660699 KL Loss: 13.7289356 DSM Loss: 17.6798955 Overall Loss:33.1749009
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(29.8955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1669, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7871875 KL Loss: 13.7247110 DSM Loss: 17.5986048 Overall Loss:33.1105031
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(26.5837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7808058 KL Loss: 13.8247373 DSM Loss: 17.8782414 Overall Loss:33.4837847
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(27.3723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7835411 KL Loss: 13.8038558 DSM Loss: 17.3885623 Overall Loss:32.9759594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.36215856671333313


Running on file CODI.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.3777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7460, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9386265 KL Loss: 14.2315126 DSM Loss: 25.5657165 Overall Loss:41.7358557
Validation loss decreased (inf --> 11.516298).  Saving model ...
Updating learning rate to 0.0005
tensor(26.5005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.2600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8729702 KL Loss: 14.0439872 DSM Loss: 19.7377264 Overall Loss:35.6546840
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(30.9068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9546, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8904472 KL Loss: 14.0749820 DSM Loss: 18.3891312 Overall Loss:34.3545604
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(27.7208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8516413 KL Loss: 13.9022492 DSM Loss: 18.0486651 Overall Loss:33.8025554
Validation loss decreased (11.516298 --> 11.180282).  Saving model ...
Updating learning rate to 6.25e-05
tensor(39.1594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8654371 KL Loss: 13.9013607 DSM Loss: 17.8092739 Overall Loss:33.5760717
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(37.5017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8183352 KL Loss: 13.8466208 DSM Loss: 18.0704080 Overall Loss:33.7353639
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(36.9511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3678, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8105091 KL Loss: 13.8532561 DSM Loss: 18.0617279 Overall Loss:33.7254929
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(28.5231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7860726 KL Loss: 13.6892703 DSM Loss: 18.1194622 Overall Loss:33.5948049
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(28.8915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8330425 KL Loss: 13.8921091 DSM Loss: 17.9134836 Overall Loss:33.6386352
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(42.4745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7897293 KL Loss: 13.7491580 DSM Loss: 17.8820042 Overall Loss:33.4208915
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(27.0400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4630, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8343162 KL Loss: 13.8349980 DSM Loss: 18.0040931 Overall Loss:33.6734074
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(26.1923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8675026 KL Loss: 13.9524930 DSM Loss: 17.7111166 Overall Loss:33.5311123
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(24.3595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.7786115 KL Loss: 13.6548818 DSM Loss: 18.0784046 Overall Loss:33.5118979
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(50.9316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.8109, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8278556 KL Loss: 13.8530280 DSM Loss: 17.9248654 Overall Loss:33.6057490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.2734673023223877


Running on file CSCO.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.0334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9113299 KL Loss: 14.1692309 DSM Loss: 25.0221039 Overall Loss:41.1026647
Validation loss decreased (inf --> 3.751889).  Saving model ...
Updating learning rate to 0.0005
tensor(37.6862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6215, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8851635 KL Loss: 14.1550210 DSM Loss: 18.8160621 Overall Loss:34.8562464
Validation loss decreased (3.751889 --> 3.295512).  Saving model ...
Updating learning rate to 0.00025
tensor(30.4130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9248, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8613639 KL Loss: 14.1171736 DSM Loss: 18.1802630 Overall Loss:34.1588003
Validation loss decreased (3.295512 --> 3.104757).  Saving model ...
Updating learning rate to 0.000125
tensor(33.4884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8101514 KL Loss: 13.8943967 DSM Loss: 18.0404435 Overall Loss:33.7449917
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(38.2879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8218291 KL Loss: 13.9542510 DSM Loss: 17.6319591 Overall Loss:33.4080394
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(25.7638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.5252, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3033, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8293052 KL Loss: 13.9948434 DSM Loss: 17.6509390 Overall Loss:33.4750873
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(32.0809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7788874 KL Loss: 13.9586830 DSM Loss: 17.6503403 Overall Loss:33.3879106
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(35.0393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7860268 KL Loss: 13.9002129 DSM Loss: 17.7585307 Overall Loss:33.4447703
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(35.8051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8258241 KL Loss: 13.8875415 DSM Loss: 17.6418213 Overall Loss:33.3551870
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(30.1642, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8013498 KL Loss: 13.9041549 DSM Loss: 17.8157458 Overall Loss:33.5212506
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(29.3136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7853676 KL Loss: 13.7968302 DSM Loss: 17.6847977 Overall Loss:33.2669957
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.6785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2171, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8265419 KL Loss: 14.0052801 DSM Loss: 17.8142137 Overall Loss:33.6460356
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.2850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.7773972 KL Loss: 13.9482221 DSM Loss: 17.7323018 Overall Loss:33.4579212
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.4706683158874512


Running on file CVX.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(47.2268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9519411 KL Loss: 14.3571347 DSM Loss: 22.5220269 Overall Loss:38.8311028
Validation loss decreased (inf --> 11.378126).  Saving model ...
Updating learning rate to 0.0005
tensor(33.9515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8695138 KL Loss: 14.0991376 DSM Loss: 19.6899078 Overall Loss:35.6585594
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(33.9374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.4209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8580605 KL Loss: 14.0978593 DSM Loss: 18.8876666 Overall Loss:34.8435866
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(28.0240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1941, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8238811 KL Loss: 14.1248748 DSM Loss: 17.9464667 Overall Loss:33.8952227
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(29.4716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7826449 KL Loss: 13.9447526 DSM Loss: 17.6339825 Overall Loss:33.3613800
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(37.7718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8675, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8283260 KL Loss: 14.1373555 DSM Loss: 17.4127183 Overall Loss:33.3783997
Validation loss decreased (11.378126 --> 11.312965).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(37.8447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1572, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7871609 KL Loss: 13.8953065 DSM Loss: 17.2408436 Overall Loss:32.9233111
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(31.5876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8235287 KL Loss: 13.9718269 DSM Loss: 17.5862095 Overall Loss:33.3815652
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(38.5010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7994763 KL Loss: 14.0186920 DSM Loss: 17.4542815 Overall Loss:33.2724497
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(40.8374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8017150 KL Loss: 14.0653614 DSM Loss: 17.3136705 Overall Loss:33.1807469
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(30.4168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0582, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7977932 KL Loss: 13.9143654 DSM Loss: 17.4205481 Overall Loss:33.1327068
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.1725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7933, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8098552 KL Loss: 13.9062500 DSM Loss: 17.5227096 Overall Loss:33.2388148
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(38.6676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8283371 KL Loss: 14.0967336 DSM Loss: 17.3265968 Overall Loss:33.2516674
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(27.7366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.7754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.7952343 KL Loss: 13.9451929 DSM Loss: 17.1377906 Overall Loss:32.8782180
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(34.0984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8028903 KL Loss: 13.9825299 DSM Loss: 17.2221457 Overall Loss:33.0075659
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(38.2289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.7925383 KL Loss: 13.8876080 DSM Loss: 17.5628275 Overall Loss:33.2429736
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:37.07216262817383


Running on file D.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.1084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8688798 KL Loss: 14.2136822 DSM Loss: 26.7569966 Overall Loss:42.8395588
Validation loss decreased (inf --> 3.270331).  Saving model ...
Updating learning rate to 0.0005
tensor(37.2340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6498, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9372737 KL Loss: 14.2472683 DSM Loss: 19.6076419 Overall Loss:35.7921837
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(37.9135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8685526 KL Loss: 14.1763752 DSM Loss: 19.1372360 Overall Loss:35.1821636
Validation loss decreased (3.270331 --> 2.998201).  Saving model ...
Updating learning rate to 0.000125
tensor(38.6105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2127, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8716170 KL Loss: 14.1051830 DSM Loss: 18.2139041 Overall Loss:34.1907039
Validation loss decreased (2.998201 --> 2.932912).  Saving model ...
Updating learning rate to 6.25e-05
tensor(34.9398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2381, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1727, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8579906 KL Loss: 14.1667218 DSM Loss: 18.0434229 Overall Loss:34.0681350
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(34.8129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8513371 KL Loss: 14.1309054 DSM Loss: 18.2940839 Overall Loss:34.2763263
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(36.6114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1701, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8416630 KL Loss: 14.1243077 DSM Loss: 17.9355474 Overall Loss:33.9015184
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(38.1580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4572, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8641922 KL Loss: 14.1818553 DSM Loss: 18.0857392 Overall Loss:34.1317868
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(24.2078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8399249 KL Loss: 14.1853498 DSM Loss: 17.9515823 Overall Loss:33.9768572
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(33.9247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4776, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8241547 KL Loss: 14.1225981 DSM Loss: 18.0236398 Overall Loss:33.9703927
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(31.0361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0440, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8497201 KL Loss: 14.1071272 DSM Loss: 18.3670742 Overall Loss:34.3239217
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.3158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5588, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8014206 KL Loss: 13.9690362 DSM Loss: 18.1275323 Overall Loss:33.8979892
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(36.7125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8443948 KL Loss: 14.1029144 DSM Loss: 18.0838060 Overall Loss:34.0311151
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(35.6312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8252520 KL Loss: 14.0122930 DSM Loss: 17.8187353 Overall Loss:33.6562804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.981523275375366


Running on file DHR.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(64.9622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8576509 KL Loss: 14.1054952 DSM Loss: 23.5261517 Overall Loss:39.4892981
Validation loss decreased (inf --> 8.244666).  Saving model ...
Updating learning rate to 0.0005
tensor(33.0733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8492926 KL Loss: 14.0980995 DSM Loss: 18.7994830 Overall Loss:34.7468750
Validation loss decreased (8.244666 --> 7.609529).  Saving model ...
Updating learning rate to 0.00025
tensor(32.2848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8533556 KL Loss: 13.9259790 DSM Loss: 18.4048418 Overall Loss:34.1841763
Validation loss decreased (7.609529 --> 7.399473).  Saving model ...
Updating learning rate to 0.000125
tensor(24.6251, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4741, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8567049 KL Loss: 13.9537286 DSM Loss: 18.2671804 Overall Loss:34.0776138
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(35.7248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8126452 KL Loss: 13.8318052 DSM Loss: 18.2657258 Overall Loss:33.9101760
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(26.5739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8307928 KL Loss: 13.7805876 DSM Loss: 17.8228647 Overall Loss:33.4342451
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(54.0329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.7016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8023908 KL Loss: 13.6913019 DSM Loss: 17.8928682 Overall Loss:33.3865609
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(30.5571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8361, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8204218 KL Loss: 13.7889713 DSM Loss: 17.9434702 Overall Loss:33.5528632
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(33.7935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8134548 KL Loss: 13.7280098 DSM Loss: 17.7814196 Overall Loss:33.3228841
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(38.8809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8180839 KL Loss: 13.6627966 DSM Loss: 17.7912810 Overall Loss:33.2721615
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(37.6382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5011, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8183976 KL Loss: 13.6439082 DSM Loss: 17.8034338 Overall Loss:33.2657396
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(42.1600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8618863 KL Loss: 13.9080420 DSM Loss: 17.8903128 Overall Loss:33.6602411
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(24.1360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.9324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1391, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8020534 KL Loss: 13.7219066 DSM Loss: 17.6474815 Overall Loss:33.1714413
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.9214980602264404


Running on file DIS.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.5192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0598, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9076564 KL Loss: 14.0506782 DSM Loss: 23.0494232 Overall Loss:39.0077577
Validation loss decreased (inf --> 1.853880).  Saving model ...
Updating learning rate to 0.0005
tensor(27.8292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0497, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9055503 KL Loss: 14.1084520 DSM Loss: 19.7153467 Overall Loss:35.7293490
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(29.0981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3722, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8692430 KL Loss: 14.0068431 DSM Loss: 19.3364445 Overall Loss:35.2125305
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(44.7752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8481526 KL Loss: 13.9933462 DSM Loss: 19.1319202 Overall Loss:34.9734191
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(24.5805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8308130 KL Loss: 13.9082080 DSM Loss: 18.8197827 Overall Loss:34.5588038
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(32.6031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8380976 KL Loss: 13.9415287 DSM Loss: 18.7235955 Overall Loss:34.5032217
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(24.8429, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6713, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8186393 KL Loss: 13.8616794 DSM Loss: 18.6782325 Overall Loss:34.3585513
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(29.5109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6376, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8165857 KL Loss: 13.8443326 DSM Loss: 18.2579950 Overall Loss:33.9189133
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(33.6341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7922046 KL Loss: 13.7580560 DSM Loss: 18.6896347 Overall Loss:34.2398953
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(34.6674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8127364 KL Loss: 13.8099659 DSM Loss: 18.4907354 Overall Loss:34.1134376
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(24.3961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4073, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8251514 KL Loss: 13.9069163 DSM Loss: 18.1971118 Overall Loss:33.9291795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.841057538986206


Running on file DUK.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.8375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9499743 KL Loss: 14.3962559 DSM Loss: 21.9526970 Overall Loss:38.2989273
Validation loss decreased (inf --> 6.032477).  Saving model ...
Updating learning rate to 0.0005
tensor(39.4756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9126475 KL Loss: 14.1273559 DSM Loss: 18.4231802 Overall Loss:34.4631836
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(43.0244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9299175 KL Loss: 14.2613984 DSM Loss: 17.7724917 Overall Loss:33.9638073
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(31.5886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8477610 KL Loss: 13.9196606 DSM Loss: 17.7178996 Overall Loss:33.4853213
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(36.3756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8124399 KL Loss: 13.8492250 DSM Loss: 17.5198106 Overall Loss:33.1814756
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(32.4118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7913615 KL Loss: 13.8326129 DSM Loss: 17.3476106 Overall Loss:32.9715849
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(32.2102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7812395 KL Loss: 13.8485690 DSM Loss: 17.5264535 Overall Loss:33.1562621
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(24.7763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7953841 KL Loss: 13.7644574 DSM Loss: 17.2123168 Overall Loss:32.7721583
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(27.2717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8159364 KL Loss: 13.8500927 DSM Loss: 17.5765660 Overall Loss:33.2425952
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(28.0358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7996046 KL Loss: 13.8227263 DSM Loss: 17.5269095 Overall Loss:33.1492403
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(38.3370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.5302, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8239964 KL Loss: 13.8903274 DSM Loss: 17.5192040 Overall Loss:33.2335278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.155498504638672


Running on file EXC.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.9855, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8159334 KL Loss: 13.9833189 DSM Loss: 21.0040646 Overall Loss:36.8033168
Validation loss decreased (inf --> 10.812210).  Saving model ...
Updating learning rate to 0.0005
tensor(37.1959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9429, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8819165 KL Loss: 14.0614222 DSM Loss: 18.1041338 Overall Loss:34.0474724
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(27.4760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8060648 KL Loss: 13.9311893 DSM Loss: 17.9521338 Overall Loss:33.6893878
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(34.1557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7118, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8913503 KL Loss: 14.1406541 DSM Loss: 17.8277629 Overall Loss:33.8597670
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(37.4565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9556, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8281690 KL Loss: 13.8544028 DSM Loss: 17.4556623 Overall Loss:33.1382343
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(30.9615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7986354 KL Loss: 13.8502096 DSM Loss: 17.2951411 Overall Loss:32.9439861
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(37.0513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8137347 KL Loss: 13.8627275 DSM Loss: 17.1215679 Overall Loss:32.7980298
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(35.8323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8228143 KL Loss: 13.9464676 DSM Loss: 17.1697452 Overall Loss:32.9390270
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(30.2605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7295, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7988840 KL Loss: 13.6645112 DSM Loss: 17.4023392 Overall Loss:32.8657345
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(35.2195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8256952 KL Loss: 13.7977353 DSM Loss: 17.3353591 Overall Loss:32.9587897
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(32.9543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8171543 KL Loss: 13.8020023 DSM Loss: 17.3977697 Overall Loss:33.0169264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:14.371837615966797


Running on file GD.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.3294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8715884 KL Loss: 14.1791630 DSM Loss: 21.3678276 Overall Loss:37.4185789
Validation loss decreased (inf --> 5.179240).  Saving model ...
Updating learning rate to 0.0005
tensor(40.5390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9127165 KL Loss: 14.2943873 DSM Loss: 18.4202463 Overall Loss:34.6273501
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(31.7166, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8495222 KL Loss: 14.0819802 DSM Loss: 17.6970672 Overall Loss:33.6285696
Validation loss decreased (5.179240 --> 4.464883).  Saving model ...
Updating learning rate to 0.000125
tensor(46.9913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7954156 KL Loss: 13.9262538 DSM Loss: 17.8225590 Overall Loss:33.5442282
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(28.9158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8243610 KL Loss: 14.0517406 DSM Loss: 17.6572135 Overall Loss:33.5333151
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(31.5897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5176, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7816628 KL Loss: 13.9575387 DSM Loss: 17.7911262 Overall Loss:33.5303276
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(34.3037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8083924 KL Loss: 14.0653017 DSM Loss: 17.3307979 Overall Loss:33.2044921
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(23.0079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4357, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8329780 KL Loss: 14.0273847 DSM Loss: 17.8300074 Overall Loss:33.6903701
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(42.3949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8163797 KL Loss: 13.9794087 DSM Loss: 17.3415468 Overall Loss:33.1373351
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(24.0106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8013645 KL Loss: 13.9190867 DSM Loss: 17.4934537 Overall Loss:33.2139048
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(27.2104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6784, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8012807 KL Loss: 13.9638794 DSM Loss: 17.6594555 Overall Loss:33.4246157
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(43.9412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8359793 KL Loss: 13.9501343 DSM Loss: 17.4841218 Overall Loss:33.2702355
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(40.5255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1862, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8187291 KL Loss: 14.0400786 DSM Loss: 17.5710070 Overall Loss:33.4298144
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.79369831085205


Running on file GE.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.4244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7262, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9171575 KL Loss: 14.2395922 DSM Loss: 25.7043927 Overall Loss:41.8611427
Validation loss decreased (inf --> 0.224624).  Saving model ...
Updating learning rate to 0.0005
tensor(31.0389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9292221 KL Loss: 14.1537358 DSM Loss: 19.6097469 Overall Loss:35.6927050
Validation loss decreased (0.224624 --> 0.175071).  Saving model ...
Updating learning rate to 0.00025
tensor(22.8566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8706387 KL Loss: 14.1258738 DSM Loss: 19.7147802 Overall Loss:35.7112928
Validation loss decreased (0.175071 --> 0.111009).  Saving model ...
Updating learning rate to 0.000125
tensor(36.6054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8159584 KL Loss: 14.0280239 DSM Loss: 19.0703844 Overall Loss:34.9143666
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(32.1085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8923915 KL Loss: 14.1067289 DSM Loss: 18.9970581 Overall Loss:34.9961785
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(26.9669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4966, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8031135 KL Loss: 13.9955661 DSM Loss: 18.9662017 Overall Loss:34.7648812
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(35.5595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.2704, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8029800 KL Loss: 13.9269689 DSM Loss: 18.9897603 Overall Loss:34.7197094
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(36.7733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4175, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8469587 KL Loss: 14.0343632 DSM Loss: 18.7761670 Overall Loss:34.6574888
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(35.0286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8262953 KL Loss: 14.0298792 DSM Loss: 18.8687211 Overall Loss:34.7248955
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(37.5643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4695, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8194302 KL Loss: 13.9102584 DSM Loss: 18.7662645 Overall Loss:34.4959530
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(31.7058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8363264 KL Loss: 13.9740763 DSM Loss: 18.9921312 Overall Loss:34.8025338
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(39.4689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4961, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8349302 KL Loss: 14.0183182 DSM Loss: 18.6926905 Overall Loss:34.5459388
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(32.7206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8078050 KL Loss: 13.8468830 DSM Loss: 18.8791770 Overall Loss:34.5338650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.27154457569122314


Running on file GOOG.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.7464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2273, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8640058 KL Loss: 14.0841031 DSM Loss: 22.1103328 Overall Loss:38.0584416
Validation loss decreased (inf --> 11.064791).  Saving model ...
Updating learning rate to 0.0005
tensor(31.3923, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9103359 KL Loss: 14.0747154 DSM Loss: 18.5486223 Overall Loss:34.5336736
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(37.5885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1144, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8619900 KL Loss: 13.8618360 DSM Loss: 18.3560443 Overall Loss:34.0798703
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(53.9175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(19.1188, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8349644 KL Loss: 13.6710765 DSM Loss: 17.8041710 Overall Loss:33.3102120
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(30.9966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6787, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8387248 KL Loss: 13.6222953 DSM Loss: 17.7223741 Overall Loss:33.1833943
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(27.4143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3664, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8133643 KL Loss: 13.6162614 DSM Loss: 18.1000938 Overall Loss:33.5297195
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(44.5937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7684, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8599730 KL Loss: 13.7225721 DSM Loss: 17.5272116 Overall Loss:33.1097565
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(38.6071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3661, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.2515, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8060677 KL Loss: 13.5533913 DSM Loss: 17.5154826 Overall Loss:32.8749416
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(26.4260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8621369 KL Loss: 13.7662418 DSM Loss: 17.7389149 Overall Loss:33.3672935
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(50.6723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8607023 KL Loss: 13.7805159 DSM Loss: 16.9210738 Overall Loss:32.5622920
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(26.9155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9387, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8033596 KL Loss: 13.5446651 DSM Loss: 17.4801348 Overall Loss:32.8281596
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.897956848144531


Running on file HD.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.5646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.8839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8829168 KL Loss: 14.1279843 DSM Loss: 22.0450237 Overall Loss:38.0559248
Validation loss decreased (inf --> 7.941094).  Saving model ...
Updating learning rate to 0.0005
tensor(35.6169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8937773 KL Loss: 14.0705155 DSM Loss: 19.2702915 Overall Loss:35.2345845
Validation loss decreased (7.941094 --> 6.480601).  Saving model ...
Updating learning rate to 0.00025
tensor(39.1477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4110, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.7902519 KL Loss: 13.9169684 DSM Loss: 18.7165455 Overall Loss:34.4237655
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(29.7601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7771971 KL Loss: 13.8642866 DSM Loss: 18.2730939 Overall Loss:33.9145778
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(35.4422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7993106 KL Loss: 13.8958249 DSM Loss: 18.1427918 Overall Loss:33.8379274
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(25.1340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8188220 KL Loss: 13.9509037 DSM Loss: 18.0536323 Overall Loss:33.8233581
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(38.2207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.1465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1651, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8139451 KL Loss: 13.9216623 DSM Loss: 18.3677332 Overall Loss:34.1033406
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(30.1608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8201947 KL Loss: 13.9188866 DSM Loss: 17.8651503 Overall Loss:33.6042317
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(36.6660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7234, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2943, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8284202 KL Loss: 13.9577463 DSM Loss: 18.3914982 Overall Loss:34.1776646
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(42.1105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8295073 KL Loss: 13.9755970 DSM Loss: 18.1051790 Overall Loss:33.9102831
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(28.0289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7758318 KL Loss: 13.7496214 DSM Loss: 17.9264528 Overall Loss:33.4519062
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.6393, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7847014 KL Loss: 13.8493275 DSM Loss: 18.2064452 Overall Loss:33.8404742
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.541182279586792


Running on file HON.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.3063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0668, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8889170 KL Loss: 14.2576870 DSM Loss: 22.7262058 Overall Loss:38.8728098
Validation loss decreased (inf --> 2.901636).  Saving model ...
Updating learning rate to 0.0005
tensor(33.5436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5142, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8427352 KL Loss: 13.9415261 DSM Loss: 18.3181515 Overall Loss:34.1024130
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(31.7300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8496033 KL Loss: 13.9763088 DSM Loss: 18.3516648 Overall Loss:34.1775766
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(38.7676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8366522 KL Loss: 13.8032393 DSM Loss: 18.3145176 Overall Loss:33.9544088
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(20.7129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.1342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8115069 KL Loss: 13.8311108 DSM Loss: 17.8942606 Overall Loss:33.5368784
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(35.0264, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8156446 KL Loss: 13.9233944 DSM Loss: 18.1113043 Overall Loss:33.8503433
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(37.0243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8660203 KL Loss: 13.9110618 DSM Loss: 17.6679262 Overall Loss:33.4450084
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(33.7362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8838927 KL Loss: 13.9508253 DSM Loss: 17.8353004 Overall Loss:33.6700186
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(32.5428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8376061 KL Loss: 13.8099740 DSM Loss: 17.6347881 Overall Loss:33.2823683
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(33.1258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8773007 KL Loss: 13.9215052 DSM Loss: 17.5418572 Overall Loss:33.3406629
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(20.6134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8102754 KL Loss: 13.6691392 DSM Loss: 17.8562380 Overall Loss:33.3356525
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.1720235347747803


Running on file HSBC.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(50.8991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8649, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5984, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9461157 KL Loss: 14.2079796 DSM Loss: 24.9415824 Overall Loss:41.0956776
Validation loss decreased (inf --> 0.266676).  Saving model ...
Updating learning rate to 0.0005
tensor(39.4307, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1543, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9338738 KL Loss: 14.2648875 DSM Loss: 19.9105592 Overall Loss:36.1093207
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(44.4279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2572, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9164827 KL Loss: 14.1414354 DSM Loss: 19.7006748 Overall Loss:35.7585929
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(43.4526, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8187244 KL Loss: 13.9062421 DSM Loss: 19.0374208 Overall Loss:34.7623873
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(36.0616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8117990 KL Loss: 14.0453308 DSM Loss: 18.9732030 Overall Loss:34.8303327
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(31.0765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9608, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8309181 KL Loss: 14.0410155 DSM Loss: 18.9337140 Overall Loss:34.8056475
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(34.6412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8020453 KL Loss: 13.9649911 DSM Loss: 18.9538937 Overall Loss:34.7209301
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(40.4087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8086142 KL Loss: 13.8719136 DSM Loss: 19.0023091 Overall Loss:34.6828367
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(32.8654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4016, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8055629 KL Loss: 14.0597164 DSM Loss: 18.5701414 Overall Loss:34.4354209
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(34.9989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6159, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8162263 KL Loss: 14.0758707 DSM Loss: 19.1361806 Overall Loss:35.0282778
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(31.3624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5855, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8510318 KL Loss: 14.0913877 DSM Loss: 18.9113764 Overall Loss:34.8537958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9496435523033142


Running on file IEP.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.8330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1849, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8938432 KL Loss: 14.2765000 DSM Loss: 22.7334427 Overall Loss:38.9037861
Validation loss decreased (inf --> 2.162401).  Saving model ...
Updating learning rate to 0.0005
tensor(28.0173, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9038974 KL Loss: 14.1734897 DSM Loss: 19.1821786 Overall Loss:35.2595656
Validation loss decreased (2.162401 --> 1.836246).  Saving model ...
Updating learning rate to 0.00025
tensor(32.9330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0203, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8959337 KL Loss: 14.1916546 DSM Loss: 18.5402505 Overall Loss:34.6278389
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(39.1518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8483660 KL Loss: 14.0558248 DSM Loss: 18.4741677 Overall Loss:34.3783581
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(37.2222, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7833735 KL Loss: 13.9705104 DSM Loss: 18.1995057 Overall Loss:33.9533896
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(35.1569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6488, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8086682 KL Loss: 13.8554316 DSM Loss: 18.1167535 Overall Loss:33.7808532
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(39.8260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7822285 KL Loss: 13.7335767 DSM Loss: 18.0942042 Overall Loss:33.6100092
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(34.9899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5269, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7902021 KL Loss: 13.8032688 DSM Loss: 18.1899104 Overall Loss:33.7833813
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(33.6567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7943374 KL Loss: 13.8282064 DSM Loss: 18.2006183 Overall Loss:33.8231621
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(35.5862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8091308 KL Loss: 14.0061077 DSM Loss: 18.0546608 Overall Loss:33.8698992
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(31.4849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8123497 KL Loss: 13.9068293 DSM Loss: 18.4769158 Overall Loss:34.1960945
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(37.9224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8238970 KL Loss: 13.8957753 DSM Loss: 18.3945574 Overall Loss:34.1142298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.1694037914276123


Running on file INTC.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.9646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8318134 KL Loss: 14.1920374 DSM Loss: 26.1249176 Overall Loss:42.1487685
Validation loss decreased (inf --> 0.357513).  Saving model ...
Updating learning rate to 0.0005
tensor(27.7352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9180282 KL Loss: 14.1890685 DSM Loss: 19.3890651 Overall Loss:35.4961619
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(39.3469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6447, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8841157 KL Loss: 14.1423456 DSM Loss: 18.6633352 Overall Loss:34.6897967
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(35.3406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8440939 KL Loss: 14.1409670 DSM Loss: 18.5044081 Overall Loss:34.4894690
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(33.1207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8732971 KL Loss: 14.1578942 DSM Loss: 18.3993663 Overall Loss:34.4305576
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(26.3501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5821, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8375733 KL Loss: 14.1324966 DSM Loss: 18.0910244 Overall Loss:34.0610944
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(35.4362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6833, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8392278 KL Loss: 14.1496847 DSM Loss: 18.2392109 Overall Loss:34.2281234
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(39.5212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8267551 KL Loss: 14.1090219 DSM Loss: 18.3515355 Overall Loss:34.2873123
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(29.6731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8144403 KL Loss: 13.9895762 DSM Loss: 18.2962841 Overall Loss:34.1003005
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(41.1851, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8213067 KL Loss: 13.9805645 DSM Loss: 18.2414211 Overall Loss:34.0432923
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(34.6513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8420571 KL Loss: 14.1114659 DSM Loss: 18.0328583 Overall Loss:33.9863813
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.9777196049690247


Running on file JNJ.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(50.8185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8523085 KL Loss: 14.1780975 DSM Loss: 21.8440055 Overall Loss:37.8744117
Validation loss decreased (inf --> 5.130995).  Saving model ...
Updating learning rate to 0.0005
tensor(25.0279, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9686, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8435628 KL Loss: 14.0579110 DSM Loss: 19.0640061 Overall Loss:34.9654798
Validation loss decreased (5.130995 --> 4.739061).  Saving model ...
Updating learning rate to 0.00025
tensor(33.7276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8437503 KL Loss: 13.9744917 DSM Loss: 18.3245112 Overall Loss:34.1427531
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(36.5370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8256559 KL Loss: 13.8386252 DSM Loss: 17.6203003 Overall Loss:33.2845815
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(32.7114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8069814 KL Loss: 13.8843529 DSM Loss: 17.3748106 Overall Loss:33.0661450
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(21.3405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7917857 KL Loss: 13.9216084 DSM Loss: 17.1722644 Overall Loss:32.8856585
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(31.6988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0347, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8115227 KL Loss: 13.8449285 DSM Loss: 17.2031441 Overall Loss:32.8595954
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(31.9873, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8134440 KL Loss: 13.8426055 DSM Loss: 17.1116213 Overall Loss:32.7676708
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(34.7399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8163356 KL Loss: 13.8296721 DSM Loss: 17.2072862 Overall Loss:32.8532939
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(32.7201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8165993 KL Loss: 13.8343988 DSM Loss: 17.2809397 Overall Loss:32.9319377
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(32.1521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4581, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8138076 KL Loss: 13.8997889 DSM Loss: 17.2232440 Overall Loss:32.9368405
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(26.3836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3925, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8315641 KL Loss: 13.8961827 DSM Loss: 17.0494611 Overall Loss:32.7772077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.056424617767334


Running on file JPM.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.9330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1346, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9202227 KL Loss: 14.2749692 DSM Loss: 23.9503101 Overall Loss:40.1455018
Validation loss decreased (inf --> 4.950406).  Saving model ...
Updating learning rate to 0.0005
tensor(29.2053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8921185 KL Loss: 14.1601024 DSM Loss: 19.0866569 Overall Loss:35.1388777
Validation loss decreased (4.950406 --> 4.946110).  Saving model ...
Updating learning rate to 0.00025
tensor(43.0436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8245222 KL Loss: 14.1190365 DSM Loss: 18.3509431 Overall Loss:34.2945015
Validation loss decreased (4.946110 --> 4.735685).  Saving model ...
Updating learning rate to 0.000125
tensor(37.3367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8361119 KL Loss: 13.9635694 DSM Loss: 18.1375013 Overall Loss:33.9371826
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(33.8654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.1010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8705306 KL Loss: 14.0219859 DSM Loss: 17.9099318 Overall Loss:33.8024487
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(16.1768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8317587 KL Loss: 13.9442596 DSM Loss: 17.9931935 Overall Loss:33.7692116
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(32.1832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3413, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8136041 KL Loss: 13.8854598 DSM Loss: 17.7411891 Overall Loss:33.4402531
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(23.7944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.9044962 KL Loss: 14.0418790 DSM Loss: 17.4165329 Overall Loss:33.3629080
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(26.9859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8483203 KL Loss: 13.9790035 DSM Loss: 17.8037894 Overall Loss:33.6311134
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(18.2331, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5339, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8295835 KL Loss: 13.8641748 DSM Loss: 17.9149749 Overall Loss:33.6087333
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(35.3382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8374579 KL Loss: 13.9762298 DSM Loss: 17.9645472 Overall Loss:33.7782349
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(29.7245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8427175 KL Loss: 13.9543455 DSM Loss: 17.5165832 Overall Loss:33.3136463
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(28.2424, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8437389 KL Loss: 14.0362251 DSM Loss: 17.8966976 Overall Loss:33.7766616
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.8214271068573


Running on file KO.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(50.3428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8581467 KL Loss: 14.1751488 DSM Loss: 23.9443105 Overall Loss:39.9776060
Validation loss decreased (inf --> 5.013298).  Saving model ...
Updating learning rate to 0.0005
tensor(32.3723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8934606 KL Loss: 14.1333923 DSM Loss: 19.4297905 Overall Loss:35.4566433
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(44.3516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0678, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8869013 KL Loss: 14.0974060 DSM Loss: 18.6883262 Overall Loss:34.6726334
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(29.7705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0334, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.7906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8729766 KL Loss: 14.1137884 DSM Loss: 18.4747964 Overall Loss:34.4615614
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(35.6519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8282307 KL Loss: 14.1248847 DSM Loss: 18.0966745 Overall Loss:34.0497899
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(35.8180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8548840 KL Loss: 14.1091111 DSM Loss: 18.0445598 Overall Loss:34.0085549
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(26.5637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6342, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8581086 KL Loss: 14.0363193 DSM Loss: 17.9062419 Overall Loss:33.8006697
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(43.7943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8344488 KL Loss: 13.9925762 DSM Loss: 17.9299977 Overall Loss:33.7570227
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(36.8648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9117, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8327218 KL Loss: 14.0722174 DSM Loss: 18.2606888 Overall Loss:34.1656279
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(40.8547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8148084 KL Loss: 13.9636918 DSM Loss: 17.9140953 Overall Loss:33.6925954
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(36.1443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8431288 KL Loss: 14.1229701 DSM Loss: 17.8904489 Overall Loss:33.8565477
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:8.426141738891602


Running on file LMT.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.6217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3962, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9296013 KL Loss: 14.1895273 DSM Loss: 23.1783448 Overall Loss:39.2974734
Validation loss decreased (inf --> 2.297255).  Saving model ...
Updating learning rate to 0.0005
tensor(34.1798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8813405 KL Loss: 14.1507631 DSM Loss: 19.0308777 Overall Loss:35.0629809
Validation loss decreased (2.297255 --> 2.025906).  Saving model ...
Updating learning rate to 0.00025
tensor(39.7853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8344096 KL Loss: 14.0052728 DSM Loss: 18.3285755 Overall Loss:34.1682578
Validation loss decreased (2.025906 --> 1.837387).  Saving model ...
Updating learning rate to 0.000125
tensor(30.9271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9417, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8438530 KL Loss: 13.9686622 DSM Loss: 17.9461137 Overall Loss:33.7586290
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(34.5516, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8223969 KL Loss: 13.9234837 DSM Loss: 17.8242698 Overall Loss:33.5701503
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(29.4580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8211088 KL Loss: 13.8933275 DSM Loss: 17.9680889 Overall Loss:33.6825253
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(38.7706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4517, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8086419 KL Loss: 13.9538947 DSM Loss: 17.9782422 Overall Loss:33.7407788
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(28.8271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8060018 KL Loss: 13.7914362 DSM Loss: 17.8505332 Overall Loss:33.4479712
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(28.6246, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8089622 KL Loss: 13.8942984 DSM Loss: 17.9465595 Overall Loss:33.6498201
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(28.0384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1683, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7838592 KL Loss: 13.7936204 DSM Loss: 17.7931546 Overall Loss:33.3706342
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(37.4845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8062707 KL Loss: 13.8673604 DSM Loss: 17.8114236 Overall Loss:33.4850547
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(35.0297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6594, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8282635 KL Loss: 13.8927877 DSM Loss: 17.7531301 Overall Loss:33.4741812
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(33.1996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9544, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8319577 KL Loss: 13.9736595 DSM Loss: 17.5941792 Overall Loss:33.3997967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:6.246209621429443


Running on file MA.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(51.8430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9130484 KL Loss: 14.1225217 DSM Loss: 21.9034172 Overall Loss:37.9389872
Validation loss decreased (inf --> 2.078846).  Saving model ...
Updating learning rate to 0.0005
tensor(36.8567, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8438338 KL Loss: 14.0287251 DSM Loss: 19.0725524 Overall Loss:34.9451114
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(29.9196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.2644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8681031 KL Loss: 14.0336099 DSM Loss: 18.8314880 Overall Loss:34.7332009
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(27.6215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.9987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8271837 KL Loss: 13.7402392 DSM Loss: 18.6837724 Overall Loss:34.2511954
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(30.5143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.9491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7999207 KL Loss: 13.6824152 DSM Loss: 18.3128302 Overall Loss:33.7951660
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(35.5818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8265326 KL Loss: 13.5971680 DSM Loss: 18.0530389 Overall Loss:33.4767394
Validation loss decreased (2.078846 --> 1.994359).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(31.3685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8042076 KL Loss: 13.6767925 DSM Loss: 18.3259733 Overall Loss:33.8069733
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(35.9897, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8064767 KL Loss: 13.5907644 DSM Loss: 18.3007652 Overall Loss:33.6980062
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(30.2485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8063573 KL Loss: 13.7165519 DSM Loss: 18.4269884 Overall Loss:33.9498977
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(25.8677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7999233 KL Loss: 13.6587013 DSM Loss: 18.2886075 Overall Loss:33.7472321
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(35.8837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3633, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6951, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8090920 KL Loss: 13.7082098 DSM Loss: 18.2914938 Overall Loss:33.8087955
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.8209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6770, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7856412 KL Loss: 13.6553684 DSM Loss: 18.1449459 Overall Loss:33.5859556
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(38.6339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1903, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.7929094 KL Loss: 13.7230984 DSM Loss: 18.0661324 Overall Loss:33.5821404
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(32.6193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9949, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.7901104 KL Loss: 13.6103357 DSM Loss: 18.1493779 Overall Loss:33.5498241
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(31.3452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8517190 KL Loss: 13.8287479 DSM Loss: 18.6710820 Overall Loss:34.3515487
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(35.4010, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8103238 KL Loss: 13.5238539 DSM Loss: 18.0126870 Overall Loss:33.3468648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.474637746810913


Running on file MCD.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.3748, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8814409 KL Loss: 14.1924882 DSM Loss: 22.4731217 Overall Loss:38.5470507
Validation loss decreased (inf --> 5.088011).  Saving model ...
Updating learning rate to 0.0005
tensor(37.3050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8573778 KL Loss: 14.0121154 DSM Loss: 19.2168064 Overall Loss:35.0862996
Validation loss decreased (5.088011 --> 3.685899).  Saving model ...
Updating learning rate to 0.00025
tensor(40.8901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8430428 KL Loss: 13.9887233 DSM Loss: 18.2304727 Overall Loss:34.0622389
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(39.0975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0884, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7938672 KL Loss: 13.8033242 DSM Loss: 18.4802976 Overall Loss:34.0774891
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(36.3057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9364, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8075182 KL Loss: 13.7190897 DSM Loss: 18.0448353 Overall Loss:33.5714434
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(36.7126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4632, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7842247 KL Loss: 13.7581575 DSM Loss: 18.1975949 Overall Loss:33.7399772
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(37.6700, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8121298 KL Loss: 13.7865226 DSM Loss: 17.9545217 Overall Loss:33.5531740
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(26.3909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0832, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8151182 KL Loss: 13.6877058 DSM Loss: 18.0216346 Overall Loss:33.5244584
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(33.6975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5462, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7905140 KL Loss: 13.7052238 DSM Loss: 18.1625967 Overall Loss:33.6583344
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(28.3402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8036344 KL Loss: 13.7936879 DSM Loss: 18.1820687 Overall Loss:33.7793909
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(33.6591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8019991 KL Loss: 13.6693743 DSM Loss: 18.2964533 Overall Loss:33.7678267
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(33.7620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2306, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7709330 KL Loss: 13.6062410 DSM Loss: 17.9123600 Overall Loss:33.2895341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.158811569213867


Running on file MDT.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.3975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9172, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9333602 KL Loss: 14.1994331 DSM Loss: 22.9198525 Overall Loss:39.0526458
Validation loss decreased (inf --> 2.414229).  Saving model ...
Updating learning rate to 0.0005
tensor(38.0243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4291, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9025905 KL Loss: 14.1805385 DSM Loss: 19.7545790 Overall Loss:35.8377081
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(39.2409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8375992 KL Loss: 13.9161854 DSM Loss: 18.6297901 Overall Loss:34.3835745
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(34.8321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8199, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8129730 KL Loss: 13.8644193 DSM Loss: 18.4177751 Overall Loss:34.0951674
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(26.9734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1044, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8286530 KL Loss: 13.9025432 DSM Loss: 18.1484597 Overall Loss:33.8796556
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(39.2569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5520, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8443800 KL Loss: 13.9430465 DSM Loss: 17.9753832 Overall Loss:33.7628096
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(31.2416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5112, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0101, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8232475 KL Loss: 13.9001823 DSM Loss: 18.0324093 Overall Loss:33.7558392
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(41.4120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8747765 KL Loss: 14.0581304 DSM Loss: 17.4539278 Overall Loss:33.3868347
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(33.7684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.1028, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8304273 KL Loss: 13.8933651 DSM Loss: 17.8852235 Overall Loss:33.6090161
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(25.3057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3667, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8073885 KL Loss: 13.8763838 DSM Loss: 18.0400795 Overall Loss:33.7238518
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(28.9040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8709134 KL Loss: 14.0430067 DSM Loss: 18.0266898 Overall Loss:33.9406099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.13430777192115784


Running on file MMM.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(50.0551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9143, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8874725 KL Loss: 14.1816184 DSM Loss: 22.2478863 Overall Loss:38.3169769
Validation loss decreased (inf --> 0.441831).  Saving model ...
Updating learning rate to 0.0005
tensor(37.7652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8381024 KL Loss: 13.9969869 DSM Loss: 18.2856944 Overall Loss:34.1207836
Validation loss decreased (0.441831 --> 0.427095).  Saving model ...
Updating learning rate to 0.00025
tensor(26.9934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8571705 KL Loss: 14.0224486 DSM Loss: 17.8861705 Overall Loss:33.7657897
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(29.8902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7943551 KL Loss: 13.8807633 DSM Loss: 17.5956011 Overall Loss:33.2707193
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(39.3439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8094336 KL Loss: 13.9130392 DSM Loss: 17.5829618 Overall Loss:33.3054347
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(41.6693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7117, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8306614 KL Loss: 13.9342710 DSM Loss: 17.3325063 Overall Loss:33.0974385
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(33.1778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4111, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.0763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8080800 KL Loss: 13.9705883 DSM Loss: 16.9531519 Overall Loss:32.7318204
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(38.7361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8218, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8012734 KL Loss: 13.8245360 DSM Loss: 17.1489652 Overall Loss:32.7747745
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(33.4123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.5675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7886187 KL Loss: 13.8553628 DSM Loss: 17.3894429 Overall Loss:33.0334246
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(29.3348, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8443751 KL Loss: 13.9778502 DSM Loss: 17.2800808 Overall Loss:33.1023062
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(28.4106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3525, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8140137 KL Loss: 13.9683095 DSM Loss: 17.2780013 Overall Loss:33.0603246
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.4198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8221662 KL Loss: 13.8883550 DSM Loss: 17.5276777 Overall Loss:33.2381989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.168328762054443


Running on file MO.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.2253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9502551 KL Loss: 14.3291298 DSM Loss: 27.8637862 Overall Loss:44.1431712
Validation loss decreased (inf --> 1.092805).  Saving model ...
Updating learning rate to 0.0005
tensor(41.4083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0072, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9102348 KL Loss: 14.2785742 DSM Loss: 20.2136836 Overall Loss:36.4024927
Validation loss decreased (1.092805 --> 0.937426).  Saving model ...
Updating learning rate to 0.00025
tensor(32.4045, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2735, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7547, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8972437 KL Loss: 14.2766833 DSM Loss: 19.8158443 Overall Loss:35.9897714
Validation loss decreased (0.937426 --> 0.903143).  Saving model ...
Updating learning rate to 0.000125
tensor(41.7664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6559, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8736793 KL Loss: 14.2432785 DSM Loss: 19.3180246 Overall Loss:35.4349822
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(43.6718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.1723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7987, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8534648 KL Loss: 14.1843726 DSM Loss: 19.6290100 Overall Loss:35.6668473
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(32.6193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5335, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7897, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8802361 KL Loss: 14.2435498 DSM Loss: 19.2636378 Overall Loss:35.3874237
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(32.8400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7993511 KL Loss: 14.0589993 DSM Loss: 19.4838771 Overall Loss:35.3422275
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(43.7690, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4501, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8213035 KL Loss: 14.1939402 DSM Loss: 19.2923434 Overall Loss:35.3075870
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(36.0792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3972, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8357745 KL Loss: 14.1160859 DSM Loss: 19.5759191 Overall Loss:35.5277796
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(31.0071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8429160 KL Loss: 14.2399518 DSM Loss: 19.2548626 Overall Loss:35.3377302
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(31.3718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8448744 KL Loss: 14.2543627 DSM Loss: 19.0292894 Overall Loss:35.1285264
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(38.8039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3778, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8454592 KL Loss: 14.2181281 DSM Loss: 19.3985364 Overall Loss:35.4621234
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(34.2250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8386428 KL Loss: 14.1460057 DSM Loss: 19.5549007 Overall Loss:35.5395492
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.5845633745193481


Running on file MRK.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(52.3783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5732, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8767598 KL Loss: 14.2413025 DSM Loss: 32.2249774 Overall Loss:48.3430392
Validation loss decreased (inf --> 2.189209).  Saving model ...
Updating learning rate to 0.0005
tensor(41.1164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4213, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8544869 KL Loss: 14.1401661 DSM Loss: 19.3423058 Overall Loss:35.3369588
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(32.2493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6552, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8827208 KL Loss: 14.2315316 DSM Loss: 18.6012478 Overall Loss:34.7155002
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(33.2578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8482115 KL Loss: 14.0185983 DSM Loss: 17.9964983 Overall Loss:33.8633079
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(31.8220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7373, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8769658 KL Loss: 14.1750466 DSM Loss: 18.2654639 Overall Loss:34.3174762
Validation loss decreased (2.189209 --> 2.125172).  Saving model ...
Updating learning rate to 3.125e-05
tensor(34.1464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6019, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8128237 KL Loss: 13.9992760 DSM Loss: 18.1221008 Overall Loss:33.9342005
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(35.2684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6612, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8334481 KL Loss: 13.9979704 DSM Loss: 17.9168853 Overall Loss:33.7483036
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(29.8309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8110114 KL Loss: 13.9288223 DSM Loss: 17.8433386 Overall Loss:33.5831722
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(33.3204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8243514 KL Loss: 14.0020096 DSM Loss: 17.8465348 Overall Loss:33.6728959
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(39.2484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1662, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8318129 KL Loss: 13.9443908 DSM Loss: 18.1553638 Overall Loss:33.9315675
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(38.5350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7857897 KL Loss: 13.9154868 DSM Loss: 18.2614469 Overall Loss:33.9627235
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(32.7931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4342, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8219349 KL Loss: 13.9383096 DSM Loss: 17.8541886 Overall Loss:33.6144331
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(36.7893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6342, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8275933 KL Loss: 14.0043012 DSM Loss: 17.8039810 Overall Loss:33.6358755
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(29.8904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8226901 KL Loss: 13.9654990 DSM Loss: 17.9783505 Overall Loss:33.7665392
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(38.2732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.0805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0784, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8135238 KL Loss: 13.9678413 DSM Loss: 17.9647184 Overall Loss:33.7460833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:14.715429306030273


Running on file MSFT.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(49.2875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5148, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8712733 KL Loss: 14.1986698 DSM Loss: 23.1594706 Overall Loss:39.2294138
Validation loss decreased (inf --> 8.045123).  Saving model ...
Updating learning rate to 0.0005
tensor(34.6167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0553, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9422608 KL Loss: 14.2978445 DSM Loss: 19.0150500 Overall Loss:35.2551554
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(39.4801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8445654 KL Loss: 13.9526449 DSM Loss: 18.7828472 Overall Loss:34.5800576
Validation loss decreased (8.045123 --> 7.955026).  Saving model ...
Updating learning rate to 0.000125
tensor(26.7522, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6648, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8348812 KL Loss: 13.6961209 DSM Loss: 18.5952742 Overall Loss:34.1262764
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(33.2099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5327, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8601735 KL Loss: 13.9004217 DSM Loss: 18.0464762 Overall Loss:33.8070714
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(39.2870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8536320 KL Loss: 13.8638887 DSM Loss: 18.1779547 Overall Loss:33.8954753
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(25.5436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6887, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8668898 KL Loss: 13.9879857 DSM Loss: 17.9676675 Overall Loss:33.8225430
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(25.4723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8870961 KL Loss: 13.9134396 DSM Loss: 18.2076003 Overall Loss:34.0081359
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(42.1286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8429208 KL Loss: 13.8122250 DSM Loss: 17.9712600 Overall Loss:33.6264059
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(40.3411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8964, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8520016 KL Loss: 13.8900291 DSM Loss: 17.9009064 Overall Loss:33.6429371
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(24.8125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9355, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8333173 KL Loss: 13.8541451 DSM Loss: 18.3241569 Overall Loss:34.0116190
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(29.0125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8278614 KL Loss: 13.7592259 DSM Loss: 18.2721176 Overall Loss:33.8592049
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(30.8012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9847, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8155448 KL Loss: 13.7591521 DSM Loss: 18.2391100 Overall Loss:33.8138069
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:6.8358941078186035


Running on file NEE.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(58.6028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9069129 KL Loss: 14.1368757 DSM Loss: 22.8573807 Overall Loss:38.9011692
Validation loss decreased (inf --> 5.771785).  Saving model ...
Updating learning rate to 0.0005
tensor(31.7817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2334, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8482496 KL Loss: 13.9054290 DSM Loss: 19.5808040 Overall Loss:35.3344830
Validation loss decreased (5.771785 --> 3.665887).  Saving model ...
Updating learning rate to 0.00025
tensor(36.5319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8660219 KL Loss: 13.7363426 DSM Loss: 18.8107158 Overall Loss:34.4130802
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(30.5776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7895212 KL Loss: 13.6212242 DSM Loss: 18.2991060 Overall Loss:33.7098513
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(32.3485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4368, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8120753 KL Loss: 13.6715812 DSM Loss: 18.5177672 Overall Loss:34.0014237
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(29.7906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3458, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7559, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7843925 KL Loss: 13.6367326 DSM Loss: 18.5494009 Overall Loss:33.9705260
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(43.5359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9564, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8270496 KL Loss: 13.7175898 DSM Loss: 18.3503280 Overall Loss:33.8949674
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(31.7579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8340221 KL Loss: 13.6244594 DSM Loss: 18.4750631 Overall Loss:33.9335445
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(26.1400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7932905 KL Loss: 13.6983026 DSM Loss: 18.3361263 Overall Loss:33.8277194
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(38.4371, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2592, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7878023 KL Loss: 13.5526197 DSM Loss: 18.1315508 Overall Loss:33.4719727
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(40.9859, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7839017 KL Loss: 13.5245117 DSM Loss: 18.1667719 Overall Loss:33.4751853
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(34.4392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8087368 KL Loss: 13.7057652 DSM Loss: 18.2388367 Overall Loss:33.7533387
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.6561167240142822


Running on file NGG.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(74.3351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9430456 KL Loss: 14.2256592 DSM Loss: 24.0486132 Overall Loss:40.2173181
Validation loss decreased (inf --> 10.953194).  Saving model ...
Updating learning rate to 0.0005
tensor(33.9400, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4824, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.9024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8995157 KL Loss: 14.1010240 DSM Loss: 19.7885379 Overall Loss:35.7890778
Validation loss decreased (10.953194 --> 10.826038).  Saving model ...
Updating learning rate to 0.00025
tensor(37.1605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8669413 KL Loss: 14.0807120 DSM Loss: 19.0821569 Overall Loss:35.0298102
Validation loss decreased (10.826038 --> 10.524816).  Saving model ...
Updating learning rate to 0.000125
tensor(36.9484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2278, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8412811 KL Loss: 13.9925155 DSM Loss: 18.8858952 Overall Loss:34.7196916
Validation loss decreased (10.524816 --> 10.190028).  Saving model ...
Updating learning rate to 6.25e-05
tensor(35.2558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3007, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7939766 KL Loss: 13.8663130 DSM Loss: 18.4521841 Overall Loss:34.1124738
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(31.9116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7812930 KL Loss: 13.8838917 DSM Loss: 18.7271755 Overall Loss:34.3923602
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(45.7357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8277202 KL Loss: 14.0882758 DSM Loss: 18.8369661 Overall Loss:34.7529622
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(33.1379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4719, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8133141 KL Loss: 13.9491177 DSM Loss: 18.8231833 Overall Loss:34.5856150
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(31.5077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4397, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8717552 KL Loss: 14.1223402 DSM Loss: 18.7460656 Overall Loss:34.7401608
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(39.3689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9035, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8142690 KL Loss: 13.8828202 DSM Loss: 18.7445358 Overall Loss:34.4416249
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(37.8325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.5793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0599, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8140976 KL Loss: 13.9524848 DSM Loss: 18.7989143 Overall Loss:34.5654963
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(34.2402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7859749 KL Loss: 13.9022711 DSM Loss: 18.3593395 Overall Loss:34.0475855
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.1775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.9216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8433, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8034331 KL Loss: 13.8533611 DSM Loss: 18.4846417 Overall Loss:34.1414359
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(30.5286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7582, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8099291 KL Loss: 13.9554723 DSM Loss: 18.5654846 Overall Loss:34.3308861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.969299793243408


Running on file NVS.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(59.8839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6260, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8638272 KL Loss: 14.1968436 DSM Loss: 23.5877886 Overall Loss:39.6484594
Validation loss decreased (inf --> 1.662380).  Saving model ...
Updating learning rate to 0.0005
tensor(39.1232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9221, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9131641 KL Loss: 14.3275139 DSM Loss: 19.4274535 Overall Loss:35.6681315
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(33.8544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8944327 KL Loss: 14.1806511 DSM Loss: 18.7944090 Overall Loss:34.8694927
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(34.0632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8749431 KL Loss: 14.1562296 DSM Loss: 18.8140206 Overall Loss:34.8451934
Validation loss decreased (1.662380 --> 1.377665).  Saving model ...
Updating learning rate to 6.25e-05
tensor(38.3773, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8458024 KL Loss: 14.0304558 DSM Loss: 18.6306140 Overall Loss:34.5068724
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(37.0825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8579, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8024543 KL Loss: 13.9346090 DSM Loss: 18.5361451 Overall Loss:34.2732083
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(45.8548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6225, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8140587 KL Loss: 13.8738817 DSM Loss: 18.4518306 Overall Loss:34.1397710
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(32.0116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2465, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8217880 KL Loss: 14.1534708 DSM Loss: 18.5622318 Overall Loss:34.5374905
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(38.5610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7926982 KL Loss: 13.9749620 DSM Loss: 18.4145261 Overall Loss:34.1821863
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(32.6210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0079, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1466, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8030641 KL Loss: 14.1135220 DSM Loss: 18.2668997 Overall Loss:34.1834857
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(35.0149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8048227 KL Loss: 13.9772037 DSM Loss: 18.4434010 Overall Loss:34.2254275
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(35.9867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8014157 KL Loss: 14.1241826 DSM Loss: 18.5486272 Overall Loss:34.4742253
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(32.9379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.7976295 KL Loss: 14.0427110 DSM Loss: 18.3483345 Overall Loss:34.1886749
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(34.9882, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7990, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.7894689 KL Loss: 13.9628466 DSM Loss: 18.3785289 Overall Loss:34.1308443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.80198860168457


Running on file ORCL.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(47.0016, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2142, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8659826 KL Loss: 14.1519182 DSM Loss: 21.4403240 Overall Loss:37.4582248
Validation loss decreased (inf --> 12.894289).  Saving model ...
Updating learning rate to 0.0005
tensor(29.7256, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8634321 KL Loss: 14.0362409 DSM Loss: 17.9310310 Overall Loss:33.8307039
Validation loss decreased (12.894289 --> 12.242547).  Saving model ...
Updating learning rate to 0.00025
tensor(56.4106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8614244 KL Loss: 13.8965966 DSM Loss: 17.5805261 Overall Loss:33.3385470
Validation loss decreased (12.242547 --> 11.730218).  Saving model ...
Updating learning rate to 0.000125
tensor(22.9067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5815, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8494759 KL Loss: 13.8189913 DSM Loss: 17.0511196 Overall Loss:32.7195868
Validation loss decreased (11.730218 --> 11.726600).  Saving model ...
Updating learning rate to 6.25e-05
tensor(21.7340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7768, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8277477 KL Loss: 13.8418928 DSM Loss: 17.2725115 Overall Loss:32.9421519
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(49.3071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8670980 KL Loss: 13.9173428 DSM Loss: 16.8615823 Overall Loss:32.6460231
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(29.7660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8422538 KL Loss: 13.6899876 DSM Loss: 16.9780946 Overall Loss:32.5103359
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(23.1005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9231, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8741221 KL Loss: 13.9156558 DSM Loss: 16.7179768 Overall Loss:32.5077548
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(30.8446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(18.3614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9557, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8348019 KL Loss: 13.6587095 DSM Loss: 16.8226574 Overall Loss:32.3161688
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(46.3011, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.9219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8558817 KL Loss: 13.9204710 DSM Loss: 16.9640292 Overall Loss:32.7403821
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(46.8967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8457641 KL Loss: 13.7985160 DSM Loss: 16.9530557 Overall Loss:32.5973357
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(41.7042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3414, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8675922 KL Loss: 13.8106135 DSM Loss: 16.7718114 Overall Loss:32.4500171
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(33.9170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4935, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8249063 KL Loss: 13.8567255 DSM Loss: 16.8542217 Overall Loss:32.5358533
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(46.0752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7516, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8504107 KL Loss: 13.7746628 DSM Loss: 16.7240830 Overall Loss:32.3491563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:18.83690643310547


Running on file PCG.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(48.7518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3277, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8036296 KL Loss: 14.0609385 DSM Loss: 25.6008167 Overall Loss:41.4653849
Validation loss decreased (inf --> 0.555884).  Saving model ...
Updating learning rate to 0.0005
tensor(29.3698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3257, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8355937 KL Loss: 13.9865627 DSM Loss: 20.5097059 Overall Loss:36.3318623
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(34.6050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2183, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8176371 KL Loss: 13.7484202 DSM Loss: 19.4550284 Overall Loss:35.0210859
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(36.0711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8093877 KL Loss: 13.7479567 DSM Loss: 19.2121175 Overall Loss:34.7694618
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(31.3880, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.7948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5076, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7979748 KL Loss: 13.6634449 DSM Loss: 19.0389162 Overall Loss:34.5003357
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(32.3761, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.0245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8330781 KL Loss: 13.8200047 DSM Loss: 19.1944216 Overall Loss:34.8475042
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(35.5319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8207956 KL Loss: 13.6512245 DSM Loss: 19.0078498 Overall Loss:34.4798699
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(40.9403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7685451 KL Loss: 13.6519773 DSM Loss: 18.9230131 Overall Loss:34.3435355
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(35.6032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8061679 KL Loss: 13.7292089 DSM Loss: 19.1547092 Overall Loss:34.6900859
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(33.2459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8293, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8298171 KL Loss: 13.7928147 DSM Loss: 19.1096363 Overall Loss:34.7322681
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(38.6777, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8169933 KL Loss: 13.7738726 DSM Loss: 19.1617073 Overall Loss:34.7525734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.33937180042266846


Running on file PEP.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(46.6624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8848005 KL Loss: 14.0796669 DSM Loss: 22.0749308 Overall Loss:38.0393982
Validation loss decreased (inf --> 7.556899).  Saving model ...
Updating learning rate to 0.0005
tensor(33.9409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7560, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.7965663 KL Loss: 13.9013486 DSM Loss: 18.4342098 Overall Loss:34.1321248
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(29.1274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8020066 KL Loss: 13.9420057 DSM Loss: 18.1334509 Overall Loss:33.8774633
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(29.4301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8030460 KL Loss: 13.7899139 DSM Loss: 17.9695133 Overall Loss:33.5624732
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(35.5714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7842959 KL Loss: 13.6741527 DSM Loss: 17.8019258 Overall Loss:33.2603744
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(27.5979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7851948 KL Loss: 13.7197967 DSM Loss: 17.6518441 Overall Loss:33.1568355
Validation loss decreased (7.556899 --> 7.527945).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(33.4772, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.4463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1225, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8125814 KL Loss: 13.8582614 DSM Loss: 17.8793101 Overall Loss:33.5501528
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(29.2114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8090230 KL Loss: 13.6664055 DSM Loss: 17.6897361 Overall Loss:33.1651645
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(40.8024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7165, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7677555 KL Loss: 13.6995252 DSM Loss: 17.7111060 Overall Loss:33.1783869
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(35.9225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8515, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7955075 KL Loss: 13.7571999 DSM Loss: 17.5824297 Overall Loss:33.1351372
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(42.8456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5227, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8206062 KL Loss: 13.8968570 DSM Loss: 17.4786249 Overall Loss:33.1960880
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(38.0974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.5248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4639, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7513060 KL Loss: 13.7046295 DSM Loss: 17.5458116 Overall Loss:33.0017471
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(30.0190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6645, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.7767798 KL Loss: 13.6535788 DSM Loss: 17.9487267 Overall Loss:33.3790854
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(33.5825, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8207180 KL Loss: 13.8320939 DSM Loss: 17.6556162 Overall Loss:33.3084280
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(42.8590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.7395045 KL Loss: 13.5903499 DSM Loss: 17.6559519 Overall Loss:32.9858063
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(28.5469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2779, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.7802149 KL Loss: 13.7075098 DSM Loss: 17.5055066 Overall Loss:32.9932314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:13.518431663513184


Running on file PFE.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(63.7258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7304, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9067342 KL Loss: 14.2029412 DSM Loss: 20.7789997 Overall Loss:36.8886751
Validation loss decreased (inf --> 17.736099).  Saving model ...
Updating learning rate to 0.0005
tensor(35.9659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8210811 KL Loss: 13.9143804 DSM Loss: 18.1136346 Overall Loss:33.8490960
Validation loss decreased (17.736099 --> 15.904340).  Saving model ...
Updating learning rate to 0.00025
tensor(28.8417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9004, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8222095 KL Loss: 13.9247828 DSM Loss: 17.2587036 Overall Loss:33.0056959
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(25.2309, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.6041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8276402 KL Loss: 13.9387842 DSM Loss: 17.5568216 Overall Loss:33.3232462
Validation loss decreased (15.904340 --> 15.833314).  Saving model ...
Updating learning rate to 6.25e-05
tensor(39.8875, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.7292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8368927 KL Loss: 13.9431903 DSM Loss: 17.6277859 Overall Loss:33.4078689
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(39.5896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3901, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8013784 KL Loss: 13.8977573 DSM Loss: 17.0026728 Overall Loss:32.7018085
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(34.1557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8047093 KL Loss: 13.9129585 DSM Loss: 17.2703287 Overall Loss:32.9879965
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(38.4809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0536, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8188418 KL Loss: 13.9365968 DSM Loss: 17.3596064 Overall Loss:33.1150452
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(27.4287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.9672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7749778 KL Loss: 13.7315249 DSM Loss: 17.3196495 Overall Loss:32.8261523
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(30.3281, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.5871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2204, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7853185 KL Loss: 13.7654016 DSM Loss: 17.3706582 Overall Loss:32.9213783
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(32.3443, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0410, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7853892 KL Loss: 13.8114755 DSM Loss: 17.2388305 Overall Loss:32.8356952
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(32.9144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8273528 KL Loss: 14.0139261 DSM Loss: 17.4367432 Overall Loss:33.2780221
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(32.3666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0907, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.7880563 KL Loss: 13.8756723 DSM Loss: 17.5560949 Overall Loss:33.2198235
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(30.1914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8065769 KL Loss: 13.9127917 DSM Loss: 17.2722604 Overall Loss:32.9916287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.846781253814697


Running on file PG.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(71.2210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9092802 KL Loss: 14.2358178 DSM Loss: 25.1690269 Overall Loss:41.3141249
Validation loss decreased (inf --> 5.474435).  Saving model ...
Updating learning rate to 0.0005
tensor(33.6125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.4579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2247, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8950363 KL Loss: 14.0705276 DSM Loss: 19.8794761 Overall Loss:35.8450401
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(34.9943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8532574 KL Loss: 13.9882568 DSM Loss: 19.1296915 Overall Loss:34.9712057
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(31.4896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2302, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8459, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8175369 KL Loss: 13.9254579 DSM Loss: 18.8819134 Overall Loss:34.6249082
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(37.0287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8159145 KL Loss: 13.9744297 DSM Loss: 18.4025158 Overall Loss:34.1928601
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(34.1705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.5272, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8114647 KL Loss: 13.8822245 DSM Loss: 18.3232282 Overall Loss:34.0169174
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(35.9047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4246, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8000150 KL Loss: 13.8073308 DSM Loss: 18.2660487 Overall Loss:33.8733946
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(37.7113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3444, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7841519 KL Loss: 13.7844771 DSM Loss: 18.4881204 Overall Loss:34.0567494
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(31.2876, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1756, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.7984682 KL Loss: 13.8537292 DSM Loss: 18.4651373 Overall Loss:34.1173346
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(32.2481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7909038 KL Loss: 13.8693865 DSM Loss: 18.4272743 Overall Loss:34.0875647
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(32.6320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7918663 KL Loss: 13.8251341 DSM Loss: 18.4018447 Overall Loss:34.0188451
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.215885639190674


Running on file PM.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(67.8785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9557359 KL Loss: 14.3226855 DSM Loss: 22.7809334 Overall Loss:39.0593545
Validation loss decreased (inf --> 5.258862).  Saving model ...
Updating learning rate to 0.0005
tensor(40.0194, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8634896 KL Loss: 14.0728866 DSM Loss: 19.3597702 Overall Loss:35.2961463
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(35.3886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7916, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8655661 KL Loss: 14.0695723 DSM Loss: 18.6791732 Overall Loss:34.6143117
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(40.6887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0354, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8357720 KL Loss: 14.0393966 DSM Loss: 18.5834608 Overall Loss:34.4586293
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(37.3375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0511, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8471949 KL Loss: 14.0980833 DSM Loss: 18.3742652 Overall Loss:34.3195433
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(33.4980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4725, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8511299 KL Loss: 14.1052178 DSM Loss: 18.3182265 Overall Loss:34.2745743
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(30.0484, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8816, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8091984 KL Loss: 13.9969280 DSM Loss: 18.6376978 Overall Loss:34.4438242
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(30.9927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8220130 KL Loss: 14.0040657 DSM Loss: 18.4863198 Overall Loss:34.3123983
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(24.1569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8487420 KL Loss: 13.9699270 DSM Loss: 18.1111967 Overall Loss:33.9298656
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(38.6744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8263253 KL Loss: 14.0354518 DSM Loss: 18.2483759 Overall Loss:34.1101531
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(30.1715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4656, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8506916 KL Loss: 14.1180903 DSM Loss: 18.0603437 Overall Loss:34.0291258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.351274490356445


Running on file PPL.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.5529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8192, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9229324 KL Loss: 14.3726308 DSM Loss: 25.0568245 Overall Loss:41.3523875
Validation loss decreased (inf --> 0.959023).  Saving model ...
Updating learning rate to 0.0005
tensor(36.6441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0155, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.2986, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9080804 KL Loss: 14.2341460 DSM Loss: 20.6056798 Overall Loss:36.7479064
Validation loss decreased (0.959023 --> 0.628000).  Saving model ...
Updating learning rate to 0.00025
tensor(31.4328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.5237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8653697 KL Loss: 14.1916331 DSM Loss: 19.9414522 Overall Loss:35.9984551
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(32.7576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8573017 KL Loss: 14.1091184 DSM Loss: 19.7792024 Overall Loss:35.7456223
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(24.1240, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8542, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8547542 KL Loss: 14.1548525 DSM Loss: 19.4891560 Overall Loss:35.4987625
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(36.3378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3913, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8147997 KL Loss: 14.0772800 DSM Loss: 19.7687871 Overall Loss:35.6608668
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(31.9250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0047, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8330912 KL Loss: 14.1777183 DSM Loss: 19.1618343 Overall Loss:35.1726438
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(29.6078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.3281, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8828566 KL Loss: 14.2670972 DSM Loss: 19.3053280 Overall Loss:35.4552818
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(28.5724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6881, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8763090 KL Loss: 14.2207575 DSM Loss: 19.4560301 Overall Loss:35.5530964
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(33.9025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.9740, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8713259 KL Loss: 14.1640773 DSM Loss: 19.0381248 Overall Loss:35.0735278
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(21.8629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8639617 KL Loss: 14.1399290 DSM Loss: 19.3241044 Overall Loss:35.3279952
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(35.0800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3987, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4739, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8410524 KL Loss: 14.1814417 DSM Loss: 19.2504935 Overall Loss:35.2729875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.7518491148948669


Running on file REX.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(38.9937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6386, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9638539 KL Loss: 14.4064772 DSM Loss: 22.7241389 Overall Loss:39.0944699
Validation loss decreased (inf --> 1.264146).  Saving model ...
Updating learning rate to 0.0005
tensor(25.7835, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1173, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8668563 KL Loss: 14.0940812 DSM Loss: 18.6621488 Overall Loss:34.6230862
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(33.9985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8630674 KL Loss: 14.2164313 DSM Loss: 18.2476538 Overall Loss:34.3271522
Validation loss decreased (1.264146 --> 1.247175).  Saving model ...
Updating learning rate to 0.000125
tensor(28.7168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8559552 KL Loss: 14.0496440 DSM Loss: 17.8547160 Overall Loss:33.7603152
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(34.6739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8174077 KL Loss: 14.0788808 DSM Loss: 17.8907376 Overall Loss:33.7870261
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(36.9714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.0115, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8457937 KL Loss: 14.2734010 DSM Loss: 17.4444914 Overall Loss:33.5636862
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(34.8405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6589, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8486956 KL Loss: 14.1941304 DSM Loss: 17.5188229 Overall Loss:33.5616490
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(36.9983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2831, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8498552 KL Loss: 14.1158934 DSM Loss: 17.4436029 Overall Loss:33.4093516
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(40.8086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8438445 KL Loss: 14.1542696 DSM Loss: 17.5591926 Overall Loss:33.5573067
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(39.8162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8224783 KL Loss: 14.1098923 DSM Loss: 17.6498068 Overall Loss:33.5821773
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(45.8506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7007, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8363986 KL Loss: 14.0074113 DSM Loss: 17.7064739 Overall Loss:33.5502838
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(30.6043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1377, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8396836 KL Loss: 14.1491895 DSM Loss: 17.6988514 Overall Loss:33.6877244
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.4502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3796, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8433532 KL Loss: 14.1738303 DSM Loss: 17.4827723 Overall Loss:33.4999560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.7199110984802246


Running on file SLB.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.1728, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.2973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7850, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8116393 KL Loss: 14.0433116 DSM Loss: 24.7390933 Overall Loss:40.5940442
Validation loss decreased (inf --> 0.301398).  Saving model ...
Updating learning rate to 0.0005
tensor(42.4376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.1743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.7912385 KL Loss: 13.9635611 DSM Loss: 20.5989676 Overall Loss:36.3537673
Validation loss decreased (0.301398 --> 0.275025).  Saving model ...
Updating learning rate to 0.00025
tensor(37.6037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8367693 KL Loss: 14.0242288 DSM Loss: 20.0901947 Overall Loss:35.9511926
Validation loss decreased (0.275025 --> 0.219747).  Saving model ...
Updating learning rate to 0.000125
tensor(33.2719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6426, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8155721 KL Loss: 13.8393424 DSM Loss: 19.7615368 Overall Loss:35.4164512
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(36.3296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.0107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6891, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7768357 KL Loss: 13.7327371 DSM Loss: 19.3635688 Overall Loss:34.8731415
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(35.5756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2402, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.7691061 KL Loss: 13.6045081 DSM Loss: 19.3236911 Overall Loss:34.6973055
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(38.2223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8668, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7872557 KL Loss: 13.6912995 DSM Loss: 19.0120845 Overall Loss:34.4906398
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(35.5925, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7358, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8000567 KL Loss: 13.7368040 DSM Loss: 18.8851157 Overall Loss:34.4219765
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(34.2951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8003125 KL Loss: 13.6810877 DSM Loss: 19.0999877 Overall Loss:34.5813881
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(40.1938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2569, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7963457 KL Loss: 13.6865941 DSM Loss: 19.0130728 Overall Loss:34.4960124
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(34.1344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7975480 KL Loss: 13.7109932 DSM Loss: 19.2168001 Overall Loss:34.7253411
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(32.6014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6331, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8150976 KL Loss: 13.6941410 DSM Loss: 19.0238630 Overall Loss:34.5331018
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(35.6570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1931, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.7890277 KL Loss: 13.6939478 DSM Loss: 18.9919627 Overall Loss:34.4749384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.24893945455551147


Running on file SNY.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.8324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9796319 KL Loss: 14.3502722 DSM Loss: 22.2374084 Overall Loss:38.5673124
Validation loss decreased (inf --> 2.951226).  Saving model ...
Updating learning rate to 0.0005
tensor(37.9802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.3513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9318564 KL Loss: 14.2932158 DSM Loss: 19.3062501 Overall Loss:35.5313222
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(32.5915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.5940, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8781123 KL Loss: 14.1063135 DSM Loss: 19.0163675 Overall Loss:35.0007932
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(33.7492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8650913 KL Loss: 14.0736319 DSM Loss: 18.5004490 Overall Loss:34.4391720
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(37.4040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8204223 KL Loss: 14.0574902 DSM Loss: 18.4691254 Overall Loss:34.3470378
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(27.3462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1086, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8444308 KL Loss: 14.0371765 DSM Loss: 18.4215881 Overall Loss:34.3031954
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(37.1838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.0537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8871043 KL Loss: 14.2922908 DSM Loss: 18.0930327 Overall Loss:34.2724278
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(47.6295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.2463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7685, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8400759 KL Loss: 14.0456451 DSM Loss: 18.5315058 Overall Loss:34.4172268
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(28.6399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.3764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8517451 KL Loss: 14.0786441 DSM Loss: 18.4161958 Overall Loss:34.3465850
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(30.9277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8511063 KL Loss: 14.1299034 DSM Loss: 18.3575579 Overall Loss:34.3385676
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(31.6082, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.0462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5994, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8615856 KL Loss: 14.1833290 DSM Loss: 18.2085557 Overall Loss:34.2534702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:4.082766532897949


Running on file SO.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(50.3696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.7023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8873787 KL Loss: 13.9892040 DSM Loss: 22.6089431 Overall Loss:38.4855256
Validation loss decreased (inf --> 6.401712).  Saving model ...
Updating learning rate to 0.0005
tensor(38.8075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3988, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9711308 KL Loss: 14.3075633 DSM Loss: 19.6648147 Overall Loss:35.9435088
Validation loss decreased (6.401712 --> 6.229554).  Saving model ...
Updating learning rate to 0.00025
tensor(29.3462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6801, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.9031405 KL Loss: 14.1684403 DSM Loss: 19.0158406 Overall Loss:35.0874214
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(40.2477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8118648 KL Loss: 13.9315349 DSM Loss: 18.7097389 Overall Loss:34.4531386
Validation loss decreased (6.229554 --> 5.550041).  Saving model ...
Updating learning rate to 6.25e-05
tensor(32.2036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0663, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8000152 KL Loss: 13.9133698 DSM Loss: 18.6736046 Overall Loss:34.3869896
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(30.3577, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.9084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8220343 KL Loss: 13.8685247 DSM Loss: 18.3267899 Overall Loss:34.0173489
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(39.2503, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0470, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8556372 KL Loss: 14.0092292 DSM Loss: 18.3566388 Overall Loss:34.2215051
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(34.9604, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8017123 KL Loss: 13.8979926 DSM Loss: 18.5681341 Overall Loss:34.2678388
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(30.2997, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6512, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8205908 KL Loss: 13.9551162 DSM Loss: 18.3112898 Overall Loss:34.0869969
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(33.0208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9826, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.7932560 KL Loss: 13.8599423 DSM Loss: 18.4039029 Overall Loss:34.0571009
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(36.5988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8046531 KL Loss: 13.8544441 DSM Loss: 18.4679137 Overall Loss:34.1270109
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(29.7430, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7391, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8023167 KL Loss: 13.8000673 DSM Loss: 17.9412515 Overall Loss:33.5436355
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(25.5337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5303, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8127426 KL Loss: 13.9173092 DSM Loss: 18.3595726 Overall Loss:34.0896245
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(33.0628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4817, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.7835586 KL Loss: 13.8554685 DSM Loss: 18.3377018 Overall Loss:33.9767288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:9.525702476501465


Running on file SPLP.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.4901, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5154, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9253757 KL Loss: 14.3045115 DSM Loss: 22.1354201 Overall Loss:38.3653073
Validation loss decreased (inf --> 19.835083).  Saving model ...
Updating learning rate to 0.0005
tensor(54.3782, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.8443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9102957 KL Loss: 14.2620263 DSM Loss: 19.1414079 Overall Loss:35.3137298
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(25.6051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7099, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8786277 KL Loss: 14.2593315 DSM Loss: 18.3836480 Overall Loss:34.5216074
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(27.3201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.6365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8467297 KL Loss: 13.9816642 DSM Loss: 18.6102635 Overall Loss:34.4386574
Validation loss decreased (19.835083 --> 18.983761).  Saving model ...
Updating learning rate to 6.25e-05
tensor(27.8121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8386602 KL Loss: 14.0344596 DSM Loss: 18.2859392 Overall Loss:34.1590590
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(23.0755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.5963, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8599310 KL Loss: 14.0404452 DSM Loss: 18.2574878 Overall Loss:34.1578641
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(40.4992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.8858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8290743 KL Loss: 13.9628637 DSM Loss: 18.4255760 Overall Loss:34.2175138
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(38.8928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.7108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8307398 KL Loss: 14.0410967 DSM Loss: 17.8998194 Overall Loss:33.7716559
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(19.1939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.4259, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8331174 KL Loss: 14.0962980 DSM Loss: 17.8365408 Overall Loss:33.7659561
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(33.4857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.2978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8121107 KL Loss: 13.9442841 DSM Loss: 18.1289123 Overall Loss:33.8853069
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(23.2714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.2869, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3701, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8607101 KL Loss: 14.0504499 DSM Loss: 18.1947196 Overall Loss:34.1058795
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.1277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8550695 KL Loss: 14.0037528 DSM Loss: 18.0768080 Overall Loss:33.9356303
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(26.9044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.4000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8614799 KL Loss: 14.1028279 DSM Loss: 17.6262043 Overall Loss:33.5905119
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(29.8229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8538885 KL Loss: 14.0475785 DSM Loss: 18.2331584 Overall Loss:34.1346255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:32.067115783691406


Running on file SRE.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.3883, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1746, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8834464 KL Loss: 14.1414704 DSM Loss: 21.5604526 Overall Loss:37.5853694
Validation loss decreased (inf --> 4.014935).  Saving model ...
Updating learning rate to 0.0005
tensor(33.5668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9214, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8879837 KL Loss: 14.0820059 DSM Loss: 18.8910245 Overall Loss:34.8610140
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(37.8209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1749, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8438244 KL Loss: 14.0862328 DSM Loss: 18.4817376 Overall Loss:34.4117948
Validation loss decreased (4.014935 --> 3.920340).  Saving model ...
Updating learning rate to 0.000125
tensor(36.5631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8556059 KL Loss: 14.0098733 DSM Loss: 18.3610436 Overall Loss:34.2265226
Validation loss decreased (3.920340 --> 3.840761).  Saving model ...
Updating learning rate to 6.25e-05
tensor(30.0666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.6853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8098485 KL Loss: 14.0117544 DSM Loss: 17.9278294 Overall Loss:33.7494322
Validation loss decreased (3.840761 --> 3.528771).  Saving model ...
Updating learning rate to 3.125e-05
tensor(40.3919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2441, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8150063 KL Loss: 14.0853105 DSM Loss: 18.0997316 Overall Loss:34.0000481
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(39.3817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8346197 KL Loss: 13.9754777 DSM Loss: 17.6503542 Overall Loss:33.4604516
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(33.7765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5673, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9185, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8653803 KL Loss: 14.1843138 DSM Loss: 17.6986884 Overall Loss:33.7483824
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(29.8316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.3378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.3891, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8143926 KL Loss: 13.9620920 DSM Loss: 18.2009690 Overall Loss:33.9774536
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(30.7219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3474, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8740296 KL Loss: 14.1672990 DSM Loss: 17.4510590 Overall Loss:33.4923874
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(25.0418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8008641 KL Loss: 13.9788953 DSM Loss: 18.1729570 Overall Loss:33.9527165
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(33.9217, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.3577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8640211 KL Loss: 14.2267867 DSM Loss: 18.0062588 Overall Loss:34.0970664
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(34.4833, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.2993, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8676469 KL Loss: 14.0916269 DSM Loss: 18.0675187 Overall Loss:34.0267926
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(28.3018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0746, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4783, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8182683 KL Loss: 14.0257953 DSM Loss: 17.7510865 Overall Loss:33.5951500
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(31.1723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.8021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.1134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8660430 KL Loss: 14.1229728 DSM Loss: 17.8381107 Overall Loss:33.8271263
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:7.5453996658325195


Running on file T.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.9493, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8308, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.6895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8795478 KL Loss: 14.1882299 DSM Loss: 24.1566923 Overall Loss:40.2244705
Validation loss decreased (inf --> 0.696440).  Saving model ...
Updating learning rate to 0.0005
tensor(35.1831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9425975 KL Loss: 14.3656848 DSM Loss: 19.1348831 Overall Loss:35.4431653
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(43.0474, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8956421 KL Loss: 14.1014207 DSM Loss: 18.8268456 Overall Loss:34.8239082
Validation loss decreased (0.696440 --> 0.677466).  Saving model ...
Updating learning rate to 0.000125
tensor(25.3766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7073, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.9811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8850797 KL Loss: 14.0737112 DSM Loss: 18.1540479 Overall Loss:34.1128388
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(34.3096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3086, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8873181 KL Loss: 14.1074321 DSM Loss: 18.1327766 Overall Loss:34.1275268
Validation loss decreased (0.677466 --> 0.590720).  Saving model ...
Updating learning rate to 3.125e-05
tensor(24.9719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.2890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8786807 KL Loss: 14.2298736 DSM Loss: 18.3863058 Overall Loss:34.4948601
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(33.4496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5802, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8891615 KL Loss: 14.0722761 DSM Loss: 17.9933639 Overall Loss:33.9548016
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(46.1145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8495593 KL Loss: 14.0714604 DSM Loss: 18.1629270 Overall Loss:34.0839466
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(24.5706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8205510 KL Loss: 13.9143358 DSM Loss: 18.1176790 Overall Loss:33.8525659
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(36.5108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.9557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.5959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8184339 KL Loss: 13.9943453 DSM Loss: 18.0687299 Overall Loss:33.8815092
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(46.1681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8688977 KL Loss: 14.1114853 DSM Loss: 17.7628823 Overall Loss:33.7432654
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.7652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4977, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8725124 KL Loss: 14.0828662 DSM Loss: 18.1600395 Overall Loss:34.1154178
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(42.9108, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8570068 KL Loss: 14.1166125 DSM Loss: 18.1919479 Overall Loss:34.1655672
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(31.9732, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.3283, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8905285 KL Loss: 14.1161341 DSM Loss: 17.5290801 Overall Loss:33.5357429
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(24.1421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.1447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8887173 KL Loss: 14.2188759 DSM Loss: 18.0385207 Overall Loss:34.1461142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.626490592956543


Running on file TM.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.6943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0831, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9112237 KL Loss: 14.2535237 DSM Loss: 23.0887456 Overall Loss:39.2534931
Validation loss decreased (inf --> 11.066470).  Saving model ...
Updating learning rate to 0.0005
tensor(31.5635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.6975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0866, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9464713 KL Loss: 14.2762874 DSM Loss: 19.0141375 Overall Loss:35.2368962
Validation loss decreased (11.066470 --> 10.889129).  Saving model ...
Updating learning rate to 0.00025
tensor(40.4954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.3421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8945634 KL Loss: 14.2488118 DSM Loss: 18.1815363 Overall Loss:34.3249114
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(28.2355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.4313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.8707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8669106 KL Loss: 14.0595414 DSM Loss: 17.7936893 Overall Loss:33.7201411
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(27.8566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3382, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8755077 KL Loss: 14.1287684 DSM Loss: 17.5811597 Overall Loss:33.5854358
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(31.1304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8512361 KL Loss: 13.9061601 DSM Loss: 17.9118152 Overall Loss:33.6692112
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(32.7072, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8157914 KL Loss: 13.8887705 DSM Loss: 17.7719660 Overall Loss:33.4765279
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(53.2485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.4216, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8424257 KL Loss: 14.0559200 DSM Loss: 18.1233306 Overall Loss:34.0216762
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(23.1647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.8587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2942, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8744214 KL Loss: 14.0445597 DSM Loss: 17.5882787 Overall Loss:33.5072600
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(37.6225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.8823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8588111 KL Loss: 14.1115990 DSM Loss: 17.7721336 Overall Loss:33.7425437
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(32.4858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9188, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8335321 KL Loss: 14.0221218 DSM Loss: 17.7331458 Overall Loss:33.5887997
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(56.7658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0805, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.8324, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8034543 KL Loss: 13.8944204 DSM Loss: 17.7219843 Overall Loss:33.4198590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.3344593048095703


Running on file TSM.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(59.8932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.9461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8428197 KL Loss: 13.9992292 DSM Loss: 22.4638350 Overall Loss:38.3058838
Validation loss decreased (inf --> 5.224647).  Saving model ...
Updating learning rate to 0.0005
tensor(26.6707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0160, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8739253 KL Loss: 13.8548342 DSM Loss: 19.5067490 Overall Loss:35.2355087
Validation loss decreased (5.224647 --> 4.262821).  Saving model ...
Updating learning rate to 0.00025
tensor(29.7664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8197734 KL Loss: 13.7671066 DSM Loss: 18.9737277 Overall Loss:34.5606077
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(46.5892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.4453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7537, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8760077 KL Loss: 13.7628088 DSM Loss: 18.6188753 Overall Loss:34.2576917
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(51.1865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.5251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8543729 KL Loss: 13.7217892 DSM Loss: 18.8715220 Overall Loss:34.4476842
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(29.2878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8194131 KL Loss: 13.6128909 DSM Loss: 18.6507831 Overall Loss:34.0830873
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(37.3241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.8384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.5074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8281279 KL Loss: 13.6235467 DSM Loss: 18.1647953 Overall Loss:33.6164700
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(22.9538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.3951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.7381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8793623 KL Loss: 13.8012454 DSM Loss: 18.2921987 Overall Loss:33.9728064
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(25.0288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.3499, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8788907 KL Loss: 13.8120939 DSM Loss: 18.3836571 Overall Loss:34.0746415
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(27.4085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.4617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8680855 KL Loss: 13.6346863 DSM Loss: 18.2888010 Overall Loss:33.7915730
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(32.5415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8468444 KL Loss: 13.8312985 DSM Loss: 18.8362439 Overall Loss:34.5143867
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(40.6263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.0438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.3059, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.9038908 KL Loss: 13.7611429 DSM Loss: 18.2532339 Overall Loss:33.9182678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.5545203685760498


Running on file UL.csv (64/71)...
Use GPU: cuda:0
>>>>>>>start training : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(66.0085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.0570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8514162 KL Loss: 14.0861091 DSM Loss: 21.5792181 Overall Loss:37.5167434
Validation loss decreased (inf --> 0.266460).  Saving model ...
Updating learning rate to 0.0005
tensor(29.5200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.3313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7759, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8857354 KL Loss: 14.0725686 DSM Loss: 18.5400762 Overall Loss:34.4983802
Validation loss decreased (0.266460 --> 0.262481).  Saving model ...
Updating learning rate to 0.00025
tensor(33.0365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8704651 KL Loss: 14.0806300 DSM Loss: 18.0544247 Overall Loss:34.0055196
Validation loss decreased (0.262481 --> 0.235460).  Saving model ...
Updating learning rate to 0.000125
tensor(31.6263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8309294 KL Loss: 13.9898304 DSM Loss: 18.0638545 Overall Loss:33.8846139
Validation loss decreased (0.235460 --> 0.225285).  Saving model ...
Updating learning rate to 6.25e-05
tensor(31.7646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8152104 KL Loss: 13.8743591 DSM Loss: 18.0323196 Overall Loss:33.7218891
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(39.1486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.1580, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3545, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8113235 KL Loss: 13.8736748 DSM Loss: 17.9947403 Overall Loss:33.6797387
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(22.5445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7565, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7967625 KL Loss: 13.8358573 DSM Loss: 17.7037142 Overall Loss:33.3363340
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(41.4929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.9908, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7785737 KL Loss: 13.7932468 DSM Loss: 17.8372271 Overall Loss:33.4090476
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(24.5995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8017661 KL Loss: 13.8193097 DSM Loss: 17.6227929 Overall Loss:33.2438685
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(32.3150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.8539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8239533 KL Loss: 13.8463215 DSM Loss: 17.9183880 Overall Loss:33.5886626
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(33.4764, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4359, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7868950 KL Loss: 13.7768132 DSM Loss: 17.8550013 Overall Loss:33.4187095
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(41.0546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.8793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2858, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7838927 KL Loss: 13.7391403 DSM Loss: 17.6376318 Overall Loss:33.1606648
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(51.0786, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.8756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.8724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8194236 KL Loss: 13.9424046 DSM Loss: 17.6044241 Overall Loss:33.3662522
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(33.4084, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.3780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.3426, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8032727 KL Loss: 13.9377821 DSM Loss: 17.6127144 Overall Loss:33.3537691
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.2737041413784027


Running on file UNH.csv (65/71)...
Use GPU: cuda:0
>>>>>>>start training : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(56.6675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.5043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.9799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9236044 KL Loss: 14.2437639 DSM Loss: 21.0927352 Overall Loss:37.2601033
Validation loss decreased (inf --> 8.421448).  Saving model ...
Updating learning rate to 0.0005
tensor(32.3847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.4870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6243, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8720508 KL Loss: 14.1415580 DSM Loss: 18.6192398 Overall Loss:34.6328486
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(28.1611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.4937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0653, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8592771 KL Loss: 13.9335481 DSM Loss: 17.7969324 Overall Loss:33.5897576
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(35.6003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.2332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.7347, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8494866 KL Loss: 13.8374179 DSM Loss: 17.7143483 Overall Loss:33.4012530
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(36.4853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.0159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8185156 KL Loss: 13.7313058 DSM Loss: 17.9801162 Overall Loss:33.5299378
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(36.3049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3038, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8122734 KL Loss: 13.7635123 DSM Loss: 17.7774267 Overall Loss:33.3532125
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(51.9780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2721, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2769, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8535272 KL Loss: 13.8779658 DSM Loss: 17.8734306 Overall Loss:33.6049236
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(37.8385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8020, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0443, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.7798880 KL Loss: 13.6418450 DSM Loss: 17.6319166 Overall Loss:33.0536496
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(30.7479, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.2084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8105302 KL Loss: 13.7729324 DSM Loss: 17.6250051 Overall Loss:33.2084677
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(28.5852, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.9433, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8099975 KL Loss: 13.8926983 DSM Loss: 17.5258136 Overall Loss:33.2285092
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(32.9022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6747, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8074247 KL Loss: 13.7429873 DSM Loss: 17.3872216 Overall Loss:32.9376337
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UNH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:12.321036338806152


Running on file UPS.csv (66/71)...
Use GPU: cuda:0
>>>>>>>start training : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(60.5571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.3803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9116688 KL Loss: 14.1727939 DSM Loss: 24.2688589 Overall Loss:40.3533217
Validation loss decreased (inf --> 9.246015).  Saving model ...
Updating learning rate to 0.0005
tensor(48.4680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.2940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6955, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9082480 KL Loss: 13.9256305 DSM Loss: 19.7357177 Overall Loss:35.5695961
Validation loss decreased (9.246015 --> 8.335444).  Saving model ...
Updating learning rate to 0.00025
tensor(40.4170, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4339, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8727330 KL Loss: 13.8309342 DSM Loss: 18.9280963 Overall Loss:34.6317634
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(30.7138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.3536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(23.7869, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8553573 KL Loss: 13.7411113 DSM Loss: 18.5745927 Overall Loss:34.1710612
Validation loss decreased (8.335444 --> 8.292930).  Saving model ...
Updating learning rate to 6.25e-05
tensor(35.1257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.6948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8691535 KL Loss: 14.0159874 DSM Loss: 18.5050872 Overall Loss:34.3902282
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(35.7647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.2184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8778405 KL Loss: 13.8820860 DSM Loss: 18.0532416 Overall Loss:33.8131683
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(24.5044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.4639, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.1394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8806280 KL Loss: 13.9051590 DSM Loss: 17.7495260 Overall Loss:33.5353130
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(30.9909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8584775 KL Loss: 13.9108301 DSM Loss: 18.0889095 Overall Loss:33.8582170
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(36.5068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4750, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9969, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8552473 KL Loss: 13.9238707 DSM Loss: 17.9941195 Overall Loss:33.7732376
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(28.5051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(20.8080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0451, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8449983 KL Loss: 13.6822247 DSM Loss: 17.6871247 Overall Loss:33.2143477
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(26.4629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8254, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8174216 KL Loss: 13.8352212 DSM Loss: 17.9900494 Overall Loss:33.6426923
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(45.7686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.1010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8990986 KL Loss: 13.9323752 DSM Loss: 17.8678712 Overall Loss:33.6993448
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(25.4434, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.6616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.1939, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8481430 KL Loss: 13.8931960 DSM Loss: 17.7540876 Overall Loss:33.4954265
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(27.6262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6367, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8371353 KL Loss: 13.7868584 DSM Loss: 17.9595538 Overall Loss:33.5835475
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : UPS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:5.065621852874756


Running on file V.csv (67/71)...
Use GPU: cuda:0
>>>>>>>start training : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(53.5003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.3476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9745809 KL Loss: 14.2932103 DSM Loss: 27.3792367 Overall Loss:43.6470276
Validation loss decreased (inf --> 1.763429).  Saving model ...
Updating learning rate to 0.0005
tensor(38.6227, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5139, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8776443 KL Loss: 14.1128522 DSM Loss: 19.9879406 Overall Loss:35.9784370
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(34.5640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.1292, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8692121 KL Loss: 14.0562344 DSM Loss: 19.1961055 Overall Loss:35.1215520
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(27.8030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.6243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.7899226 KL Loss: 13.8656585 DSM Loss: 18.4117895 Overall Loss:34.0673705
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(46.8054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0631, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.4805, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.7981237 KL Loss: 13.8346650 DSM Loss: 18.3605472 Overall Loss:33.9933358
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(27.2971, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.1575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8008869 KL Loss: 13.8166931 DSM Loss: 18.2213078 Overall Loss:33.8388880
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(33.2889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.5488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4754, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8094540 KL Loss: 13.8528252 DSM Loss: 17.9700175 Overall Loss:33.6322965
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(28.6867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8225030 KL Loss: 13.9335443 DSM Loss: 18.2218827 Overall Loss:33.9779301
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(33.8366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.6555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8028806 KL Loss: 13.8557579 DSM Loss: 18.2528353 Overall Loss:33.9114739
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(40.7819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8006601 KL Loss: 13.9081614 DSM Loss: 18.0732192 Overall Loss:33.7820406
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(28.9537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8038054 KL Loss: 13.7978053 DSM Loss: 17.6938379 Overall Loss:33.2954488
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : V.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:2.1396889686584473


Running on file VZ.csv (68/71)...
Use GPU: cuda:0
>>>>>>>start training : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(54.9301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.5939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3332, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8712170 KL Loss: 14.2371665 DSM Loss: 26.3010574 Overall Loss:42.4094408
Validation loss decreased (inf --> 0.749800).  Saving model ...
Updating learning rate to 0.0005
tensor(32.1508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9751, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8334371 KL Loss: 14.0772123 DSM Loss: 19.6936257 Overall Loss:35.6042752
Validation loss decreased (0.749800 --> 0.663438).  Saving model ...
Updating learning rate to 0.00025
tensor(34.2627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.7766048 KL Loss: 14.0192024 DSM Loss: 18.9003211 Overall Loss:34.6961285
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(32.0328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8112, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8294181 KL Loss: 14.0191407 DSM Loss: 18.5762205 Overall Loss:34.4247793
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(35.7293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(26.1404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8247042 KL Loss: 13.9779008 DSM Loss: 18.5167867 Overall Loss:34.3193917
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(34.2632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.4906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8161020 KL Loss: 13.8941726 DSM Loss: 18.3178749 Overall Loss:34.0281494
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(32.2228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.2826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.7873051 KL Loss: 13.9057509 DSM Loss: 18.0755725 Overall Loss:33.7686284
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(34.2099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.8000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7471, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8153113 KL Loss: 13.8596115 DSM Loss: 18.2852529 Overall Loss:33.9601756
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(31.5955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.3966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8105525 KL Loss: 13.8900268 DSM Loss: 18.0235802 Overall Loss:33.7241594
Validation loss decreased (0.663438 --> 0.633022).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(29.7231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6204, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.7012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8012923 KL Loss: 13.8886849 DSM Loss: 18.0621778 Overall Loss:33.7521549
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-07
tensor(31.9417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.4628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.9424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.7705762 KL Loss: 13.8637972 DSM Loss: 17.7766370 Overall Loss:33.4110105
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-07
tensor(36.1110, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0398, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.3475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8090853 KL Loss: 13.9666049 DSM Loss: 18.3595797 Overall Loss:34.1352696
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-07
tensor(29.4221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.5475, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1511, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.7741287 KL Loss: 13.8532947 DSM Loss: 17.8531657 Overall Loss:33.4805890
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-07
tensor(31.7999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5114, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6856, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.7862890 KL Loss: 13.9209737 DSM Loss: 18.3135703 Overall Loss:34.0208332
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-08
tensor(33.1666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.7809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.7046, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.7955600 KL Loss: 13.9169428 DSM Loss: 18.2760716 Overall Loss:33.9885743
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-08
tensor(31.9849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.6727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.7738416 KL Loss: 13.9143609 DSM Loss: 18.2998646 Overall Loss:33.9880670
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-08
tensor(38.0527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2849, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.4469, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8421951 KL Loss: 14.0092737 DSM Loss: 18.2442473 Overall Loss:34.0957160
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-09
tensor(39.1747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.1182, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6619, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 85 | MSE Loss: 1.7942365 KL Loss: 13.8567356 DSM Loss: 18.2485362 Overall Loss:33.8995083
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-09
tensor(36.4718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.7807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7594, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 85 | MSE Loss: 1.7970934 KL Loss: 13.9444895 DSM Loss: 18.1869621 Overall Loss:33.9285451
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : VZ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:1.1601858139038086


Running on file WFC.csv (69/71)...
Use GPU: cuda:0
>>>>>>>start training : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(57.6707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.3044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1844, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8777549 KL Loss: 14.0498992 DSM Loss: 26.6046746 Overall Loss:42.5323286
Validation loss decreased (inf --> 0.876974).  Saving model ...
Updating learning rate to 0.0005
tensor(35.6464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.1683, device='cuda:0', grad_fn=<AddBackward0>)
tensor(25.7860, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9246105 KL Loss: 14.1390796 DSM Loss: 21.6944609 Overall Loss:37.7581510
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(41.0265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8779076 KL Loss: 14.0909771 DSM Loss: 21.0826376 Overall Loss:37.0515224
Validation loss decreased (0.876974 --> 0.816795).  Saving model ...
Updating learning rate to 0.000125
tensor(34.8641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.6614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8815244 KL Loss: 14.1340310 DSM Loss: 20.1502163 Overall Loss:36.1657718
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(47.9974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.4127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.6037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8284260 KL Loss: 14.1111379 DSM Loss: 19.9983573 Overall Loss:35.9379212
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(30.9560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.5644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8815470 KL Loss: 14.2158471 DSM Loss: 19.5836196 Overall Loss:35.6810137
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(32.4460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.3053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8658911 KL Loss: 14.0743127 DSM Loss: 19.2785228 Overall Loss:35.2187265
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(37.1716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.8614, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8390872 KL Loss: 13.9950353 DSM Loss: 19.6331085 Overall Loss:35.4672310
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(42.3025, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4914, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8597940 KL Loss: 14.1080038 DSM Loss: 19.3538616 Overall Loss:35.3216594
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(25.9734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.2694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.9711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8693872 KL Loss: 14.1696960 DSM Loss: 19.4607840 Overall Loss:35.4998670
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(32.4938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8035, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8327865 KL Loss: 13.8866865 DSM Loss: 19.8321405 Overall Loss:35.5516136
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(34.1858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.2917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8180288 KL Loss: 13.9440166 DSM Loss: 19.2805292 Overall Loss:35.0425746
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(42.7261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.5902, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8754312 KL Loss: 14.0863801 DSM Loss: 19.4104289 Overall Loss:35.3722401
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : WFC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:0.11769700795412064


Running on file WMT.csv (70/71)...
Use GPU: cuda:0
>>>>>>>start training : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(47.5126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.7975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.7700, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.8942983 KL Loss: 14.1799098 DSM Loss: 22.0358468 Overall Loss:38.1100548
Validation loss decreased (inf --> 3.228590).  Saving model ...
Updating learning rate to 0.0005
tensor(37.0607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.0470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.9716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.8835759 KL Loss: 14.1945764 DSM Loss: 19.2910725 Overall Loss:35.3692247
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(33.2870, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.7107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8882284 KL Loss: 14.0648691 DSM Loss: 18.8374010 Overall Loss:34.7904986
Validation loss decreased (3.228590 --> 2.892860).  Saving model ...
Updating learning rate to 0.000125
tensor(30.1143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.3608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.0473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8444325 KL Loss: 14.0907069 DSM Loss: 18.5410459 Overall Loss:34.4761855
Validation loss decreased (2.892860 --> 2.854378).  Saving model ...
Updating learning rate to 6.25e-05
tensor(31.2569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.1356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.9615, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8660415 KL Loss: 14.0853675 DSM Loss: 18.6491399 Overall Loss:34.6005489
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(37.0346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.7573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.3526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8282209 KL Loss: 13.9460859 DSM Loss: 18.6274187 Overall Loss:34.4017255
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(37.3539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.8255363 KL Loss: 14.0283045 DSM Loss: 18.4584198 Overall Loss:34.3122606
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(32.7717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.0030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.9069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8124803 KL Loss: 14.0487189 DSM Loss: 18.4039351 Overall Loss:34.2651344
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(33.8143, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.6519, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8141595 KL Loss: 14.0515892 DSM Loss: 18.0978954 Overall Loss:33.9636441
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(34.4394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.6213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8067111 KL Loss: 13.9416383 DSM Loss: 18.2174112 Overall Loss:33.9657605
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(35.1497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.0071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.0795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8105424 KL Loss: 13.9298731 DSM Loss: 18.3570019 Overall Loss:34.0974174
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(48.8569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7256, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.7945648 KL Loss: 13.9029511 DSM Loss: 18.2669448 Overall Loss:33.9644607
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(37.8196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.2276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.1860, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8333598 KL Loss: 14.1078262 DSM Loss: 18.4077698 Overall Loss:34.3489555
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(26.5891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(35.0550, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.1689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8213665 KL Loss: 13.9443502 DSM Loss: 17.9066950 Overall Loss:33.6724115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : WMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:3.631397247314453


Running on file XOM.csv (71/71)...
Use GPU: cuda:0
>>>>>>>start training : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1369
val 182
test 383
tensor(43.2454, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.5223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.6721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 85 | MSE Loss: 1.9567569 KL Loss: 14.1960354 DSM Loss: 23.4597128 Overall Loss:39.6125053
Validation loss decreased (inf --> 2.454822).  Saving model ...
Updating learning rate to 0.0005
tensor(26.9511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(22.5627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(34.8621, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 85 | MSE Loss: 1.9135128 KL Loss: 14.1393425 DSM Loss: 20.8172791 Overall Loss:36.8701340
Validation loss decreased (2.454822 --> 2.284072).  Saving model ...
Updating learning rate to 0.00025
tensor(27.0490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.6617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.7689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 85 | MSE Loss: 1.8852236 KL Loss: 14.0659107 DSM Loss: 20.0905898 Overall Loss:36.0417241
Validation loss decreased (2.284072 --> 2.172023).  Saving model ...
Updating learning rate to 0.000125
tensor(22.1435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.1347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.4052, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 85 | MSE Loss: 1.8821296 KL Loss: 13.7960655 DSM Loss: 19.3753738 Overall Loss:35.0535689
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(31.5903, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.9225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(24.0015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 85 | MSE Loss: 1.8332487 KL Loss: 13.8783978 DSM Loss: 19.6985622 Overall Loss:35.4102088
Validation loss decreased (2.172023 --> 2.129856).  Saving model ...
Updating learning rate to 3.125e-05
tensor(34.6289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.1771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(21.6210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 85 | MSE Loss: 1.8772213 KL Loss: 13.9496374 DSM Loss: 19.7320181 Overall Loss:35.5588765
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(40.1267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(36.8428, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.0426, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 85 | MSE Loss: 1.9098630 KL Loss: 13.9782906 DSM Loss: 18.9090980 Overall Loss:34.7972516
Validation loss decreased (2.129856 --> 2.109948).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(55.2167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.4336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(27.4659, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 85 | MSE Loss: 1.8582061 KL Loss: 13.8282869 DSM Loss: 19.4064238 Overall Loss:35.0929170
Validation loss decreased (2.109948 --> 2.106488).  Saving model ...
Updating learning rate to 3.90625e-06
tensor(36.1796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 85 | MSE Loss: 1.8547365 KL Loss: 13.8588082 DSM Loss: 19.4364827 Overall Loss:35.1500273
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-06
tensor(43.0787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.8351, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 85 | MSE Loss: 1.8507422 KL Loss: 13.9446166 DSM Loss: 19.4396059 Overall Loss:35.2349647
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-07
tensor(31.2515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.6891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.4161, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 85 | MSE Loss: 1.8321898 KL Loss: 13.8601626 DSM Loss: 19.4847055 Overall Loss:35.1770579
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-07
tensor(31.9053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.5975, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.2053, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 85 | MSE Loss: 1.8451734 KL Loss: 13.8496788 DSM Loss: 19.7669167 Overall Loss:35.4617687
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-07
tensor(33.4977, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1106, device='cuda:0', grad_fn=<AddBackward0>)
tensor(32.4889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 85 | MSE Loss: 1.8748131 KL Loss: 13.9595006 DSM Loss: 19.5063533 Overall Loss:35.3406670
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-07
tensor(36.8491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.2311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(31.3841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 85 | MSE Loss: 1.8509478 KL Loss: 13.8455813 DSM Loss: 19.1530024 Overall Loss:34.8495314
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-08
tensor(25.3337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.2974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.8806, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 85 | MSE Loss: 1.8424552 KL Loss: 13.8727233 DSM Loss: 19.6562994 Overall Loss:35.3714778
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-08
tensor(20.7149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(28.6559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(29.1984, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 85 | MSE Loss: 1.8885909 KL Loss: 14.0118978 DSM Loss: 19.3617913 Overall Loss:35.2622799
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-08
tensor(26.0779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.7666, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 85 | MSE Loss: 1.8481314 KL Loss: 13.8198864 DSM Loss: 19.6485467 Overall Loss:35.3165645
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-09
tensor(35.1140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(30.1565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.7837, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 85 | MSE Loss: 1.8328595 KL Loss: 13.8515079 DSM Loss: 19.5304071 Overall Loss:35.2147745
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : XOM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl20>>>>>>>>>>>>>>>>>>>>>>>>>>
test 383
mse:24.23581886291504
   Ticker        MSE StdDev
0    AAPL   8.855839    0.0
1    ABBV  17.784466    0.0
2     AEP   2.756172    0.0
3    AMGN    4.00575    0.0
4    AMZN   0.520155    0.0
..    ...        ...    ...
66      V   2.139689    0.0
67     VZ   1.160186    0.0
68    WFC   0.117697    0.0
69    WMT   3.631397    0.0
70    XOM  24.235819    0.0

[71 rows x 3 columns]
Args in experiment:
Namespace(arch_instance='res_mbconv', batch_size=16, beta_end=1.0, beta_schedule='linear', beta_start=0.0, channel_mult=2, checkpoints='./checkpoints/', diff_steps=1000, dropout_rate=0.1, embedding_dimension=64, eta=1.0, gpu=0, groups_per_scale=2, hidden_size=128, input_dim=6, itr=1, learning_rate=0.0005, mult=1, num_channels_dec=32, num_channels_enc=32, num_latent_per_group=8, num_layers=2, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=3, num_workers=5, patience=10, prediction_length=40, root_path='data/EcmP_stock_L_2016_24_dva_spec', scale=0.1, sequence_length=40, target_dim=1, train_epochs=30, use_gpu=True, weight_decay=0.0, zeta=0.5)


Running on file AAPL.csv (1/71)...
Use GPU: cuda:0
>>>>>>>start training : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(100.9390, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9551263 KL Loss: 27.9851164 DSM Loss: 45.5605334 Overall Loss:75.5007761
Validation loss decreased (inf --> 11.210656).  Saving model ...
Updating learning rate to 0.0005
tensor(53.5890, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2616, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9821790 KL Loss: 27.8083387 DSM Loss: 36.9508258 Overall Loss:66.7413437
Validation loss decreased (11.210656 --> 9.169858).  Saving model ...
Updating learning rate to 0.00025
tensor(53.6898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9477231 KL Loss: 27.5539896 DSM Loss: 36.2094326 Overall Loss:65.7111456
Validation loss decreased (9.169858 --> 8.981872).  Saving model ...
Updating learning rate to 0.000125
tensor(71.6431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9412974 KL Loss: 27.5110650 DSM Loss: 36.4073844 Overall Loss:65.8597466
Validation loss decreased (8.981872 --> 8.250107).  Saving model ...
Updating learning rate to 6.25e-05
tensor(66.5405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9566, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0919528 KL Loss: 27.9974733 DSM Loss: 34.8073719 Overall Loss:64.8967983
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(82.5609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.3002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9542328 KL Loss: 27.8380039 DSM Loss: 35.7523374 Overall Loss:65.5445737
Validation loss decreased (8.250107 --> 8.103980).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(66.4641, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.0582683 KL Loss: 27.7961299 DSM Loss: 34.9441501 Overall Loss:64.7985482
Validation loss decreased (8.103980 --> 8.012296).  Saving model ...
Updating learning rate to 7.8125e-06
tensor(77.9688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5806, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.0780773 KL Loss: 27.9863521 DSM Loss: 34.8796327 Overall Loss:64.9440622
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-06
tensor(55.3244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2789, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1507, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 2.0609255 KL Loss: 28.2146040 DSM Loss: 35.2600056 Overall Loss:65.5355352
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-06
tensor(56.5931, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 2.0413214 KL Loss: 27.6492155 DSM Loss: 35.0765202 Overall Loss:64.7670569
Validation loss decreased (8.012296 --> 7.968804).  Saving model ...
Updating learning rate to 9.765625e-07
tensor(64.1662, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0595, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 2.0318377 KL Loss: 28.0541590 DSM Loss: 35.2385892 Overall Loss:65.3245859
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-07
tensor(90.6827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 2.0901773 KL Loss: 27.9794423 DSM Loss: 34.4433887 Overall Loss:64.5130083
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-07
tensor(52.6329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 2.1787066 KL Loss: 28.2834772 DSM Loss: 34.2079053 Overall Loss:64.6700892
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.220703125e-07
tensor(54.4389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8567, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 2.0669990 KL Loss: 28.0056812 DSM Loss: 34.8720417 Overall Loss:64.9447220
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.103515625e-08
tensor(60.4823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(33.9898, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 2.2146951 KL Loss: 28.3637320 DSM Loss: 33.7545904 Overall Loss:64.3330172
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.0517578125e-08
tensor(47.3540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2771, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 2.0918314 KL Loss: 28.2786002 DSM Loss: 34.8776497 Overall Loss:65.2480815
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.52587890625e-08
tensor(48.2608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6667, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 17, Steps: 83 | MSE Loss: 2.1198257 KL Loss: 28.1553595 DSM Loss: 34.5535269 Overall Loss:64.8287115
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.62939453125e-09
tensor(74.4406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 18, Steps: 83 | MSE Loss: 2.0555409 KL Loss: 28.0043859 DSM Loss: 35.0733268 Overall Loss:65.1332535
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.814697265625e-09
tensor(42.2691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.7847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8177, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 19, Steps: 83 | MSE Loss: 2.0528818 KL Loss: 28.0581037 DSM Loss: 35.1270430 Overall Loss:65.2380285
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.9073486328125e-09
tensor(69.4286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 20, Steps: 83 | MSE Loss: 2.0721099 KL Loss: 28.0048893 DSM Loss: 34.7262001 Overall Loss:64.8031993
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AAPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.435591697692871


Running on file ABBV.csv (2/71)...
Use GPU: cuda:0
>>>>>>>start training : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(93.1319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2524, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.7194, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9421339 KL Loss: 28.4060176 DSM Loss: 42.4370811 Overall Loss:72.7852325
Validation loss decreased (inf --> 10.137288).  Saving model ...
Updating learning rate to 0.0005
tensor(58.7237, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9319205 KL Loss: 28.2918947 DSM Loss: 34.7504664 Overall Loss:64.9742816
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(61.7005, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1878, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9063337 KL Loss: 28.2314125 DSM Loss: 34.0659407 Overall Loss:64.2036868
Validation loss decreased (10.137288 --> 10.009308).  Saving model ...
Updating learning rate to 0.000125
tensor(67.4736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0164, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9094307 KL Loss: 28.3771022 DSM Loss: 33.0155861 Overall Loss:63.3021190
Validation loss decreased (10.009308 --> 9.984320).  Saving model ...
Updating learning rate to 6.25e-05
tensor(76.1900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1953, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8846780 KL Loss: 27.9463424 DSM Loss: 33.1610569 Overall Loss:62.9920773
Validation loss decreased (9.984320 --> 9.941033).  Saving model ...
Updating learning rate to 3.125e-05
tensor(57.1702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9155283 KL Loss: 28.1867368 DSM Loss: 33.3340237 Overall Loss:63.4362891
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(51.4647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0997, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8756791 KL Loss: 27.8789833 DSM Loss: 33.1860959 Overall Loss:62.9407583
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(60.6407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8737465 KL Loss: 27.8451246 DSM Loss: 33.2491301 Overall Loss:62.9680011
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(47.0961, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.3210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8825529 KL Loss: 27.8437236 DSM Loss: 33.6478804 Overall Loss:63.3741570
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(54.0546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8900670 KL Loss: 27.9401616 DSM Loss: 33.4241740 Overall Loss:63.2544029
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(59.8051, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0228, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.8352, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8724936 KL Loss: 27.9726231 DSM Loss: 33.4753842 Overall Loss:63.3205008
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(66.9814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8776555 KL Loss: 27.9654688 DSM Loss: 33.8084350 Overall Loss:63.6515593
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(52.8003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8911852 KL Loss: 28.0576470 DSM Loss: 33.5395322 Overall Loss:63.4883647
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(69.2791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.6272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8818729 KL Loss: 27.9046277 DSM Loss: 33.3125572 Overall Loss:63.0990578
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(56.5658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.8800769 KL Loss: 28.0270271 DSM Loss: 33.7165171 Overall Loss:63.6236208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ABBV.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:17.93320083618164


Running on file AEP.csv (3/71)...
Use GPU: cuda:0
>>>>>>>start training : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(104.5001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.7214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8432787 KL Loss: 27.8919764 DSM Loss: 46.3919336 Overall Loss:76.1271886
Validation loss decreased (inf --> 3.959010).  Saving model ...
Updating learning rate to 0.0005
tensor(58.7109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4378, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6594, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9506956 KL Loss: 28.3579867 DSM Loss: 37.1061768 Overall Loss:67.4148593
Validation loss decreased (3.959010 --> 3.350365).  Saving model ...
Updating learning rate to 0.00025
tensor(75.7595, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9314253 KL Loss: 28.2260514 DSM Loss: 36.5901143 Overall Loss:66.7475914
Validation loss decreased (3.350365 --> 2.460611).  Saving model ...
Updating learning rate to 0.000125
tensor(57.0320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0261, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9308954 KL Loss: 28.3491555 DSM Loss: 36.1934692 Overall Loss:66.4735199
Validation loss decreased (2.460611 --> 2.289242).  Saving model ...
Updating learning rate to 6.25e-05
tensor(58.3113, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9335149 KL Loss: 28.4034701 DSM Loss: 35.6030330 Overall Loss:65.9400175
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(66.0737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9322983 KL Loss: 28.3246630 DSM Loss: 35.3263359 Overall Loss:65.5832969
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(55.1344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9300704 KL Loss: 28.2745357 DSM Loss: 35.7225228 Overall Loss:65.9271287
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(87.3674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5874, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9277772 KL Loss: 28.3276624 DSM Loss: 35.5378550 Overall Loss:65.7932942
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(67.5584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.8263, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9203070 KL Loss: 28.3977176 DSM Loss: 35.2071944 Overall Loss:65.5252191
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(71.2906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9222558 KL Loss: 28.4009409 DSM Loss: 35.4992000 Overall Loss:65.8223967
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(76.1289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9285382 KL Loss: 28.4612807 DSM Loss: 35.5876669 Overall Loss:65.9774857
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(71.9921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7449, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9438082 KL Loss: 28.4933406 DSM Loss: 34.9888407 Overall Loss:65.4259898
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(65.1952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9354623 KL Loss: 28.3567089 DSM Loss: 35.6062619 Overall Loss:65.8984330
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(67.5029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9521587 KL Loss: 28.5564671 DSM Loss: 35.2740700 Overall Loss:65.7826957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.2894060611724854


Running on file AMGN.csv (4/71)...
Use GPU: cuda:0
>>>>>>>start training : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(106.3513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6521, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9300093 KL Loss: 28.2543320 DSM Loss: 44.4591909 Overall Loss:74.6435320
Validation loss decreased (inf --> 1.205815).  Saving model ...
Updating learning rate to 0.0005
tensor(71.0708, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4527, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9433404 KL Loss: 28.1110758 DSM Loss: 36.6702962 Overall Loss:66.7247122
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(71.5482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1010, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9212471 KL Loss: 28.1975194 DSM Loss: 36.4835304 Overall Loss:66.6022971
Validation loss decreased (1.205815 --> 1.164710).  Saving model ...
Updating learning rate to 0.000125
tensor(65.4878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9430343 KL Loss: 28.0783046 DSM Loss: 35.6573428 Overall Loss:65.6786815
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(70.4285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9856, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8400770 KL Loss: 27.6602907 DSM Loss: 35.2616308 Overall Loss:64.7619984
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(70.0795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8824253 KL Loss: 27.9070711 DSM Loss: 34.8996460 Overall Loss:64.6891427
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(71.7229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8873740 KL Loss: 27.7416469 DSM Loss: 35.0354569 Overall Loss:64.6644777
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(55.3384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9004102 KL Loss: 27.8407998 DSM Loss: 35.0871511 Overall Loss:64.8283608
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(46.9296, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3600, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6244, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8656776 KL Loss: 27.7125988 DSM Loss: 35.2394405 Overall Loss:64.8177171
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(68.4950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8823362 KL Loss: 27.7084978 DSM Loss: 35.4402756 Overall Loss:65.0311098
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(67.5473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8787314 KL Loss: 27.8345159 DSM Loss: 35.2984842 Overall Loss:65.0117317
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(79.9594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.0160, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8708683 KL Loss: 27.6675908 DSM Loss: 35.5957317 Overall Loss:65.1341908
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(50.7965, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8593082 KL Loss: 27.4909334 DSM Loss: 35.5078561 Overall Loss:64.8580974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMGN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.2439775466918945


Running on file AMZN.csv (5/71)...
Use GPU: cuda:0
>>>>>>>start training : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(101.0466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9680715 KL Loss: 28.2199909 DSM Loss: 41.7007493 Overall Loss:71.8888116
Validation loss decreased (inf --> 2.553093).  Saving model ...
Updating learning rate to 0.0005
tensor(70.5920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.8095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9523551 KL Loss: 28.1761317 DSM Loss: 36.3645947 Overall Loss:66.4930815
Validation loss decreased (2.553093 --> 2.425660).  Saving model ...
Updating learning rate to 0.00025
tensor(72.2027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5436, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9253086 KL Loss: 27.8935199 DSM Loss: 35.6828158 Overall Loss:65.5016443
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(64.1551, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9109949 KL Loss: 27.6682764 DSM Loss: 35.4533564 Overall Loss:65.0326275
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(55.0533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3452, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8876646 KL Loss: 27.4458355 DSM Loss: 34.6535825 Overall Loss:63.9870820
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(63.2597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0657, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9075470 KL Loss: 27.7630464 DSM Loss: 35.5256130 Overall Loss:65.1962063
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(61.9546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2587, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9207, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9167686 KL Loss: 27.6461037 DSM Loss: 34.4930607 Overall Loss:64.0559331
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(66.0606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2586, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9271180 KL Loss: 27.6141673 DSM Loss: 34.3701060 Overall Loss:63.9113915
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(85.0408, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9102794 KL Loss: 27.3928831 DSM Loss: 34.5119279 Overall Loss:63.8150902
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(63.5451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0064, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9132455 KL Loss: 27.6066918 DSM Loss: 34.8618157 Overall Loss:64.3817530
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(49.4048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7829, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8829423 KL Loss: 27.4010489 DSM Loss: 34.8738663 Overall Loss:64.1578576
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(61.0197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9320, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9483, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9049602 KL Loss: 27.3148390 DSM Loss: 34.9479736 Overall Loss:64.1677729
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : AMZN.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.45343348383903503


Running on file BA.csv (6/71)...
Use GPU: cuda:0
>>>>>>>start training : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(89.1467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2195, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0129, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8929580 KL Loss: 28.1867185 DSM Loss: 51.2373824 Overall Loss:81.3170593
Validation loss decreased (inf --> 0.301792).  Saving model ...
Updating learning rate to 0.0005
tensor(71.6626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5815, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7791, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9349954 KL Loss: 28.2334205 DSM Loss: 39.4952465 Overall Loss:69.6636624
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(72.0294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5672, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9435499 KL Loss: 28.3028333 DSM Loss: 37.9528430 Overall Loss:68.1992265
Validation loss decreased (0.301792 --> 0.254770).  Saving model ...
Updating learning rate to 0.000125
tensor(68.6090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.5328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7692, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9274878 KL Loss: 28.3723051 DSM Loss: 36.9288020 Overall Loss:67.2285949
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(60.7871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4139, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9296214 KL Loss: 28.3877691 DSM Loss: 36.7508667 Overall Loss:67.0682571
Validation loss decreased (0.254770 --> 0.237183).  Saving model ...
Updating learning rate to 3.125e-05
tensor(54.7946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2313, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9463478 KL Loss: 28.4328901 DSM Loss: 36.3837670 Overall Loss:66.7630050
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(63.8757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9226688 KL Loss: 28.3484246 DSM Loss: 36.9113326 Overall Loss:67.1824259
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(62.6533, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8275, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9326784 KL Loss: 28.3636009 DSM Loss: 36.5213895 Overall Loss:66.8176687
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(65.6189, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4015, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9395887 KL Loss: 28.4969479 DSM Loss: 36.5882206 Overall Loss:67.0247570
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(75.1983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4014, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9584224 KL Loss: 28.5522436 DSM Loss: 36.1749795 Overall Loss:66.6856454
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(70.7232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9280509 KL Loss: 28.5519756 DSM Loss: 36.0602064 Overall Loss:66.5402330
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(70.7944, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4590, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9206950 KL Loss: 28.3883066 DSM Loss: 36.7172828 Overall Loss:67.0262843
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(78.2765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5210, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9469535 KL Loss: 28.4781646 DSM Loss: 36.5187931 Overall Loss:66.9439110
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(64.6172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0386, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9438931 KL Loss: 28.3659994 DSM Loss: 36.4914355 Overall Loss:66.8013284
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(64.1834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.5634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4707, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9476299 KL Loss: 28.3584802 DSM Loss: 36.1740616 Overall Loss:66.4801713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.48078757524490356


Running on file BAC.csv (7/71)...
Use GPU: cuda:0
>>>>>>>start training : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(80.8356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0803, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9821323 KL Loss: 28.4168580 DSM Loss: 38.9667748 Overall Loss:69.3657653
Validation loss decreased (inf --> 8.210844).  Saving model ...
Updating learning rate to 0.0005
tensor(48.0486, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1976, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9443557 KL Loss: 28.2239676 DSM Loss: 34.1731508 Overall Loss:64.3414739
Validation loss decreased (8.210844 --> 7.053685).  Saving model ...
Updating learning rate to 0.00025
tensor(63.7116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9006, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9572454 KL Loss: 28.2382625 DSM Loss: 33.0217945 Overall Loss:63.2173027
Validation loss decreased (7.053685 --> 7.049054).  Saving model ...
Updating learning rate to 0.000125
tensor(62.1584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9270247 KL Loss: 28.1503187 DSM Loss: 32.3758528 Overall Loss:62.4531961
Validation loss decreased (7.049054 --> 6.944475).  Saving model ...
Updating learning rate to 6.25e-05
tensor(93.0061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8168, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9076982 KL Loss: 28.0466454 DSM Loss: 32.2154982 Overall Loss:62.1698419
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(49.3511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3725, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8727738 KL Loss: 27.9191298 DSM Loss: 32.4344860 Overall Loss:62.2263896
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(42.6107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2425, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8649937 KL Loss: 27.7514461 DSM Loss: 32.3060379 Overall Loss:61.9224777
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(55.5145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1245, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4023, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8833777 KL Loss: 28.0391882 DSM Loss: 31.8778575 Overall Loss:61.8004232
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(60.6232, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8807, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8582953 KL Loss: 27.8702497 DSM Loss: 32.2491291 Overall Loss:61.9776741
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(44.2357, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5715, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8659174 KL Loss: 27.7585723 DSM Loss: 32.0954094 Overall Loss:61.7198990
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(41.6078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8682880 KL Loss: 27.8063935 DSM Loss: 32.6864170 Overall Loss:62.3610982
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(64.4253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(97.3601, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8599732 KL Loss: 27.8641794 DSM Loss: 32.2434181 Overall Loss:61.9675707
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(87.1289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9155, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8825110 KL Loss: 27.9005528 DSM Loss: 32.2269041 Overall Loss:62.0099680
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(49.9269, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8083, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9031954 KL Loss: 28.1029439 DSM Loss: 31.5539002 Overall Loss:61.5600393
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.012120008468628


Running on file BCH.csv (8/71)...
Use GPU: cuda:0
>>>>>>>start training : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(136.6008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.9937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5529, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9438845 KL Loss: 28.3285385 DSM Loss: 42.4481008 Overall Loss:72.7205239
Validation loss decreased (inf --> 0.901060).  Saving model ...
Updating learning rate to 0.0005
tensor(74.7344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9649674 KL Loss: 28.4009405 DSM Loss: 38.4032851 Overall Loss:68.7691928
Validation loss decreased (0.901060 --> 0.575108).  Saving model ...
Updating learning rate to 0.00025
tensor(70.4694, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9503198 KL Loss: 28.2998363 DSM Loss: 37.4055123 Overall Loss:67.6556686
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(57.5013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9205299 KL Loss: 28.1954359 DSM Loss: 37.0491803 Overall Loss:67.1651461
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(77.5504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4445, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8626926 KL Loss: 28.0739353 DSM Loss: 36.8952001 Overall Loss:66.8318281
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(59.2197, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0287, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8893746 KL Loss: 28.2014294 DSM Loss: 36.6256255 Overall Loss:66.7164292
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(70.9241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8839842 KL Loss: 28.2205951 DSM Loss: 35.9592409 Overall Loss:66.0638204
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(62.5637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0491, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9046875 KL Loss: 28.3155180 DSM Loss: 36.5846015 Overall Loss:66.8048071
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(68.1857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5731, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8808990 KL Loss: 28.0741265 DSM Loss: 36.5462628 Overall Loss:66.5012886
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(59.9592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6078, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8915583 KL Loss: 28.1898389 DSM Loss: 36.2990390 Overall Loss:66.3804357
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(70.0766, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5865, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9307581 KL Loss: 28.2805517 DSM Loss: 36.6178289 Overall Loss:66.8291388
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(69.9024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8724715 KL Loss: 28.0815460 DSM Loss: 36.9290466 Overall Loss:66.8830639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BCH.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.24244435131549835


Running on file BHP.csv (9/71)...
Use GPU: cuda:0
>>>>>>>start training : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(112.8149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7503, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9246647 KL Loss: 28.2912474 DSM Loss: 38.9747973 Overall Loss:69.1907098
Validation loss decreased (inf --> 1.597175).  Saving model ...
Updating learning rate to 0.0005
tensor(71.5076, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5259, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8918907 KL Loss: 27.9561411 DSM Loss: 35.1211091 Overall Loss:64.9691409
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(69.6984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9581, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4410, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8960024 KL Loss: 27.9269303 DSM Loss: 33.9555222 Overall Loss:63.7784548
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(59.2102, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.1774, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9082419 KL Loss: 27.9001208 DSM Loss: 33.2148173 Overall Loss:63.0231802
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(56.5794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8929, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9177985 KL Loss: 27.9439402 DSM Loss: 32.8250022 Overall Loss:62.6867408
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(63.7221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9023, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9079747 KL Loss: 27.9282370 DSM Loss: 32.5790083 Overall Loss:62.4152200
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(43.5211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6917, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8801912 KL Loss: 27.8002427 DSM Loss: 33.2960344 Overall Loss:62.9764684
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(76.7158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3329, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8911224 KL Loss: 27.9305526 DSM Loss: 32.7186939 Overall Loss:62.5403689
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(73.4644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(108.5786, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8851727 KL Loss: 27.6735966 DSM Loss: 32.6752288 Overall Loss:62.2339982
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(61.6571, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.2134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3984, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8898704 KL Loss: 27.7520983 DSM Loss: 33.0144301 Overall Loss:62.6563984
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(78.6702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9137, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8599300 KL Loss: 27.5571731 DSM Loss: 32.7776152 Overall Loss:62.1947182
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BHP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.7856106758117676


Running on file BP.csv (10/71)...
Use GPU: cuda:0
>>>>>>>start training : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(118.9446, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1771, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9477205 KL Loss: 28.3777160 DSM Loss: 45.2241745 Overall Loss:75.5496114
Validation loss decreased (inf --> 0.155344).  Saving model ...
Updating learning rate to 0.0005
tensor(68.7768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0375, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9696050 KL Loss: 28.3999476 DSM Loss: 39.0223134 Overall Loss:69.3918658
Validation loss decreased (0.155344 --> 0.149007).  Saving model ...
Updating learning rate to 0.00025
tensor(54.3697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9589, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9317203 KL Loss: 28.2373410 DSM Loss: 37.9883444 Overall Loss:68.1574056
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(53.2203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3846, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9204632 KL Loss: 28.2276207 DSM Loss: 37.2378912 Overall Loss:67.3859749
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(60.7395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0942, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8902180 KL Loss: 27.9828653 DSM Loss: 37.6837918 Overall Loss:67.5568747
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(81.3340, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9343, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8870321 KL Loss: 28.1299498 DSM Loss: 37.1007327 Overall Loss:67.1177144
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(74.2406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6186, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8695462 KL Loss: 27.8134992 DSM Loss: 36.7504454 Overall Loss:66.4334912
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(65.9722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5654, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8702868 KL Loss: 27.9526131 DSM Loss: 37.0401409 Overall Loss:66.8630405
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(50.6889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8022, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8787517 KL Loss: 27.8979064 DSM Loss: 36.7904844 Overall Loss:66.5671424
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(74.2546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(94.2152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8760735 KL Loss: 28.0033170 DSM Loss: 37.4731465 Overall Loss:67.3525370
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(66.1602, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5322, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8584768 KL Loss: 27.9452983 DSM Loss: 36.4854449 Overall Loss:66.2892201
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(56.2130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8975102 KL Loss: 28.1118242 DSM Loss: 37.0658417 Overall Loss:67.0751760
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.3972525596618652


Running on file BRK-A.csv (11/71)...
Use GPU: cuda:0
>>>>>>>start training : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(87.1054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7066, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9158527 KL Loss: 27.8658471 DSM Loss: 39.2600211 Overall Loss:69.0417208
Validation loss decreased (inf --> 9.410384).  Saving model ...
Updating learning rate to 0.0005
tensor(66.4709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9430243 KL Loss: 28.2473831 DSM Loss: 33.1977818 Overall Loss:63.3881891
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(51.8407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.5655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.6473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9224114 KL Loss: 27.7293421 DSM Loss: 32.8333351 Overall Loss:62.4850884
Validation loss decreased (9.410384 --> 9.176217).  Saving model ...
Updating learning rate to 0.000125
tensor(36.7151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9475, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8939957 KL Loss: 27.7503656 DSM Loss: 31.7124059 Overall Loss:61.3567672
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(41.8930, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2879, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8637557 KL Loss: 27.6980019 DSM Loss: 32.3639367 Overall Loss:61.9256942
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(70.2995, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9990, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8760054 KL Loss: 27.5518898 DSM Loss: 31.3767045 Overall Loss:60.8045996
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(58.2038, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.5802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5431, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8930352 KL Loss: 27.8505649 DSM Loss: 31.6101905 Overall Loss:61.3537906
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(74.5717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(40.3014, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8788847 KL Loss: 27.7770255 DSM Loss: 32.3283147 Overall Loss:61.9842250
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(74.1739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4342, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8855723 KL Loss: 27.8215293 DSM Loss: 31.5553136 Overall Loss:61.2624154
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(62.1576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5052, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8593828 KL Loss: 27.6382990 DSM Loss: 32.3246136 Overall Loss:61.8222958
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(67.2300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8719611 KL Loss: 27.6035217 DSM Loss: 32.3543254 Overall Loss:61.8298085
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(89.8104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.2762, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8613965 KL Loss: 27.3988347 DSM Loss: 31.7405615 Overall Loss:61.0007928
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(69.7557, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4423, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8598519 KL Loss: 27.4488243 DSM Loss: 32.2730589 Overall Loss:61.5817350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BRK-A.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:11.868592262268066


Running on file BSAC.csv (12/71)...
Use GPU: cuda:0
>>>>>>>start training : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(100.5055, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3837, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.7523, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9649913 KL Loss: 28.1447492 DSM Loss: 44.4585898 Overall Loss:74.5683301
Validation loss decreased (inf --> 0.329364).  Saving model ...
Updating learning rate to 0.0005
tensor(62.6213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4029, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4583, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9398359 KL Loss: 28.0035905 DSM Loss: 38.3371780 Overall Loss:68.2806044
Validation loss decreased (0.329364 --> 0.253852).  Saving model ...
Updating learning rate to 0.00025
tensor(71.0701, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1595, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9332501 KL Loss: 28.1485313 DSM Loss: 36.3450764 Overall Loss:66.4268581
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(72.3963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.8827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9026070 KL Loss: 27.9276201 DSM Loss: 36.3090683 Overall Loss:66.1392953
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(50.1900, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.6797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6617, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8764339 KL Loss: 27.9652601 DSM Loss: 35.8205637 Overall Loss:65.6622577
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(64.2081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8986860 KL Loss: 27.9865065 DSM Loss: 35.7352467 Overall Loss:65.6204394
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(67.7397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1555, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8686887 KL Loss: 27.8713684 DSM Loss: 35.7468617 Overall Loss:65.4869186
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(59.3031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.5487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1869, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8649229 KL Loss: 28.0351841 DSM Loss: 35.5134686 Overall Loss:65.4135756
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(67.4069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8983079 KL Loss: 28.0298442 DSM Loss: 35.7281847 Overall Loss:65.6563367
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(63.9520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3101, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8557814 KL Loss: 27.8444693 DSM Loss: 35.6585068 Overall Loss:65.3587573
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(71.5607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5962, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7064, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8746753 KL Loss: 27.9627772 DSM Loss: 34.6982017 Overall Loss:64.5356539
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(59.3932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6635, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8998561 KL Loss: 28.2030919 DSM Loss: 35.9890032 Overall Loss:66.0919514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BSAC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.47248008847236633


Running on file BUD.csv (13/71)...
Use GPU: cuda:0
>>>>>>>start training : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(107.4926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9792, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1712, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9665798 KL Loss: 28.4797871 DSM Loss: 44.8868199 Overall Loss:75.3331865
Validation loss decreased (inf --> 1.504357).  Saving model ...
Updating learning rate to 0.0005
tensor(71.2568, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4226, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0046243 KL Loss: 28.4437974 DSM Loss: 40.5165858 Overall Loss:70.9650074
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(69.3140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1399, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9754925 KL Loss: 28.4206534 DSM Loss: 39.4452023 Overall Loss:69.8413486
Validation loss decreased (1.504357 --> 1.485352).  Saving model ...
Updating learning rate to 0.000125
tensor(71.3620, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9938388 KL Loss: 28.5100332 DSM Loss: 38.8847713 Overall Loss:69.3886437
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(70.2358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.9280, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 2.0698615 KL Loss: 28.8441286 DSM Loss: 39.5040987 Overall Loss:70.4180887
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(78.2597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.1058202 KL Loss: 28.9042246 DSM Loss: 38.5756973 Overall Loss:69.5857426
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(58.7137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.8306, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3270, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 2.0694521 KL Loss: 28.7639748 DSM Loss: 38.4968097 Overall Loss:69.3302364
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(74.8681, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1158, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.0563202 KL Loss: 28.8145492 DSM Loss: 38.2082799 Overall Loss:69.0791490
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(75.8768, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9294, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 2.0776668 KL Loss: 28.7562976 DSM Loss: 37.6719907 Overall Loss:68.5059553
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(78.7282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.6634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 2.0759451 KL Loss: 28.9531845 DSM Loss: 38.1923907 Overall Loss:69.2215203
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(61.0598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.8314, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 2.0960315 KL Loss: 29.0102741 DSM Loss: 37.7662835 Overall Loss:68.8725883
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(60.3818, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9452, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0854, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 2.1201824 KL Loss: 29.0109298 DSM Loss: 37.9404496 Overall Loss:69.0715618
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(78.4124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 2.1366490 KL Loss: 29.0837174 DSM Loss: 37.6990447 Overall Loss:68.9194110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : BUD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.8325295448303223


Running on file C.csv (14/71)...
Use GPU: cuda:0
>>>>>>>start training : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(96.4803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9451167 KL Loss: 28.3769534 DSM Loss: 40.9278776 Overall Loss:71.2499475
Validation loss decreased (inf --> 0.698805).  Saving model ...
Updating learning rate to 0.0005
tensor(59.0402, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2202, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9542609 KL Loss: 28.3359470 DSM Loss: 35.5942603 Overall Loss:65.8844678
Validation loss decreased (0.698805 --> 0.659863).  Saving model ...
Updating learning rate to 0.00025
tensor(58.9162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3384, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9482645 KL Loss: 28.2150144 DSM Loss: 34.9398405 Overall Loss:65.1031191
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(61.3183, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9185783 KL Loss: 28.3008232 DSM Loss: 33.1077758 Overall Loss:63.3271775
Validation loss decreased (0.659863 --> 0.609326).  Saving model ...
Updating learning rate to 6.25e-05
tensor(72.3617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3141, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8939373 KL Loss: 28.1374458 DSM Loss: 33.9817754 Overall Loss:64.0131585
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(82.7202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0071, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5743, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8893881 KL Loss: 28.1290518 DSM Loss: 33.9449735 Overall Loss:63.9634136
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(68.7049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9605, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8828570 KL Loss: 28.0625006 DSM Loss: 33.9861016 Overall Loss:63.9314594
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(67.3039, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5970, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8843915 KL Loss: 28.1043664 DSM Loss: 33.7314819 Overall Loss:63.7202397
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(50.0623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8512099 KL Loss: 27.8268419 DSM Loss: 33.6930415 Overall Loss:63.3710937
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(64.7127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9242, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8816951 KL Loss: 28.0868852 DSM Loss: 33.6673369 Overall Loss:63.6359171
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(70.5740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9062, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8637164 KL Loss: 28.0076143 DSM Loss: 34.1497738 Overall Loss:64.0211049
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(56.5541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.3478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4071, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8953204 KL Loss: 28.2148311 DSM Loss: 34.1545788 Overall Loss:64.2647303
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(59.0455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6630, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8647629 KL Loss: 27.8838364 DSM Loss: 33.7645542 Overall Loss:63.5131534
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(83.1233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8445539 KL Loss: 27.9530472 DSM Loss: 33.4971456 Overall Loss:63.2947466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : C.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.682309091091156


Running on file CAT.csv (15/71)...
Use GPU: cuda:0
>>>>>>>start training : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(102.4586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8626, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7895, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9605685 KL Loss: 28.2290795 DSM Loss: 39.0313062 Overall Loss:69.2209541
Validation loss decreased (inf --> 3.322920).  Saving model ...
Updating learning rate to 0.0005
tensor(45.7397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3920, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9655812 KL Loss: 28.2672437 DSM Loss: 35.7757929 Overall Loss:66.0086180
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(46.7347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.0485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3187, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9924014 KL Loss: 28.2983362 DSM Loss: 34.0159240 Overall Loss:64.3066615
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(69.3813, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3546, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.6070, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9127930 KL Loss: 27.8156269 DSM Loss: 34.6476326 Overall Loss:64.3760524
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(83.6834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7288, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9179320 KL Loss: 27.8986446 DSM Loss: 33.7171239 Overall Loss:63.5337004
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(51.8128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.1358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1135, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9707963 KL Loss: 28.1092083 DSM Loss: 33.0627804 Overall Loss:63.1427853
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(81.8061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2308, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9270688 KL Loss: 27.9378242 DSM Loss: 33.6451868 Overall Loss:63.5100797
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(76.4660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3487, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9207258 KL Loss: 27.8163843 DSM Loss: 34.1623075 Overall Loss:63.8994179
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(48.5565, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8891407 KL Loss: 27.5581392 DSM Loss: 33.3979748 Overall Loss:62.8452547
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(43.5638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9274, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9314200 KL Loss: 27.9482327 DSM Loss: 33.6160401 Overall Loss:63.4956931
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(73.6528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4899, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9186688 KL Loss: 27.7180785 DSM Loss: 33.8747888 Overall Loss:63.5115358
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CAT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.024648666381836


Running on file CHTR.csv (16/71)...
Use GPU: cuda:0
>>>>>>>start training : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(94.2220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9439633 KL Loss: 28.1694530 DSM Loss: 46.6439915 Overall Loss:76.7574078
Validation loss decreased (inf --> 2.692624).  Saving model ...
Updating learning rate to 0.0005
tensor(77.6238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7092, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9195563 KL Loss: 27.8308316 DSM Loss: 35.9054529 Overall Loss:65.6558407
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(71.4377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9176274 KL Loss: 27.7658987 DSM Loss: 34.5309973 Overall Loss:64.2145231
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(66.6267, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.1056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1875, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8636672 KL Loss: 27.6226871 DSM Loss: 34.0120348 Overall Loss:63.4983890
Validation loss decreased (2.692624 --> 2.597341).  Saving model ...
Updating learning rate to 6.25e-05
tensor(61.2812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8751241 KL Loss: 27.8123131 DSM Loss: 33.8556833 Overall Loss:63.5431206
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(69.9471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4921, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8483063 KL Loss: 27.6523305 DSM Loss: 33.5365501 Overall Loss:63.0371871
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(65.8615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3896, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1223, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8651238 KL Loss: 27.6192600 DSM Loss: 33.1796036 Overall Loss:62.6639875
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(61.3808, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6360, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8515092 KL Loss: 27.6552394 DSM Loss: 33.2106822 Overall Loss:62.7174307
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(58.8453, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1663, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8714511 KL Loss: 27.6807198 DSM Loss: 32.8437002 Overall Loss:62.3958706
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(62.5413, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.5701, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8610203 KL Loss: 27.5702559 DSM Loss: 33.2385321 Overall Loss:62.6698084
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(49.7770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8561, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8467970 KL Loss: 27.4899027 DSM Loss: 33.0551372 Overall Loss:62.3918370
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(52.7133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.3224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8676622 KL Loss: 27.6771753 DSM Loss: 32.9317595 Overall Loss:62.4765968
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(62.9068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8743817 KL Loss: 27.6781200 DSM Loss: 33.0177645 Overall Loss:62.5702664
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(78.8535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8408610 KL Loss: 27.5209657 DSM Loss: 33.3909548 Overall Loss:62.7527816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CHTR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.11923254281282425


Running on file CMCSA.csv (17/71)...
Use GPU: cuda:0
>>>>>>>start training : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(93.7783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.1881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1432, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9288322 KL Loss: 28.1490179 DSM Loss: 44.0294834 Overall Loss:74.1073334
Validation loss decreased (inf --> 2.467282).  Saving model ...
Updating learning rate to 0.0005
tensor(55.2507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.8921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.2145, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9274725 KL Loss: 28.1708782 DSM Loss: 34.6321516 Overall Loss:64.7305023
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(48.1623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8640, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8800092 KL Loss: 27.7441386 DSM Loss: 33.5760051 Overall Loss:63.2001531
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(49.9801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.5945, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8873517 KL Loss: 27.8403618 DSM Loss: 33.3711841 Overall Loss:63.0988975
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(74.7952, device='cuda:0', grad_fn=<AddBackward0>)
tensor(95.9536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0130, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9009385 KL Loss: 27.6615041 DSM Loss: 33.0451400 Overall Loss:62.6075827
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(71.6372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8874580 KL Loss: 27.7202159 DSM Loss: 32.8998605 Overall Loss:62.5075343
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(71.2000, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4292, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9036961 KL Loss: 27.8849072 DSM Loss: 32.8772837 Overall Loss:62.6658869
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(55.7202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3297, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6156, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8993017 KL Loss: 27.8561921 DSM Loss: 32.2614559 Overall Loss:62.0169496
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(62.7003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1358, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7182, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9084949 KL Loss: 27.9836422 DSM Loss: 32.8867625 Overall Loss:62.7788996
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(59.3361, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9046073 KL Loss: 27.7326176 DSM Loss: 32.4267002 Overall Loss:62.0639252
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(62.0105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0853, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9235659 KL Loss: 27.7919793 DSM Loss: 32.4947179 Overall Loss:62.2102634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CMCSA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.4039323031902313


Running on file CODI.csv (18/71)...
Use GPU: cuda:0
>>>>>>>start training : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(95.2547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7513, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9278055 KL Loss: 28.1626364 DSM Loss: 49.9675945 Overall Loss:80.0580365
Validation loss decreased (inf --> 11.135008).  Saving model ...
Updating learning rate to 0.0005
tensor(56.5756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6601, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.2173, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9528069 KL Loss: 27.9589459 DSM Loss: 36.2617126 Overall Loss:66.1734655
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(97.6311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5106, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9113727 KL Loss: 27.7755530 DSM Loss: 35.2044881 Overall Loss:64.8914141
Validation loss decreased (11.135008 --> 10.976048).  Saving model ...
Updating learning rate to 0.000125
tensor(46.4098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4008, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4788, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9371065 KL Loss: 27.5247818 DSM Loss: 33.8247151 Overall Loss:63.2866035
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(65.0736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0666, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9060061 KL Loss: 27.6456593 DSM Loss: 33.8661206 Overall Loss:63.4177861
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(56.7909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2080, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3933, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9066327 KL Loss: 27.7746289 DSM Loss: 33.5351432 Overall Loss:63.2164051
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(50.7505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.0795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9224365 KL Loss: 27.8335445 DSM Loss: 33.6230044 Overall Loss:63.3789852
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(50.7389, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.0692, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8899700 KL Loss: 27.6902974 DSM Loss: 33.4612894 Overall Loss:63.0415569
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(56.2921, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1670, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9160445 KL Loss: 27.8841998 DSM Loss: 33.5701770 Overall Loss:63.3704208
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(38.0951, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.8099, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.7220, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9244783 KL Loss: 27.8306903 DSM Loss: 33.8962367 Overall Loss:63.6514055
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(49.3382, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.9127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7708, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9361783 KL Loss: 27.7404614 DSM Loss: 33.1127964 Overall Loss:62.7894363
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(68.1078, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3643, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9069794 KL Loss: 27.7574165 DSM Loss: 33.3708106 Overall Loss:63.0352068
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(71.2129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9013427 KL Loss: 27.8405613 DSM Loss: 33.2865848 Overall Loss:63.0284886
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CODI.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.1531364917755127


Running on file CSCO.csv (19/71)...
Use GPU: cuda:0
>>>>>>>start training : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(98.6758, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0020719 KL Loss: 28.3996412 DSM Loss: 40.5214948 Overall Loss:70.9232081
Validation loss decreased (inf --> 4.115860).  Saving model ...
Updating learning rate to 0.0005
tensor(64.1276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1368, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2964, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9423948 KL Loss: 28.4790613 DSM Loss: 34.4355161 Overall Loss:64.8569727
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(73.2140, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1886, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9262133 KL Loss: 28.1206182 DSM Loss: 34.1690465 Overall Loss:64.2158777
Validation loss decreased (4.115860 --> 4.053365).  Saving model ...
Updating learning rate to 0.000125
tensor(73.4027, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1552, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0097, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9020813 KL Loss: 28.0157897 DSM Loss: 33.3790212 Overall Loss:63.2968922
Validation loss decreased (4.053365 --> 3.681488).  Saving model ...
Updating learning rate to 6.25e-05
tensor(68.6421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1012, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8824356 KL Loss: 28.1291019 DSM Loss: 33.1439922 Overall Loss:63.1555296
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(60.0324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0839, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9093, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9125770 KL Loss: 28.2441778 DSM Loss: 32.9648028 Overall Loss:63.1215575
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(53.5628, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8823407 KL Loss: 27.8325579 DSM Loss: 33.4481936 Overall Loss:63.1630923
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(71.0181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5801, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1015, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8857799 KL Loss: 28.1089127 DSM Loss: 33.3734986 Overall Loss:63.3681909
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(63.0056, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8787705 KL Loss: 27.9823054 DSM Loss: 32.9552763 Overall Loss:62.8163520
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(55.8920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8864, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8639572 KL Loss: 28.0179124 DSM Loss: 33.5155000 Overall Loss:63.3973697
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(75.5793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.2476, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8716964 KL Loss: 27.9852021 DSM Loss: 33.1248905 Overall Loss:62.9817890
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(76.1632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1570, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.3113, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8575972 KL Loss: 27.9455715 DSM Loss: 33.3639758 Overall Loss:63.1671444
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(58.1152, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3494, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8717501 KL Loss: 27.9734433 DSM Loss: 33.2492758 Overall Loss:63.0944693
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(58.5054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8895163 KL Loss: 28.0864341 DSM Loss: 33.0942019 Overall Loss:63.0701520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CSCO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.8507765531539917


Running on file CVX.csv (20/71)...
Use GPU: cuda:0
>>>>>>>start training : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(104.5136, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0411, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1606, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9171845 KL Loss: 28.4489064 DSM Loss: 44.7612481 Overall Loss:75.1273391
Validation loss decreased (inf --> 10.614117).  Saving model ...
Updating learning rate to 0.0005
tensor(91.9282, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1012, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9020144 KL Loss: 28.3013497 DSM Loss: 35.2545914 Overall Loss:65.4579552
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(70.0619, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6117, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9108477 KL Loss: 28.2964888 DSM Loss: 34.2518463 Overall Loss:64.4591826
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(69.8579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5385, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8525, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9111759 KL Loss: 28.3091367 DSM Loss: 33.0405041 Overall Loss:63.2608171
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(78.6167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2885, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8734179 KL Loss: 28.1533862 DSM Loss: 33.2634665 Overall Loss:63.2902704
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(67.8664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8742192 KL Loss: 28.0958920 DSM Loss: 32.7799658 Overall Loss:62.7500772
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(59.3608, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7737, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8889262 KL Loss: 28.1851930 DSM Loss: 33.0233081 Overall Loss:63.0974271
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(58.6004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.3401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8683278 KL Loss: 28.1240616 DSM Loss: 32.9152925 Overall Loss:62.9076819
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(65.4685, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1715, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8788437 KL Loss: 28.1459153 DSM Loss: 32.8777283 Overall Loss:62.9024872
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(63.8394, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8824655 KL Loss: 28.2405027 DSM Loss: 33.1294759 Overall Loss:63.2524439
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(63.1672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1842, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8758482 KL Loss: 28.0168648 DSM Loss: 32.9841142 Overall Loss:62.8768277
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : CVX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:36.682769775390625


Running on file D.csv (21/71)...
Use GPU: cuda:0
>>>>>>>start training : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(98.4208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1576, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9922151 KL Loss: 28.4330537 DSM Loss: 41.6505060 Overall Loss:72.0757746
Validation loss decreased (inf --> 2.941116).  Saving model ...
Updating learning rate to 0.0005
tensor(58.0506, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.9140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0033027 KL Loss: 28.4319392 DSM Loss: 36.5453390 Overall Loss:66.9805806
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(83.1482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.7811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8975, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9321001 KL Loss: 28.3296941 DSM Loss: 35.5614419 Overall Loss:65.8232361
Validation loss decreased (2.941116 --> 2.736475).  Saving model ...
Updating learning rate to 0.000125
tensor(75.5606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1508, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8778965 KL Loss: 28.0367760 DSM Loss: 35.0208026 Overall Loss:64.9354747
Validation loss decreased (2.736475 --> 2.502819).  Saving model ...
Updating learning rate to 6.25e-05
tensor(79.1476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.8307, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9000090 KL Loss: 28.2643928 DSM Loss: 35.5191878 Overall Loss:65.6835896
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(68.2447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2877, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9152405 KL Loss: 28.2588407 DSM Loss: 35.3250114 Overall Loss:65.4990921
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(64.9985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4889, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3827, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9021507 KL Loss: 28.1899868 DSM Loss: 34.9647126 Overall Loss:65.0568507
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(59.6707, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6611, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5957, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8808829 KL Loss: 28.0861348 DSM Loss: 34.8432353 Overall Loss:64.8102529
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(54.1888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3282, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8664256 KL Loss: 28.0424812 DSM Loss: 35.4292580 Overall Loss:65.3381649
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(72.0416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8808339 KL Loss: 28.1511360 DSM Loss: 34.8632418 Overall Loss:64.8952115
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(65.0532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5893, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8831742 KL Loss: 28.2337362 DSM Loss: 34.5280984 Overall Loss:64.6450091
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(70.9821, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8805058 KL Loss: 28.0981954 DSM Loss: 34.9731396 Overall Loss:64.9518407
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(61.7372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9125230 KL Loss: 28.1522420 DSM Loss: 34.5449062 Overall Loss:64.6096716
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(69.4536, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8690820 KL Loss: 27.9755346 DSM Loss: 35.0183641 Overall Loss:64.8629804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : D.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.1617588996887207


Running on file DHR.csv (22/71)...
Use GPU: cuda:0
>>>>>>>start training : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(99.8425, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9243104 KL Loss: 28.3367792 DSM Loss: 44.1344580 Overall Loss:74.3955481
Validation loss decreased (inf --> 8.903421).  Saving model ...
Updating learning rate to 0.0005
tensor(54.6500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.6087, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9856967 KL Loss: 28.0842597 DSM Loss: 35.6335106 Overall Loss:65.7034667
Validation loss decreased (8.903421 --> 7.771087).  Saving model ...
Updating learning rate to 0.00025
tensor(65.5097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3605, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4663, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9102833 KL Loss: 27.6111879 DSM Loss: 34.6929138 Overall Loss:64.2143851
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(66.4576, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.6877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9050535 KL Loss: 27.8742343 DSM Loss: 34.0289386 Overall Loss:63.8082261
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(55.9793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6232, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8855213 KL Loss: 27.6611978 DSM Loss: 34.5402746 Overall Loss:64.0869937
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(72.6169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.1241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8843603 KL Loss: 27.5166582 DSM Loss: 33.8942141 Overall Loss:63.2952326
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(50.5314, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2062, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8757005 KL Loss: 27.4910636 DSM Loss: 33.7489533 Overall Loss:63.1157173
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(78.1521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9963, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2775, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9204161 KL Loss: 27.5777564 DSM Loss: 33.4253966 Overall Loss:62.9235691
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(61.8756, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9011892 KL Loss: 27.6350186 DSM Loss: 33.9520724 Overall Loss:63.4882804
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(64.5418, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0525, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8747044 KL Loss: 27.4002260 DSM Loss: 33.8761723 Overall Loss:63.1511033
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(87.1002, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.3776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(37.7852, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8715640 KL Loss: 27.4535520 DSM Loss: 33.7057065 Overall Loss:63.0308224
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(82.7881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8933483 KL Loss: 27.5817104 DSM Loss: 33.5973863 Overall Loss:63.0724450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DHR.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.2906999588012695


Running on file DIS.csv (23/71)...
Use GPU: cuda:0
>>>>>>>start training : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(93.3791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.3976, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7068, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9211379 KL Loss: 28.3503477 DSM Loss: 44.0056778 Overall Loss:74.2771636
Validation loss decreased (inf --> 1.921113).  Saving model ...
Updating learning rate to 0.0005
tensor(95.4937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.0736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1805, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8826887 KL Loss: 27.9545084 DSM Loss: 37.3010562 Overall Loss:67.1382530
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(59.0706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0383, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9233890 KL Loss: 28.2135809 DSM Loss: 36.7075683 Overall Loss:66.8445384
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(59.7872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.1535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5416, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8928967 KL Loss: 27.9379377 DSM Loss: 36.2629339 Overall Loss:66.0937686
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(73.2718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.9525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.9721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9080482 KL Loss: 27.8434651 DSM Loss: 35.8276154 Overall Loss:65.5791286
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(41.2203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4067, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.9305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8953995 KL Loss: 27.7180834 DSM Loss: 36.7812231 Overall Loss:66.3947059
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(55.5344, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.7933, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.8773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9018896 KL Loss: 27.7347050 DSM Loss: 36.5466830 Overall Loss:66.1832775
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(49.7537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8211, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4523, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8989647 KL Loss: 27.9135895 DSM Loss: 35.9146092 Overall Loss:65.7271631
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(54.3624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.4534, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5481, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8676035 KL Loss: 27.6847410 DSM Loss: 35.9989180 Overall Loss:65.5512621
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(62.6093, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9104, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8969780 KL Loss: 27.6730037 DSM Loss: 35.5480716 Overall Loss:65.1180534
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(50.4042, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4696, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9355744 KL Loss: 28.0210970 DSM Loss: 35.5612662 Overall Loss:65.5179377
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DIS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5201920866966248


Running on file DUK.csv (24/71)...
Use GPU: cuda:0
>>>>>>>start training : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(117.5878, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5195, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9313455 KL Loss: 28.3288471 DSM Loss: 42.7983803 Overall Loss:73.0585733
Validation loss decreased (inf --> 7.078233).  Saving model ...
Updating learning rate to 0.0005
tensor(58.7068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.3924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5909, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9719364 KL Loss: 28.3843355 DSM Loss: 34.7732865 Overall Loss:65.1295589
Validation loss decreased (7.078233 --> 6.312136).  Saving model ...
Updating learning rate to 0.00025
tensor(52.4591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9063903 KL Loss: 28.1547210 DSM Loss: 34.0175183 Overall Loss:64.0786292
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(48.8470, device='cuda:0', grad_fn=<AddBackward0>)
tensor(106.9906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.3162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8989365 KL Loss: 28.0074552 DSM Loss: 33.1483597 Overall Loss:63.0547516
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(92.5779, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9814, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8837475 KL Loss: 28.1690760 DSM Loss: 32.8569045 Overall Loss:62.9097278
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(71.4920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6136, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9006420 KL Loss: 28.2429992 DSM Loss: 32.9582276 Overall Loss:63.1018688
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(63.5061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8024, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8980878 KL Loss: 28.0690488 DSM Loss: 32.3881204 Overall Loss:62.3552572
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(73.3214, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3276, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5042, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8844372 KL Loss: 28.1566510 DSM Loss: 32.3338712 Overall Loss:62.3749595
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(51.3457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8150, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6745, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8845405 KL Loss: 27.9831961 DSM Loss: 32.8279435 Overall Loss:62.6956804
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(58.3684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9108, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9030291 KL Loss: 28.0154623 DSM Loss: 32.9608760 Overall Loss:62.8793672
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(68.1637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6428, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8822335 KL Loss: 27.9893844 DSM Loss: 32.4242844 Overall Loss:62.2959022
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(65.2729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0958, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6380, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8780539 KL Loss: 27.9084833 DSM Loss: 32.8219047 Overall Loss:62.6084422
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : DUK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.55097770690918


Running on file EXC.csv (25/71)...
Use GPU: cuda:0
>>>>>>>start training : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(95.2926, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5349, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7020, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9571965 KL Loss: 28.2216819 DSM Loss: 40.4329404 Overall Loss:70.6118185
Validation loss decreased (inf --> 9.821964).  Saving model ...
Updating learning rate to 0.0005
tensor(58.6778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0060, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9989597 KL Loss: 28.2623041 DSM Loss: 35.8429189 Overall Loss:66.1041825
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(63.7511, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8633, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9318373 KL Loss: 28.0119336 DSM Loss: 33.8835656 Overall Loss:63.8273369
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(59.7967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3420, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7133, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8683799 KL Loss: 27.7694558 DSM Loss: 33.2284978 Overall Loss:62.8663333
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(62.5208, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2644, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2138, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8261702 KL Loss: 27.5188921 DSM Loss: 33.4072921 Overall Loss:62.7523546
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(56.8144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1168, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8426879 KL Loss: 27.6124417 DSM Loss: 33.2697728 Overall Loss:62.7249023
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(55.0405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8373585 KL Loss: 27.6645396 DSM Loss: 33.0519796 Overall Loss:62.5538777
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(65.2822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9461, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8570065 KL Loss: 27.8196295 DSM Loss: 33.3867798 Overall Loss:63.0634155
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(57.0157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5490, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8572188 KL Loss: 27.7382747 DSM Loss: 33.6715496 Overall Loss:63.2670429
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(58.1097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.1097, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8882, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8443061 KL Loss: 27.6404163 DSM Loss: 33.2278218 Overall Loss:62.7125444
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(59.6853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3915, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8576136 KL Loss: 27.8021327 DSM Loss: 33.1641087 Overall Loss:62.8238549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : EXC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:13.26295280456543


Running on file GD.csv (26/71)...
Use GPU: cuda:0
>>>>>>>start training : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(95.0448, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9284194 KL Loss: 28.3165098 DSM Loss: 39.1138311 Overall Loss:69.3587602
Validation loss decreased (inf --> 4.895725).  Saving model ...
Updating learning rate to 0.0005
tensor(85.2040, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2477, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1000, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9551717 KL Loss: 28.2260066 DSM Loss: 34.4151325 Overall Loss:64.5963109
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(81.8133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4163, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6467, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9470002 KL Loss: 28.1256012 DSM Loss: 33.2427194 Overall Loss:63.3153207
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(54.0263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7714, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9110439 KL Loss: 28.1255548 DSM Loss: 33.3408159 Overall Loss:63.3774146
Validation loss decreased (4.895725 --> 4.829832).  Saving model ...
Updating learning rate to 6.25e-05
tensor(77.7998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9216163 KL Loss: 28.2236339 DSM Loss: 32.8639354 Overall Loss:63.0091859
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(56.5180, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.3956, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8931946 KL Loss: 28.0095596 DSM Loss: 33.2762786 Overall Loss:63.1790325
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(59.8157, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9047282 KL Loss: 28.1185048 DSM Loss: 32.3795857 Overall Loss:62.4028183
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(48.5509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.3884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5157, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8777760 KL Loss: 28.0987857 DSM Loss: 32.5019082 Overall Loss:62.4784701
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(65.0502, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3363, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9080622 KL Loss: 28.1046607 DSM Loss: 32.9849857 Overall Loss:62.9977084
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(62.1504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.1880, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8807855 KL Loss: 27.9407346 DSM Loss: 32.6869476 Overall Loss:62.5084677
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(59.4939, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9155694 KL Loss: 28.1098061 DSM Loss: 32.6816484 Overall Loss:62.7070237
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(68.5716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8235, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4947, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8939517 KL Loss: 28.1250361 DSM Loss: 32.5521573 Overall Loss:62.5711446
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(69.3404, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4145, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4883, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8822416 KL Loss: 27.9531804 DSM Loss: 32.6947353 Overall Loss:62.5301572
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(54.2669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5881, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9044018 KL Loss: 27.9674968 DSM Loss: 32.7131947 Overall Loss:62.5850934
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:9.26004409790039


Running on file GE.csv (27/71)...
Use GPU: cuda:0
>>>>>>>start training : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(117.8885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.1411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0208399 KL Loss: 28.2656118 DSM Loss: 50.5804056 Overall Loss:80.8668575
Validation loss decreased (inf --> 0.154459).  Saving model ...
Updating learning rate to 0.0005
tensor(65.9955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.8104, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0292905 KL Loss: 28.4341584 DSM Loss: 39.4074318 Overall Loss:69.8708807
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(56.0489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2198, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.2818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9397661 KL Loss: 28.2664165 DSM Loss: 38.2321582 Overall Loss:68.4383408
Validation loss decreased (0.154459 --> 0.085538).  Saving model ...
Updating learning rate to 0.000125
tensor(72.6328, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1919, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7340, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9319139 KL Loss: 28.2373909 DSM Loss: 38.0343597 Overall Loss:68.2036642
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(77.4122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1509, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6276, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9140197 KL Loss: 28.0888419 DSM Loss: 37.0945476 Overall Loss:67.0974093
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(53.9271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8941174 KL Loss: 27.9696075 DSM Loss: 37.2346977 Overall Loss:67.0984224
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(67.5659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8487, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9631642 KL Loss: 28.2096280 DSM Loss: 36.8450873 Overall Loss:67.0178793
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(71.9131, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0946, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9746674 KL Loss: 28.2554858 DSM Loss: 36.6371086 Overall Loss:66.8672618
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(53.1887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8723, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3024, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9410977 KL Loss: 28.1390481 DSM Loss: 37.4325841 Overall Loss:67.5127299
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(67.7169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9223493 KL Loss: 28.0743357 DSM Loss: 37.2936691 Overall Loss:67.2903537
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(74.5253, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2847, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1540, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9417162 KL Loss: 28.1260457 DSM Loss: 36.8273494 Overall Loss:66.8951113
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(72.5088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0436, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9496372 KL Loss: 28.2570951 DSM Loss: 36.8939080 Overall Loss:67.1006402
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(57.9190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.0973, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9196495 KL Loss: 28.0180876 DSM Loss: 37.0834766 Overall Loss:67.0212132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.2709622085094452


Running on file GOOG.csv (28/71)...
Use GPU: cuda:0
>>>>>>>start training : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(81.7658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.9280, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.1923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9574654 KL Loss: 27.8851269 DSM Loss: 39.9256524 Overall Loss:69.7682451
Validation loss decreased (inf --> 12.181938).  Saving model ...
Updating learning rate to 0.0005
tensor(59.3867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2271, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9407204 KL Loss: 27.8875514 DSM Loss: 33.6962899 Overall Loss:63.5245617
Validation loss decreased (12.181938 --> 10.390479).  Saving model ...
Updating learning rate to 0.00025
tensor(48.4490, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.4286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.4711, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9487464 KL Loss: 27.8105505 DSM Loss: 33.2558121 Overall Loss:63.0151089
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(81.2433, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.1507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8409, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9014639 KL Loss: 27.5918313 DSM Loss: 32.5257019 Overall Loss:62.0189971
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(61.1886, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.8069, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.9321, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9264213 KL Loss: 27.4989418 DSM Loss: 32.0736020 Overall Loss:61.4989656
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(71.5423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.8597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3091, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8671329 KL Loss: 27.0237391 DSM Loss: 32.0509471 Overall Loss:60.9418192
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(89.7743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.2505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6297, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9002971 KL Loss: 27.4484141 DSM Loss: 32.1512664 Overall Loss:61.4999777
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(50.2507, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8647378 KL Loss: 27.2876822 DSM Loss: 32.4731527 Overall Loss:61.6255726
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(98.7231, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.0325, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8775622 KL Loss: 27.3398394 DSM Loss: 32.3205501 Overall Loss:61.5379520
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(56.2337, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6936, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9191704 KL Loss: 27.4598925 DSM Loss: 31.6901280 Overall Loss:61.0691905
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(62.7629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3867, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8767474 KL Loss: 27.1952009 DSM Loss: 32.3915852 Overall Loss:61.4635336
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(46.4050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5652, device='cuda:0', grad_fn=<AddBackward0>)
tensor(93.3825, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9162546 KL Loss: 27.6721936 DSM Loss: 32.1574122 Overall Loss:61.7458602
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : GOOG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.823967933654785


Running on file HD.csv (29/71)...
Use GPU: cuda:0
>>>>>>>start training : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(112.0135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7359, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8368, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9867578 KL Loss: 28.3128358 DSM Loss: 46.3983171 Overall Loss:76.6979103
Validation loss decreased (inf --> 7.585188).  Saving model ...
Updating learning rate to 0.0005
tensor(71.4656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.3689, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9394243 KL Loss: 28.0367976 DSM Loss: 36.8224362 Overall Loss:66.7986582
Validation loss decreased (7.585188 --> 6.970792).  Saving model ...
Updating learning rate to 0.00025
tensor(78.9221, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.5485, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8682758 KL Loss: 27.8093036 DSM Loss: 34.9601468 Overall Loss:64.6377262
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(57.5262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0917, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9116, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8605224 KL Loss: 27.5531938 DSM Loss: 34.2801400 Overall Loss:63.6938563
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(52.1316, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8562009 KL Loss: 27.3367562 DSM Loss: 34.4529713 Overall Loss:63.6459287
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(63.9036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.7523, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8746244 KL Loss: 27.5402294 DSM Loss: 33.9954434 Overall Loss:63.4102972
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(56.7022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.0508, device='cuda:0', grad_fn=<AddBackward0>)
tensor(90.4245, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8345967 KL Loss: 27.1741540 DSM Loss: 34.3340639 Overall Loss:63.3428145
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(74.2230, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.0164, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8452922 KL Loss: 27.3422852 DSM Loss: 34.2325183 Overall Loss:63.4200957
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(52.8151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6545, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0381, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8475634 KL Loss: 27.4586361 DSM Loss: 34.2130228 Overall Loss:63.5192222
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(61.5362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1613, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8565166 KL Loss: 27.4941867 DSM Loss: 34.2783829 Overall Loss:63.6290860
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(71.4030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6225, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8701614 KL Loss: 27.5057723 DSM Loss: 34.1995787 Overall Loss:63.5755124
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(62.5350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.8582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0637, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8714536 KL Loss: 27.2796820 DSM Loss: 34.0769225 Overall Loss:63.2280581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.5655665397644043


Running on file HON.csv (30/71)...
Use GPU: cuda:0
>>>>>>>start training : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(139.0703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.4200, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8153, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9170064 KL Loss: 28.1813844 DSM Loss: 41.5798115 Overall Loss:71.6782022
Validation loss decreased (inf --> 4.010912).  Saving model ...
Updating learning rate to 0.0005
tensor(73.3817, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9786894 KL Loss: 28.5239667 DSM Loss: 35.0499154 Overall Loss:65.5525714
Validation loss decreased (4.010912 --> 3.568246).  Saving model ...
Updating learning rate to 0.00025
tensor(54.3233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3249, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5329, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9539316 KL Loss: 28.1861103 DSM Loss: 34.3755683 Overall Loss:64.5156102
Validation loss decreased (3.568246 --> 3.295364).  Saving model ...
Updating learning rate to 0.000125
tensor(56.7726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9736, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9263356 KL Loss: 28.1139138 DSM Loss: 33.1220849 Overall Loss:63.1623343
Validation loss decreased (3.295364 --> 3.208036).  Saving model ...
Updating learning rate to 6.25e-05
tensor(74.3548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9724, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8983062 KL Loss: 27.9331711 DSM Loss: 33.2815494 Overall Loss:63.1130260
Validation loss decreased (3.208036 --> 3.148754).  Saving model ...
Updating learning rate to 3.125e-05
tensor(62.8585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5096, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9496994 KL Loss: 28.2250267 DSM Loss: 33.8054567 Overall Loss:63.9801826
Validation loss decreased (3.148754 --> 3.116120).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(54.6856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9414287 KL Loss: 28.0806551 DSM Loss: 32.7921425 Overall Loss:62.8142269
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(61.7739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9012597 KL Loss: 27.8227365 DSM Loss: 33.3445550 Overall Loss:63.0685509
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(57.2562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6120, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9208113 KL Loss: 28.0101551 DSM Loss: 33.6228755 Overall Loss:63.5538417
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-06
tensor(76.4339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4332, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3841, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9749060 KL Loss: 28.2989430 DSM Loss: 33.5040678 Overall Loss:63.7779168
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-07
tensor(64.7665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.3818, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9174349 KL Loss: 28.0891580 DSM Loss: 33.7951612 Overall Loss:63.8017545
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-07
tensor(44.4656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8934, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9248595 KL Loss: 28.0183939 DSM Loss: 33.7628700 Overall Loss:63.7061233
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-07
tensor(51.0574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.5671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9143300 KL Loss: 28.0147410 DSM Loss: 33.3785505 Overall Loss:63.3076212
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-07
tensor(76.8940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.4844, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9003996 KL Loss: 27.8341932 DSM Loss: 33.4527906 Overall Loss:63.1873835
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-08
tensor(83.9780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1929, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8102, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.9595800 KL Loss: 28.3026722 DSM Loss: 33.3219680 Overall Loss:63.5842203
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-08
tensor(65.7287, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.4096, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9171339 KL Loss: 27.9703512 DSM Loss: 33.2303319 Overall Loss:63.1178166
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HON.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.486565589904785


Running on file HSBC.csv (31/71)...
Use GPU: cuda:0
>>>>>>>start training : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(112.2274, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8812, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4732, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9979371 KL Loss: 28.4816274 DSM Loss: 42.2063039 Overall Loss:72.6858686
Validation loss decreased (inf --> 0.297050).  Saving model ...
Updating learning rate to 0.0005
tensor(57.0125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8022, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7574, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9398821 KL Loss: 28.2766149 DSM Loss: 38.9013567 Overall Loss:69.1178537
Validation loss decreased (0.297050 --> 0.291639).  Saving model ...
Updating learning rate to 0.00025
tensor(91.3121, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.2447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9593, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9458493 KL Loss: 28.3179028 DSM Loss: 38.0134258 Overall Loss:68.2771779
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(67.4257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1561, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1680, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9184110 KL Loss: 28.2876863 DSM Loss: 37.8288870 Overall Loss:68.0349845
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(70.8797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1776, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0646, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9170521 KL Loss: 28.0359998 DSM Loss: 37.3438017 Overall Loss:67.2968538
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(47.0754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1513, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.0140, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8844524 KL Loss: 28.0320142 DSM Loss: 37.4738975 Overall Loss:67.3903637
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(64.1517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0437, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8846720 KL Loss: 27.9693505 DSM Loss: 36.9632197 Overall Loss:66.8172424
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(68.5850, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3811, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9026330 KL Loss: 28.2253982 DSM Loss: 36.9900012 Overall Loss:67.1180322
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(65.8219, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8974299 KL Loss: 28.1786678 DSM Loss: 36.9297605 Overall Loss:67.0058584
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(58.8582, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3119, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4748, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8837109 KL Loss: 28.0432962 DSM Loss: 37.2568879 Overall Loss:67.1838954
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(61.1841, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.7566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0717, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9002331 KL Loss: 28.0207229 DSM Loss: 37.0222917 Overall Loss:66.9432476
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(65.8336, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5468, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9111511 KL Loss: 28.1668222 DSM Loss: 37.3535957 Overall Loss:67.4315690
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : HSBC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.8917268514633179


Running on file IEP.csv (32/71)...
Use GPU: cuda:0
>>>>>>>start training : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(121.1829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5758, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9904862 KL Loss: 28.4180774 DSM Loss: 43.5596203 Overall Loss:73.9681839
Validation loss decreased (inf --> 2.247390).  Saving model ...
Updating learning rate to 0.0005
tensor(66.0823, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9618878 KL Loss: 28.3915720 DSM Loss: 37.6786020 Overall Loss:68.0320620
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(78.0018, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9950, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9549555 KL Loss: 28.2775050 DSM Loss: 36.5833732 Overall Loss:66.8158340
Validation loss decreased (2.247390 --> 1.953746).  Saving model ...
Updating learning rate to 0.000125
tensor(57.0284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8927381 KL Loss: 28.1418873 DSM Loss: 36.1495658 Overall Loss:66.1841911
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(63.7637, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.3393, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9024024 KL Loss: 28.1402089 DSM Loss: 35.7845119 Overall Loss:65.8271230
Validation loss decreased (1.953746 --> 1.827641).  Saving model ...
Updating learning rate to 3.125e-05
tensor(56.3909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2902, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8767821 KL Loss: 28.1648623 DSM Loss: 35.7746033 Overall Loss:65.8162473
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(55.5703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7760, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2089, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9011431 KL Loss: 28.1515669 DSM Loss: 35.8243464 Overall Loss:65.8770563
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(77.6879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7313, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.5741, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9209665 KL Loss: 28.3096671 DSM Loss: 35.5848965 Overall Loss:65.8155303
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(68.3017, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.3435, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6618, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8898899 KL Loss: 28.1393489 DSM Loss: 35.9750449 Overall Loss:66.0042836
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(60.2998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0134, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8850698 KL Loss: 28.0794882 DSM Loss: 35.9190798 Overall Loss:65.8836379
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(64.6983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8904109 KL Loss: 28.0082654 DSM Loss: 36.1622815 Overall Loss:66.0609582
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(63.3843, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8505, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8725106 KL Loss: 28.0805007 DSM Loss: 35.4489144 Overall Loss:65.4019259
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(68.4785, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7301, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8924734 KL Loss: 28.2469906 DSM Loss: 35.5965279 Overall Loss:65.7359918
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(69.3202, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1293, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8757336 KL Loss: 28.1027712 DSM Loss: 35.4549852 Overall Loss:65.4334905
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(66.8184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3323, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.8952098 KL Loss: 28.1841054 DSM Loss: 35.5198323 Overall Loss:65.5991481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : IEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.1967318058013916


Running on file INTC.csv (33/71)...
Use GPU: cuda:0
>>>>>>>start training : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(117.3265, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.2969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.7450, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9651898 KL Loss: 28.1589791 DSM Loss: 48.6172645 Overall Loss:78.7414330
Validation loss decreased (inf --> 0.450030).  Saving model ...
Updating learning rate to 0.0005
tensor(65.5623, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0209, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6805, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9266777 KL Loss: 28.1886861 DSM Loss: 36.4420568 Overall Loss:66.5574208
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(54.4294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2017, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9424993 KL Loss: 28.1660074 DSM Loss: 35.5531660 Overall Loss:65.6616724
Validation loss decreased (0.450030 --> 0.336993).  Saving model ...
Updating learning rate to 0.000125
tensor(58.1283, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5799, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9058440 KL Loss: 28.0189428 DSM Loss: 35.2088291 Overall Loss:65.1336158
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(78.2680, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4873, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9022920 KL Loss: 27.8872993 DSM Loss: 34.9830070 Overall Loss:64.7725984
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(62.3469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7726, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9151, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8844223 KL Loss: 28.0179525 DSM Loss: 35.1887858 Overall Loss:65.0911606
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(66.4323, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0268, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8815157 KL Loss: 28.1507069 DSM Loss: 34.7388797 Overall Loss:64.7711021
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(58.1286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8455, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8832442 KL Loss: 27.9366153 DSM Loss: 34.9334426 Overall Loss:64.7533022
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(65.8094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.9988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0235, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8855035 KL Loss: 28.0101123 DSM Loss: 35.0499331 Overall Loss:64.9455489
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(61.5003, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2224, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8729885 KL Loss: 27.9182786 DSM Loss: 34.3155509 Overall Loss:64.1068182
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(55.4495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6624, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2777, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9021815 KL Loss: 28.0709829 DSM Loss: 34.8564595 Overall Loss:64.8296236
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(75.7457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7631, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8559702 KL Loss: 27.9803324 DSM Loss: 34.8872982 Overall Loss:64.7236003
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(64.2751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6717, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.7316, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8618623 KL Loss: 28.0425519 DSM Loss: 34.6839479 Overall Loss:64.5883623
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : INTC.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.091792106628418


Running on file JNJ.csv (34/71)...
Use GPU: cuda:0
>>>>>>>start training : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(101.1275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.2277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7733, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8925458 KL Loss: 28.2130677 DSM Loss: 40.1818689 Overall Loss:70.2874824
Validation loss decreased (inf --> 4.581213).  Saving model ...
Updating learning rate to 0.0005
tensor(62.7124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7226, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8830887 KL Loss: 27.9859099 DSM Loss: 32.5691331 Overall Loss:62.4381319
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(60.3862, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8540281 KL Loss: 27.9082732 DSM Loss: 31.6079270 Overall Loss:61.3702287
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(60.6353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.2385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8561587 KL Loss: 27.6230666 DSM Loss: 31.3842947 Overall Loss:60.8635198
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(72.3285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9244, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0473, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8729703 KL Loss: 27.7088042 DSM Loss: 31.4786914 Overall Loss:61.0604654
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(70.5738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8807328 KL Loss: 27.7256386 DSM Loss: 31.2503726 Overall Loss:60.8567441
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(60.7092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3310, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.9936, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8491643 KL Loss: 27.6540018 DSM Loss: 31.6149761 Overall Loss:61.1181421
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(43.8894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4132, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8493169 KL Loss: 27.5087520 DSM Loss: 31.6006320 Overall Loss:60.9587008
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(63.5338, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1684, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0844, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8500233 KL Loss: 27.6010261 DSM Loss: 31.1226378 Overall Loss:60.5736873
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(53.2583, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8268227 KL Loss: 27.4842128 DSM Loss: 30.8052595 Overall Loss:60.1162945
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(71.7191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8803177 KL Loss: 27.8293334 DSM Loss: 31.3184208 Overall Loss:61.0280717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JNJ.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.033051490783691


Running on file JPM.csv (35/71)...
Use GPU: cuda:0
>>>>>>>start training : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(106.9472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(87.8126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6979, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9611549 KL Loss: 28.2630905 DSM Loss: 40.4856727 Overall Loss:70.7099182
Validation loss decreased (inf --> 4.074035).  Saving model ...
Updating learning rate to 0.0005
tensor(66.3888, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.3077, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9389, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9400360 KL Loss: 28.0507505 DSM Loss: 35.1823085 Overall Loss:65.1730950
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(74.8009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6634, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9027020 KL Loss: 27.6541136 DSM Loss: 33.7641725 Overall Loss:63.3209873
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(90.0043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5635, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8920827 KL Loss: 27.7751181 DSM Loss: 32.8690210 Overall Loss:62.5362216
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(67.8734, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.3041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.4985, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8791869 KL Loss: 27.6998473 DSM Loss: 32.8907607 Overall Loss:62.4697950
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(58.9893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.5802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.6691, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9014709 KL Loss: 28.0218520 DSM Loss: 32.3682367 Overall Loss:62.2915596
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(48.6124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6940, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2180, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8959308 KL Loss: 27.6947959 DSM Loss: 33.1024274 Overall Loss:62.6931537
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(69.8154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.8061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4356, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9149960 KL Loss: 27.9810425 DSM Loss: 32.8604805 Overall Loss:62.7565190
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(95.9759, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9803, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8801318 KL Loss: 27.7052283 DSM Loss: 32.3728908 Overall Loss:61.9582513
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(71.1868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.0603, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8764600 KL Loss: 27.6748592 DSM Loss: 32.7023297 Overall Loss:62.2536494
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(60.0672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(41.8154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4839, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8959972 KL Loss: 27.7079618 DSM Loss: 32.5002603 Overall Loss:62.1042192
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : JPM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.320150136947632


Running on file KO.csv (36/71)...
Use GPU: cuda:0
>>>>>>>start training : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(96.7645, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9824, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8896845 KL Loss: 28.0460397 DSM Loss: 41.5290330 Overall Loss:71.4647570
Validation loss decreased (inf --> 7.345994).  Saving model ...
Updating learning rate to 0.0005
tensor(68.2908, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4445, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5528, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9392530 KL Loss: 28.2755798 DSM Loss: 36.2697073 Overall Loss:66.4845400
Validation loss decreased (7.345994 --> 5.572860).  Saving model ...
Updating learning rate to 0.00025
tensor(78.2304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9206285 KL Loss: 28.1426867 DSM Loss: 36.2318110 Overall Loss:66.2951265
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(48.7879, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2794, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1253, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9584490 KL Loss: 28.3736329 DSM Loss: 35.5684743 Overall Loss:65.9005560
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(87.1286, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8284, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9084514 KL Loss: 27.9683154 DSM Loss: 35.5614616 Overall Loss:65.4382278
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(60.8914, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.3596, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1025, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9250108 KL Loss: 28.1087478 DSM Loss: 35.7450680 Overall Loss:65.7788267
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(60.4598, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.7910, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9356577 KL Loss: 28.2442607 DSM Loss: 35.4157168 Overall Loss:65.5956347
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(66.2770, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8906, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9349461 KL Loss: 28.0572608 DSM Loss: 35.2193876 Overall Loss:65.2115947
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(65.2362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4335, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9443566 KL Loss: 28.1545292 DSM Loss: 35.3735754 Overall Loss:65.4724610
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(59.2366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6790, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9401332 KL Loss: 28.2832649 DSM Loss: 35.2810562 Overall Loss:65.5044544
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(68.8737, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6356, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1868, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9293081 KL Loss: 28.1117087 DSM Loss: 35.4342627 Overall Loss:65.4752793
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(72.4105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.8233, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4250, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9734283 KL Loss: 28.2872887 DSM Loss: 35.3770744 Overall Loss:65.6377911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : KO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:9.163694381713867


Running on file LMT.csv (37/71)...
Use GPU: cuda:0
>>>>>>>start training : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(108.6495, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5738, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7742, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9487148 KL Loss: 28.3011132 DSM Loss: 39.6854000 Overall Loss:69.9352284
Validation loss decreased (inf --> 2.377254).  Saving model ...
Updating learning rate to 0.0005
tensor(72.5710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9379, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9782989 KL Loss: 28.2868038 DSM Loss: 34.6441307 Overall Loss:64.9092332
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(68.7133, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8669, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8478, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9410061 KL Loss: 28.1087236 DSM Loss: 33.9542197 Overall Loss:64.0039491
Validation loss decreased (2.377254 --> 1.987455).  Saving model ...
Updating learning rate to 0.000125
tensor(63.4618, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8998, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.8110, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9496291 KL Loss: 28.1104818 DSM Loss: 34.7692848 Overall Loss:64.8293958
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(76.3657, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0989, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9333277 KL Loss: 28.0856631 DSM Loss: 33.7288526 Overall Loss:63.7478434
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(81.1745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.4496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5266, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9098836 KL Loss: 28.0241109 DSM Loss: 33.8247750 Overall Loss:63.7587697
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(75.0031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5317, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5417, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9235059 KL Loss: 28.1019322 DSM Loss: 33.9901555 Overall Loss:64.0155935
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(73.8405, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8991867 KL Loss: 27.9654406 DSM Loss: 33.4419160 Overall Loss:63.3065434
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(79.9634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4162, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1396, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9147903 KL Loss: 27.9482183 DSM Loss: 33.1234150 Overall Loss:62.9864233
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(69.1138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5098, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8721, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8858487 KL Loss: 28.0671415 DSM Loss: 33.6344113 Overall Loss:63.5874015
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(61.4935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.0271, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8906635 KL Loss: 27.9092105 DSM Loss: 33.4469669 Overall Loss:63.2468407
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(61.3967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.6126, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2780, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9337035 KL Loss: 28.1998009 DSM Loss: 33.1682957 Overall Loss:63.3018001
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(61.1438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8275, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9013467 KL Loss: 27.8919719 DSM Loss: 33.0348345 Overall Loss:62.8281529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : LMT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:6.444633483886719


Running on file MA.csv (38/71)...
Use GPU: cuda:0
>>>>>>>start training : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(112.5044, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7999, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9052861 KL Loss: 28.0350412 DSM Loss: 47.3803976 Overall Loss:77.3207245
Validation loss decreased (inf --> 2.597790).  Saving model ...
Updating learning rate to 0.0005
tensor(71.1629, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8574, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7723, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9658201 KL Loss: 28.3661294 DSM Loss: 37.0786104 Overall Loss:67.4105599
Validation loss decreased (2.597790 --> 2.590243).  Saving model ...
Updating learning rate to 0.00025
tensor(62.0970, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.6809, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.1734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9523659 KL Loss: 28.1426785 DSM Loss: 35.6562343 Overall Loss:65.7512787
Validation loss decreased (2.590243 --> 1.923664).  Saving model ...
Updating learning rate to 0.000125
tensor(66.5802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4510, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9185741 KL Loss: 28.0340002 DSM Loss: 36.1530636 Overall Loss:66.1056383
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(62.3751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.0613, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.5289, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8929244 KL Loss: 28.0670209 DSM Loss: 36.0397066 Overall Loss:65.9996518
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(65.4696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5612, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9222452 KL Loss: 28.0175901 DSM Loss: 35.6035031 Overall Loss:65.5433383
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(77.6646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.5927, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.4705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9039404 KL Loss: 27.9578031 DSM Loss: 35.4942963 Overall Loss:65.3560397
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(65.2767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3395, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6792, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8999271 KL Loss: 27.9219051 DSM Loss: 35.0171412 Overall Loss:64.8389730
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(65.1968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6646, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9002737 KL Loss: 27.9937153 DSM Loss: 35.2615272 Overall Loss:65.1555158
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(71.2397, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5116, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5355, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8921949 KL Loss: 27.9329704 DSM Loss: 34.8857785 Overall Loss:64.7109435
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(53.9262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9272, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8877057 KL Loss: 27.9173900 DSM Loss: 35.2152166 Overall Loss:65.0203120
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(66.7924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9027398 KL Loss: 27.9522765 DSM Loss: 35.6075346 Overall Loss:65.4625507
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(52.7059, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8874296 KL Loss: 27.9454355 DSM Loss: 35.3352627 Overall Loss:65.1681280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MA.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.408754587173462


Running on file MCD.csv (39/71)...
Use GPU: cuda:0
>>>>>>>start training : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(113.3456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.1473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1773, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8646605 KL Loss: 28.2187698 DSM Loss: 46.9625796 Overall Loss:77.0460096
Validation loss decreased (inf --> 4.828391).  Saving model ...
Updating learning rate to 0.0005
tensor(71.0697, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5811, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9709, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8774703 KL Loss: 28.1426540 DSM Loss: 37.9163694 Overall Loss:67.9364935
Validation loss decreased (4.828391 --> 4.170213).  Saving model ...
Updating learning rate to 0.00025
tensor(57.2412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.1179, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8826322 KL Loss: 27.9364209 DSM Loss: 35.0720793 Overall Loss:64.8911323
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(58.6650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4505, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.2184, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8772231 KL Loss: 27.9248105 DSM Loss: 35.4501966 Overall Loss:65.2522301
Validation loss decreased (4.170213 --> 4.068382).  Saving model ...
Updating learning rate to 6.25e-05
tensor(75.3290, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.9258, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5410, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9133315 KL Loss: 28.0460291 DSM Loss: 34.7475112 Overall Loss:64.7068717
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(62.7703, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3859, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8824171 KL Loss: 27.8854313 DSM Loss: 34.2198622 Overall Loss:63.9877105
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(66.9991, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7409, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3335, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9083172 KL Loss: 28.1095148 DSM Loss: 34.5893321 Overall Loss:64.6071640
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(65.6898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.7559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5291, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8984039 KL Loss: 27.9768716 DSM Loss: 34.7143041 Overall Loss:64.5895797
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(60.0492, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2421, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9763, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9445587 KL Loss: 28.2132917 DSM Loss: 34.3979358 Overall Loss:64.5557861
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(58.3374, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0181, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8894696 KL Loss: 27.9063581 DSM Loss: 34.4060422 Overall Loss:64.2018703
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(89.3586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4251, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8969903 KL Loss: 28.1094061 DSM Loss: 33.9034286 Overall Loss:63.9098251
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(57.9225, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0212, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6387, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9238319 KL Loss: 28.1950926 DSM Loss: 34.5317860 Overall Loss:64.6507105
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(59.0858, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5867, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6584, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9039454 KL Loss: 28.0710259 DSM Loss: 34.6804609 Overall Loss:64.6554319
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(54.1610, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.0196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0563, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8855312 KL Loss: 28.1011987 DSM Loss: 34.2598025 Overall Loss:64.2465324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MCD.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.618244171142578


Running on file MDT.csv (40/71)...
Use GPU: cuda:0
>>>>>>>start training : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(96.2554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7322, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1530, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9704049 KL Loss: 28.3679933 DSM Loss: 41.9566664 Overall Loss:72.2950646
Validation loss decreased (inf --> 2.194209).  Saving model ...
Updating learning rate to 0.0005
tensor(67.0555, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4109, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5039, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9719366 KL Loss: 28.0894005 DSM Loss: 37.3488414 Overall Loss:67.4101782
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(55.1523, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.6485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3575, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9193435 KL Loss: 28.0569846 DSM Loss: 35.1972651 Overall Loss:65.1735935
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(87.9239, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1518, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8914382 KL Loss: 27.7703941 DSM Loss: 34.8754081 Overall Loss:64.5372402
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(65.4630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7075, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9085738 KL Loss: 27.9551415 DSM Loss: 34.1708068 Overall Loss:64.0345222
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(56.1947, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2351, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8586825 KL Loss: 27.8147805 DSM Loss: 34.7479327 Overall Loss:64.4213960
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(55.6887, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.2209, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8759808 KL Loss: 27.8138693 DSM Loss: 34.4103418 Overall Loss:64.1001922
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(69.7094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0041, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8667511 KL Loss: 27.7849589 DSM Loss: 35.0341655 Overall Loss:64.6858757
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(52.2832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4529, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.9330, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8632090 KL Loss: 27.7055142 DSM Loss: 33.8663497 Overall Loss:63.4350731
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(51.0781, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6907, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.5694, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8794208 KL Loss: 27.8361903 DSM Loss: 34.4938534 Overall Loss:64.2094645
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(59.4365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.6911, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7611, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8928200 KL Loss: 27.7505247 DSM Loss: 34.5602010 Overall Loss:64.2035453
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MDT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.18614423274993896


Running on file MMM.csv (41/71)...
Use GPU: cuda:0
>>>>>>>start training : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(99.7412, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4724, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7809, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9191674 KL Loss: 28.2831234 DSM Loss: 41.7212981 Overall Loss:71.9235886
Validation loss decreased (inf --> 0.390621).  Saving model ...
Updating learning rate to 0.0005
tensor(45.4553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.3068, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8191, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9797432 KL Loss: 28.3567446 DSM Loss: 34.6086497 Overall Loss:64.9451377
Validation loss decreased (0.390621 --> 0.390316).  Saving model ...
Updating learning rate to 0.00025
tensor(64.3362, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.8848, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.0971, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9450128 KL Loss: 28.1743375 DSM Loss: 32.9992351 Overall Loss:63.1185852
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(57.7295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8954, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1658, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8812317 KL Loss: 28.1269121 DSM Loss: 33.7534783 Overall Loss:63.7616221
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(63.1844, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1043, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.8641, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9275364 KL Loss: 28.3993053 DSM Loss: 32.8321589 Overall Loss:63.1590007
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(63.7021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3782, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8875206 KL Loss: 28.1334142 DSM Loss: 33.1596696 Overall Loss:63.1806045
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(54.4597, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5021, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9559, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8807347 KL Loss: 28.0637160 DSM Loss: 33.0871613 Overall Loss:63.0316121
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(52.2525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4665, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5557, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9042296 KL Loss: 28.2564086 DSM Loss: 33.3763862 Overall Loss:63.5370246
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(71.7440, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6688, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8753, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8804998 KL Loss: 28.0435936 DSM Loss: 32.8836659 Overall Loss:62.8077591
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(65.1345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7252, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8743443 KL Loss: 28.0605967 DSM Loss: 33.1941122 Overall Loss:63.1290530
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(65.8457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.1094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5009, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8892454 KL Loss: 28.1198118 DSM Loss: 32.8778047 Overall Loss:62.8868621
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(65.5467, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8899936 KL Loss: 28.0950604 DSM Loss: 33.5184598 Overall Loss:63.5035142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MMM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.211314678192139


Running on file MO.csv (42/71)...
Use GPU: cuda:0
>>>>>>>start training : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(103.3450, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0604662 KL Loss: 28.7083307 DSM Loss: 47.2132388 Overall Loss:77.9820359
Validation loss decreased (inf --> 0.978870).  Saving model ...
Updating learning rate to 0.0005
tensor(71.6775, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1579, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3465, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0268697 KL Loss: 28.6058395 DSM Loss: 41.4477039 Overall Loss:72.0804130
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(76.5924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6130, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.8642, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9474271 KL Loss: 28.4289495 DSM Loss: 41.4935630 Overall Loss:71.8699397
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(80.6899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5127, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6065, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9739375 KL Loss: 28.5180521 DSM Loss: 40.3364449 Overall Loss:70.8284344
Validation loss decreased (0.978870 --> 0.928447).  Saving model ...
Updating learning rate to 6.25e-05
tensor(71.2091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7647, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5110, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9411719 KL Loss: 28.5858009 DSM Loss: 40.1929356 Overall Loss:70.7199085
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(57.3573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.3350, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9819, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9616859 KL Loss: 28.4886089 DSM Loss: 40.0589163 Overall Loss:70.5092116
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(56.8591, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.1743, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9138089 KL Loss: 28.5824122 DSM Loss: 40.0866910 Overall Loss:70.5829123
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(69.8747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8031, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.4539, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9302878 KL Loss: 28.4117738 DSM Loss: 39.7460232 Overall Loss:70.0880849
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(66.6125, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.9346, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0147, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9651078 KL Loss: 28.6338061 DSM Loss: 39.5713552 Overall Loss:70.1702692
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(58.2960, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5169, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0446, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9513965 KL Loss: 28.6939336 DSM Loss: 39.6065726 Overall Loss:70.2519025
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(63.6829, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.7868, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.7400, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9428786 KL Loss: 28.6361187 DSM Loss: 40.2308329 Overall Loss:70.8098301
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(73.4548, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2263, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5764, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9236878 KL Loss: 28.4063390 DSM Loss: 39.6322888 Overall Loss:69.9623156
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(72.1615, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5288, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6785, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9131545 KL Loss: 28.3740170 DSM Loss: 40.1825372 Overall Loss:70.4697081
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(56.2636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9050, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9462404 KL Loss: 28.5768104 DSM Loss: 39.8276749 Overall Loss:70.3507257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.6740884184837341


Running on file MRK.csv (43/71)...
Use GPU: cuda:0
>>>>>>>start training : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(94.7765, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6159, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9384275 KL Loss: 28.4617769 DSM Loss: 41.0224578 Overall Loss:71.4226623
Validation loss decreased (inf --> 2.644425).  Saving model ...
Updating learning rate to 0.0005
tensor(65.4115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8349, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9423196 KL Loss: 28.3937135 DSM Loss: 36.1108470 Overall Loss:66.4468803
Validation loss decreased (2.644425 --> 2.369438).  Saving model ...
Updating learning rate to 0.00025
tensor(66.5053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5586, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.1050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8854916 KL Loss: 28.0531603 DSM Loss: 35.1384392 Overall Loss:65.0770913
Validation loss decreased (2.369438 --> 1.716516).  Saving model ...
Updating learning rate to 0.000125
tensor(57.8242, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5383, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.5249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8400794 KL Loss: 27.7334692 DSM Loss: 34.6819143 Overall Loss:64.2554629
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(64.5496, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3704, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6695, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8609209 KL Loss: 27.8901529 DSM Loss: 34.5742637 Overall Loss:64.3253376
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(60.1836, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5729, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8321723 KL Loss: 27.6362337 DSM Loss: 34.1170852 Overall Loss:63.5854908
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(64.0128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8493869 KL Loss: 27.6053278 DSM Loss: 34.1868027 Overall Loss:63.6415174
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(54.2638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3571, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8503532 KL Loss: 27.7794888 DSM Loss: 34.5430926 Overall Loss:64.1729351
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(61.7973, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5739, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3676, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8545538 KL Loss: 27.7145828 DSM Loss: 34.4437969 Overall Loss:64.0129336
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(63.2540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2845, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5057, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8353756 KL Loss: 27.6777379 DSM Loss: 34.2565542 Overall Loss:63.7696673
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(64.3691, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.9478, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3679, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8280574 KL Loss: 27.5978284 DSM Loss: 33.9120356 Overall Loss:63.3379212
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(52.0763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.2767, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8335, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8530879 KL Loss: 27.8543564 DSM Loss: 34.6030240 Overall Loss:64.3104683
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(70.3741, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8590, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.7671, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8578572 KL Loss: 28.1091369 DSM Loss: 34.3974545 Overall Loss:64.3644489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MRK.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:13.466277122497559


Running on file MSFT.csv (44/71)...
Use GPU: cuda:0
>>>>>>>start training : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(101.9041, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7616, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.4967, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9415996 KL Loss: 28.2727866 DSM Loss: 45.3887341 Overall Loss:75.6031208
Validation loss decreased (inf --> 7.754813).  Saving model ...
Updating learning rate to 0.0005
tensor(72.6699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.5672, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.7054, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9274133 KL Loss: 27.8943515 DSM Loss: 36.4234343 Overall Loss:66.2451986
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(67.4153, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.4238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5169, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9053670 KL Loss: 27.8583937 DSM Loss: 35.1737334 Overall Loss:64.9374943
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(61.4515, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9866, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.5407, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8963000 KL Loss: 27.9372628 DSM Loss: 35.0496672 Overall Loss:64.8832297
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(63.2974, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.9262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9620, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9054156 KL Loss: 27.5957368 DSM Loss: 35.1004300 Overall Loss:64.6015823
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(71.6094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0431, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9924, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8759071 KL Loss: 27.5151701 DSM Loss: 34.5829642 Overall Loss:63.9740413
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(71.2419, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4742, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5100, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8900031 KL Loss: 27.6168472 DSM Loss: 34.7813765 Overall Loss:64.2882267
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(72.3797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5978, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8989849 KL Loss: 27.5816771 DSM Loss: 34.5459124 Overall Loss:64.0265745
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(56.1810, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8781937 KL Loss: 27.3615095 DSM Loss: 34.6039431 Overall Loss:63.8436464
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(62.7205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.4268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1176, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8897153 KL Loss: 27.5376054 DSM Loss: 34.7072303 Overall Loss:64.1345509
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(58.9872, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5034, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.0081, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8592087 KL Loss: 27.2646048 DSM Loss: 34.5797887 Overall Loss:63.7036027
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : MSFT.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:6.50393533706665


Running on file NEE.csv (45/71)...
Use GPU: cuda:0
>>>>>>>start training : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(106.5369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5482, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9376436 KL Loss: 28.0676010 DSM Loss: 44.0375548 Overall Loss:74.0427997
Validation loss decreased (inf --> 4.490579).  Saving model ...
Updating learning rate to 0.0005
tensor(85.0254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.2036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.6162, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9496115 KL Loss: 28.1612785 DSM Loss: 37.0089022 Overall Loss:67.1197921
Validation loss decreased (4.490579 --> 4.000146).  Saving model ...
Updating learning rate to 0.00025
tensor(72.2978, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.5405, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9218479 KL Loss: 27.9244437 DSM Loss: 36.4113153 Overall Loss:66.2576070
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(65.1668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.6531, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2331, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9630564 KL Loss: 27.9462545 DSM Loss: 35.6088000 Overall Loss:65.5181107
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(76.4315, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6980, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.7249, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9777791 KL Loss: 27.8459972 DSM Loss: 35.8506595 Overall Loss:65.6744357
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(75.0943, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9488, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.2337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.0150310 KL Loss: 28.0455686 DSM Loss: 35.7032550 Overall Loss:65.7638542
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(69.9755, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.0916, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9982688 KL Loss: 28.2750697 DSM Loss: 35.6559152 Overall Loss:65.9292535
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(53.7857, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.6793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8124, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9744082 KL Loss: 27.8849885 DSM Loss: 36.1279476 Overall Loss:65.9873439
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(61.5885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.0213, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0668, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 2.0563314 KL Loss: 28.1806688 DSM Loss: 34.8991901 Overall Loss:65.1361903
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(69.8154, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6192, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 2.0344832 KL Loss: 28.0488387 DSM Loss: 35.5528242 Overall Loss:65.6361459
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(61.4248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.1046, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5689, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 2.0514148 KL Loss: 28.3890493 DSM Loss: 35.7866312 Overall Loss:66.2270953
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(55.3327, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4388, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2420, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 2.0807414 KL Loss: 28.1439537 DSM Loss: 35.0834888 Overall Loss:65.3081840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NEE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.982943534851074


Running on file NGG.csv (46/71)...
Use GPU: cuda:0
>>>>>>>start training : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(104.4210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.6054, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3026, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9108629 KL Loss: 28.3871439 DSM Loss: 47.5208919 Overall Loss:77.8188985
Validation loss decreased (inf --> 9.890639).  Saving model ...
Updating learning rate to 0.0005
tensor(79.2983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7483, device='cuda:0', grad_fn=<AddBackward0>)
tensor(91.2472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9715004 KL Loss: 28.3548393 DSM Loss: 38.9629905 Overall Loss:69.2893303
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(65.6427, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0519, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.1384, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9497020 KL Loss: 28.2888306 DSM Loss: 37.4718493 Overall Loss:67.7103819
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(62.8693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.5955, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9818622 KL Loss: 28.4577098 DSM Loss: 36.8733394 Overall Loss:67.3129117
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(63.3026, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.4638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.5789, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9354604 KL Loss: 28.2222748 DSM Loss: 36.4097684 Overall Loss:66.5675035
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(88.5422, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.0191, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.0492, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9271376 KL Loss: 28.2317848 DSM Loss: 36.8402459 Overall Loss:66.9991681
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(76.1498, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.8050, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9378881 KL Loss: 28.3153597 DSM Loss: 36.6840276 Overall Loss:66.9372752
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(55.5295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.8326, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5201, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9202374 KL Loss: 28.3133515 DSM Loss: 36.7340209 Overall Loss:66.9676100
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(73.9142, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1294, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7422, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9046880 KL Loss: 28.2206529 DSM Loss: 36.5332220 Overall Loss:66.6585631
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(61.9709, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.4052, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.2867, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9455738 KL Loss: 28.3539005 DSM Loss: 36.0000695 Overall Loss:66.2995437
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(61.9622, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.2932, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9497194 KL Loss: 28.4315452 DSM Loss: 36.4252670 Overall Loss:66.8065318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NGG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.715330600738525


Running on file NVS.csv (47/71)...
Use GPU: cuda:0
>>>>>>>start training : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(115.5321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4538, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8662228 KL Loss: 27.8484107 DSM Loss: 45.2646604 Overall Loss:74.9792941
Validation loss decreased (inf --> 0.998930).  Saving model ...
Updating learning rate to 0.0005
tensor(55.4123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4369, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.3655, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9117351 KL Loss: 28.2661648 DSM Loss: 37.7664424 Overall Loss:67.9443424
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(61.1719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0037, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6103, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9128567 KL Loss: 28.2737478 DSM Loss: 36.5796153 Overall Loss:66.7662194
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(65.7754, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6084, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9006576 KL Loss: 28.0948823 DSM Loss: 35.9211225 Overall Loss:65.9166626
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(58.7744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9660, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8174, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8914845 KL Loss: 28.0737532 DSM Loss: 35.4902977 Overall Loss:65.4555355
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(57.9324, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0820, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0660, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8861335 KL Loss: 28.0794954 DSM Loss: 35.1510260 Overall Loss:65.1166549
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(73.4243, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5447, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.4043, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8781304 KL Loss: 28.0710730 DSM Loss: 34.8718198 Overall Loss:64.8210231
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(73.1318, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6407, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6032, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8520089 KL Loss: 27.8230525 DSM Loss: 35.2212358 Overall Loss:64.8962971
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(61.1215, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.0766, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8716721 KL Loss: 27.8762233 DSM Loss: 35.3870508 Overall Loss:65.1349465
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(63.6787, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3339, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.6414, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8704972 KL Loss: 27.9175455 DSM Loss: 35.0752181 Overall Loss:64.8632607
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(66.1966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.4463, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.7337, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8846745 KL Loss: 27.9289599 DSM Loss: 35.5888437 Overall Loss:65.4024784
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : NVS.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:4.448439598083496


Running on file ORCL.csv (48/71)...
Use GPU: cuda:0
>>>>>>>start training : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(101.4330, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2174, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.7578, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8776832 KL Loss: 27.8575668 DSM Loss: 40.6804000 Overall Loss:70.4156502
Validation loss decreased (inf --> 11.389946).  Saving model ...
Updating learning rate to 0.0005
tensor(61.5384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5178, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.1319, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8638892 KL Loss: 27.7045015 DSM Loss: 33.2314133 Overall Loss:62.7998042
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(52.7345, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.1822, device='cuda:0', grad_fn=<AddBackward0>)
tensor(39.4079, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8529421 KL Loss: 27.5157170 DSM Loss: 31.9391503 Overall Loss:61.3078094
Validation loss decreased (11.389946 --> 11.226256).  Saving model ...
Updating learning rate to 0.000125
tensor(51.5909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.8018, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8548333 KL Loss: 27.3601159 DSM Loss: 31.2563101 Overall Loss:60.4712595
Validation loss decreased (11.226256 --> 11.129431).  Saving model ...
Updating learning rate to 6.25e-05
tensor(88.1585, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.7444, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.4619, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8485926 KL Loss: 27.3295585 DSM Loss: 30.5242671 Overall Loss:59.7024178
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(64.8304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1238, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5439, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8780083 KL Loss: 27.4090538 DSM Loss: 30.0634168 Overall Loss:59.3504789
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-05
tensor(63.3966, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.5083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8438, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8657970 KL Loss: 27.2824314 DSM Loss: 30.6094671 Overall Loss:59.7576959
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-06
tensor(72.8664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0262, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.1061, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9012542 KL Loss: 27.7174155 DSM Loss: 30.6172076 Overall Loss:60.2358772
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-06
tensor(58.0528, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.5184, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.4734, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9102370 KL Loss: 27.6472227 DSM Loss: 30.5284102 Overall Loss:60.0858697
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-06
tensor(58.3539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.0718, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8807, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8621348 KL Loss: 27.3633846 DSM Loss: 30.9702960 Overall Loss:60.1958154
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765625e-07
tensor(44.4115, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8462, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1836, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8632262 KL Loss: 27.2053849 DSM Loss: 30.3422224 Overall Loss:59.4108337
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.8828125e-07
tensor(69.7167, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5032, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.3493, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8626005 KL Loss: 27.2618195 DSM Loss: 30.6615454 Overall Loss:59.7859655
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.44140625e-07
tensor(124.1311, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.6365, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.5774, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8898130 KL Loss: 27.6069080 DSM Loss: 31.1645002 Overall Loss:60.6612212
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.220703125e-07
tensor(88.8686, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6752, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9923, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8937937 KL Loss: 27.4574530 DSM Loss: 30.7712148 Overall Loss:60.1224613
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : ORCL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:18.1943302154541


Running on file PCG.csv (49/71)...
Use GPU: cuda:0
>>>>>>>start training : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(102.9187, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.2632, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0331242 KL Loss: 28.3938572 DSM Loss: 46.1199472 Overall Loss:76.5469283
Validation loss decreased (inf --> 1.371798).  Saving model ...
Updating learning rate to 0.0005
tensor(67.8763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.9684, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9866547 KL Loss: 28.3692707 DSM Loss: 40.1771398 Overall Loss:70.5330655
Validation loss decreased (1.371798 --> 0.777963).  Saving model ...
Updating learning rate to 0.00025
tensor(78.4105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1423, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.5300, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9860156 KL Loss: 28.4920051 DSM Loss: 38.8954555 Overall Loss:69.3734760
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(64.2643, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.3554, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8591, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9034979 KL Loss: 28.2966680 DSM Loss: 38.9424585 Overall Loss:69.1426246
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(76.4518, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.7540, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8737, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9009409 KL Loss: 28.3092111 DSM Loss: 38.2399669 Overall Loss:68.4501190
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(63.1004, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8449, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.1698, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9332648 KL Loss: 28.4771099 DSM Loss: 38.5229608 Overall Loss:68.9333356
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(61.2257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.9367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8554, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9248432 KL Loss: 28.4597676 DSM Loss: 38.3545356 Overall Loss:68.7391459
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(70.8481, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.3175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.1327, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9488449 KL Loss: 28.6380909 DSM Loss: 37.7940242 Overall Loss:68.3809600
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(68.2957, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.3273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.9265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9397831 KL Loss: 28.5520608 DSM Loss: 38.3200297 Overall Loss:68.8118736
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(71.0714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0208, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9389109 KL Loss: 28.5988159 DSM Loss: 38.6123328 Overall Loss:69.1500594
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(73.0047, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.0001, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.7840, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9493102 KL Loss: 28.5761194 DSM Loss: 38.3486716 Overall Loss:68.8741014
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(62.1946, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0899, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9207761 KL Loss: 28.4978431 DSM Loss: 38.4919630 Overall Loss:68.9105823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PCG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.5205588340759277


Running on file PEP.csv (50/71)...
Use GPU: cuda:0
>>>>>>>start training : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(103.3081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5517, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8674, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8866051 KL Loss: 27.9182667 DSM Loss: 41.5738385 Overall Loss:71.3787102
Validation loss decreased (inf --> 7.907478).  Saving model ...
Updating learning rate to 0.0005
tensor(71.1201, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.4763, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6812, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9431594 KL Loss: 28.0591128 DSM Loss: 35.3111251 Overall Loss:65.3133972
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(62.0938, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6569, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8353, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9960228 KL Loss: 28.4462561 DSM Loss: 34.6061217 Overall Loss:65.0484006
Validation loss decreased (7.907478 --> 7.572295).  Saving model ...
Updating learning rate to 0.000125
tensor(71.4537, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0874, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9277104 KL Loss: 28.2265562 DSM Loss: 34.3892619 Overall Loss:64.5435281
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(61.6416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5107, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.9088, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9042288 KL Loss: 28.1069250 DSM Loss: 34.1902529 Overall Loss:64.2014066
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(61.8968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8780, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1150, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9011239 KL Loss: 28.0996873 DSM Loss: 33.5952412 Overall Loss:63.5960526
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(63.9370, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4543, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0401, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8714692 KL Loss: 28.0442702 DSM Loss: 33.7854192 Overall Loss:63.7011585
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(69.8959, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.2793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.8918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8822932 KL Loss: 28.0846123 DSM Loss: 34.0259321 Overall Loss:63.9928378
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(68.9176, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.7937, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6148, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8719196 KL Loss: 28.1364156 DSM Loss: 33.4718877 Overall Loss:63.4802228
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(65.8893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.8144, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.2834, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8759812 KL Loss: 27.9558215 DSM Loss: 33.6495313 Overall Loss:63.4813343
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(62.4377, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7083, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1398, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8759759 KL Loss: 27.9764151 DSM Loss: 33.3971214 Overall Loss:63.2495125
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(56.8968, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3751, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.8564, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8759630 KL Loss: 27.8592596 DSM Loss: 33.7593771 Overall Loss:63.4945996
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(62.6676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5885, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.7984, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8817995 KL Loss: 28.0910823 DSM Loss: 33.6355549 Overall Loss:63.6084364
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PEP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:13.675843238830566


Running on file PFE.csv (51/71)...
Use GPU: cuda:0
>>>>>>>start training : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(94.8247, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6578, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.2442, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9005514 KL Loss: 28.3082906 DSM Loss: 39.1109473 Overall Loss:69.3197895
Validation loss decreased (inf --> 18.310922).  Saving model ...
Updating learning rate to 0.0005
tensor(62.6699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.2722, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.4961, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.8914241 KL Loss: 28.2276231 DSM Loss: 34.4451715 Overall Loss:64.5642188
Validation loss decreased (18.310922 --> 17.602803).  Saving model ...
Updating learning rate to 0.00025
tensor(66.7284, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1969, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.2222, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8628689 KL Loss: 28.0524875 DSM Loss: 33.2744730 Overall Loss:63.1898292
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(60.6530, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.1075, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.4049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8655582 KL Loss: 28.1430110 DSM Loss: 32.0100602 Overall Loss:62.0186292
Validation loss decreased (17.602803 --> 17.526425).  Saving model ...
Updating learning rate to 6.25e-05
tensor(63.4391, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.9793, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3627, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8883488 KL Loss: 28.1655810 DSM Loss: 32.2544556 Overall Loss:62.3083855
Validation loss decreased (17.526425 --> 17.454772).  Saving model ...
Updating learning rate to 3.125e-05
tensor(63.8898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.8063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9726, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8813192 KL Loss: 28.0395889 DSM Loss: 32.2423331 Overall Loss:62.1632410
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(65.2196, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.3510, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7036, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8871396 KL Loss: 28.0075595 DSM Loss: 32.2043214 Overall Loss:62.0990203
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(63.0241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.0599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.0019, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8865835 KL Loss: 28.1746322 DSM Loss: 31.4587999 Overall Loss:61.5200157
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(72.0013, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8439, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1795, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8821513 KL Loss: 28.1006822 DSM Loss: 31.5439609 Overall Loss:61.5267940
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(61.4993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4664, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.1938, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8891663 KL Loss: 28.0864817 DSM Loss: 32.2625760 Overall Loss:62.2382236
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(64.6655, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8912, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.0219, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8676981 KL Loss: 27.9494855 DSM Loss: 32.0589738 Overall Loss:61.8761576
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(59.6135, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.8607, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0532, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8589334 KL Loss: 28.0055270 DSM Loss: 31.8193003 Overall Loss:61.6837612
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(51.3525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.9229, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.3716, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8479266 KL Loss: 27.8901763 DSM Loss: 31.9668636 Overall Loss:61.7049664
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(55.7593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6553, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.8370, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8764898 KL Loss: 27.9890144 DSM Loss: 31.8222526 Overall Loss:61.6877565
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(56.6476, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.8300, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9568, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.8708512 KL Loss: 27.9316813 DSM Loss: 32.0117360 Overall Loss:61.8142686
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PFE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:8.52076244354248


Running on file PG.csv (52/71)...
Use GPU: cuda:0
>>>>>>>start training : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(109.8562, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.1129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5125, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9664808 KL Loss: 28.1018164 DSM Loss: 44.8445003 Overall Loss:74.9127974
Validation loss decreased (inf --> 5.420304).  Saving model ...
Updating learning rate to 0.0005
tensor(69.2403, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.6376, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.0166, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 2.0024458 KL Loss: 28.3562412 DSM Loss: 39.0564728 Overall Loss:69.4151599
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(63.5636, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.7677, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.6800, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9485775 KL Loss: 28.0248386 DSM Loss: 37.1676139 Overall Loss:67.1410299
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(66.2030, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3630, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8960, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8863841 KL Loss: 27.7852801 DSM Loss: 36.3668232 Overall Loss:66.0384871
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(72.1934, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2904, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4959, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8950577 KL Loss: 27.8548605 DSM Loss: 36.7643651 Overall Loss:66.5142834
Validation loss decreased (5.420304 --> 5.396523).  Saving model ...
Updating learning rate to 3.125e-05
tensor(51.1871, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.1457, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.1190, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9242146 KL Loss: 27.9607427 DSM Loss: 36.2526208 Overall Loss:66.1375781
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(64.1828, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.5559, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3372, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9184405 KL Loss: 27.9274260 DSM Loss: 36.3064327 Overall Loss:66.1522992
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(80.0932, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.9699, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6944, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8576381 KL Loss: 27.4765198 DSM Loss: 36.0591678 Overall Loss:65.3933260
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(61.8653, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8541, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.0458, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8803874 KL Loss: 27.6973236 DSM Loss: 36.2696331 Overall Loss:65.8473444
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(57.2713, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.6968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8988878 KL Loss: 27.6767650 DSM Loss: 36.3032586 Overall Loss:65.8789113
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(65.9028, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.8826, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8879410 KL Loss: 27.6309277 DSM Loss: 35.9686757 Overall Loss:65.4875444
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(69.4753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.4352, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.1541, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8834479 KL Loss: 27.6628765 DSM Loss: 36.2155285 Overall Loss:65.7618528
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(72.5640, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.2617, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.1411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8974322 KL Loss: 27.6379722 DSM Loss: 36.4484619 Overall Loss:65.9838666
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(74.3437, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3566, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1954, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8882182 KL Loss: 27.8304974 DSM Loss: 36.3055816 Overall Loss:66.0242971
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(63.9877, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8920, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9703, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.8677292 KL Loss: 27.5122709 DSM Loss: 36.0519047 Overall Loss:65.4319049
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PG.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:5.100332736968994


Running on file PM.csv (53/71)...
Use GPU: cuda:0
>>>>>>>start training : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(76.5819, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5696, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1577, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9445960 KL Loss: 28.4412237 DSM Loss: 44.0620964 Overall Loss:74.4479158
Validation loss decreased (inf --> 4.911132).  Saving model ...
Updating learning rate to 0.0005
tensor(60.0138, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0747, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.8430, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9743154 KL Loss: 28.4505888 DSM Loss: 38.4696303 Overall Loss:68.8945343
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(72.5469, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0034, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9628192 KL Loss: 28.2280161 DSM Loss: 36.1614606 Overall Loss:66.3522961
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(56.3456, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.7464, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9261771 KL Loss: 28.1879077 DSM Loss: 36.7778656 Overall Loss:66.8919502
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(74.8257, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.2141, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9367703 KL Loss: 28.2947694 DSM Loss: 36.1996441 Overall Loss:66.4311841
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(54.3451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7165, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9080890 KL Loss: 28.1469940 DSM Loss: 36.3490459 Overall Loss:66.4041288
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(55.5532, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.0549, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7534, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9112235 KL Loss: 28.0576804 DSM Loss: 36.0936269 Overall Loss:66.0625307
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(67.7416, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.9105, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.7526, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9440609 KL Loss: 28.3831743 DSM Loss: 35.1800008 Overall Loss:65.5072357
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(77.2999, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9949, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.7403, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9545167 KL Loss: 28.2404837 DSM Loss: 35.7471963 Overall Loss:65.9421969
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(53.7853, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.4353, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.8105, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9383685 KL Loss: 28.2379342 DSM Loss: 36.2014405 Overall Loss:66.3777431
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(74.2406, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1212, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9815786 KL Loss: 28.3044128 DSM Loss: 35.4933112 Overall Loss:65.7793024
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.1158127784729


Running on file PPL.csv (54/71)...
Use GPU: cuda:0
>>>>>>>start training : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(100.6460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(110.2504, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0687, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9955694 KL Loss: 28.6297181 DSM Loss: 57.7365658 Overall Loss:88.3618532
Validation loss decreased (inf --> 0.589172).  Saving model ...
Updating learning rate to 0.0005
tensor(63.0081, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.5295, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.4456, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9460289 KL Loss: 28.2222025 DSM Loss: 42.4728700 Overall Loss:72.6411013
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(80.3740, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.1942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.9179, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9684353 KL Loss: 28.4369790 DSM Loss: 40.1075677 Overall Loss:70.5129818
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(56.3658, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.7894, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.4240, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9802375 KL Loss: 28.4828634 DSM Loss: 40.1086891 Overall Loss:70.5717900
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(78.5979, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9315, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9418111 KL Loss: 28.2908568 DSM Loss: 39.7723555 Overall Loss:70.0050231
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(91.6304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.4091, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.2318, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9484656 KL Loss: 28.3218247 DSM Loss: 40.0165267 Overall Loss:70.2868167
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(61.8702, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.8659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.6286, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9388509 KL Loss: 28.3777503 DSM Loss: 40.1109587 Overall Loss:70.4275599
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(65.4372, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.4181, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3890, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9697404 KL Loss: 28.5132414 DSM Loss: 38.7634302 Overall Loss:69.2464120
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(64.5193, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.5659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.9411, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9281508 KL Loss: 28.2952081 DSM Loss: 39.5343063 Overall Loss:69.7576656
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(76.6594, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.3092, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0069, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9377868 KL Loss: 28.4359867 DSM Loss: 39.6183926 Overall Loss:69.9921665
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(76.3438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.8037, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9445917 KL Loss: 28.3573488 DSM Loss: 39.1899221 Overall Loss:69.4918627
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : PPL.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.7629876136779785


Running on file REX.csv (55/71)...
Use GPU: cuda:0
>>>>>>>start training : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(141.8123, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.6928, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.8049, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9406165 KL Loss: 28.3034732 DSM Loss: 47.5487759 Overall Loss:77.7928655
Validation loss decreased (inf --> 1.413238).  Saving model ...
Updating learning rate to 0.0005
tensor(57.7542, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2321, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4217, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9277222 KL Loss: 28.2473550 DSM Loss: 35.0346920 Overall Loss:65.2097691
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(69.2392, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.0603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2441, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9107710 KL Loss: 28.0821297 DSM Loss: 34.4207675 Overall Loss:64.4136681
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(57.6950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3087, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.3014, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9374890 KL Loss: 28.3447968 DSM Loss: 33.1090865 Overall Loss:63.3913720
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(53.4798, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.5802, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.4884, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9127288 KL Loss: 27.9663750 DSM Loss: 33.1219297 Overall Loss:63.0010334
Validation loss decreased (1.413238 --> 1.364734).  Saving model ...
Updating learning rate to 3.125e-05
tensor(52.7860, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2207, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.7306, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9198845 KL Loss: 28.2026001 DSM Loss: 32.9689331 Overall Loss:63.0914172
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-05
tensor(68.1560, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2514, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5665, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9302211 KL Loss: 28.2014674 DSM Loss: 33.0841326 Overall Loss:63.2158210
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-06
tensor(54.0355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.4137, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9090704 KL Loss: 28.1121886 DSM Loss: 32.5677639 Overall Loss:62.5890227
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.90625e-06
tensor(60.7260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2989, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.2506, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9311894 KL Loss: 28.2104575 DSM Loss: 32.6255617 Overall Loss:62.7672085
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.953125e-06
tensor(65.9948, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.8500, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7900, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9119365 KL Loss: 28.0987784 DSM Loss: 33.0630836 Overall Loss:63.0737983
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.765625e-07
tensor(73.9254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.9134, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1002, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9368441 KL Loss: 28.3858181 DSM Loss: 32.7439429 Overall Loss:63.0666051
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.8828125e-07
tensor(80.9260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5727, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0647, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8989486 KL Loss: 28.1725575 DSM Loss: 32.7312986 Overall Loss:62.8028043
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.44140625e-07
tensor(72.8547, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9753, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.2196, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.9274134 KL Loss: 28.2268400 DSM Loss: 32.9428236 Overall Loss:63.0970771
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.220703125e-07
tensor(63.2942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.7984, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.4531, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.8987047 KL Loss: 28.0853160 DSM Loss: 33.2864013 Overall Loss:63.2704217
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.103515625e-08
tensor(58.7482, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.4036, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.6600, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 1.8963541 KL Loss: 28.0538515 DSM Loss: 32.7077185 Overall Loss:62.6579242
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : REX.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.7683968544006348


Running on file SLB.csv (56/71)...
Use GPU: cuda:0
>>>>>>>start training : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(116.1171, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7827, device='cuda:0', grad_fn=<AddBackward0>)
tensor(100.3365, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9875740 KL Loss: 28.2354078 DSM Loss: 50.1207772 Overall Loss:80.3437589
Validation loss decreased (inf --> 0.187246).  Saving model ...
Updating learning rate to 0.0005
tensor(68.1485, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.6491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6913, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9545007 KL Loss: 28.3223319 DSM Loss: 41.2980555 Overall Loss:71.5748881
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(79.9935, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5347, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.9761, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9358089 KL Loss: 28.2613120 DSM Loss: 40.5786981 Overall Loss:70.7758188
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(74.3778, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.0698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.6705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9402255 KL Loss: 28.2684257 DSM Loss: 39.3295731 Overall Loss:69.5382241
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(70.1627, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1124, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.3597, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9738800 KL Loss: 28.4650372 DSM Loss: 38.7390187 Overall Loss:69.1779355
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(66.6706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.4335, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9368532 KL Loss: 28.4126894 DSM Loss: 38.5990176 Overall Loss:68.9485603
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(67.3955, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.6656, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.0998, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9312584 KL Loss: 28.3647989 DSM Loss: 38.9332667 Overall Loss:69.2293238
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(61.6063, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3941, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9055, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9308225 KL Loss: 28.4241695 DSM Loss: 38.9006302 Overall Loss:69.2556220
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(73.1489, device='cuda:0', grad_fn=<AddBackward0>)
tensor(83.1950, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.3838, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9340746 KL Loss: 28.5082788 DSM Loss: 38.5476047 Overall Loss:68.9899583
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(68.2915, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.5800, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9794, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9579728 KL Loss: 28.4391218 DSM Loss: 38.0832886 Overall Loss:68.4803834
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(69.5558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.2384, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0122, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9622892 KL Loss: 28.4593581 DSM Loss: 38.5210176 Overall Loss:68.9426650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SLB.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:0.31467360258102417


Running on file SNY.csv (57/71)...
Use GPU: cuda:0
>>>>>>>start training : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(111.1451, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.3623, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9383705 KL Loss: 28.3091476 DSM Loss: 42.4750740 Overall Loss:72.7225924
Validation loss decreased (inf --> 3.046804).  Saving model ...
Updating learning rate to 0.0005
tensor(51.2048, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.1535, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.8341, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9369432 KL Loss: 28.0255829 DSM Loss: 36.6273617 Overall Loss:66.5898880
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(61.8675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3593, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.1558, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8655703 KL Loss: 27.8977027 DSM Loss: 35.3717020 Overall Loss:65.1349748
Validation loss decreased (3.046804 --> 2.714339).  Saving model ...
Updating learning rate to 0.000125
tensor(61.9521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5066, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.3261, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9123945 KL Loss: 28.2482586 DSM Loss: 35.4187239 Overall Loss:65.5793770
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-05
tensor(55.3659, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5736, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8642626 KL Loss: 28.0358258 DSM Loss: 35.0034194 Overall Loss:64.9035076
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-05
tensor(73.8521, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3861, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0644, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8971303 KL Loss: 27.9695458 DSM Loss: 34.3737493 Overall Loss:64.2404253
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5625e-05
tensor(61.1892, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5366, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.6385, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8821571 KL Loss: 27.9138338 DSM Loss: 35.0946403 Overall Loss:64.8906312
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.8125e-06
tensor(65.6606, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.8289, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.8652, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8789384 KL Loss: 27.9284989 DSM Loss: 34.8348972 Overall Loss:64.6423345
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.90625e-06
tensor(64.3711, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.0609, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8508064 KL Loss: 27.8027971 DSM Loss: 34.7742494 Overall Loss:64.4278528
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.953125e-06
tensor(57.3834, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.2273, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.5995, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8622309 KL Loss: 27.8586223 DSM Loss: 35.1201807 Overall Loss:64.8410342
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.765625e-07
tensor(60.4367, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.3033, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5629, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8618153 KL Loss: 27.8266598 DSM Loss: 35.1864702 Overall Loss:64.8749454
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.8828125e-07
tensor(78.3415, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0527, device='cuda:0', grad_fn=<AddBackward0>)
tensor(51.0498, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8818043 KL Loss: 28.1247507 DSM Loss: 34.8972332 Overall Loss:64.9037883
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.44140625e-07
tensor(70.4796, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.2255, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9876, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 1.8975650 KL Loss: 28.1768609 DSM Loss: 34.4079966 Overall Loss:64.4824226
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SNY.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:3.9696099758148193


Running on file SO.csv (58/71)...
Use GPU: cuda:0
>>>>>>>start training : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(104.4638, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.0520, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3918, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 2.0065169 KL Loss: 28.2164519 DSM Loss: 45.7766475 Overall Loss:75.9996160
Validation loss decreased (inf --> 5.284376).  Saving model ...
Updating learning rate to 0.0005
tensor(54.1898, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8797, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1484, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9834148 KL Loss: 28.3305887 DSM Loss: 38.1570008 Overall Loss:68.4710043
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(71.7442, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.9539, device='cuda:0', grad_fn=<AddBackward0>)
tensor(72.0412, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9439539 KL Loss: 28.0573321 DSM Loss: 37.5009141 Overall Loss:67.5021998
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(75.7783, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6714, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.3267, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9454825 KL Loss: 27.9717125 DSM Loss: 36.9585148 Overall Loss:66.8757094
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(74.7203, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.2671, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8565780 KL Loss: 27.6801767 DSM Loss: 36.6267531 Overall Loss:66.1635079
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(65.2731, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1992, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.8152, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9050665 KL Loss: 27.7453700 DSM Loss: 35.8369890 Overall Loss:65.4874257
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(77.6190, device='cuda:0', grad_fn=<AddBackward0>)
tensor(60.9676, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.4170, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9329828 KL Loss: 28.0679552 DSM Loss: 36.3751233 Overall Loss:66.3760614
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(54.5945, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9891, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.8587, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9317005 KL Loss: 27.9104612 DSM Loss: 36.4702617 Overall Loss:66.3124230
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(58.0675, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.0049, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.5424, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9152850 KL Loss: 28.0304050 DSM Loss: 36.6633663 Overall Loss:66.6090566
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(67.2074, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.6983, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.3305, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9035663 KL Loss: 27.7514126 DSM Loss: 36.2326490 Overall Loss:65.8876278
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(60.7205, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.0893, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.3408, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9417700 KL Loss: 28.1711363 DSM Loss: 36.1143839 Overall Loss:66.2272903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SO.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:9.484278678894043


Running on file SPLP.csv (59/71)...
Use GPU: cuda:0
>>>>>>>start training : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(144.0206, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.0480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3816, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9854763 KL Loss: 28.3905489 DSM Loss: 46.4682399 Overall Loss:76.8442650
Validation loss decreased (inf --> 20.796590).  Saving model ...
Updating learning rate to 0.0005
tensor(53.0682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.1401, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.4345, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9430808 KL Loss: 28.2459280 DSM Loss: 36.1839237 Overall Loss:66.3729327
Validation loss decreased (20.796590 --> 18.434938).  Saving model ...
Updating learning rate to 0.00025
tensor(79.7085, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.8494, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9141351 KL Loss: 28.2828753 DSM Loss: 35.7733602 Overall Loss:65.9703705
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(59.5061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.2122, device='cuda:0', grad_fn=<AddBackward0>)
tensor(85.6030, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8963375 KL Loss: 28.0780970 DSM Loss: 34.6408470 Overall Loss:64.6152812
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(43.0132, device='cuda:0', grad_fn=<AddBackward0>)
tensor(109.8584, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.5992, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8927952 KL Loss: 28.0590357 DSM Loss: 34.7237077 Overall Loss:64.6755384
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(64.3061, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3241, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.0650, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8762649 KL Loss: 27.7850896 DSM Loss: 35.2317747 Overall Loss:64.8931291
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(57.0363, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.6884, device='cuda:0', grad_fn=<AddBackward0>)
tensor(89.2888, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9291585 KL Loss: 28.1229676 DSM Loss: 34.2686680 Overall Loss:64.3207942
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(49.4149, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.0909, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.5588, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8860053 KL Loss: 28.0050008 DSM Loss: 34.7103168 Overall Loss:64.6013228
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(67.9719, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.2491, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.9682, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8861943 KL Loss: 27.8612271 DSM Loss: 34.6843194 Overall Loss:64.4317405
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(78.6053, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.5360, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9290, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9210440 KL Loss: 28.2074437 DSM Loss: 34.4928656 Overall Loss:64.6213531
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(48.1466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(49.1277, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.8810, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9141615 KL Loss: 28.5847543 DSM Loss: 33.7058294 Overall Loss:64.2047453
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(91.4668, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.6706, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.9501, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8950648 KL Loss: 28.1309403 DSM Loss: 34.1860935 Overall Loss:64.2120985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SPLP.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:31.16008949279785


Running on file SRE.csv (60/71)...
Use GPU: cuda:0
>>>>>>>start training : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(106.3712, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.4994, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5348, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9910874 KL Loss: 28.3238831 DSM Loss: 42.8168179 Overall Loss:73.1317887
Validation loss decreased (inf --> 3.340432).  Saving model ...
Updating learning rate to 0.0005
tensor(69.6471, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.7094, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.6586, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9386689 KL Loss: 28.2248307 DSM Loss: 35.4865127 Overall Loss:65.6500123
Validation loss decreased (3.340432 --> 3.040319).  Saving model ...
Updating learning rate to 0.00025
tensor(65.0716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.4679, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.9415, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9154741 KL Loss: 28.0817930 DSM Loss: 35.4560180 Overall Loss:65.4532849
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000125
tensor(73.0248, device='cuda:0', grad_fn=<AddBackward0>)
tensor(71.6499, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.4570, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8916983 KL Loss: 27.9247463 DSM Loss: 34.9416317 Overall Loss:64.7580764
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.25e-05
tensor(61.9693, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.5856, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6504, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8971636 KL Loss: 28.0288613 DSM Loss: 34.8955050 Overall Loss:64.8215302
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.125e-05
tensor(66.7603, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.7185, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1074, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8903023 KL Loss: 28.0047531 DSM Loss: 35.1208833 Overall Loss:65.0159389
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5625e-05
tensor(66.2745, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.7674, device='cuda:0', grad_fn=<AddBackward0>)
tensor(67.6968, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9124869 KL Loss: 28.1680201 DSM Loss: 34.6901648 Overall Loss:64.7706718
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.8125e-06
tensor(70.3325, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9924, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.3551, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8844831 KL Loss: 27.8731614 DSM Loss: 34.4357639 Overall Loss:64.1934087
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.90625e-06
tensor(71.1298, device='cuda:0', grad_fn=<AddBackward0>)
tensor(62.8497, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.8626, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8863821 KL Loss: 27.9995785 DSM Loss: 35.0038108 Overall Loss:64.8897714
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.953125e-06
tensor(67.4716, device='cuda:0', grad_fn=<AddBackward0>)
tensor(52.5838, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.8750, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8834373 KL Loss: 27.9619116 DSM Loss: 34.6490810 Overall Loss:64.4944299
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.765625e-07
tensor(57.9592, device='cuda:0', grad_fn=<AddBackward0>)
tensor(47.6558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.7699, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8662288 KL Loss: 27.8136750 DSM Loss: 34.2113348 Overall Loss:63.8912385
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.8828125e-07
tensor(55.4744, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.6895, device='cuda:0', grad_fn=<AddBackward0>)
tensor(78.4163, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.8453129 KL Loss: 27.9602817 DSM Loss: 34.4978205 Overall Loss:64.3034153
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : SRE.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:7.160778045654297


Running on file T.csv (61/71)...
Use GPU: cuda:0
>>>>>>>start training : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(92.1147, device='cuda:0', grad_fn=<AddBackward0>)
tensor(96.0981, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.0464, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9810704 KL Loss: 28.5784217 DSM Loss: 45.2354794 Overall Loss:75.7949711
Validation loss decreased (inf --> 0.533398).  Saving model ...
Updating learning rate to 0.0005
tensor(48.5172, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.2319, device='cuda:0', grad_fn=<AddBackward0>)
tensor(88.6823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9268767 KL Loss: 28.3333974 DSM Loss: 37.4586064 Overall Loss:67.7188802
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(72.9460, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.0312, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.5524, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9962556 KL Loss: 28.6637565 DSM Loss: 36.7618021 Overall Loss:67.4218141
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(69.3480, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.5832, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.9684, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9556427 KL Loss: 28.4149049 DSM Loss: 36.7730210 Overall Loss:67.1435684
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(78.3151, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2558, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.6912, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9343393 KL Loss: 28.1507811 DSM Loss: 36.8204842 Overall Loss:66.9056040
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(44.4985, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.2698, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.3472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 2.0036039 KL Loss: 28.6164949 DSM Loss: 36.1382417 Overall Loss:66.7583407
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(79.7614, device='cuda:0', grad_fn=<AddBackward0>)
tensor(92.4128, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.9813, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9423588 KL Loss: 28.3357089 DSM Loss: 36.1912249 Overall Loss:66.4692922
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(52.1250, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.9573, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.2702, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.9233086 KL Loss: 28.3384513 DSM Loss: 37.1234870 Overall Loss:67.3852468
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(81.8058, device='cuda:0', grad_fn=<AddBackward0>)
tensor(84.2285, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.9265, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.9910775 KL Loss: 28.5506832 DSM Loss: 36.1747406 Overall Loss:66.7165012
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(59.9354, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.6993, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.6889, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.9725477 KL Loss: 28.5222984 DSM Loss: 36.2408154 Overall Loss:66.7356614
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(59.7268, device='cuda:0', grad_fn=<AddBackward0>)
tensor(44.3301, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.6107, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.9408260 KL Loss: 28.3884504 DSM Loss: 36.4215699 Overall Loss:66.7508461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : T.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:1.4723563194274902


Running on file TM.csv (62/71)...
Use GPU: cuda:0
>>>>>>>start training : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(100.4705, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.0967, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.9548, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.9029151 KL Loss: 28.1980302 DSM Loss: 39.3525183 Overall Loss:69.4534635
Validation loss decreased (inf --> 9.107187).  Saving model ...
Updating learning rate to 0.0005
tensor(77.1254, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.4417, device='cuda:0', grad_fn=<AddBackward0>)
tensor(66.5479, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9000321 KL Loss: 27.9029727 DSM Loss: 33.2645804 Overall Loss:63.0675853
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(62.0399, device='cuda:0', grad_fn=<AddBackward0>)
tensor(82.0379, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1421, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.8745796 KL Loss: 27.7765394 DSM Loss: 33.6383474 Overall Loss:63.2894664
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(39.5757, device='cuda:0', grad_fn=<AddBackward0>)
tensor(55.9380, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.7823, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.8711035 KL Loss: 27.8532214 DSM Loss: 32.2751475 Overall Loss:61.9994722
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-05
tensor(70.7494, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.9769, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.8610, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.8807959 KL Loss: 27.6923136 DSM Loss: 31.7818505 Overall Loss:61.3549600
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-05
tensor(35.5996, device='cuda:0', grad_fn=<AddBackward0>)
tensor(50.9473, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.2872, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.8549278 KL Loss: 27.6713171 DSM Loss: 32.4795397 Overall Loss:62.0057847
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-05
tensor(109.0355, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.2472, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0237, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.8676122 KL Loss: 27.9504623 DSM Loss: 32.4451847 Overall Loss:62.2632592
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-06
tensor(57.7220, device='cuda:0', grad_fn=<AddBackward0>)
tensor(48.8438, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0328, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 1.8827212 KL Loss: 27.7101777 DSM Loss: 32.0213818 Overall Loss:61.6142803
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-06
tensor(84.7260, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.5088, device='cuda:0', grad_fn=<AddBackward0>)
tensor(54.9327, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 1.8502315 KL Loss: 27.6774093 DSM Loss: 32.2217014 Overall Loss:61.7493423
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-06
tensor(52.8341, device='cuda:0', grad_fn=<AddBackward0>)
tensor(68.1199, device='cuda:0', grad_fn=<AddBackward0>)
tensor(86.1117, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 1.8838007 KL Loss: 27.7089078 DSM Loss: 31.8240769 Overall Loss:61.4167856
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-07
tensor(70.8710, device='cuda:0', grad_fn=<AddBackward0>)
tensor(80.6095, device='cuda:0', grad_fn=<AddBackward0>)
tensor(105.7705, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 1.8947885 KL Loss: 27.7154504 DSM Loss: 31.5124921 Overall Loss:61.1227314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>start testing : TM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
test 363
mse:2.3019347190856934


Running on file TSM.csv (63/71)...
Use GPU: cuda:0
>>>>>>>start training : TSM.csv_tpEcmP_stock_L_2016_24_dva_spec_sl40>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1329
val 162
test 363
tensor(86.3988, device='cuda:0', grad_fn=<AddBackward0>)
tensor(61.5544, device='cuda:0', grad_fn=<AddBackward0>)
tensor(42.9550, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 1, Steps: 83 | MSE Loss: 1.8924970 KL Loss: 27.8482651 DSM Loss: 48.3429482 Overall Loss:78.0837097
Validation loss decreased (inf --> 4.998468).  Saving model ...
Updating learning rate to 0.0005
tensor(53.7090, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.1223, device='cuda:0', grad_fn=<AddBackward0>)
tensor(38.1760, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 2, Steps: 83 | MSE Loss: 1.9580343 KL Loss: 27.7621578 DSM Loss: 36.3585518 Overall Loss:66.0787439
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00025
tensor(48.0175, device='cuda:0', grad_fn=<AddBackward0>)
tensor(59.0146, device='cuda:0', grad_fn=<AddBackward0>)
tensor(69.2648, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 3, Steps: 83 | MSE Loss: 1.9910505 KL Loss: 27.7539399 DSM Loss: 36.8591171 Overall Loss:66.6041075
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000125
tensor(56.9795, device='cuda:0', grad_fn=<AddBackward0>)
tensor(74.5009, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.0781, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 4, Steps: 83 | MSE Loss: 1.9095951 KL Loss: 27.4389174 DSM Loss: 35.9786814 Overall Loss:65.3271941
Validation loss decreased (4.998468 --> 4.897052).  Saving model ...
Updating learning rate to 6.25e-05
tensor(58.1156, device='cuda:0', grad_fn=<AddBackward0>)
tensor(43.4466, device='cuda:0', grad_fn=<AddBackward0>)
tensor(46.7455, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 5, Steps: 83 | MSE Loss: 1.9731701 KL Loss: 27.7003823 DSM Loss: 35.6456624 Overall Loss:65.3192146
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-05
tensor(72.1906, device='cuda:0', grad_fn=<AddBackward0>)
tensor(53.1682, device='cuda:0', grad_fn=<AddBackward0>)
tensor(57.1991, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 6, Steps: 83 | MSE Loss: 1.9886723 KL Loss: 27.6738076 DSM Loss: 35.0932283 Overall Loss:64.7557078
Validation loss decreased (4.897052 --> 4.619615).  Saving model ...
Updating learning rate to 1.5625e-05
tensor(57.4305, device='cuda:0', grad_fn=<AddBackward0>)
tensor(65.2942, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.6622, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 7, Steps: 83 | MSE Loss: 1.9659170 KL Loss: 27.9358158 DSM Loss: 36.1159551 Overall Loss:66.0176879
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-06
tensor(68.9158, device='cuda:0', grad_fn=<AddBackward0>)
tensor(81.8663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(79.0198, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 8, Steps: 83 | MSE Loss: 2.0741254 KL Loss: 27.9832638 DSM Loss: 34.8706010 Overall Loss:64.9279901
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-06
tensor(49.7304, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.7100, device='cuda:0', grad_fn=<AddBackward0>)
tensor(99.8472, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 9, Steps: 83 | MSE Loss: 2.0525814 KL Loss: 28.0547425 DSM Loss: 34.5339088 Overall Loss:64.6412325
Validation loss decreased (4.619615 --> 4.347852).  Saving model ...
Updating learning rate to 1.953125e-06
tensor(35.6956, device='cuda:0', grad_fn=<AddBackward0>)
tensor(76.7210, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.5390, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 10, Steps: 83 | MSE Loss: 2.0881616 KL Loss: 27.7183490 DSM Loss: 34.4130920 Overall Loss:64.2196027
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-07
tensor(62.3129, device='cuda:0', grad_fn=<AddBackward0>)
tensor(56.1733, device='cuda:0', grad_fn=<AddBackward0>)
tensor(75.5333, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 11, Steps: 83 | MSE Loss: 2.0134659 KL Loss: 27.6328978 DSM Loss: 35.2104857 Overall Loss:64.8568496
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-07
tensor(35.9525, device='cuda:0', grad_fn=<AddBackward0>)
tensor(45.0730, device='cuda:0', grad_fn=<AddBackward0>)
tensor(77.5638, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 12, Steps: 83 | MSE Loss: 1.9767276 KL Loss: 27.9679827 DSM Loss: 35.9286443 Overall Loss:65.8733544
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-07
tensor(75.6060, device='cuda:0', grad_fn=<AddBackward0>)
tensor(70.7459, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.1394, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 13, Steps: 83 | MSE Loss: 2.0299939 KL Loss: 27.7672638 DSM Loss: 34.9519524 Overall Loss:64.7492100
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-07
tensor(71.3650, device='cuda:0', grad_fn=<AddBackward0>)
tensor(115.9663, device='cuda:0', grad_fn=<AddBackward0>)
tensor(73.7404, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 14, Steps: 83 | MSE Loss: 1.9682528 KL Loss: 27.6893360 DSM Loss: 35.5797805 Overall Loss:65.2373693
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-08
tensor(71.2057, device='cuda:0', grad_fn=<AddBackward0>)
tensor(63.3634, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.0799, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 15, Steps: 83 | MSE Loss: 2.1091410 KL Loss: 27.7521692 DSM Loss: 34.8133785 Overall Loss:64.6746887
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-08
tensor(67.5599, device='cuda:0', grad_fn=<AddBackward0>)
tensor(58.7791, device='cuda:0', grad_fn=<AddBackward0>)
tensor(64.6661, device='cuda:0', grad_fn=<AddBackward0>)
Epoch: 16, Steps: 83 | MSE Loss: 1.9853218 KL Loss: 28.1012923 DSM Loss: 35.9527444 Overall Loss:66.0393588
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-08
